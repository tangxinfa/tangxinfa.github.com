<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    <meta charset="utf-8"/>
    <title>数据库中的数据带来的诱惑 | tangxinfa&#x27;s blog</title>
    <link rel="shortcut icon" href="/static/favicon.ico" />
    <link rel="stylesheet" type="text/css" href="/style/ediary.css"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="generator" content="o-blog"/>
  </head>
  <body>
    <div class="navbar navbar-fixed-top" id="header">
      <div class="navbar-inner">
        <a class="brand" href="/" style="line-height:100%;">tangxinfa&#x27;s blog</a>
        <ul class="navbar-links">
          <li><a href="/index.xml"><i class="icon-rss icon-white"></i> 订阅</a></li>
          
          <li><a href="/index.html"><i class="icon-folder-close icon-white"></i> 技术</a></li>
          <li><a href="/category/life/0.html"><i class="icon-folder-close icon-white"></i> 生活</a></li>
        </ul>
      </div>
    </div>

    <div class="container container-fluid" id="page">
      <div class="push-header"></div>

      <div class="article">
        <header class="article-header">
          <h1>数据库中的数据带来的诱惑</h1>
        </header>
      
        <div class="article-content">
          <p>
平常开发的后台服务会有一个数据库在最底层，而最外层对客户端提供一个 Restful 接口。
</p>

<p>
在这两个层次中会定义最重要的数据结构：
</p>

<ul class="org-ul">
<li>数据库表结构</li>

<li>HTTP 请求响应体的结构</li>
</ul>

<p>
这两个层次中的相同事务往往会定义地非常相似，我们会忍不住共用它们，或者是强烈地渴望它们保持一致。这带了的一个好处是形式上很优美（统一就是美），还有就是中间不需要做任何处理或适配，客户端请求中的数据可以直接用于数据库操作，数据库中取出的数据可以直接用于响应客户端请求。ORM（Object relational mapping）就是这种思想的产物，《<a href="https://rrees.me/2007/12/12/orm-is-evil/">ORM is evil | Echo One</a>》一文对这种想法进行了驳斥：
</p>

<blockquote>
<p>
Worse, it allows people to not think of database as being a collection of, y’know, relational data but instead as being a list of entities. 
</p>

<p>
&#x2026;
</p>

<p>
The biggest problem with programmers seeing the database through the ORM reality-distortion filter is that they start thinking that the entities they deal with are the data. In most cases that simply isn’t true, or if it is it is because the entities have started to become some kind of uber-object that contains everything about everything.
</p>

<p>
&#x2026;
</p>

<p>
  You use queries to constitute a coherent and logical projection of the underlying data that
can be defined by the purpose the data is going to be used for.
</p>

<p>
&#x2026;
</p>

<p>
ORM should see itself as just being one consumer of data and learn to play better with
others. It should be about the convenience of presenting one valid method of data
modelling in a form that is more familiar to programmers. It should take away any
impedance due to having to comprehend the relational model (which I admit is hard) but it
should leave it there and stop thinking that is the true answer to complex data issues.  
</p>

<p>
太坏了，它让人意识不到数据库是关系数据的集合，误以为是实体的集合。
</p>

<p>
&#x2026;
</p>

<p>
最大的问题是程序员透过 ORM 的变形滤镜去看数据库后，
</p>

<p>
会认为数据库中的数据就是要处理的实体。
</p>

<p>
大多数情况下这不是真的，或这些“实体”成了包罗万象的对象。
</p>

<p>
&#x2026;
</p>

<p>
你应该针对数据的用途，从数据库中查询出相应的内聚逻辑实体。
</p>

<p>
&#x2026;
</p>

<p>
ORM 应该将自已看做是众多的数据消费者中的一个，学会和其它消费者共存。
</p>

<p>
要意思到 ORM 只是便捷而有效的一种数据建模方式，被程序员所熟知。
</p>

<p>
ORM 需要理解关系模型，会对数据库设计本身带来了阻力，这是不应该的，
</p>

<p>
面对复杂数据这一难题，不要指望 ORM。
</p>
</blockquote>

<p>
我们应该意识到数据库中的数据和客户端需要的“数据”是不同的，数据库中的数据就像你放在冰箱里的食材，而用户想要的是丰盛的大餐，而后台服务需要根据客户的要求利用数据库中的食材做出一道道大餐。</p>

        </div>
        <br />
        <footer class="article-footer">
          <span class="muted">
            <i class="icon-time icon-white"></i> <time datetime="2017-07-31T18:07:00+0800">2017年7月31日 18时</time>
          </span>
          <a class="tag" href="/tag/architecture/0.html"><i class="icon-tag icon-white"></i> architecture</a>
          <a class="tag" href="/tag/think/0.html"><i class="icon-tag icon-white"></i> think</a>
        </footer>
      </div>

<div id="disqus_thread"></div>
<script type="text/javascript">
  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  var disqus_shortname = 'kankananblog';

  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function() {
  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

      <div class="push-footer"></div>
    </div>

    <div id="footer">
  	  <div class="copyright" style="text-align: center;">
  	    版权所有 © 2011-2020 tangxinfa
  	    <p>Powered by <a href="https://github.com/tangxinfa/ediary">ediary</a>.</p>
  	  </div>
    </div>
  </body>
</html>
