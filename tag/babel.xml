<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:content="http://purl.org/rss/1.0/modules/content/">
    <channel>
        <title>babel - 看看俺 – KanKanAn.com</title>
        <link>http://blog.kankanan.com/tag/babel.xml</link>
        <description>记我所思，忆我所为。</description>
        <lastBuildDate>Wed, 26 Jul 2017 11:09:32 GMT</lastBuildDate>
        <docs>http://blogs.law.harvard.edu/tech/rss</docs>
        <generator>Feed for Node.js</generator>
        <image>
            <title>babel - 看看俺 – KanKanAn.com</title>
            <url>http://blog.kankanan.com/static/favicon.ico</url>
            <link>http://blog.kankanan.com/tag/babel.xml</link>
        </image>
        <copyright>版权所有 © 2011-2015 看看俺 – KanKanAn.com</copyright>
        <category>技术</category>
        <item>
            <title><![CDATA[python应用国际化：Babel]]></title>
            <link>/article/python-5e94752856fd96455316ff1a-babel.html</link>
            <guid>/article/python-5e94752856fd96455316ff1a-babel.html</guid>
            <pubDate>Sun, 09 Mar 2014 11:54:00 GMT</pubDate>
            <content:encoded><![CDATA[<p>
<a href="http://babel.pocoo.org/">Babel</a> 是 <code>Python</code> 的一个国际化工具包，原本为<i>Edgewall.org</i>下的一个项目，现在已经转为由<i>pocoo.org</i>维护。
</p>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">统一管理 <code>Python</code> 虚拟环境</h2>
<div class="outline-text-2" id="text-1">
<div class="org-src-container">

<pre class="src src-sh">yaourt -S python-virtualenvwrapper
mkdir $<span style="color: #f0c674;">HOME</span>/.virtualenvs
<span style="color: #b294bb;">echo</span> <span style="color: #8abeb7;">'export WORKON_HOME=$HOME/.virtualenvs'</span> &gt;&gt; ~/.bashrc
<span style="color: #b294bb;">echo</span> <span style="color: #8abeb7;">'source virtualenvwrapper.sh'</span> &gt;&gt; ~/.bashrc
<span style="color: #b294bb;">source</span> ~/.bashrc
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">建立学习 <code>Babel</code> 专用虚拟环境</h2>
<div class="outline-text-2" id="text-2">
<div class="org-src-container">

<pre class="src src-sh">mkvirtualenv --python=/usr/bin/python2 --no-site-packages LearnBabel
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3">编译安装 <code>Babel</code></h2>
<div class="outline-text-2" id="text-3">
<div class="org-src-container">

<pre class="src src-sh">git clone https://github.com/mitsuhiko/babel.git
<span style="color: #b294bb;">cd</span> babel
pip install pytz
python setup.py import_cldr
pip install --editable .
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4">常用信息国际化</h2>
<div class="outline-text-2" id="text-4">
<pre class="example">
&gt;&gt;&gt; from babel import Locale
&gt;&gt;&gt; locale = Locale('en', 'US')
&gt;&gt;&gt; print locale.territories['CN']
China
&gt;&gt;&gt; locale = Locale('zh')
&gt;&gt;&gt; print locale.territories['CN']
中国
&gt;&gt;&gt; month_names = locale.months['format']['wide'].items()
&gt;&gt;&gt; for idx, name in sorted(month_names):
...   print name
... 
一月
二月
三月
四月
五月
六月
七月
八月
九月
十月
十一月
十二月
&gt;&gt;&gt; from datetime import date
&gt;&gt;&gt; from babel.dates import format_date
&gt;&gt;&gt; today = date.today()
&gt;&gt;&gt; print format_date(today, locale='zh')
2014年3月9日
</pre>
</div>
</div>

<div id="outline-container-sec-5" class="outline-2">
<h2 id="sec-5">任意信息国际化</h2>
<div class="outline-text-2" id="text-5">
<ul class="org-ul">
<li>创建python程序： <code>hello.py</code>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #b5bd68;">import</span> gettext
gettext.bindtextdomain(<span style="color: #8abeb7;">'messages'</span>, <span style="color: #8abeb7;">'./hello.i18n'</span>)
<span style="color: #f0c674;">_</span> = gettext.gettext
<span style="color: #b5bd68;">print</span> _(<span style="color: #8abeb7;">'Hello'</span>)
</pre>
</div>
</li>

<li>创建Babel配置文件： <code>hello.babel</code>

<pre class="example">
[python: hello.py]
</pre>
</li>

<li>准备翻译成中文

<div class="org-src-container">

<pre class="src src-sh">mkdir hello.i18n
pybabel extract -F hello.babel . -o hello.i18n/messages.pot    <span style="color: #969896; font-style: italic;"># </span><span style="color: #969896; font-style: italic;">&#20174;&#28304;&#20195;&#30721;&#20013;&#25552;&#21462;&#21487;&#32763;&#35793;&#30340;&#25991;&#26412;&#21040;P</span><span style="color: #969896; font-style: italic; text-decoration: underline;">OT&#65288;PO&#27169;&#26495;&#65289;&#25991;&#20214;</span>
pybabel init -l zh_CN -d ./hello.i18n -i ./hello.i18n/messages.pot    <span style="color: #969896; font-style: italic;"># </span><span style="color: #969896; font-style: italic;">&#23558;POT&#25991;&#26412;&#25335;&#36125;</span><span style="color: #969896; font-style: italic; text-decoration: underline;">&#20986;&#19968;&#20221;&#25351;&#23450;&#35821;&#35328;&#30340;PO&#25991;&#20214;</span>
</pre>
</div>
</li>

<li>译成中文后的PO文件： <code>./hello.i18n/zh_CN/LC_MESSAGES/messages.po</code>

<pre class="example">
# Chinese (Simplified, China) translations for PROJECT.
# Copyright (C) 2014 ORGANIZATION
# This file is distributed under the same license as the PROJECT project.
# FIRST AUTHOR &lt;EMAIL@ADDRESS&gt;, 2014.
#
#, fuzzy
msgid ""
msgstr ""
"Project-Id-Version: PROJECT VERSION\n"
"Report-Msgid-Bugs-To: EMAIL@ADDRESS\n"
"POT-Creation-Date: 2014-03-09 19:08+0800\n"
"PO-Revision-Date: 2014-03-09 19:12+0800\n"
"Last-Translator: FULL NAME &lt;EMAIL@ADDRESS&gt;\n"
"Language-Team: zh_Hans_CN &lt;LL@li.org&gt;\n"
"Plural-Forms: nplurals=2; plural=(n != 1)\n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=utf-8\n"
"Content-Transfer-Encoding: 8bit\n"
"Generated-By: Babel 2.0-dev\n"

#: hello.py:1
msgid "Hello"
msgstr "喂"
</pre>
</li>

<li>编译翻译结果

<div class="org-src-container">

<pre class="src src-sh">pybabel compile -f -d ./hello.i18n    <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">&#32534;&#35793;PO&#25991;&#20214;&#20026;MO&#25991;&#20214;</span>
</pre>
</div>
</li>

<li>英文环境下运行程序

<pre class="example">
python ./hello.py
Hello
</pre>
</li>

<li>中文环境下运行程序

<pre class="example">
LC_ALL=zh_CN python ./hello.py
喂
</pre>
</li>

<li>更新 <code>hello.py</code> ，追加一句“      print _('World')”
</li>

<li>将“World”翻译成中文

<div class="org-src-container">

<pre class="src src-sh">pybabel extract -F hello.babel . -o hello.i18n/messages.pot    <span style="color: #969896; font-style: italic;"># </span><span style="color: #969896; font-style: italic;">&#20174;&#28304;&#20195;&#30721;&#20013;&#25552;&#21462;&#21487;&#32763;&#35793;&#30340;&#25991;&#26412;&#21040;P</span><span style="color: #969896; font-style: italic; text-decoration: underline;">OT&#65288;PO&#27169;&#26495;&#65289;&#25991;&#20214;</span>
pybabel update -l zh_CN -d ./hello.i18n -i ./hello.i18n/messages.pot    <span style="color: #969896; font-style: italic;"># </span><span style="color: #969896; font-style: italic;">&#20174;POT&#25991;&#26412;</span><span style="color: #969896; font-style: italic; text-decoration: underline;">&#26356;&#26032;&#25351;&#23450;&#35821;&#35328;&#30340;PO&#25991;&#20214;</span>
<span style="color: #969896; font-style: italic;"># </span><span style="color: #969896; font-style: italic;">&#24320;&#22987;&#32763;&#35793;&#25351;&#23450;&#35821;&#35328;&#30340;PO&#25991;&#20214;&#65306; hello.i18n/zh_CN/LC_MESSAGES/messages.po</span>
pybabel compile -f -d ./hello.i18n    <span style="color: #969896; font-style: italic;">#</span><span style="color: #969896; font-style: italic;">&#32534;&#35793;PO&#25991;&#20214;&#20026;MO&#25991;&#20214;</span>
</pre>
</div>
</li>

<li>再次运行

<pre class="example">
LC_ALL=zh_CN python ./hello.py
喂
世界
</pre>
</li>

<li>程序中强制使用中文语言： <code>hello.cn.py</code>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #b5bd68;">import</span> gettext

<span style="color: #f0c674;">t</span> = gettext.translation(<span style="color: #8abeb7;">'messages'</span>, <span style="color: #8abeb7;">'./hello.i18n'</span>, languages=[<span style="color: #8abeb7;">'zh_CN'</span>])
<span style="color: #f0c674;">_</span> = t.gettext

<span style="color: #b5bd68;">print</span> _(<span style="color: #8abeb7;">'Hello'</span>)
<span style="color: #b5bd68;">print</span> _(<span style="color: #8abeb7;">'World'</span>)
</pre>
</div>
</li>

<li>即使是在英文环境下也输出中文

<pre class="example">
LC_ALL=en_US python ./hello.py
喂
世界
</pre>
</li>
</ul>
</div>
</div>
]]></content:encoded>
        </item>
    </channel>
</rss>